<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CEO+ Help - 관리자 도구</title>
    <link rel="icon" type="image/jpeg" href="../favicon-32x32.jpg">
    <link rel="icon" type="image/jpeg" sizes="16x16" href="../favicon-16x16.jpg">
    <link rel="icon" type="image/jpeg" sizes="32x32" href="../favicon-32x32.jpg">
    
    <!-- TailwindCSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: {
                            50: '#fffbeb',
                            100: '#fef3c7',
                            200: '#fde68a',
                            300: '#fcd34d',
                            400: '#fbbf24',
                            500: '#f59e0b',
                            600: '#d97706',
                            700: '#b45309',
                            800: '#92400e',
                            900: '#78350f',
                        },
                        accent: {
                            50: '#fef2f2',
                            100: '#fee2e2',
                            200: '#fecaca',
                            300: '#fca5a5',
                            400: '#f87171',
                            500: '#ef4444',
                            600: '#dc2626',
                            700: '#b91c1c',
                            800: '#991b1b',
                            900: '#7f1d1d',
                        },
                        neutral: {
                            50: '#fafafa',
                            100: '#f5f5f5',
                            200: '#e5e5e5',
                            300: '#d4d4d4',
                            400: '#a3a3a3',
                            500: '#737373',
                            600: '#525252',
                            700: '#404040',
                            800: '#262626',
                            900: '#171717',
                        }
                    }
                }
            }
        }
    </script>
    
    <!-- XLSX 라이브러리 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    
    <style>
        :root {
            --header-height: 64px;
            --transition-speed: 0.3s;
        }

        /* 기본 레이아웃 */
        .app-layout {
            display: grid;
            grid-template-rows: var(--header-height) 1fr;
            grid-template-areas: 
                "header"
                "main";
            height: 100vh;
            background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%);
        }

        /* 햄버거 메뉴 버튼 */
        .hamburger-menu {
            display: none;
            width: 40px;
            height: 40px;
            padding: 8px;
            cursor: pointer;
            border-radius: 8px;
            transition: background 0.3s;
        }

        .hamburger-menu:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .hamburger-menu span {
            display: block;
            width: 100%;
            height: 2px;
            background: currentColor;
            margin: 5px 0;
            transition: all 0.3s;
        }

        /* 모바일 사이드바 */
        .mobile-sidebar {
            position: fixed;
            top: 0;
            left: -280px;
            width: 280px;
            height: 100vh;
            background: white;
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
            transition: left 0.3s;
            z-index: 100;
            overflow-y: auto;
        }

        .mobile-sidebar.active {
            left: 0;
        }

        .mobile-sidebar-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            z-index: 99;
        }

        .mobile-sidebar-overlay.active {
            display: block;
        }

        .mobile-nav-item {
            display: flex;
            align-items: center;
            padding: 1rem 1.5rem;
            border-bottom: 1px solid #e5e5e5;
            cursor: pointer;
            transition: background 0.2s;
        }

        .mobile-nav-item:hover {
            background: #f5f5f5;
        }

        .mobile-nav-item.active {
            background: linear-gradient(90deg, #fbbf24 0%, #f59e0b 100%);
            color: white;
        }

        .mobile-nav-item svg {
            width: 20px;
            height: 20px;
            margin-right: 12px;
        }

        /* 모바일 반응형 */
        @media (max-width: 768px) {
            .hamburger-menu {
                display: block;
            }

            .tab-container {
                display: none !important;
            }

            nav.flex-1 {
                display: none;
            }

            .main-content {
                padding: 1rem;
            }

            .card-grid {
                grid-template-columns: 1fr;
            }
        }

        .header {
            grid-area: header;
            background: linear-gradient(90deg, #fbbf24 0%, #f59e0b 100%);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            z-index: 50;
        }

        .main-content {
            grid-area: main;
            overflow-y: auto;
            padding: 2rem;
        }

        /* 카드 스타일 */
        .card {
            background: white;
            border-radius: 16px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            transition: all var(--transition-speed) ease;
            border: 1px solid rgba(251, 191, 36, 0.2);
        }

        .card:hover {
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            transform: translateY(-2px);
            border-color: rgba(251, 191, 36, 0.4);
        }

        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
        }

        /* 탭 스타일 */
        .tab-button {
            position: relative;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            font-weight: 500;
            transition: all var(--transition-speed) ease;
            color: rgba(0, 0, 0, 0.7);
        }

        .tab-button:hover {
            background: rgba(255, 255, 255, 0.2);
            color: rgba(0, 0, 0, 0.9);
        }

        .tab-button.active {
            background: rgba(255, 255, 255, 0.3);
            color: #000;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .tab-button.active::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 50%;
            transform: translateX(-50%);
            width: 50%;
            height: 2px;
            background: #dc2626;
            border-radius: 1px;
        }

        /* 툴 카드 특별 스타일 */
        .tool-card {
            cursor: pointer;
            overflow: hidden;
        }

        .tool-card .icon-container {
            background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
            width: 64px;
            height: 64px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 1rem;
            box-shadow: 0 4px 8px rgba(251, 191, 36, 0.3);
        }

        .tool-card:hover .icon-container {
            transform: scale(1.05);
            box-shadow: 0 8px 16px rgba(251, 191, 36, 0.4);
        }

        /* 로딩 스피너 */
        .loading-spinner {
            border: 3px solid #fde68a;
            border-top: 3px solid #f59e0b;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* 알림 토스트 */
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            border-left: 4px solid #f59e0b;
            padding: 1rem 1.5rem;
            z-index: 1000;
            animation: slideIn 0.3s ease;
            max-width: 400px;
        }

        .toast.success {
            border-left-color: #10b981;
        }

        .toast.error {
            border-left-color: #dc2626;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        /* 탭 텍스트 반응형 처리 */
        .tab-text {
            transition: all var(--transition-speed) ease;
        }
        
        /* 중간 크기에서 텍스트 숨김 (개행되기 전) */
        @media (max-width: 1024px) {
            .tab-text {
                display: none;
            }
            
            .tab-button svg {
                margin-right: 0 !important;
            }
            
            .tab-button {
                padding: 0.5rem 0.75rem;
                min-width: 44px;
                display: flex;
                align-items: center;
                justify-content: center;
            }
        }

        /* 모바일 반응형 */
        @media (max-width: 768px) {
            .main-content {
                padding: 1rem;
            }
            
            .card-grid {
                grid-template-columns: 1fr;
                gap: 1rem;
            }
            
            .tab-container {
                overflow-x: auto;
                scrollbar-width: none;
                -ms-overflow-style: none;
                justify-content: flex-start;
            }
            
            .tab-container::-webkit-scrollbar {
                display: none;
            }
            
            .tab-text {
                display: inline; /* 모바일에서는 다시 텍스트 표시 */
            }
            
            .tab-button svg {
                margin-right: 0.5rem !important;
            }
            
            .tab-button {
                padding: 0.5rem 1rem;
                min-width: auto;
                white-space: nowrap;
            }
        }

        /* 아주 작은 모바일에서는 아이콘만 */
        @media (max-width: 480px) {
            .tab-text {
                display: none;
            }
            
            .tab-button svg {
                margin-right: 0 !important;
            }
            
            .tab-button {
                padding: 0.5rem 0.75rem;
                min-width: 44px;
            }
        }

        /* 폼 스타일 */
        .form-input {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid #e5e5e5;
            border-radius: 8px;
            transition: border-color var(--transition-speed) ease;
            background: white;
        }

        .form-input:focus {
            outline: none;
            border-color: #fbbf24;
            box-shadow: 0 0 0 3px rgba(251, 191, 36, 0.1);
        }

        .btn-primary {
            background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
            color: black;
            font-weight: 600;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            transition: all var(--transition-speed) ease;
            box-shadow: 0 2px 4px rgba(251, 191, 36, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(251, 191, 36, 0.4);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%);
            color: white;
            font-weight: 600;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            transition: all var(--transition-speed) ease;
            box-shadow: 0 2px 4px rgba(220, 38, 38, 0.3);
        }

        .btn-secondary:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(220, 38, 38, 0.4);
        }

        /* 통계 카드 */
        .stat-card {
            background: linear-gradient(135deg, white 0%, #fffbeb 100%);
            border-left: 4px solid #fbbf24;
        }

        .stat-number {
            font-size: 2rem;
            font-weight: 700;
            color: #f59e0b;
        }
    </style>
</head>

<body>
    <!-- 모바일 사이드바 -->
    <div class="mobile-sidebar" id="mobileSidebar">
        <div class="p-4 bg-gradient-to-r from-primary-500 to-primary-600">
            <div class="flex items-center space-x-3">
                <img src="../logo.jpg" alt="CEO+ Help" class="w-10 h-10 rounded-lg shadow-md">
                <div>
                    <h1 class="text-lg font-bold text-white">CEO+ Help</h1>
                    <p class="text-xs text-white opacity-80">Admin Tools</p>
                </div>
            </div>
        </div>
        
        <nav class="py-2">
            <div class="mobile-nav-item active" data-tab="dashboard" onclick="showTabFromMobile('dashboard')">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2-2z"></path>
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5a2 2 0 012-2h4a2 2 0 012 2v6H8V5z"></path>
                </svg>
                <span data-ko="대시보드" data-en="Dashboard">대시보드</span>
            </div>
            
            <div class="mobile-nav-item" data-tab="admin-tools" onclick="showTabFromMobile('admin-tools')">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.096 2.572-1.065z"></path>
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                </svg>
                <span data-ko="어드민 활용" data-en="Admin Tools">어드민 활용</span>
            </div>
            
            <div class="mobile-nav-item" data-tab="data-tools" onclick="showTabFromMobile('data-tools')">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                </svg>
                <span data-ko="데이터 생성" data-en="Data Tools">데이터 생성</span>
            </div>
            
            <div class="mobile-nav-item" data-tab="settings" onclick="showTabFromMobile('settings')">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 100-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 100-4m0 4v2m0-6V4"></path>
                </svg>
                <span data-ko="설정" data-en="Settings">설정</span>
            </div>
        </nav>
        
        <div class="border-t border-gray-200 mt-4 pt-4 px-4">
            <button class="w-full p-3 bg-neutral-100 text-neutral-700 rounded-lg hover:bg-neutral-200 transition-colors" onclick="closeMobileSidebar()">
                <span data-ko="닫기" data-en="Close">닫기</span>
            </button>
        </div>
    </div>
    
    <!-- 모바일 사이드바 오버레이 -->
    <div class="mobile-sidebar-overlay" id="mobileSidebarOverlay" onclick="closeMobileSidebar()"></div>
    
    <div class="app-layout">
        <!-- 헤더 네비게이션 -->
        <header class="header">
            <div class="flex items-center justify-between h-full px-4 lg:px-8">
                <!-- 로고 -->
                <div class="flex items-center space-x-4">
                    <!-- 햄버거 메뉴 버튼 -->
                    <div class="hamburger-menu" onclick="toggleMobileSidebar()">
                        <span></span>
                        <span></span>
                        <span></span>
                    </div>
                    <img src="../logo.jpg" alt="CEO+ Help" class="w-12 h-12 rounded-lg shadow-md">
                    <div class="hidden sm:block">
                        <h1 class="text-xl font-bold text-black">CEO+</h1>
                        <p class="text-sm font-semibold text-red-600">Help</p>
                    </div>
                </div>

                <!-- 네비게이션 탭 -->
                <nav class="flex-1 mx-8">
                    <div class="tab-container flex space-x-1 justify-center">
                        <button class="tab-button active" onclick="showTab('dashboard')" id="tab-dashboard">
                            <svg class="w-5 h-5 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2-2z"></path>
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5a2 2 0 012-2h4a2 2 0 012 2v6H8V5z"></path>
                            </svg>
                            <span class="tab-text" data-ko="대시보드" data-en="Dashboard">대시보드</span>
                        </button>
                        <button class="tab-button" onclick="showTab('admin-tools')" id="tab-admin-tools">
                            <svg class="w-5 h-5 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.096 2.572-1.065z"></path>
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                            </svg>
                            <span class="tab-text" data-ko="어드민 활용" data-en="Admin Tools">어드민 활용</span>
                        </button>
                        <button class="tab-button" onclick="showTab('data-tools')" id="tab-data-tools">
                            <svg class="w-5 h-5 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                            </svg>
                            <span class="tab-text" data-ko="데이터 생성" data-en="Data Tools">데이터 생성</span>
                        </button>
                        <button class="tab-button" onclick="showTab('settings')" id="tab-settings">
                            <svg class="w-5 h-5 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 100-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 100-4m0 4v2m0-6V4"></path>
                            </svg>
                            <span class="tab-text" data-ko="설정" data-en="Settings">설정</span>
                        </button>
                    </div>
                </nav>

                <!-- 우측 유틸리티 -->
                <div class="flex items-center space-x-3">
                    <!-- 언어 선택 버튼 -->
                    <div class="relative">
                        <button class="px-3 py-1.5 rounded-lg bg-white bg-opacity-20 hover:bg-opacity-30 transition-all text-sm font-medium" onclick="toggleLanguage()">
                            <span id="current-lang" class="text-black">KOR</span>
                            <span class="text-black opacity-50 mx-1">|</span>
                            <span id="other-lang" class="text-black opacity-50">ENG</span>
                        </button>
                    </div>
                    
                    <!-- 알림 버튼 -->
                    <div class="relative">
                        <button class="p-2 rounded-lg bg-white bg-opacity-20 hover:bg-opacity-30 transition-all" onclick="showNotifications()">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18 8A6 6 0 006 8c0 7-3 9-3 9h18s-3-2-3-9z"></path>
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m13.73 21a2 2 0 01-3.46 0"></path>
                            </svg>
                        </button>
                        <span id="notification-badge" class="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center hidden">3</span>
                    </div>
                </div>
            </div>
        </header>

        <!-- 메인 콘텐츠 -->
        <main class="main-content">
            <!-- 대시보드 탭 -->
            <div id="dashboard-content" class="tab-content">
                <div class="mb-8">
                    <div class="flex items-center justify-between">
                        <div>
                            <h2 id="dashboard-title" class="text-3xl font-bold text-neutral-800 mb-2">대시보드</h2>
                            <p id="dashboard-desc" class="text-neutral-600">CEO+ Help의 전체 현황을 확인하세요</p>
                        </div>
                        <!-- 기간 필터 -->
                        <div class="flex items-center space-x-2">
                            <button onclick="changeDateRange('day')" id="range-day" class="px-3 py-1 rounded-lg bg-primary-100 text-primary-800 font-medium"><span data-ko="오늘" data-en="Today">오늘</span></button>
                            <button onclick="changeDateRange('week')" id="range-week" class="px-3 py-1 rounded-lg hover:bg-neutral-100"><span data-ko="주간" data-en="Week">주간</span></button>
                            <button onclick="changeDateRange('month')" id="range-month" class="px-3 py-1 rounded-lg hover:bg-neutral-100"><span data-ko="월간" data-en="Month">월간</span></button>
                            <button onclick="changeDateRange('year')" id="range-year" class="px-3 py-1 rounded-lg hover:bg-neutral-100"><span data-ko="연간" data-en="Year">연간</span></button>
                        </div>
                    </div>
                </div>

                <!-- 통계 카드들 -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                    <div class="card stat-card p-6" data-ko-title="오늘 사용한 고유 기능 수" data-en-title="Number of unique features used today">
                        <div class="flex items-center justify-between">
                            <div>
                                <p id="active-sessions-label" class="text-sm font-medium text-neutral-600"><span data-ko="오늘 활동" data-en="Today's Activity">오늘 활동</span></p>
                                <p class="stat-number" id="active-sessions">0</p>
                                <p class="text-xs text-neutral-500 mt-1"><span data-ko="고유 기능 사용" data-en="Unique features used">고유 기능 사용</span></p>
                            </div>
                            <div class="w-12 h-12 bg-primary-100 rounded-lg flex items-center justify-center">
                                <svg class="w-6 h-6 text-primary-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                                </svg>
                            </div>
                        </div>
                    </div>

                    <div class="card stat-card p-6" data-ko-title="선택한 기간 동안 완료된 작업" data-en-title="Tasks completed during selected period">
                        <div class="flex items-center justify-between">
                            <div>
                                <p id="completed-tasks-label" class="text-sm font-medium text-neutral-600"><span data-ko="완료된 작업" data-en="Completed Tasks">완료된 작업</span></p>
                                <p class="stat-number" id="completed-tasks">0</p>
                                <p class="text-xs text-neutral-500 mt-1"><span data-ko="성공적으로 완료" data-en="Successfully completed">성공적으로 완료</span></p>
                            </div>
                            <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center">
                                <svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                            </div>
                        </div>
                    </div>

                    <div class="card stat-card p-6" data-ko-title="현재 브라우저에 저장된 토큰" data-en-title="Tokens saved in current browser">
                        <div class="flex items-center justify-between">
                            <div>
                                <p id="saved-tokens-label" class="text-sm font-medium text-neutral-600"><span data-ko="저장된 토큰" data-en="Saved Tokens">저장된 토큰</span></p>
                                <p class="stat-number" id="token-count">0</p>
                                <p class="text-xs text-neutral-500 mt-1"><span data-ko="현재 활성" data-en="Currently active">현재 활성</span></p>
                            </div>
                            <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center">
                                <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"></path>
                                </svg>
                            </div>
                        </div>
                    </div>

                    <div class="card stat-card p-6" data-ko-title="데이터 생성 도구로 생성한 파일" data-en-title="Files generated with data tools">
                        <div class="flex items-center justify-between">
                            <div>
                                <p id="generated-files-label" class="text-sm font-medium text-neutral-600"><span data-ko="생성된 파일" data-en="Generated Files">생성된 파일</span></p>
                                <p class="stat-number" id="file-count">0</p>
                                <p class="text-xs text-neutral-500 mt-1"><span data-ko="데이터 파일" data-en="Data files">데이터 파일</span></p>
                            </div>
                            <div class="w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center">
                                <svg class="w-6 h-6 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                                </svg>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 최근 활동 -->
                <div class="card p-6">
                    <div class="flex items-center justify-between mb-4">
                        <h3 id="recent-activities-title" class="text-xl font-bold text-neutral-800">최근 활동</h3>
                        <button onclick="clearActivityHistory()" class="text-sm text-neutral-500 hover:text-red-600">
                            <span data-ko="기록 삭제" data-en="Clear History">기록 삭제</span>
                        </button>
                    </div>
                    <div id="recent-activities" class="space-y-4">
                        <!-- 실제 활동이 여기에 표시됩니다 -->
                    </div>
                </div>
            </div>

            <!-- 어드민 도구 탭 -->
            <div id="admin-tools-content" class="tab-content hidden">
                <div class="mb-8">
                    <div class="flex items-center justify-between">
                        <div>
                            <h2 id="admin-tools-title" class="text-3xl font-bold text-neutral-800 mb-2">어드민 활용</h2>
                            <p id="admin-tools-desc" class="text-neutral-600">가맹점 관리 및 시스템 운영 도구들</p>
                        </div>
                        <div class="flex gap-2">
                            <button onclick="openAdminToolManager()" class="btn-secondary">
                                <svg class="w-4 h-4 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                </svg>
                                <span data-ko="관리" data-en="Manage">관리</span>
                            </button>
                            <button onclick="exportAdminConfig()" class="btn-secondary">
                                <svg class="w-4 h-4 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path>
                                </svg>
                                <span data-ko="내보내기" data-en="Export">내보내기</span>
                            </button>
                            <label class="btn-primary cursor-pointer">
                                <svg class="w-4 h-4 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"></path>
                                </svg>
                                <span data-ko="불러오기" data-en="Import">불러오기</span>
                                <input type="file" accept=".json" onchange="importAdminConfig(event)" class="hidden">
                            </label>
                        </div>
                    </div>
                </div>

                <div id="admin-tools-grid" class="card-grid">
                    <!-- 동적으로 로드될 어드민 도구 카드들 -->
                </div>
            </div>

            <!-- 데이터 생성 도구 탭 -->
            <div id="data-tools-content" class="tab-content hidden">
                <div class="mb-8">
                    <h2 id="data-tools-title" class="text-3xl font-bold text-neutral-800 mb-2">데이터 생성 도구</h2>
                    <p id="data-tools-desc" class="text-neutral-600">테스트 데이터 및 샘플 파일 생성 도구들</p>
                </div>

                <div class="card-grid">
                    <div class="card tool-card p-6" onclick="openDataTool('sample-image')">
                        <div class="icon-container">
                            <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                            </svg>
                        </div>
                        <h3 class="text-xl font-bold text-neutral-800 mb-2"><span data-ko="샘플 이미지 생성기" data-en="Sample Image Generator">샘플 이미지 생성기</span></h3>
                        <p class="text-neutral-600 mb-4"><span data-ko="다양한 크기와 포맷의 테스트 이미지를 생성합니다" data-en="Generate test images in various sizes and formats">다양한 크기와 포맷의 테스트 이미지를 생성합니다</span></p>
                        <div class="flex items-center text-sm text-neutral-500">
                            <span class="bg-purple-100 text-purple-800 px-2 py-1 rounded text-xs mr-2"><span data-ko="이미지 도구" data-en="Image Tool">이미지 도구</span></span>
                            <span>→</span>
                        </div>
                    </div>

                    <div class="card tool-card p-6" onclick="openDataTool('qr-xlsx')">
                        <div class="icon-container">
                            <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                            </svg>
                        </div>
                        <h3 class="text-xl font-bold text-neutral-800 mb-2"><span data-ko="QR XLSX 생성기" data-en="QR XLSX Generator">QR XLSX 생성기</span></h3>
                        <p class="text-neutral-600 mb-4"><span data-ko="QR 코드 정보가 포함된 엑셀 파일을 생성합니다" data-en="Generate Excel files with QR code information">QR 코드 정보가 포함된 엑셀 파일을 생성합니다</span></p>
                        <div class="flex items-center text-sm text-neutral-500">
                            <span class="bg-green-100 text-green-800 px-2 py-1 rounded text-xs mr-2"><span data-ko="엑셀 도구" data-en="Excel Tool">엑셀 도구</span></span>
                            <span>→</span>
                        </div>
                    </div>

                    <div class="card tool-card p-6" onclick="openDataTool('csv-generator')">
                        <div class="icon-container">
                            <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                            </svg>
                        </div>
                        <h3 class="text-xl font-bold text-neutral-800 mb-2"><span data-ko="CSV 생성기" data-en="CSV Generator">CSV 생성기</span></h3>
                        <p class="text-neutral-600 mb-4"><span data-ko="커스텀 CSV 파일을 생성하고 다운로드합니다" data-en="Generate and download custom CSV files">커스텀 CSV 파일을 생성하고 다운로드합니다</span></p>
                        <div class="flex items-center text-sm text-neutral-500">
                            <span class="bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs mr-2"><span data-ko="데이터 도구" data-en="Data Tool">데이터 도구</span></span>
                            <span>→</span>
                        </div>
                    </div>

                    <div class="card tool-card p-6" onclick="openDataTool('profile-generator')">
                        <div class="icon-container">
                            <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                            </svg>
                        </div>
                        <h3 class="text-xl font-bold text-neutral-800 mb-2"><span data-ko="프로필 이미지 생성기" data-en="Profile Image Generator">프로필 이미지 생성기</span></h3>
                        <p class="text-neutral-600 mb-4"><span data-ko="텍스트 기반 프로필 이미지를 환경별 칩과 함께 생성합니다" data-en="Generate text-based profile images with environment chips">텍스트 기반 프로필 이미지를 환경별 칩과 함께 생성합니다</span></p>
                        <div class="flex items-center text-sm text-neutral-500">
                            <span class="bg-indigo-100 text-indigo-800 px-2 py-1 rounded text-xs mr-2"><span data-ko="프로필 도구" data-en="Profile Tool">프로필 도구</span></span>
                            <span>→</span>
                        </div>
                    </div>

                    <div class="card tool-card p-6" onclick="openDataTool('env-badge')">
                        <div class="icon-container">
                            <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"></path>
                            </svg>
                        </div>
                        <h3 class="text-xl font-bold text-neutral-800 mb-2"><span data-ko="환경 뱃지 생성기" data-en="Environment Badge Generator">환경 뱃지 생성기</span></h3>
                        <p class="text-neutral-600 mb-4"><span data-ko="QA, 개발, 운영 환경을 구분하는 뱃지를 생성합니다" data-en="Generate badges to distinguish QA, dev, and production environments">QA, 개발, 운영 환경을 구분하는 뱃지를 생성합니다</span></p>
                        <div class="flex items-center text-sm text-neutral-500">
                            <span class="bg-amber-100 text-amber-800 px-2 py-1 rounded text-xs mr-2"><span data-ko="뱃지 도구" data-en="Badge Tool">뱃지 도구</span></span>
                            <span>→</span>
                        </div>
                    </div>

                    <div class="card tool-card p-6" onclick="openDataTool('business-number')">
                        <div class="icon-container">
                            <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"></path>
                            </svg>
                        </div>
                        <h3 class="text-xl font-bold text-neutral-800 mb-2"><span data-ko="사업자등록번호 생성기" data-en="Business Number Generator">사업자등록번호 생성기</span></h3>
                        <p class="text-neutral-600 mb-4"><span data-ko="유효한 한국 사업자등록번호를 생성합니다" data-en="Generate valid Korean business registration numbers">유효한 한국 사업자등록번호를 생성합니다</span></p>
                        <div class="flex items-center text-sm text-neutral-500">
                            <span class="bg-teal-100 text-teal-800 px-2 py-1 rounded text-xs mr-2"><span data-ko="번호 생성" data-en="Number Generator">번호 생성</span></span>
                            <span>→</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 설정 탭 -->
            <div id="settings-content" class="tab-content hidden">
                <div class="mb-8">
                    <h2 id="settings-title" class="text-3xl font-bold text-neutral-800 mb-2">설정</h2>
                    <p id="settings-desc" class="text-neutral-600">시스템 설정 및 토큰 관리</p>
                </div>

                <div class="space-y-6">
                    <!-- 토큰 관리 카드 -->
                    <div class="card p-6">
                        <h3 id="token-management-title" class="text-xl font-bold text-neutral-800 mb-4">토큰 관리</h3>
                        <div class="space-y-4">
                            <div class="flex items-center justify-between p-4 bg-neutral-50 rounded-lg">
                                <div>
                                    <p class="font-medium text-neutral-800"><span data-ko="토큰 상태" data-en="Token Status">토큰 상태</span></p>
                                    <p class="text-sm text-neutral-600" id="token-status-detail"><span data-ko="토큰 확인 중..." data-en="Checking tokens...">토큰 확인 중...</span></p>
                                </div>
                                <button class="btn-primary" onclick="syncTokens()">
                                    🔄 <span data-ko="토큰 동기화" data-en="Sync Tokens">토큰 동기화</span>
                                </button>
                            </div>
                            <div class="flex space-x-4">
                                <button class="btn-secondary" onclick="showCookieModal()">
                                    🍪 <span data-ko="쿠키 관리" data-en="Manage Cookies">쿠키 관리</span>
                                </button>
                                <button class="btn-primary" onclick="exportTokens()">
                                    📤 <span data-ko="토큰 내보내기" data-en="Export Tokens">토큰 내보내기</span>
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- 시스템 설정 카드 -->
                    <div class="card p-6">
                        <h3 id="system-settings-title" class="text-xl font-bold text-neutral-800 mb-4">시스템 설정</h3>
                        <div class="space-y-4">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="font-medium text-neutral-800"><span data-ko="다크 모드" data-en="Dark Mode">다크 모드</span></p>
                                    <p class="text-sm text-neutral-600"><span data-ko="인터페이스 테마 변경" data-en="Change interface theme">인터페이스 테마 변경</span></p>
                                </div>
                                <label class="relative inline-flex items-center cursor-pointer">
                                    <input type="checkbox" class="sr-only peer" id="dark-mode-toggle">
                                    <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-primary-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-primary-600"></div>
                                </label>
                            </div>
                            
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="font-medium text-neutral-800"><span data-ko="자동 저장" data-en="Auto Save">자동 저장</span></p>
                                    <p class="text-sm text-neutral-600"><span data-ko="작업 내용 자동 저장" data-en="Automatically save work">작업 내용 자동 저장</span></p>
                                </div>
                                <label class="relative inline-flex items-center cursor-pointer">
                                    <input type="checkbox" class="sr-only peer" id="auto-save-toggle" checked>
                                    <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-primary-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-primary-600"></div>
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- 정보 카드 -->
                    <div class="card p-6">
                        <h3 id="system-info-title" class="text-xl font-bold text-neutral-800 mb-4">시스템 정보</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="p-4 bg-neutral-50 rounded-lg">
                                <p class="text-sm font-medium text-neutral-600"><span data-ko="버전" data-en="Version">버전</span></p>
                                <p class="text-lg font-bold text-neutral-800">v2.1.0</p>
                            </div>
                            <div class="p-4 bg-neutral-50 rounded-lg">
                                <p class="text-sm font-medium text-neutral-600"><span data-ko="마지막 업데이트" data-en="Last Update">마지막 업데이트</span></p>
                                <p class="text-lg font-bold text-neutral-800">2024-08-15</p>
                            </div>
                            <div class="p-4 bg-neutral-50 rounded-lg">
                                <p class="text-sm font-medium text-neutral-600"><span data-ko="총 사용자" data-en="Total Users">총 사용자</span></p>
                                <p class="text-lg font-bold text-neutral-800"><span data-ko="247명" data-en="247">247명</span></p>
                            </div>
                            <div class="p-4 bg-neutral-50 rounded-lg">
                                <p class="text-sm font-medium text-neutral-600"><span data-ko="업타임" data-en="Uptime">업타임</span></p>
                                <p class="text-lg font-bold text-neutral-800">99.9%</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- 쿠키 관리 모달 -->
    <div id="cookie-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50">
        <div class="bg-white rounded-2xl p-8 max-w-2xl w-full m-4 max-h-[80vh] overflow-y-auto">
            <h3 class="text-2xl font-bold text-neutral-800 mb-6">🍪 <span data-ko="쿠키 관리" data-en="Cookie Management">쿠키 관리</span></h3>
            <div class="mb-6">
                <h4 class="font-medium text-neutral-700 mb-3"><span data-ko="현재 저장된 쿠키:" data-en="Current Saved Cookies:">현재 저장된 쿠키:</span></h4>
                <div id="cookie-list" class="bg-neutral-100 p-4 rounded-lg text-sm font-mono max-h-40 overflow-y-auto">
                    <span data-ko="로딩중..." data-en="Loading...">로딩중...</span>
                </div>
            </div>
            <div class="mb-6">
                <h4 class="font-medium text-neutral-700 mb-3"><span data-ko="쿠키 추가/수정:" data-en="Add/Edit Cookie:">쿠키 추가/수정:</span></h4>
                <input id="cookie-input" type="text"
                       placeholder="name=value; domain=.example.com; path=/"
                       class="form-input mb-3">
                <button onclick="addCookie()" class="btn-primary">
                    <span data-ko="쿠키 추가" data-en="Add Cookie">쿠키 추가</span>
                </button>
            </div>
            <button onclick="closeCookieModal()" class="w-full p-3 bg-neutral-300 text-neutral-700 rounded-lg hover:bg-neutral-400 transition-colors">
                <span data-ko="닫기" data-en="Close">닫기</span>
            </button>
        </div>
    </div>

    <!-- 도구 상세 모달 -->
    <div id="tool-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50">
        <div class="bg-white rounded-2xl max-w-4xl w-full m-4 max-h-[90vh] overflow-hidden">
            <div class="p-6 border-b border-neutral-200 flex items-center justify-between">
                <h3 id="tool-modal-title" class="text-2xl font-bold text-neutral-800"><span data-ko="도구" data-en="Tool">도구</span></h3>
                <button onclick="closeToolModal()" class="p-2 hover:bg-neutral-100 rounded-lg transition-colors">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            <div id="tool-modal-content" class="p-6 overflow-y-auto" style="max-height: calc(90vh - 100px);">
                <!-- 도구별 콘텐츠가 여기에 로드됩니다 -->
            </div>
        </div>
    </div>

    <!-- 어드민 도구 관리 모달 -->
    <div id="admin-manager-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50">
        <div class="bg-white rounded-2xl max-w-5xl w-full m-4 max-h-[90vh] overflow-hidden">
            <div class="p-6 border-b border-neutral-200 flex items-center justify-between">
                <h3 class="text-2xl font-bold text-neutral-800">
                    <span data-ko="어드민 도구 관리" data-en="Admin Tool Manager">어드민 도구 관리</span>
                </h3>
                <button onclick="closeAdminToolManager()" class="p-2 hover:bg-neutral-100 rounded-lg transition-colors">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            <div class="p-6 overflow-y-auto" style="max-height: calc(90vh - 100px);">
                <!-- 도구 추가 섹션 -->
                <div class="mb-6 p-4 bg-neutral-50 rounded-lg">
                    <h4 class="font-semibold text-neutral-800 mb-4">
                        <span data-ko="새 도구 추가" data-en="Add New Tool">새 도구 추가</span>
                    </h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-neutral-700 mb-2">
                                <span data-ko="도구 이름" data-en="Tool Name">도구 이름</span>
                            </label>
                            <input type="text" id="new-tool-name" class="form-input" placeholder="예: 가맹점 생성">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-neutral-700 mb-2">
                                <span data-ko="태그" data-en="Tag">태그</span>
                            </label>
                            <input type="text" id="new-tool-tag" class="form-input" placeholder="예: 3개 어드민">
                        </div>
                        <div class="md:col-span-2">
                            <label class="block text-sm font-medium text-neutral-700 mb-2">
                                <span data-ko="설명" data-en="Description">설명</span>
                            </label>
                            <textarea id="new-tool-desc" class="form-input" rows="2" placeholder="도구의 기능을 설명하세요"></textarea>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-neutral-700 mb-2">
                                <span data-ko="아이콘 타입" data-en="Icon Type">아이콘 타입</span>
                            </label>
                            <select id="new-tool-icon" class="form-input">
                                <option value="plus">➕ 추가</option>
                                <option value="refresh">🔄 새로고침</option>
                                <option value="lock">🔒 보안</option>
                                <option value="chart">📊 차트</option>
                                <option value="settings">⚙️ 설정</option>
                                <option value="users">👥 사용자</option>
                                <option value="store">🏪 매장</option>
                                <option value="qr">📱 QR</option>
                            </select>
                        </div>
                    </div>
                    <button onclick="addAdminTool()" class="btn-primary mt-4">
                        <span data-ko="도구 추가" data-en="Add Tool">도구 추가</span>
                    </button>
                </div>

                <!-- 기존 도구 목록 -->
                <div>
                    <h4 class="font-semibold text-neutral-800 mb-4">
                        <span data-ko="등록된 도구 목록" data-en="Registered Tools">등록된 도구 목록</span>
                    </h4>
                    <div id="admin-tools-list" class="space-y-2">
                        <!-- 동적으로 로드될 도구 목록 -->
                    </div>
                </div>

                <!-- 기본값 복원 -->
                <div class="mt-6 pt-6 border-t flex justify-between">
                    <button onclick="loadDefaultAdminTools()" class="btn-secondary">
                        <span data-ko="기본값 복원" data-en="Restore Defaults">기본값 복원</span>
                    </button>
                    <button onclick="downloadDefaultConfig()" class="btn-secondary">
                        <span data-ko="기본 설정 다운로드" data-en="Download Default Config">기본 설정 다운로드</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // 전역 변수
        let currentTab = 'dashboard';
        let windowRefs = {};
        let currentLanguage = 'ko'; // 기본 언어는 한국어
        let notificationHistory = []; // 알림 히스토리
        let maxNotifications = 100; // 최대 알림 보관 개수
        let activityHistory = []; // 활동 히스토리
        let maxActivities = 100; // 최대 활동 보관 개수
        const ACTIVITY_STORAGE_KEY = 'ceoplus_activity_history'; // 로컬스토리지 키
        let currentDateRange = 'day'; // 현재 선택된 기간 필터

        // 다국어 텍스트 데이터
        const translations = {
            ko: {
                // 헤더 및 네비게이션
                dashboard: "대시보드",
                adminTools: "어드민 활용",
                dataTools: "데이터 생성", 
                settings: "설정",
                
                // 대시보드
                dashboardTitle: "대시보드",
                dashboardDesc: "CEO+ Help의 전체 현황을 확인하세요",
                activeSessions: "활성 세션",
                completedTasks: "완료된 작업",
                savedTokens: "저장된 토큰",
                generatedFiles: "생성된 파일",
                recentActivities: "최근 활동",
                
                // 어드민 도구
                adminToolsTitle: "어드민 활용",
                adminToolsDesc: "가맹점 관리 및 시스템 운영 도구들",
                
                // 데이터 생성 도구
                dataToolsTitle: "데이터 생성 도구",
                dataToolsDesc: "테스트 데이터 및 샘플 파일 생성 도구들",
                
                // 설정
                settingsTitle: "설정",
                settingsDesc: "시스템 설정 및 토큰 관리",
                tokenManagement: "토큰 관리",
                systemSettings: "시스템 설정",
                systemInfo: "시스템 정보",
                
                // 알림 및 활동
                notifications: "알림",
                noNotifications: "새로운 알림이 없습니다",
                clearNotifications: "모든 알림 지우기",
                requestStarted: "요청 시작됨",
                requestCompleted: "요청 완료됨",
                requestFailed: "요청 실패",
                
                // 요청 타입
                adminToolRequest: "어드민 도구 실행",
                dataGenerationRequest: "데이터 생성",
                tokenSyncRequest: "토큰 동기화",
                cookieManagementRequest: "쿠키 관리",
                languageChangeRequest: "언어 변경",
                
                // 시간 표시
                justNow: "방금 전",
                minutesAgo: "분 전",
                hoursAgo: "시간 전",
                daysAgo: "일 전"
            },
            en: {
                // 헤더 및 네비게이션
                dashboard: "Dashboard",
                adminTools: "Admin Tools",
                dataTools: "Data Tools",
                settings: "Settings",
                
                // 대시보드
                dashboardTitle: "Dashboard",
                dashboardDesc: "Check the overall status of CEO+ Help",
                activeSessions: "Active Sessions",
                completedTasks: "Completed Tasks", 
                savedTokens: "Saved Tokens",
                generatedFiles: "Generated Files",
                recentActivities: "Recent Activities",
                
                // 어드민 도구
                adminToolsTitle: "Admin Tools",
                adminToolsDesc: "Store management and system operation tools",
                
                // 데이터 생성 도구
                dataToolsTitle: "Data Generation Tools",
                dataToolsDesc: "Test data and sample file generation tools",
                
                // 설정
                settingsTitle: "Settings",
                settingsDesc: "System settings and token management",
                tokenManagement: "Token Management",
                systemSettings: "System Settings", 
                systemInfo: "System Information",
                
                // 알림 및 활동
                notifications: "Notifications",
                noNotifications: "No new notifications",
                clearNotifications: "Clear all notifications",
                requestStarted: "Request started",
                requestCompleted: "Request completed",
                requestFailed: "Request failed",
                
                // 요청 타입
                adminToolRequest: "Admin tool execution",
                dataGenerationRequest: "Data generation",
                tokenSyncRequest: "Token synchronization",
                cookieManagementRequest: "Cookie management",
                languageChangeRequest: "Language change",
                
                // 시간 표시
                justNow: "Just now",
                minutesAgo: "min ago",
                hoursAgo: "hr ago",
                daysAgo: "day ago"
            }
        };
        
        // 기존 기능 데이터
        const functionData = {
            'qr-create': {
                name: '가맹점 생성 및 QR 활성화',
                admins: [
                    { name: '와칸다_신청서', url: 'https://www.google.com', desc: '가맹점 신청서 작성', isInternal: false },
                    { name: '와칸다_활성화', url: 'https://www.naver.com', desc: '가맹점 활성화 처리', isInternal: false },
                    { name: '오프라인_QR생성요청', url: 'https://admin.example.com/qr', desc: '오프라인 QR 생성', isInternal: true }
                ]
            },
            'qr-recovery': {
                name: '가맹점 QR 복구',
                admins: [
                    { name: 'QR 관리', url: 'https://admin.example.com/qr-manage', desc: 'QR 복구', isInternal: true },
                    { name: '로그 관리', url: 'https://admin.example.com/logs', desc: '로그 확인', isInternal: true },
                    { name: '가맹점 관리', url: 'https://www.kakao.com', desc: '상태 확인', isInternal: false }
                ]
            },
            'permission': {
                name: '매장 권한변경',
                admins: [
                    { name: '권한 관리', url: 'https://admin.example.com/permissions', desc: '권한 설정', isInternal: true },
                    { name: '사용자 관리', url: 'https://admin.example.com/users', desc: '역할 관리', isInternal: true },
                    { name: '감사 관리', url: 'https://www.youtube.com', desc: '변경 이력', isInternal: false }
                ]
            }
        };

        // 모바일 사이드바 토글
        function toggleMobileSidebar() {
            const sidebar = document.getElementById('mobileSidebar');
            const overlay = document.getElementById('mobileSidebarOverlay');
            
            sidebar.classList.toggle('active');
            overlay.classList.toggle('active');
        }
        
        // 모바일 사이드바 닫기
        function closeMobileSidebar() {
            const sidebar = document.getElementById('mobileSidebar');
            const overlay = document.getElementById('mobileSidebarOverlay');
            
            sidebar.classList.remove('active');
            overlay.classList.remove('active');
        }
        
        // 모바일에서 탭 전환
        function showTabFromMobile(tabName) {
            showTab(tabName);
            closeMobileSidebar();
        }

        // 탭 전환 함수
        function showTab(tabName) {
            // 모든 탭 버튼 비활성화
            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // 모든 탭 콘텐츠 숨기기
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.add('hidden');
            });
            
            // 선택된 탭 활성화
            const tabButton = document.getElementById(`tab-${tabName}`);
            if (tabButton) {
                tabButton.classList.add('active');
            }
            document.getElementById(`${tabName}-content`).classList.remove('hidden');
            
            // 모바일 네비게이션 업데이트
            document.querySelectorAll('.mobile-nav-item').forEach(item => {
                item.classList.remove('active');
                if (item.getAttribute('data-tab') === tabName) {
                    item.classList.add('active');
                }
            });
            
            currentTab = tabName;
            
            // 탭 변경 시 추가 로직
            if (tabName === 'dashboard') {
                updateDashboardStats();
            }
        }

        // 대시보드 통계 업데이트
        function updateDashboardStats() {
            // 기간별 필터링
            const now = new Date();
            const filteredActivities = getFilteredActivities(currentDateRange);
            
            // 고유 기능 사용 수
            const uniqueActions = new Set(filteredActivities.map(a => a.type + ':' + a.action)).size;
            document.getElementById('active-sessions').textContent = uniqueActions;
            
            // 완료된 작업 수
            const completedTasks = filteredActivities.filter(a => a.status === 'completed').length;
            document.getElementById('completed-tasks').textContent = completedTasks;
            
            // 현재 저장된 토큰 수 (실제 토큰 체크)
            updateTokenStatus();
            
            // 생성된 파일 수
            const generatedFiles = filteredActivities.filter(a => a.type === 'data-generation' && a.status === 'completed').length;
            document.getElementById('file-count').textContent = generatedFiles;
            
            // 최근 활동 업데이트
            updateRecentActivities();
        }
        
        // 기간별 활동 필터링
        function getFilteredActivities(range) {
            const now = new Date();
            const startDate = new Date();
            
            switch(range) {
                case 'day':
                    startDate.setHours(0, 0, 0, 0);
                    break;
                case 'week':
                    startDate.setDate(now.getDate() - 7);
                    break;
                case 'month':
                    startDate.setMonth(now.getMonth() - 1);
                    break;
                case 'year':
                    startDate.setFullYear(now.getFullYear() - 1);
                    break;
            }
            
            return activityHistory.filter(a => new Date(a.timestamp) >= startDate);
        }
        
        // 날짜 범위 변경
        function changeDateRange(range) {
            currentDateRange = range;
            
            // 버튼 스타일 업데이트
            document.querySelectorAll('[id^="range-"]').forEach(btn => {
                btn.classList.remove('bg-primary-100', 'text-primary-800', 'font-medium');
                btn.classList.add('hover:bg-neutral-100');
            });
            
            const activeBtn = document.getElementById(`range-${range}`);
            activeBtn.classList.add('bg-primary-100', 'text-primary-800', 'font-medium');
            activeBtn.classList.remove('hover:bg-neutral-100');
            
            // 통계 업데이트
            updateDashboardStats();
        }
        
        // 활동 기록 삭제
        function clearActivityHistory() {
            if (confirm(currentLanguage === 'ko' ? '모든 활동 기록을 삭제하시겠습니까?' : 'Delete all activity history?')) {
                activityHistory = [];
                saveActivityHistory();
                updateDashboardStats();
                showToast(currentLanguage === 'ko' ? '활동 기록이 삭제되었습니다' : 'Activity history cleared', 'success');
            }
        }

        // 최근 활동 업데이트
        function updateRecentActivities() {
            const container = document.getElementById('recent-activities');
            if (!container) return;
            
            // 시간 내림차순 정렬 후 최근 5개만
            const recentActivities = activityHistory
                .sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp))
                .slice(0, 5);
            
            if (recentActivities.length === 0) {
                container.innerHTML = `
                    <div class="text-center text-neutral-500 py-8">
                        <svg class="w-12 h-12 mx-auto mb-3 text-neutral-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path>
                        </svg>
                        <p class="text-sm">${currentLanguage === 'ko' ? '최근 활동이 없습니다' : 'No recent activities'}</p>
                    </div>
                `;
                return;
            }
            
            let activitiesHTML = '';
            recentActivities.forEach(activity => {
                const timeAgo = getTimeAgo(activity.timestamp);
                const statusColor = getActivityColor(activity.type);
                const typeIcon = getActivityIcon(activity.type);
                
                activitiesHTML += `
                    <div class="flex items-center space-x-4 p-3 bg-neutral-50 rounded-lg">
                        <div class="w-8 h-8 ${statusColor} rounded-full flex items-center justify-center">
                            ${typeIcon}
                        </div>
                        <div class="flex-1">
                            <p class="font-medium text-neutral-800">
                                ${activity.action}
                            </p>
                            <p class="text-sm text-neutral-600">${timeAgo}</p>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = activitiesHTML;
        }

        // 어드민 도구 열기
        function openAdminTool(toolId) {
            const toolData = functionData[toolId];
            if (!toolData) return;
            
            document.getElementById('tool-modal-title').textContent = toolData.name;
            
            let adminListHTML = '<div class="space-y-4">';
            toolData.admins.forEach((admin, index) => {
                adminListHTML += `
                    <div class="card p-4 cursor-pointer hover:shadow-lg transition-all" onclick="openAdminUrl('${admin.url}', '${admin.name}', ${admin.isInternal})">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center space-x-4">
                                <div class="w-10 h-10 bg-primary-100 rounded-lg flex items-center justify-center">
                                    <span class="font-bold text-primary-600">${index + 1}</span>
                                </div>
                                <div>
                                    <h4 class="font-medium text-neutral-800">${admin.name}</h4>
                                    <p class="text-sm text-neutral-600">${admin.desc}</p>
                                    <p class="text-xs text-neutral-400 mt-1">${admin.url}</p>
                                </div>
                            </div>
                            <div class="flex items-center space-x-2">
                                ${admin.isInternal ? '<span class="bg-yellow-100 text-yellow-800 text-xs px-2 py-1 rounded">내부</span>' : '<span class="bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded">외부</span>'}
                                <svg class="w-5 h-5 text-neutral-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                                </svg>
                            </div>
                        </div>
                    </div>
                `;
            });
            adminListHTML += '</div>';
            
            document.getElementById('tool-modal-content').innerHTML = adminListHTML;
            document.getElementById('tool-modal').classList.remove('hidden');
        }

        // 어드민 URL 열기
        function openAdminUrl(url, name, isInternal) {
            try {
                // 활동 기록
                logActivity('admin-tool', `${name} 어드민 열기`, 'started');
                
                if (isInternal) {
                    const msg = currentLanguage === 'ko' ? `${name} 도구를 새 창에서 엽니다` : `Opening ${name} tool in new window`;
                    showToast(msg, 'success');
                }
                
                const windowName = 'admin_' + name.replace(/\s/g, '_');
                const win = window.open(url, windowName, 'width=1200,height=800,menubar=yes,toolbar=yes,location=yes,status=yes,scrollbars=yes,resizable=yes');
                
                if (win) {
                    windowRefs[windowName] = win;
                    
                    // 활동 기록 - 완료
                    logActivity('admin-tool', `${name} 어드민 열기`, 'completed');
                    const msg = currentLanguage === 'ko' ? `${name}이(가) 새 창에서 열렸습니다` : `${name} opened in new window`;
                    showToast(msg, 'success');
                } else {
                    // 활동 기록 - 실패
                    logActivity('admin-tool', `${name} 어드민 열기`, 'failed');
                    const msg = currentLanguage === 'ko' ? '팝업이 차단되었습니다. 팝업 허용 후 다시 시도하세요' : 'Popup blocked. Please allow popups and try again';
                    showToast(msg, 'error');
                }
            } catch (error) {
                console.error('어드민 도구 실행 오류:', error);
                logActivity('admin-tool', `${name} 어드민 열기`, 'failed');
                showToast(currentLanguage === 'ko' ? '도구 실행 중 오류가 발생했습니다' : 'Error running tool', 'error');
            }
        }

        // 데이터 도구 열기
        function openDataTool(toolId) {
            let title, content;
            
            switch(toolId) {
                case 'sample-image':
                    title = '샘플 이미지 생성기';
                    content = getSampleImageGeneratorHTML();
                    break;
                case 'qr-xlsx':
                    title = 'QR XLSX 생성기';
                    content = getQRXlsxGeneratorHTML();
                    break;
                case 'csv-generator':
                    title = 'CSV 생성기';
                    content = getCsvGeneratorHTML();
                    break;
                case 'profile-generator':
                    title = currentLanguage === 'ko' ? '프로필 이미지 생성기' : 'Profile Image Generator';
                    content = getProfileGeneratorHTML();
                    break;
                case 'env-badge':
                    title = currentLanguage === 'ko' ? '환경 뱃지 생성기' : 'Environment Badge Generator';
                    content = getEnvBadgeGeneratorHTML();
                    break;
                case 'business-number':
                    title = currentLanguage === 'ko' ? '사업자등록번호 생성기' : 'Business Number Generator';
                    content = getBusinessNumberGeneratorHTML();
                    break;
                default:
                    title = '도구';
                    content = '<p class="text-center text-neutral-500">도구를 찾을 수 없습니다.</p>';
            }
            
            document.getElementById('tool-modal-title').textContent = title;
            document.getElementById('tool-modal-content').innerHTML = content;
            document.getElementById('tool-modal').classList.remove('hidden');
            
            // 샘플 이미지 생성기인 경우 초기 이미지 생성
            if (toolId === 'sample-image') {
                setTimeout(generateSampleImage, 100);
            }
            // 프로필 생성기인 경우 초기 프리뷰
            if (toolId === 'profile-generator') {
                setTimeout(generateProfilePreview, 100);
            }
            // 환경 뱃지 생성기인 경우 초기 프리뷰
            if (toolId === 'env-badge') {
                setTimeout(generateEnvBadgePreview, 100);
            }
            // 사업자등록번호 생성기 초기화
            if (toolId === 'business-number') {
                setTimeout(() => {
                    window.generatedBusinessNumbers = [];
                }, 100);
            }
        }

        // 모달 닫기
        function closeToolModal() {
            document.getElementById('tool-modal').classList.add('hidden');
        }

        // 토스트 메시지 표시
        function showToast(message, type = 'success') {
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.innerHTML = `
                <div class="flex items-center">
                    <div class="flex-1">
                        <p class="font-medium text-neutral-800">${message}</p>
                    </div>
                    <button onclick="this.parentElement.parentElement.remove()" class="ml-4 text-neutral-400 hover:text-neutral-600">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
            `;
            
            document.body.appendChild(toast);
            
            setTimeout(() => {
                if (toast.parentNode) {
                    toast.remove();
                }
            }, 5000);
        }

        // 언어 변경 함수
        function toggleLanguage() {
            try {
                const oldLang = currentLanguage;
                const newLang = currentLanguage === 'ko' ? 'en' : 'ko';
                
                // 활동 기록
                logActivity('settings', `언어 변경: ${oldLang.toUpperCase()} → ${newLang.toUpperCase()}`, 'completed');
                
                // 알림 추가 - 시작
                addNotification('language-change', `${oldLang.toUpperCase()} → ${newLang.toUpperCase()}`, 'started');
                
                currentLanguage = newLang;
                updateLanguageUI();
                updateAllTexts();
                
                // localStorage에 언어 설정 저장
                localStorage.setItem('preferred-language', currentLanguage);
                
                // 알림 추가 - 완료
                addNotification('language-change', `${oldLang.toUpperCase()} → ${newLang.toUpperCase()}`, 'completed');
                
                const langText = currentLanguage === 'ko' ? '한국어' : 'English';
                const message = currentLanguage === 'ko' ? `언어가 ${langText}로 변경되었습니다` : `Language changed to ${langText}`;
                showToast(message, 'success');
            } catch (error) {
                console.error('언어 변경 오류:', error);
                addNotification('language-change', 'Language toggle', 'failed', error.message);
                showToast(currentLanguage === 'ko' ? '언어 변경 중 오류가 발생했습니다' : 'Error changing language', 'error');
            }
        }

        // 언어 선택 UI 업데이트
        function updateLanguageUI() {
            const currentLangEl = document.getElementById('current-lang');
            const otherLangEl = document.getElementById('other-lang');
            
            if (currentLanguage === 'ko') {
                currentLangEl.textContent = 'KOR';
                currentLangEl.className = 'text-black';
                otherLangEl.textContent = 'ENG';
                otherLangEl.className = 'text-black opacity-50';
            } else {
                currentLangEl.textContent = 'ENG';
                currentLangEl.className = 'text-black';
                otherLangEl.textContent = 'KOR';
                otherLangEl.className = 'text-black opacity-50';
            }
        }

        // 모든 텍스트 업데이트
        function updateAllTexts() {
            const t = translations[currentLanguage];
            
            // 탭 텍스트 업데이트
            document.querySelectorAll('.tab-text').forEach(el => {
                const key = currentLanguage === 'ko' ? el.getAttribute('data-ko') : el.getAttribute('data-en');
                if (key) el.textContent = key;
            });
            
            // 페이지 제목들 업데이트
            updateElementText('dashboard-title', t.dashboardTitle);
            updateElementText('dashboard-desc', t.dashboardDesc);
            updateElementText('admin-tools-title', t.adminToolsTitle);  
            updateElementText('admin-tools-desc', t.adminToolsDesc);
            updateElementText('data-tools-title', t.dataToolsTitle);
            updateElementText('data-tools-desc', t.dataToolsDesc);
            updateElementText('settings-title', t.settingsTitle);
            updateElementText('settings-desc', t.settingsDesc);
            
            // 통계 카드 텍스트 업데이트
            updateElementText('active-sessions-label', t.activeSessions);
            updateElementText('completed-tasks-label', t.completedTasks);
            updateElementText('saved-tokens-label', t.savedTokens);
            updateElementText('generated-files-label', t.generatedFiles);
            updateElementText('recent-activities-title', t.recentActivities);
            
            // 설정 섹션 텍스트 업데이트
            updateElementText('token-management-title', t.tokenManagement);
            updateElementText('system-settings-title', t.systemSettings);
            updateElementText('system-info-title', t.systemInfo);
        }

        // 개별 요소 텍스트 업데이트 헬퍼 함수
        function updateElementText(id, text) {
            const element = document.getElementById(id);
            if (element) {
                element.textContent = text;
            }
        }

        // 알림 히스토리에 항목 추가
        function addNotification(type, action, status, details = null) {
            const notification = {
                id: Date.now() + Math.random(),
                type: type, // 'admin-tool', 'data-generation', 'token-sync', 'cookie-management', 'language-change'
                action: action, // 구체적인 액션명
                status: status, // 'started', 'completed', 'failed'
                details: details, // 추가 정보
                timestamp: new Date(),
                read: false
            };
            
            notificationHistory.unshift(notification);
            
            // 최대 개수 초과 시 오래된 알림 제거
            if (notificationHistory.length > maxNotifications) {
                notificationHistory = notificationHistory.slice(0, maxNotifications);
            }
            
            // localStorage에 저장
            localStorage.setItem('notificationHistory', JSON.stringify(notificationHistory));
            
            // 알림 배지 업데이트
            updateNotificationBadge();
            
            // 대시보드가 활성화되어 있으면 실시간 업데이트
            if (currentTab === 'dashboard') {
                updateRecentActivities();
            }
        }

        // 알림 배지 업데이트
        function updateNotificationBadge() {
            const badge = document.getElementById('notification-badge');
            const unreadCount = notificationHistory.filter(n => !n.read).length;
            
            if (unreadCount > 0) {
                badge.textContent = unreadCount > 99 ? '99+' : unreadCount;
                badge.classList.remove('hidden');
            } else {
                badge.classList.add('hidden');
            }
        }

        // 알림 목록 표시 (현재는 최근 활동으로 이동)
        function showNotifications() {
            // 대시보드의 최근 활동으로 이동
            showTab('dashboard');
            setTimeout(() => {
                const recentSection = document.querySelector('#recent-activities-title');
                if (recentSection) {
                    recentSection.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }
            }, 100);
        }
        
        // 원래 알림 함수 (필요시 사용)
        function showNotificationsOld() {
            const t = translations[currentLanguage];
            
            // 모든 알림을 읽음으로 표시
            notificationHistory.forEach(n => n.read = true);
            localStorage.setItem('notificationHistory', JSON.stringify(notificationHistory));
            updateNotificationBadge();
            
            let notificationHTML = `
                <div class="fixed inset-0 bg-black bg-opacity-50 flex items-start justify-end z-50 pt-16 pr-4" onclick="closeNotifications()">
                    <div class="bg-white rounded-2xl w-96 max-h-96 overflow-hidden shadow-2xl" onclick="event.stopPropagation()">
                        <div class="p-4 border-b border-neutral-200 flex items-center justify-between">
                            <h3 class="text-lg font-bold text-neutral-800">${t.notifications}</h3>
                            <div class="flex items-center space-x-2">
                                <button onclick="clearAllNotifications()" class="text-xs px-3 py-1 bg-neutral-100 hover:bg-neutral-200 rounded-md text-neutral-600 transition-colors">
                                    ${t.clearNotifications}
                                </button>
                                <button onclick="closeNotifications()" class="p-1 hover:bg-neutral-100 rounded transition-colors">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                    </svg>
                                </button>
                            </div>
                        </div>
                        <div class="overflow-y-auto max-h-80">
            `;
            
            if (notificationHistory.length === 0) {
                notificationHTML += `
                    <div class="p-8 text-center text-neutral-500">
                        <svg class="w-12 h-12 mx-auto mb-3 text-neutral-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18 8A6 6 0 006 8c0 7-3 9-3 9h18s-3-2-3-9z"></path>
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m13.73 21a2 2 0 01-3.46 0"></path>
                        </svg>
                        <p>${t.noNotifications}</p>
                    </div>
                `;
            } else {
                notificationHistory.forEach(notification => {
                    const timeAgo = getTimeAgo(notification.timestamp);
                    const statusColor = getStatusColor(notification.status);
                    const statusIcon = getStatusIcon(notification.status);
                    const typeIcon = getTypeIcon(notification.type);
                    
                    notificationHTML += `
                        <div class="p-4 border-b border-neutral-100 hover:bg-neutral-50 transition-colors">
                            <div class="flex items-start space-x-3">
                                <div class="w-8 h-8 ${statusColor} rounded-full flex items-center justify-center flex-shrink-0">
                                    ${typeIcon}
                                </div>
                                <div class="flex-1 min-w-0">
                                    <p class="font-medium text-neutral-800 text-sm">
                                        ${getActionDisplayName(notification.type, notification.action)}
                                    </p>
                                    <div class="flex items-center space-x-2 mt-1">
                                        <span class="text-xs ${statusColor.replace('bg-', 'text-').replace('-100', '-600')} font-medium">
                                            ${statusIcon} ${getStatusDisplayName(notification.status)}
                                        </span>
                                        <span class="text-xs text-neutral-500">${timeAgo}</span>
                                    </div>
                                    ${notification.details ? `<p class="text-xs text-neutral-500 mt-1">${notification.details}</p>` : ''}
                                </div>
                            </div>
                        </div>
                    `;
                });
            }
            
            notificationHTML += `
                        </div>
                    </div>
                </div>
            `;
            
            // 알림 패널 표시
            const existingPanel = document.getElementById('notification-panel');
            if (existingPanel) {
                existingPanel.remove();
            }
            
            const panel = document.createElement('div');
            panel.id = 'notification-panel';
            panel.innerHTML = notificationHTML;
            document.body.appendChild(panel);
        }

        // 알림 패널 닫기
        function closeNotifications() {
            const panel = document.getElementById('notification-panel');
            if (panel) {
                panel.remove();
            }
        }

        // 모든 알림 지우기
        function clearAllNotifications() {
            if (confirm(currentLanguage === 'ko' ? '모든 알림을 삭제하시겠습니까?' : 'Are you sure you want to clear all notifications?')) {
                notificationHistory = [];
                localStorage.removeItem('notificationHistory');
                updateNotificationBadge();
                closeNotifications();
                updateRecentActivities();
                showToast(currentLanguage === 'ko' ? '모든 알림이 삭제되었습니다' : 'All notifications cleared', 'success');
            }
        }

        // 활동 히스토리 관리 함수들
        function loadActivityHistory() {
            const saved = localStorage.getItem(ACTIVITY_STORAGE_KEY);
            if (saved) {
                try {
                    activityHistory = JSON.parse(saved);
                    // 날짜 객체 복원
                    activityHistory.forEach(a => {
                        a.timestamp = new Date(a.timestamp);
                    });
                } catch (e) {
                    console.error('활동 히스토리 로드 실패:', e);
                    activityHistory = [];
                }
            }
        }
        
        function saveActivityHistory() {
            try {
                // 최대 개수 제한
                if (activityHistory.length > maxActivities) {
                    activityHistory = activityHistory.slice(-maxActivities);
                }
                localStorage.setItem(ACTIVITY_STORAGE_KEY, JSON.stringify(activityHistory));
            } catch (e) {
                console.error('활동 히스토리 저장 실패:', e);
            }
        }
        
        // 활동 기록 함수
        function logActivity(type, action, status = 'completed') {
            const activity = {
                id: Date.now() + '_' + Math.random().toString(36).substr(2, 9),
                type: type,
                action: action,
                status: status,
                timestamp: new Date(),
                language: currentLanguage
            };
            
            activityHistory.push(activity);
            saveActivityHistory();
            
            // 대시보드에 있으면 업데이트
            if (currentTab === 'dashboard') {
                updateDashboardStats();
            }
        }
        
        // 활동 아이콘 가져오기
        function getActivityIcon(type) {
            const icons = {
                'admin-tool': '<svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.096 2.572-1.065z"></path></svg>',
                'data-generation': '<svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>',
                'token-sync': '<svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"></path></svg>',
                'settings': '<svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 100-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 100-4m0 4v2m0-6V4"></path></svg>',
                'system': '<svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path></svg>'
            };
            return icons[type] || '<svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>';
        }
        
        // 활동 색상 가져오기
        function getActivityColor(type) {
            const colors = {
                'admin-tool': 'bg-primary-500',
                'data-generation': 'bg-green-500',
                'token-sync': 'bg-blue-500',
                'settings': 'bg-purple-500',
                'system': 'bg-gray-500'
            };
            return colors[type] || 'bg-neutral-500';
        }

        // 시간 표시 함수
        function getTimeAgo(timestamp) {
            const t = translations[currentLanguage];
            const now = new Date();
            const diffMs = now - new Date(timestamp);
            const diffMinutes = Math.floor(diffMs / (1000 * 60));
            const diffHours = Math.floor(diffMs / (1000 * 60 * 60));
            const diffDays = Math.floor(diffMs / (1000 * 60 * 60 * 24));
            
            if (diffMinutes < 1) return t.justNow;
            if (diffMinutes < 60) return `${diffMinutes}${t.minutesAgo}`;
            if (diffHours < 24) return `${diffHours}${t.hoursAgo}`;
            return `${diffDays}${t.daysAgo}`;
        }

        // 상태별 색상 반환
        function getStatusColor(status) {
            switch (status) {
                case 'started': return 'bg-blue-100';
                case 'completed': return 'bg-green-100';
                case 'failed': return 'bg-red-100';
                default: return 'bg-neutral-100';
            }
        }

        // 상태별 아이콘 반환
        function getStatusIcon(status) {
            switch (status) {
                case 'started': return '⏳';
                case 'completed': return '✅';
                case 'failed': return '❌';
                default: return 'ℹ️';
            }
        }

        // 타입별 아이콘 반환
        function getTypeIcon(type) {
            switch (type) {
                case 'admin-tool': return '<svg class="w-4 h-4 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.096 2.572-1.065z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>';
                case 'data-generation': return '<svg class="w-4 h-4 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>';
                case 'token-sync': return '<svg class="w-4 h-4 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1721 9z"></path></svg>';
                case 'cookie-management': return '<svg class="w-4 h-4 text-orange-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 100-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 100-4m0 4v2m0-6V4"></path></svg>';
                case 'language-change': return '<svg class="w-4 h-4 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5h12M9 3v2m1.048 9.5A18.022 18.022 0 016.412 9m6.088 9h7M11 21l5-10 5 10M12.751 5C11.783 10.77 8.07 15.61 3 18.129"></path></svg>';
                default: return '<svg class="w-4 h-4 text-neutral-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>';
            }
        }

        // 액션명 표시 함수
        function getActionDisplayName(type, action) {
            const t = translations[currentLanguage];
            
            // 타입별 기본 이름
            let baseName = '';
            switch (type) {
                case 'admin-tool': baseName = t.adminToolRequest; break;
                case 'data-generation': baseName = t.dataGenerationRequest; break;
                case 'token-sync': baseName = t.tokenSyncRequest; break;
                case 'cookie-management': baseName = t.cookieManagementRequest; break;
                case 'language-change': baseName = t.languageChangeRequest; break;
                default: baseName = action;
            }
            
            // 구체적인 액션명이 있으면 조합
            if (action && action !== type) {
                return `${baseName}: ${action}`;
            }
            
            return baseName;
        }

        // 상태명 표시 함수
        function getStatusDisplayName(status) {
            const t = translations[currentLanguage];
            switch (status) {
                case 'started': return t.requestStarted;
                case 'completed': return t.requestCompleted;
                case 'failed': return t.requestFailed;
                default: return status;
            }
        }

        // 토큰 관리 함수들
        function getStoredTokens() {
            const tokens = { localStorage: {}, sessionStorage: {}, cookies: {} };
            
            try {
                for (let i = 0; i < localStorage.length; i++) {
                    const key = localStorage.key(i);
                    if (key && (key.includes('token') || key.includes('auth') || key.includes('session'))) {
                        tokens.localStorage[key] = localStorage.getItem(key);
                    }
                }
                
                for (let i = 0; i < sessionStorage.length; i++) {
                    const key = sessionStorage.key(i);
                    if (key && (key.includes('token') || key.includes('auth') || key.includes('session'))) {
                        tokens.sessionStorage[key] = sessionStorage.getItem(key);
                    }
                }
                
                const cookies = getAllCookies();
                Object.entries(cookies).forEach(([name, value]) => {
                    if (name.includes('token') || name.includes('auth') || name.includes('session')) {
                        tokens.cookies[name] = value;
                    }
                });
            } catch (error) {
                console.error('토큰 조회 오류:', error);
            }
            
            return tokens;
        }

        function getAllCookies() {
            const cookies = {};
            document.cookie.split(';').forEach(cookie => {
                const [name, value] = cookie.trim().split('=');
                if (name) cookies[name] = value || '';
            });
            return cookies;
        }

        function syncTokens() {
            try {
                const tokens = getStoredTokens();
                const tokenCount = Object.keys(tokens.localStorage).length + 
                                   Object.keys(tokens.sessionStorage).length + 
                                   Object.keys(tokens.cookies).length;
                
                console.log('동기화할 토큰:', tokens);
                
                let syncedWindows = 0;
                Object.values(windowRefs).forEach(win => {
                    if (win && !win.closed) {
                        try {
                            win.postMessage({ type: 'SYNC_TOKENS', tokens: tokens }, '*');
                            syncedWindows++;
                        } catch (e) {
                            console.log('토큰 전송 실패:', e);
                        }
                    }
                });
                
                logActivity('token-sync', `토큰 ${tokenCount}개 동기화 (${syncedWindows}개 창)`, 'completed');
                const msg = currentLanguage === 'ko' ? `토큰 ${tokenCount}개가 동기화되었습니다` : `${tokenCount} tokens synchronized`;
                showToast(msg, 'success');
                updateTokenStatus();
            } catch (error) {
                console.error('토큰 동기화 오류:', error);
                logActivity('token-sync', '토큰 동기화 실패', 'failed');
                showToast(currentLanguage === 'ko' ? '토큰 동기화 중 오류가 발생했습니다' : 'Error synchronizing tokens', 'error');
            }
        }

        function updateTokenStatus() {
            try {
                const tokens = getStoredTokens();
                const totalCount = Object.keys(tokens.localStorage).length + Object.keys(tokens.sessionStorage).length + Object.keys(tokens.cookies).length;
                
                const statusEl = document.getElementById('token-status-detail');
                if (statusEl) {
                    if (totalCount > 0) {
                        const foundText = currentLanguage === 'ko' ? `✅ 토큰 ${totalCount}개 발견` : `✅ ${totalCount} tokens found`;
                        statusEl.innerHTML = `${foundText} (Local: ${Object.keys(tokens.localStorage).length}, Session: ${Object.keys(tokens.sessionStorage).length}, Cookie: ${Object.keys(tokens.cookies).length})`;
                    } else {
                        statusEl.innerHTML = currentLanguage === 'ko' ? '❌ 토큰 없음' : '❌ No tokens';
                    }
                }
                
                // 대시보드 토큰 카운트 업데이트
                const tokenCountEl = document.getElementById('token-count');
                if (tokenCountEl) {
                    tokenCountEl.textContent = totalCount;
                }
                
                return totalCount;
            } catch (error) {
                console.error('토큰 상태 업데이트 오류:', error);
                const statusEl = document.getElementById('token-status-detail');
                if (statusEl) {
                    statusEl.innerHTML = currentLanguage === 'ko' ? '❌ 오류 발생' : '❌ Error occurred';
                }
                return 0;
            }
        }

        function exportTokens() {
            try {
                const tokens = getStoredTokens();
                const dataStr = JSON.stringify(tokens, null, 2);
                const dataBlob = new Blob([dataStr], {type: 'application/json'});
                
                const link = document.createElement('a');
                link.href = URL.createObjectURL(dataBlob);
                link.download = `tokens_${new Date().toISOString().split('T')[0]}.json`;
                link.click();
                
                showToast(currentLanguage === 'ko' ? '토큰 정보가 다운로드되었습니다' : 'Token information downloaded', 'success');
            } catch (error) {
                console.error('토큰 내보내기 오류:', error);
                showToast(currentLanguage === 'ko' ? '토큰 내보내기 중 오류가 발생했습니다' : 'Error exporting tokens', 'error');
            }
        }

        // 쿠키 관리 함수들
        function showCookieModal() {
            document.getElementById('cookie-modal').classList.remove('hidden');
            updateCookieList();
        }

        function closeCookieModal() {
            document.getElementById('cookie-modal').classList.add('hidden');
        }

        function updateCookieList() {
            const cookies = getAllCookies();
            const cookieList = document.getElementById('cookie-list');
            
            if (Object.keys(cookies).length === 0) {
                cookieList.textContent = currentLanguage === 'ko' ? '쿠키가 없습니다.' : 'No cookies.';
            } else {
                cookieList.innerHTML = Object.entries(cookies)
                    .map(([name, value]) => `<div class="mb-1"><strong>${name}</strong> = ${value}</div>`)
                    .join('');
            }
        }

        function addCookie() {
            const input = document.getElementById('cookie-input').value.trim();
            if (!input) {
                showToast(currentLanguage === 'ko' ? '쿠키 정보를 입력해주세요' : 'Please enter cookie information', 'error');
                return;
            }
            
            try {
                // 알림 추가 - 시작
                addNotification('cookie-management', '쿠키 추가', 'started', input);
                
                const parts = input.split(';').map(p => p.trim());
                const [name, value] = parts[0].split('=');
                
                if (!name) {
                    addNotification('cookie-management', '쿠키 추가', 'failed', '쿠키 이름이 필요합니다');
                    showToast(currentLanguage === 'ko' ? '쿠키 이름이 필요합니다' : 'Cookie name is required', 'error');
                    return;
                }
                
                document.cookie = input;
                updateCookieList();
                document.getElementById('cookie-input').value = '';
                
                // 알림 추가 - 완료
                addNotification('cookie-management', '쿠키 추가', 'completed', `${name} 쿠키 추가됨`);
                showToast(currentLanguage === 'ko' ? '쿠키가 추가되었습니다' : 'Cookie added', 'success');
            } catch (e) {
                console.error('쿠키 추가 오류:', e);
                addNotification('cookie-management', '쿠키 추가', 'failed', e.message);
                showToast(currentLanguage === 'ko' ? '올바른 쿠키 형식이 아닙니다' : 'Invalid cookie format', 'error');
            }
        }

        // 샘플 이미지 생성기 HTML
        function getSampleImageGeneratorHTML() {
            return `
                <div class="space-y-6">
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-neutral-700 mb-2">이미지 크기</label>
                                <select id="sample-imageSize" class="form-input">
                                    <option value="100x100">100x100</option>
                                    <option value="200x200">200x200</option>
                                    <option value="400x400" selected>400x400</option>
                                    <option value="800x600">800x600</option>
                                    <option value="1920x1080">1920x1080</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-neutral-700 mb-2">배경색</label>
                                <input type="color" id="sample-bgColor" value="#f0f0f0" class="form-input h-12">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-neutral-700 mb-2">텍스트</label>
                                <input type="text" id="sample-imageText" value="Sample Image" class="form-input">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-neutral-700 mb-2">생성할 이미지 개수</label>
                                <input type="number" id="sample-imageCount" value="5" min="1" max="100" class="form-input">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-neutral-700 mb-2">이미지 포맷</label>
                                <div class="space-y-2">
                                    <label class="flex items-center">
                                        <input type="checkbox" name="imageFormat" value="PNG" checked class="mr-2">
                                        <span>PNG</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" name="imageFormat" value="JPG" checked class="mr-2">
                                        <span>JPG</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" name="imageFormat" value="WEBP" class="mr-2">
                                        <span>WEBP</span>
                                    </label>
                                </div>
                            </div>
                            <button onclick="generateSampleImage()" class="btn-primary w-full">
                                이미지 생성하기
                            </button>
                        </div>
                        <div>
                            <div class="border-2 border-dashed border-neutral-300 rounded-lg p-6 bg-neutral-50 min-h-64 flex items-center justify-center">
                                <canvas id="sample-canvas" class="border border-neutral-200 rounded shadow-sm"></canvas>
                            </div>
                            <button id="sample-downloadBtn" onclick="downloadSampleImage()" class="btn-secondary w-full mt-4" disabled>
                                이미지 다운로드
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }

        // QR XLSX 생성기 HTML
        function getQRXlsxGeneratorHTML() {
            return `
                <div class="space-y-6">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-neutral-700 mb-2">CID</label>
                            <input type="text" id="qr-cid" value="" placeholder="빈값" class="form-input">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-neutral-700 mb-2">TID</label>
                            <input type="text" id="qr-tid" value="" placeholder="빈값" class="form-input">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-neutral-700 mb-2">지역코드</label>
                            <input type="text" id="qr-region" value="JEJU" class="form-input">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-neutral-700 mb-2">VAN</label>
                            <input type="text" id="qr-van" value="KIS" class="form-input">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-neutral-700 mb-2">휴대폰번호</label>
                            <input type="text" id="qr-phone" value="01025710628" class="form-input">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-neutral-700 mb-2">비고</label>
                            <input type="text" id="qr-remark" value="" placeholder="빈값" class="form-input">
                        </div>
                    </div>
                    
                    <button onclick="generateQRXlsx()" class="btn-primary">QR XLSX 파일 생성</button>
                    
                    <div id="qr-preview" class="mt-6 p-4 border border-primary-200 rounded-lg bg-primary-50 hidden">
                        <h4 class="font-medium text-primary-800 mb-2">생성 완료!</h4>
                        <p class="text-primary-700">XLSX 파일이 다운로드되었습니다.</p>
                    </div>
                </div>
            `;
        }

        // CSV 생성기 HTML
        function getCsvGeneratorHTML() {
            return `
                <div class="space-y-6">
                    <div>
                        <label class="block text-sm font-medium text-neutral-700 mb-2">생성할 행 수</label>
                        <input type="number" id="csv-rowCount" value="10" min="1" max="1000" class="form-input max-w-xs">
                    </div>

                    <div class="space-y-4">
                        <h4 class="text-lg font-medium text-neutral-800">열 설정</h4>
                        
                        <!-- 1열 -->
                        <div class="card p-4">
                            <div class="flex items-center justify-between mb-3">
                                <span class="font-medium">1열 (필수)</span>
                            </div>
                            <div class="space-y-3">
                                <label class="flex items-center">
                                    <input type="radio" name="col1Type" value="random" checked class="mr-2">
                                    <span>텍스트 입력</span>
                                </label>
                                <input type="text" id="col1-text" placeholder="텍스트를 입력하세요" class="form-input">
                                <label class="flex items-center">
                                    <input type="radio" name="col1Type" value="custom" class="mr-2">
                                    <span>난수발생</span>
                                </label>
                            </div>
                        </div>

                        <!-- 2열 -->
                        <div class="card p-4">
                            <div class="flex items-center justify-between mb-3">
                                <span class="font-medium">2열 포함</span>
                                <label class="flex items-center">
                                    <input type="checkbox" id="col2-enable" checked class="mr-2" onchange="toggleCsvColumn(2)">
                                    <span>사용</span>
                                </label>
                            </div>
                            <div class="space-y-3" id="col2-options">
                                <label class="flex items-center">
                                    <input type="radio" name="col2Type" value="random" checked class="mr-2">
                                    <span>텍스트 입력</span>
                                </label>
                                <input type="text" id="col2-text" placeholder="텍스트를 입력하세요" class="form-input">
                                <label class="flex items-center">
                                    <input type="radio" name="col2Type" value="custom" class="mr-2">
                                    <span>난수발생</span>
                                </label>
                            </div>
                        </div>

                        <!-- 3열 -->
                        <div class="card p-4">
                            <div class="flex items-center justify-between mb-3">
                                <span class="font-medium">3열 포함</span>
                                <label class="flex items-center">
                                    <input type="checkbox" id="col3-enable" class="mr-2" onchange="toggleCsvColumn(3)">
                                    <span>사용</span>
                                </label>
                            </div>
                            <div class="space-y-3 hidden" id="col3-options">
                                <label class="flex items-center">
                                    <input type="radio" name="col3Type" value="random" checked class="mr-2">
                                    <span>텍스트 입력</span>
                                </label>
                                <input type="text" id="col3-text" placeholder="텍스트를 입력하세요" class="form-input">
                                <label class="flex items-center">
                                    <input type="radio" name="col3Type" value="custom" class="mr-2">
                                    <span>난수발생</span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <button onclick="generateCsvFile()" class="btn-primary">CSV 미리보기</button>

                    <div id="csv-preview" class="hidden">
                        <h4 class="text-lg font-medium text-neutral-800 mb-4">CSV 미리보기</h4>
                        <div class="overflow-auto max-h-64 border border-neutral-200 rounded-lg">
                            <table class="min-w-full">
                                <thead class="bg-neutral-100">
                                    <tr>
                                        <th class="border border-neutral-300 px-4 py-2">1열</th>
                                        <th class="border border-neutral-300 px-4 py-2">2열</th>
                                        <th class="border border-neutral-300 px-4 py-2">3열</th>
                                    </tr>
                                </thead>
                                <tbody id="csv-preview-body">
                                </tbody>
                            </table>
                        </div>
                        <button onclick="downloadCsv()" class="btn-secondary mt-4">
                            CSV 다운로드
                        </button>
                    </div>
                </div>
            `;
        }

        // 샘플 이미지 생성 함수들 (기존 함수들 이어서 사용)
        function generateSampleImage() {
            try {
                // 알림 추가 - 시작
                logActivity('data-generation', '샘플 이미지 생성 시작', 'started');
                
                const size = document.getElementById('sample-imageSize').value;
                const [width, height] = size.split('x').map(Number);
                const bgColor = document.getElementById('sample-bgColor').value;
                const text = document.getElementById('sample-imageText').value;
                const count = parseInt(document.getElementById('sample-imageCount').value) || 1;

                const formats = [];
                document.querySelectorAll('input[name="imageFormat"]:checked').forEach(el => {
                    formats.push(el.value);
                });

                if (formats.length === 0) {
                    logActivity('data-generation', '샘플 이미지 생성 실패', 'failed');
                    showToast(currentLanguage === 'ko' ? '최소 하나의 이미지 포맷을 선택해주세요' : 'Please select at least one image format', 'error');
                    return;
                }

                const canvas = document.getElementById('sample-canvas');
                const ctx = canvas.getContext('2d');

                canvas.width = width;
                canvas.height = height;
                canvas.style.maxWidth = '100%';
                canvas.style.height = 'auto';

                ctx.fillStyle = bgColor;
                ctx.fillRect(0, 0, width, height);

                ctx.fillStyle = '#333333';
                ctx.font = Math.max(16, width/20) + 'px Arial';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText(text, width/2, height/2 - Math.max(20, width/20));

                ctx.font = Math.max(40, width/10) + 'px Arial';
                ctx.fillText('1', width/2, height/2 + Math.max(20, width/20));

                ctx.font = Math.max(12, width/30) + 'px Arial';
                ctx.fillText(width + ' × ' + height, width/2, height - Math.max(20, width/30));

                window.sampleImageSettings = { width, height, bgColor, text, count, formats };
                document.getElementById('sample-downloadBtn').disabled = false;
                
                // 알림 추가 - 완료
                logActivity('data-generation', `샘플 이미지 ${count}개 생성 (${size})`, 'completed');
                showToast(currentLanguage === 'ko' ? '이미지 생성 완료' : 'Image generation complete', 'success');
            } catch (error) {
                console.error('이미지 생성 오류:', error);
                logActivity('data-generation', '샘플 이미지 생성 실패', 'failed');
                showToast(currentLanguage === 'ko' ? '이미지 생성 중 오류가 발생했습니다' : 'Error generating image', 'error');
            }
        }

        function downloadSampleImage() {
            try {
                const settings = window.sampleImageSettings;
                if (!settings) {
                    showToast(currentLanguage === 'ko' ? '먼저 이미지를 생성해주세요' : 'Please generate an image first', 'error');
                    return;
                }

                const { width, height, bgColor, text, count, formats } = settings;
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');

                canvas.width = width;
                canvas.height = height;

                for (let i = 1; i <= count; i++) {
                    ctx.fillStyle = bgColor;
                    ctx.fillRect(0, 0, width, height);

                    ctx.fillStyle = '#333333';
                    ctx.font = Math.max(16, width/20) + 'px Arial';
                    ctx.textAlign = 'center';
                    ctx.textBaseline = 'middle';
                    ctx.fillText(text, width/2, height/2 - Math.max(20, width/20));

                    ctx.font = Math.max(40, width/10) + 'px Arial';
                    ctx.fillText(i.toString(), width/2, height/2 + Math.max(20, width/20));

                    ctx.font = Math.max(12, width/30) + 'px Arial';
                    ctx.fillText(width + ' × ' + height, width/2, height - Math.max(20, width/30));

                    formats.forEach(format => {
                        const link = document.createElement('a');
                        const ext = format.toLowerCase();
                        const timestamp = new Date().toISOString().replace(/[:.]/g, '-').slice(0, -5);
                        link.download = `sample-image_${timestamp}_${i}.${ext}`;

                        if (ext === 'jpg' || ext === 'jpeg') {
                            link.href = canvas.toDataURL('image/jpeg', 0.9);
                        } else if (ext === 'webp') {
                            link.href = canvas.toDataURL('image/webp', 0.9);
                        } else {
                            link.href = canvas.toDataURL('image/png');
                        }

                        link.click();
                    });
                }

                const msg = currentLanguage === 'ko' ? `${count}개 이미지 × ${formats.length}개 포맷 = 총 ${count * formats.length}개 파일 다운로드 완료` : `${count} images × ${formats.length} formats = ${count * formats.length} files downloaded`;
                showToast(msg, 'success');
            } catch (error) {
                console.error('다운로드 오류:', error);
                showToast(currentLanguage === 'ko' ? '다운로드 중 오류가 발생했습니다' : 'Error during download', 'error');
            }
        }

        // QR XLSX 생성 함수
        function generateQRXlsx() {
            try {
                const cid = document.getElementById('qr-cid').value || '';
                const tid = document.getElementById('qr-tid').value || '';
                const region = document.getElementById('qr-region').value || 'JEJU';
                const van = document.getElementById('qr-van').value || 'KIS';
                const phone = document.getElementById('qr-phone').value || '01025710628';
                const remark = document.getElementById('qr-remark').value || '';

                const data = [
                    ['cid', 'tid', '지역코드', 'van', '휴대폰번호', '비고'],
                    [cid, tid, region, van, phone, remark]
                ];

                const ws = XLSX.utils.aoa_to_sheet(data);
                const wb = XLSX.utils.book_new();
                XLSX.utils.book_append_sheet(wb, ws, 'QR_Data');
                const timestamp = new Date().toISOString().split('T')[0];
                const cidPart = cid ? `_${cid}` : '';
                XLSX.writeFile(wb, `QR_Data${cidPart}_${timestamp}.xlsx`);

                document.getElementById('qr-preview').classList.remove('hidden');
                showToast(currentLanguage === 'ko' ? 'QR XLSX 파일이 생성되었습니다' : 'QR XLSX file generated', 'success');
            } catch (error) {
                console.error('XLSX 생성 오류:', error);
                showToast(currentLanguage === 'ko' ? 'XLSX 파일 생성 중 오류가 발생했습니다' : 'Error generating XLSX file', 'error');
            }
        }

        // CSV 생성 함수들
        function toggleCsvColumn(columnNumber) {
            const options = document.getElementById(`col${columnNumber}-options`);
            const checkbox = document.getElementById(`col${columnNumber}-enable`);

            if (checkbox && options) {
                if (checkbox.checked) {
                    options.classList.remove('hidden');
                } else {
                    options.classList.add('hidden');
                }
            }
        }

        function generateRandomString() {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
            let result = '';
            for (let i = 0; i < 10; i++) {
                result += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return result;
        }

        let csvData = [];

        function generateCsvFile() {
            try {
                const rowCount = parseInt(document.getElementById('csv-rowCount').value);

                if (rowCount <= 0 || rowCount > 1000) {
                    showToast(currentLanguage === 'ko' ? '행 수는 1~1000 범위로 입력해주세요' : 'Please enter row count between 1-1000', 'error');
                    return;
                }

                const col2Enabled = document.getElementById('col2-enable').checked;
                const col3Enabled = document.getElementById('col3-enable').checked;

                csvData = [];

                for (let i = 0; i < rowCount; i++) {
                    const row = [];

                    // 1열
                    const col1Type = document.querySelector('input[name="col1Type"]:checked').value;
                    if (col1Type === 'random') {
                        const col1Text = document.getElementById('col1-text').value || 'Data';
                        row.push(col1Text);
                    } else {
                        row.push(generateRandomString());
                    }

                    // 2열
                    if (col2Enabled) {
                        const col2Type = document.querySelector('input[name="col2Type"]:checked').value;
                        if (col2Type === 'random') {
                            const col2Text = document.getElementById('col2-text').value || 'Data';
                            row.push(col2Text);
                        } else {
                            row.push(generateRandomString());
                        }
                    }

                    // 3열
                    if (col3Enabled) {
                        const col3Type = document.querySelector('input[name="col3Type"]:checked').value;
                        if (col3Type === 'random') {
                            const col3Text = document.getElementById('col3-text').value || 'Data';
                            row.push(col3Text);
                        } else {
                            row.push(generateRandomString());
                        }
                    }

                    csvData.push(row);
                }

                displayCsvPreview();
                showToast(currentLanguage === 'ko' ? 'CSV 미리보기가 생성되었습니다' : 'CSV preview generated', 'success');
            } catch (error) {
                console.error('CSV 생성 오류:', error);
                showToast(currentLanguage === 'ko' ? 'CSV 파일 생성 중 오류가 발생했습니다' : 'Error generating CSV file', 'error');
            }
        }

        function displayCsvPreview() {
            const previewDiv = document.getElementById('csv-preview');
            const tbody = document.getElementById('csv-preview-body');

            if (!tbody) {
                previewDiv.classList.remove('hidden');
                return;
            }

            tbody.innerHTML = '';

            const previewRows = Math.min(10, csvData.length);
            for (let i = 0; i < previewRows; i++) {
                const tr = document.createElement('tr');
                csvData[i].forEach(cell => {
                    const td = document.createElement('td');
                    td.className = 'border border-neutral-300 px-4 py-2';
                    td.textContent = cell;
                    tr.appendChild(td);
                });
                tbody.appendChild(tr);
            }

            if (csvData.length > 10) {
                const tr = document.createElement('tr');
                const td = document.createElement('td');
                td.colSpan = csvData[0].length;
                td.className = 'border border-neutral-300 px-4 py-2 text-center text-neutral-500';
                td.textContent = `... 외 ${csvData.length - 10}개 행`;
                tr.appendChild(td);
                tbody.appendChild(tr);
            }

            previewDiv.classList.remove('hidden');
        }

        function downloadCsv() {
            if (csvData.length === 0) {
                showToast(currentLanguage === 'ko' ? '먼저 CSV를 생성해주세요' : 'Please generate CSV first', 'error');
                return;
            }

            let csvContent = '';
            csvData.forEach(row => {
                csvContent += row.join(',') + '\n';
            });

            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            const timestamp = new Date().toISOString().replace(/[:.]/g, '-').slice(0, -5);
            const rowCount = csvData.length;
            link.setAttribute('download', `custom_data_${rowCount}rows_${timestamp}.csv`);
            link.click();

            showToast(currentLanguage === 'ko' ? 'CSV 파일이 다운로드되었습니다' : 'CSV file downloaded', 'success');
        }

        // 초기화
        document.addEventListener('DOMContentLoaded', function() {
            // 저장된 언어 설정 불러오기
            const savedLanguage = localStorage.getItem('preferred-language');
            if (savedLanguage && (savedLanguage === 'ko' || savedLanguage === 'en')) {
                currentLanguage = savedLanguage;
            }
            
            // 활동 히스토리 불러오기
            loadActivityHistory();
            
            // 초기 UI 설정
            updateLanguageUI();
            updateAllTexts();
            updateTokenStatus();
            updateDashboardStats();
            updateRecentActivities();
            
            // 주기적으로 토큰 상태 업데이트 (자동 갱신 없음)
            // setInterval(updateTokenStatus, 30000); // 주석 처리
            
            console.log('CEO+ Help v2.1 - 시스템 시작');
        });

        // 메시지 수신 처리
        window.addEventListener('message', function(event) {
            try {
                if (event.data && event.data.type === 'REQUEST_TOKENS') {
                    const tokens = getStoredTokens();
                    event.source.postMessage({
                        type: 'SYNC_TOKENS',
                        tokens: tokens
                    }, event.origin);
                }
            } catch (error) {
                console.error('메시지 처리 오류:', error);
            }
        });

        // 에러 전역 처리
        window.addEventListener('error', function(event) {
            console.error('전역 에러:', event.error);
            showToast(currentLanguage === 'ko' ? '예상치 못한 오류가 발생했습니다' : 'An unexpected error occurred', 'error');
        });

        // 프로필 이미지 생성기 HTML
        function getProfileGeneratorHTML() {
            return `
                <div class="space-y-6">
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-neutral-700 mb-2">${currentLanguage === 'ko' ? '메인 텍스트' : 'Main Text'}</label>
                                <input type="text" id="profile-mainText" value="PQA|1247" placeholder="${currentLanguage === 'ko' ? '텍스트 입력 (| 로 줄바꿈)' : 'Enter text (| for line break)'}" class="form-input" oninput="generateProfilePreview()">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-neutral-700 mb-2">${currentLanguage === 'ko' ? '텍스트 크기' : 'Text Size'}</label>
                                <input type="range" id="profile-textSize" min="50" max="200" value="120" class="w-full" oninput="document.getElementById('profile-textSizeLabel').textContent = this.value; generateProfilePreview()">
                                <span id="profile-textSizeLabel" class="text-sm text-neutral-600">120</span>
                            </div>
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-neutral-700 mb-2">${currentLanguage === 'ko' ? '배경색' : 'Background'}</label>
                                    <input type="color" id="profile-bgColor" value="#4a5568" class="form-input h-12 w-full" onchange="generateProfilePreview()">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-neutral-700 mb-2">${currentLanguage === 'ko' ? '텍스트 색' : 'Text Color'}</label>
                                    <input type="color" id="profile-textColor" value="#ffffff" class="form-input h-12 w-full" onchange="generateProfilePreview()">
                                </div>
                            </div>
                            
                            <div class="border-t pt-4">
                                <h4 class="font-medium text-neutral-800 mb-3">${currentLanguage === 'ko' ? '환경 칩 설정' : 'Environment Chip Settings'}</h4>
                                <div class="mb-3">
                                    <label class="block text-sm font-medium text-neutral-700 mb-2">${currentLanguage === 'ko' ? '칩 텍스트 크기' : 'Chip Text Size'}</label>
                                    <input type="range" id="chip-textSize" min="8" max="20" value="12" class="w-full" oninput="updateChipSizeLabel()">
                                    <span id="chip-textSizeLabel" class="text-sm text-neutral-600">12px</span>
                                </div>
                                <div class="grid grid-cols-2 gap-3">
                                    <!-- 좌상단 칩 -->
                                    <div class="p-3 border rounded">
                                        <label class="flex items-center mb-2">
                                            <input type="checkbox" id="chip-tl-enabled" class="mr-2" onchange="generateProfilePreview()">
                                            <span class="text-sm">${currentLanguage === 'ko' ? '좌상단' : 'Top-Left'}</span>
                                        </label>
                                        <input type="text" id="chip-tl-text" placeholder="QA" class="form-input text-xs mb-1" oninput="generateProfilePreview()">
                                        <div class="flex gap-1">
                                            <input type="color" id="chip-tl-bg" value="#ff6b6b" class="w-full h-8" onchange="generateProfilePreview()">
                                            <input type="color" id="chip-tl-color" value="#ffffff" class="w-full h-8" onchange="generateProfilePreview()">
                                        </div>
                                    </div>
                                    <!-- 우상단 칩 -->
                                    <div class="p-3 border rounded">
                                        <label class="flex items-center mb-2">
                                            <input type="checkbox" id="chip-tr-enabled" class="mr-2" onchange="generateProfilePreview()">
                                            <span class="text-sm">${currentLanguage === 'ko' ? '우상단' : 'Top-Right'}</span>
                                        </label>
                                        <input type="text" id="chip-tr-text" placeholder="STAGE" class="form-input text-xs mb-1" oninput="generateProfilePreview()">
                                        <div class="flex gap-1">
                                            <input type="color" id="chip-tr-bg" value="#4ecdc4" class="w-full h-8" onchange="generateProfilePreview()">
                                            <input type="color" id="chip-tr-color" value="#ffffff" class="w-full h-8" onchange="generateProfilePreview()">
                                        </div>
                                    </div>
                                    <!-- 좌하단 칩 -->
                                    <div class="p-3 border rounded">
                                        <label class="flex items-center mb-2">
                                            <input type="checkbox" id="chip-bl-enabled" class="mr-2" onchange="generateProfilePreview()">
                                            <span class="text-sm">${currentLanguage === 'ko' ? '좌하단' : 'Bottom-Left'}</span>
                                        </label>
                                        <input type="text" id="chip-bl-text" placeholder="TEST" class="form-input text-xs mb-1" oninput="generateProfilePreview()">
                                        <div class="flex gap-1">
                                            <input type="color" id="chip-bl-bg" value="#f7b731" class="w-full h-8" onchange="generateProfilePreview()">
                                            <input type="color" id="chip-bl-color" value="#ffffff" class="w-full h-8" onchange="generateProfilePreview()">
                                        </div>
                                    </div>
                                    <!-- 우하단 칩 -->
                                    <div class="p-3 border rounded">
                                        <label class="flex items-center mb-2">
                                            <input type="checkbox" id="chip-br-enabled" class="mr-2" onchange="generateProfilePreview()">
                                            <span class="text-sm">${currentLanguage === 'ko' ? '우하단' : 'Bottom-Right'}</span>
                                        </label>
                                        <input type="text" id="chip-br-text" placeholder="v2.0" class="form-input text-xs mb-1" oninput="generateProfilePreview()">
                                        <div class="flex gap-1">
                                            <input type="color" id="chip-br-bg" value="#5f27cd" class="w-full h-8" onchange="generateProfilePreview()">
                                            <input type="color" id="chip-br-color" value="#ffffff" class="w-full h-8" onchange="generateProfilePreview()">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <button onclick="generateProfilePreview()" class="btn-primary w-full">
                                ${currentLanguage === 'ko' ? '프로필 생성하기' : 'Generate Profile'}
                            </button>
                        </div>
                        
                        <div>
                            <div class="border-2 border-dashed border-neutral-300 rounded-lg p-6 bg-neutral-50 min-h-64 flex items-center justify-center">
                                <canvas id="profile-canvas" width="300" height="300" class="border border-neutral-200 rounded shadow-sm"></canvas>
                            </div>
                            <button onclick="downloadProfileImage()" class="btn-secondary w-full mt-4">
                                ${currentLanguage === 'ko' ? '이미지 다운로드 (1080x1080)' : 'Download Image (1080x1080)'}
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }

        // 환경 뱃지 생성기 HTML
        function getEnvBadgeGeneratorHTML() {
            return `
                <div class="space-y-6">
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-neutral-700 mb-2">${currentLanguage === 'ko' ? '환경 선택' : 'Select Environment'}</label>
                                <select id="badge-env" class="form-input" onchange="updateBadgePreset()">
                                    <option value="dev">Development</option>
                                    <option value="qa">QA/Test</option>
                                    <option value="stage">Staging</option>
                                    <option value="prod">Production</option>
                                    <option value="custom">${currentLanguage === 'ko' ? '커스텀' : 'Custom'}</option>
                                </select>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-neutral-700 mb-2">${currentLanguage === 'ko' ? '뱃지 텍스트' : 'Badge Text'}</label>
                                <input type="text" id="badge-text" value="DEV" class="form-input">
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-neutral-700 mb-2">${currentLanguage === 'ko' ? '뱃지 스타일' : 'Badge Style'}</label>
                                <div class="space-y-2">
                                    <label class="flex items-center">
                                        <input type="radio" name="badgeStyle" value="rounded" checked class="mr-2">
                                        <span>${currentLanguage === 'ko' ? '둥근 모서리' : 'Rounded'}</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="radio" name="badgeStyle" value="square" class="mr-2">
                                        <span>${currentLanguage === 'ko' ? '사각형' : 'Square'}</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="radio" name="badgeStyle" value="circle" class="mr-2">
                                        <span>${currentLanguage === 'ko' ? '원형' : 'Circle'}</span>
                                    </label>
                                </div>
                            </div>
                            
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-neutral-700 mb-2">${currentLanguage === 'ko' ? '배경색' : 'Background'}</label>
                                    <input type="color" id="badge-bgColor" value="#ff6b6b" class="form-input h-12 w-full">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-neutral-700 mb-2">${currentLanguage === 'ko' ? '텍스트 색' : 'Text Color'}</label>
                                    <input type="color" id="badge-textColor" value="#ffffff" class="form-input h-12 w-full">
                                </div>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-neutral-700 mb-2">${currentLanguage === 'ko' ? '크기' : 'Size'}</label>
                                <div class="grid grid-cols-3 gap-2">
                                    <button class="btn-secondary" onclick="setBadgeSize('small')">${currentLanguage === 'ko' ? '작게' : 'Small'}</button>
                                    <button class="btn-secondary" onclick="setBadgeSize('medium')">${currentLanguage === 'ko' ? '보통' : 'Medium'}</button>
                                    <button class="btn-secondary" onclick="setBadgeSize('large')">${currentLanguage === 'ko' ? '크게' : 'Large'}</button>
                                </div>
                            </div>
                            
                            <button onclick="generateEnvBadgePreview()" class="btn-primary w-full">
                                ${currentLanguage === 'ko' ? '뱃지 생성하기' : 'Generate Badge'}
                            </button>
                        </div>
                        
                        <div>
                            <div class="border-2 border-dashed border-neutral-300 rounded-lg p-6 bg-neutral-50 min-h-64 flex items-center justify-center">
                                <canvas id="badge-canvas" width="200" height="200" class="border border-neutral-200 rounded shadow-sm"></canvas>
                            </div>
                            <div class="mt-4 space-y-2">
                                <button onclick="downloadBadgeImage('png')" class="btn-secondary w-full">
                                    ${currentLanguage === 'ko' ? 'PNG로 다운로드' : 'Download as PNG'}
                                </button>
                                <button onclick="downloadBadgeImage('svg')" class="btn-primary w-full">
                                    ${currentLanguage === 'ko' ? 'SVG로 다운로드' : 'Download as SVG'}
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // 칩 텍스트 크기 레이블 업데이트
        function updateChipSizeLabel() {
            const size = document.getElementById('chip-textSize').value;
            document.getElementById('chip-textSizeLabel').textContent = size + 'px';
            generateProfilePreview();
        }

        // 프로필 이미지 생성 함수
        function generateProfilePreview() {
            try {
                const canvas = document.getElementById('profile-canvas');
                if (!canvas) {
                    console.log('Canvas not found');
                    return;
                }
                
                const ctx = canvas.getContext('2d');
                const mainText = document.getElementById('profile-mainText')?.value || 'PROFILE';
                const textSize = parseInt(document.getElementById('profile-textSize')?.value || 120);
                const bgColor = document.getElementById('profile-bgColor')?.value || '#4a5568';
                const textColor = document.getElementById('profile-textColor')?.value || '#ffffff';
                const chipTextSize = parseInt(document.getElementById('chip-textSize')?.value || 12);
                
                // 텍스트 크기 레이블 업데이트
                const textSizeLabel = document.getElementById('profile-textSizeLabel');
                if (textSizeLabel) {
                    textSizeLabel.textContent = textSize;
                }
                
                // 캔버스 초기화
                ctx.fillStyle = bgColor;
                ctx.fillRect(0, 0, 300, 300);
                
                // 메인 텍스트 그리기
                ctx.save();
                ctx.fillStyle = textColor;
                ctx.font = `bold ${textSize}px Arial`;
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                
                const lines = mainText.split('|');
                const lineHeight = textSize * 1.2;
                const startY = 150 - ((lines.length - 1) * lineHeight) / 2;
                
                lines.forEach((line, index) => {
                    ctx.fillText(line.trim(), 150, startY + (index * lineHeight));
                });
                ctx.restore();
                
                // 칩 그리기
                const chips = [
                    { id: 'tl', x: 10, y: 10, align: 'left', vAlign: 'top' },
                    { id: 'tr', x: 290, y: 10, align: 'right', vAlign: 'top' },
                    { id: 'bl', x: 10, y: 290, align: 'left', vAlign: 'bottom' },
                    { id: 'br', x: 290, y: 290, align: 'right', vAlign: 'bottom' }
                ];
                
                chips.forEach(chip => {
                    const enabledEl = document.getElementById(`chip-${chip.id}-enabled`);
                    const textEl = document.getElementById(`chip-${chip.id}-text`);
                    const bgEl = document.getElementById(`chip-${chip.id}-bg`);
                    const colorEl = document.getElementById(`chip-${chip.id}-color`);
                    
                    console.log(`Checking chip ${chip.id}:`, {
                        enabled: enabledEl?.checked,
                        text: textEl?.value,
                        hasElements: !!(enabledEl && textEl && bgEl && colorEl)
                    });
                    
                    if (enabledEl && enabledEl.checked && textEl && bgEl && colorEl) {
                        // Use input value or placeholder as fallback
                        const text = textEl.value.trim() || textEl.getAttribute('placeholder') || '';
                        const bg = bgEl.value || '#ff6b6b';
                        const color = colorEl.value || '#ffffff';
                        
                        console.log(`Drawing chip ${chip.id}:`, { text, bg, color, placeholder: textEl.getAttribute('placeholder') });
                        
                        if (text) {
                            ctx.save();
                            
                            // 칩 텍스트 설정
                            ctx.font = `bold ${chipTextSize}px Arial`;
                            const metrics = ctx.measureText(text);
                            const padding = chipTextSize * 0.8;
                            const chipWidth = metrics.width + padding * 2;
                            const chipHeight = chipTextSize * 2;
                            
                            let chipX = chip.x;
                            let chipY = chip.y;
                            
                            // 정렬 처리
                            if (chip.align === 'right') {
                                chipX = chip.x - chipWidth;
                            }
                            
                            if (chip.vAlign === 'bottom') {
                                chipY = chip.y - chipHeight;
                            }
                            
                            console.log(`Chip position ${chip.id}:`, { x: chipX, y: chipY, width: chipWidth, height: chipHeight });
                            
                            // 칩 배경 그리기 (둥근 모서리)
                            ctx.fillStyle = bg;
                            const radius = Math.min(4, chipHeight * 0.2);
                            
                            ctx.beginPath();
                            ctx.moveTo(chipX + radius, chipY);
                            ctx.lineTo(chipX + chipWidth - radius, chipY);
                            ctx.quadraticCurveTo(chipX + chipWidth, chipY, chipX + chipWidth, chipY + radius);
                            ctx.lineTo(chipX + chipWidth, chipY + chipHeight - radius);
                            ctx.quadraticCurveTo(chipX + chipWidth, chipY + chipHeight, chipX + chipWidth - radius, chipY + chipHeight);
                            ctx.lineTo(chipX + radius, chipY + chipHeight);
                            ctx.quadraticCurveTo(chipX, chipY + chipHeight, chipX, chipY + chipHeight - radius);
                            ctx.lineTo(chipX, chipY + radius);
                            ctx.quadraticCurveTo(chipX, chipY, chipX + radius, chipY);
                            ctx.closePath();
                            ctx.fill();
                            
                            // 칩 텍스트 그리기
                            ctx.fillStyle = color;
                            ctx.font = `bold ${chipTextSize}px Arial`;
                            ctx.textAlign = 'center';
                            ctx.textBaseline = 'middle';
                            ctx.fillText(text, chipX + chipWidth/2, chipY + chipHeight/2);
                            
                            ctx.restore();
                        }
                    }
                });
                
                console.log('Profile preview generated');
                
            } catch (error) {
                console.error('프로필 생성 오류:', error);
            }
        }

        // 프로필 이미지 다운로드
        function downloadProfileImage() {
            try {
                const sourceCanvas = document.getElementById('profile-canvas');
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                
                canvas.width = 1080;
                canvas.height = 1080;
                
                // 고해상도로 다시 그리기
                const scale = 1080 / 300;
                ctx.scale(scale, scale);
                ctx.drawImage(sourceCanvas, 0, 0);
                
                const link = document.createElement('a');
                const mainText = document.getElementById('profile-mainText').value || 'PROFILE';
                const timestamp = new Date().toISOString().replace(/[:.]/g, '-').slice(0, -5);
                link.download = `profile_${mainText.replace(/[|\\s]/g, '_')}_${timestamp}.png`;
                link.href = canvas.toDataURL('image/png');
                link.click();
                
                showToast(currentLanguage === 'ko' ? '프로필 이미지가 다운로드되었습니다' : 'Profile image downloaded', 'success');
            } catch (error) {
                console.error('다운로드 오류:', error);
                showToast(currentLanguage === 'ko' ? '다운로드 중 오류가 발생했습니다' : 'Error downloading image', 'error');
            }
        }

        // 환경 뱃지 프리셋 업데이트
        function updateBadgePreset() {
            const env = document.getElementById('badge-env').value;
            const presets = {
                dev: { text: 'DEV', bg: '#4a5568', color: '#ffffff' },
                qa: { text: 'QA', bg: '#ff6b6b', color: '#ffffff' },
                stage: { text: 'STAGE', bg: '#f7b731', color: '#ffffff' },
                prod: { text: 'PROD', bg: '#00d2d3', color: '#ffffff' }
            };
            
            if (presets[env]) {
                document.getElementById('badge-text').value = presets[env].text;
                document.getElementById('badge-bgColor').value = presets[env].bg;
                document.getElementById('badge-textColor').value = presets[env].color;
                generateEnvBadgePreview();
            }
        }

        // 뱃지 크기 설정
        let badgeSize = 'medium';
        function setBadgeSize(size) {
            badgeSize = size;
            generateEnvBadgePreview();
        }

        // 환경 뱃지 생성
        function generateEnvBadgePreview() {
            try {
                const canvas = document.getElementById('badge-canvas');
                if (!canvas) return;
                
                const ctx = canvas.getContext('2d');
                const text = document.getElementById('badge-text').value || 'BADGE';
                const bgColor = document.getElementById('badge-bgColor').value;
                const textColor = document.getElementById('badge-textColor').value;
                const style = document.querySelector('input[name="badgeStyle"]:checked').value;
                
                // 크기 설정
                const sizes = {
                    small: { font: 14, padding: 8, height: 30 },
                    medium: { font: 18, padding: 12, height: 40 },
                    large: { font: 24, padding: 16, height: 50 }
                };
                const size = sizes[badgeSize];
                
                // 캔버스 초기화
                ctx.clearRect(0, 0, 200, 200);
                
                // 텍스트 크기 계산
                ctx.font = `bold ${size.font}px Arial`;
                const metrics = ctx.measureText(text);
                const width = metrics.width + size.padding * 2;
                
                // 위치 계산
                const x = (200 - width) / 2;
                const y = (200 - size.height) / 2;
                
                // 뱃지 배경 그리기
                ctx.fillStyle = bgColor;
                ctx.beginPath();
                
                if (style === 'rounded') {
                    ctx.roundRect(x, y, width, size.height, 8);
                } else if (style === 'circle') {
                    const radius = Math.max(width, size.height) / 2;
                    ctx.arc(100, 100, radius, 0, Math.PI * 2);
                } else {
                    ctx.rect(x, y, width, size.height);
                }
                ctx.fill();
                
                // 텍스트 그리기
                ctx.fillStyle = textColor;
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                
                if (style === 'circle') {
                    ctx.fillText(text, 100, 100);
                } else {
                    ctx.fillText(text, x + width/2, y + size.height/2);
                }
                
                showToast(currentLanguage === 'ko' ? '뱃지 생성 완료' : 'Badge generated', 'success');
            } catch (error) {
                console.error('뱃지 생성 오류:', error);
                showToast(currentLanguage === 'ko' ? '뱃지 생성 중 오류가 발생했습니다' : 'Error generating badge', 'error');
            }
        }

        // 뱃지 다운로드
        function downloadBadgeImage(format) {
            try {
                if (format === 'png') {
                    const canvas = document.getElementById('badge-canvas');
                    const link = document.createElement('a');
                    const text = document.getElementById('badge-text').value || 'BADGE';
                    const timestamp = new Date().toISOString().replace(/[:.]/g, '-').slice(0, -5);
                    link.download = `badge_${text}_${timestamp}.png`;
                    link.href = canvas.toDataURL('image/png');
                    link.click();
                } else if (format === 'svg') {
                    // SVG 생성
                    const text = document.getElementById('badge-text').value || 'BADGE';
                    const bgColor = document.getElementById('badge-bgColor').value;
                    const textColor = document.getElementById('badge-textColor').value;
                    const style = document.querySelector('input[name="badgeStyle"]:checked').value;
                    
                    let svg = `<svg xmlns="http://www.w3.org/2000/svg" width="200" height="60">`;
                    
                    if (style === 'rounded') {
                        svg += `<rect x="10" y="10" width="180" height="40" rx="8" fill="${bgColor}"/>`;
                    } else if (style === 'circle') {
                        svg += `<circle cx="100" cy="30" r="25" fill="${bgColor}"/>`;
                    } else {
                        svg += `<rect x="10" y="10" width="180" height="40" fill="${bgColor}"/>`;
                    }
                    
                    svg += `<text x="100" y="30" text-anchor="middle" dominant-baseline="middle" fill="${textColor}" font-family="Arial" font-weight="bold" font-size="18">${text}</text>`;
                    svg += `</svg>`;
                    
                    const blob = new Blob([svg], { type: 'image/svg+xml' });
                    const link = document.createElement('a');
                    const timestamp = new Date().toISOString().replace(/[:.]/g, '-').slice(0, -5);
                    link.download = `badge_${text}_${timestamp}.svg`;
                    link.href = URL.createObjectURL(blob);
                    link.click();
                }
                
                showToast(currentLanguage === 'ko' ? '뱃지가 다운로드되었습니다' : 'Badge downloaded', 'success');
            } catch (error) {
                console.error('다운로드 오류:', error);
                showToast(currentLanguage === 'ko' ? '다운로드 중 오류가 발생했습니다' : 'Error downloading badge', 'error');
            }
        }

        // 사업자등록번호 생성기 HTML
        function getBusinessNumberGeneratorHTML() {
            return `
                <div class="space-y-6">
                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                        <p class="text-sm text-blue-800">
                            ${currentLanguage === 'ko' ? 
                                '✅ 생성된 번호는 체크섬 검증을 통과한 유효한 형식의 번호입니다.' : 
                                '✅ Generated numbers are valid format numbers that pass checksum verification.'}
                        </p>
                    </div>
                    
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-neutral-700 mb-2">
                                    ${currentLanguage === 'ko' ? '사업자 유형' : 'Business Type'}
                                </label>
                                <select id="business-type" class="form-input" onchange="updateBusinessTypeSettings()">
                                    <option value="individual-01-79">${currentLanguage === 'ko' ? '개인사업자 (01-79)' : 'Individual (01-79)'}</option>
                                    <option value="individual-90-99">${currentLanguage === 'ko' ? '개인사업자 (90-99)' : 'Individual (90-99)'}</option>
                                    <option value="corporate-domestic">${currentLanguage === 'ko' ? '법인 영리 국내 (81,85-88)' : 'Corporate Domestic (81,85-88)'}</option>
                                    <option value="corporate-foreign">${currentLanguage === 'ko' ? '법인 영리 해외 (84)' : 'Corporate Foreign (84)'}</option>
                                    <option value="nonprofit">${currentLanguage === 'ko' ? '비영리/국가 및 지자체 (82,83)' : 'Non-profit/Government (82,83)'}</option>
                                    <option value="association">${currentLanguage === 'ko' ? '임의단체 (80,89)' : 'Association (80,89)'}</option>
                                    <option value="random">${currentLanguage === 'ko' ? '전체 랜덤' : 'All Random'}</option>
                                    <option value="max-all">${currentLanguage === 'ko' ? '전체 MAX 생성 (모든 유형)' : 'MAX Generation (All Types)'}</option>
                                </select>
                            </div>
                            
                            <div id="count-settings">
                                <label class="block text-sm font-medium text-neutral-700 mb-2">
                                    ${currentLanguage === 'ko' ? '생성 개수' : 'Count'}
                                </label>
                                <select id="business-count" class="form-input">
                                    <option value="5">5${currentLanguage === 'ko' ? '개' : ''}</option>
                                    <option value="10" selected>10${currentLanguage === 'ko' ? '개' : ''}</option>
                                    <option value="20">20${currentLanguage === 'ko' ? '개' : ''}</option>
                                    <option value="50">50${currentLanguage === 'ko' ? '개' : ''}</option>
                                    <option value="100">100${currentLanguage === 'ko' ? '개' : ''}</option>
                                </select>
                            </div>
                            
                            <div id="max-settings" class="hidden">
                                <div class="bg-yellow-50 border border-yellow-200 rounded p-3 mb-3">
                                    <p class="text-xs text-yellow-800">${currentLanguage === 'ko' ? 'MAX 생성 모드: 각 유형별 최대 생성량 설정' : 'MAX Generation Mode: Set maximum count per type'}</p>
                                </div>
                                
                                <div class="space-y-3 text-sm">
                                    <div class="flex justify-between items-center">
                                        <span>${currentLanguage === 'ko' ? '개인사업자 (01-79)' : 'Individual (01-79)'}</span>
                                        <input type="number" id="max-individual-01-79" min="0" max="200" value="30" class="w-16 text-xs p-1 border rounded">
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span>${currentLanguage === 'ko' ? '개인사업자 (90-99)' : 'Individual (90-99)'}</span>
                                        <input type="number" id="max-individual-90-99" min="0" max="50" value="20" class="w-16 text-xs p-1 border rounded">
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span>${currentLanguage === 'ko' ? '법인 영리 국내' : 'Corporate Domestic'}</span>
                                        <input type="number" id="max-corporate-domestic" min="0" max="100" value="25" class="w-16 text-xs p-1 border rounded">
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span>${currentLanguage === 'ko' ? '법인 영리 해외' : 'Corporate Foreign'}</span>
                                        <input type="number" id="max-corporate-foreign" min="0" max="30" value="10" class="w-16 text-xs p-1 border rounded">
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span>${currentLanguage === 'ko' ? '비영리/국가·지자체' : 'Non-profit/Gov'}</span>
                                        <input type="number" id="max-nonprofit" min="0" max="50" value="15" class="w-16 text-xs p-1 border rounded">
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span>${currentLanguage === 'ko' ? '임의단체' : 'Association'}</span>
                                        <input type="number" id="max-association" min="0" max="50" value="10" class="w-16 text-xs p-1 border rounded">
                                    </div>
                                    
                                    <div class="border-t pt-2 mt-3">
                                        <div class="flex justify-between items-center font-medium">
                                            <span>${currentLanguage === 'ko' ? '전체 생성 상한' : 'Total Generation Limit'}</span>
                                            <input type="number" id="max-total-limit" min="50" max="500" value="200" class="w-16 text-xs p-1 border rounded font-medium">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="border-t pt-4">
                                <details class="group">
                                    <summary class="cursor-pointer flex items-center justify-between text-sm font-medium text-neutral-700 hover:text-neutral-900">
                                        <span>⚙️ ${currentLanguage === 'ko' ? '고급 설정 (앞자리 고정)' : 'Advanced Settings (Fix Prefix)'}</span>
                                        <svg class="w-4 h-4 transition-transform group-open:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                                        </svg>
                                    </summary>
                                    <div class="mt-4 space-y-3">
                                        <div class="bg-amber-50 border border-amber-200 rounded p-3">
                                            <p class="text-xs text-amber-800">
                                                ${currentLanguage === 'ko' ? 
                                                    '💡 최대 9자리까지 고정 가능 (마지막 1자리는 체크디지트)' : 
                                                    '💡 Fix up to 9 digits (last digit is checksum)'}
                                            </p>
                                        </div>
                                        
                                        <div>
                                            <label class="block text-sm font-medium text-neutral-700 mb-2">
                                                ${currentLanguage === 'ko' ? '고정값 입력' : 'Fixed Value Input'}
                                            </label>
                                            <input type="text" 
                                                   id="fixed-prefix" 
                                                   class="form-input" 
                                                   placeholder="${currentLanguage === 'ko' ? '예: 123 또는 123-45 또는 123-45-6789' : 'e.g., 123 or 123-45 or 123-45-6789'}"
                                                   maxlength="13"
                                                   oninput="validateFixedPrefix(this)">
                                            <div id="fixed-prefix-help" class="mt-1 text-xs text-neutral-500">
                                                ${currentLanguage === 'ko' ? 
                                                    '입력 형식: XXX (지역) 또는 XXX-XX (지역-업종) 또는 XXX-XX-XXXX (지역-업종-일련번호)' : 
                                                    'Format: XXX (region) or XXX-XX (region-type) or XXX-XX-XXXX (region-type-serial)'}
                                            </div>
                                            <div id="fixed-prefix-error" class="mt-1 text-xs text-red-600 hidden"></div>
                                        </div>
                                        
                                        <div class="flex gap-2">
                                            <button onclick="applyFixedPrefix()" class="btn-secondary text-sm py-1 px-3">
                                                ✓ ${currentLanguage === 'ko' ? '적용' : 'Apply'}
                                            </button>
                                            <button onclick="clearFixedPrefix()" class="btn-secondary text-sm py-1 px-3">
                                                ✗ ${currentLanguage === 'ko' ? '초기화' : 'Clear'}
                                            </button>
                                        </div>
                                        
                                        <div id="fixed-prefix-status" class="hidden">
                                            <div class="bg-green-50 border border-green-200 rounded p-2">
                                                <p class="text-xs text-green-800">
                                                    <span class="font-medium">${currentLanguage === 'ko' ? '고정값 적용됨:' : 'Fixed value applied:'}</span>
                                                    <span id="fixed-prefix-display" class="ml-1"></span>
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                </details>
                            </div>
                            
                            <button onclick="generateBusinessNumbers()" class="btn-primary w-full">
                                🎲 ${currentLanguage === 'ko' ? '사업자번호 생성' : 'Generate Numbers'}
                            </button>
                            
                            <div class="flex gap-2">
                                <button onclick="copyBusinessNumbers()" class="btn-secondary flex-1">
                                    📋 ${currentLanguage === 'ko' ? '전체 복사' : 'Copy All'}
                                </button>
                                <button onclick="downloadBusinessNumbers()" class="btn-secondary flex-1">
                                    💾 ${currentLanguage === 'ko' ? 'CSV 다운로드' : 'Download CSV'}
                                </button>
                            </div>
                        </div>
                        
                        <div class="lg:col-span-2">
                            <div class="bg-neutral-50 border border-neutral-200 rounded-lg p-4 h-96 overflow-y-auto">
                                <div id="business-numbers-list" class="space-y-2">
                                    <p class="text-center text-neutral-500">
                                        ${currentLanguage === 'ko' ? 
                                            '생성 버튼을 클릭하여 사업자번호를 생성하세요' : 
                                            'Click generate button to create business numbers'}
                                    </p>
                                </div>
                            </div>
                            <div class="mt-2 flex justify-between text-sm text-neutral-600">
                                <span><span id="business-count-display">0</span> ${currentLanguage === 'ko' ? '개 생성됨' : 'numbers generated'}</span>
                                <span id="business-type-breakdown" class="text-xs"></span>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // 사업자등록번호 유효성 검사
        function validateBusinessNumber(number) {
            const weights = [1, 3, 7, 1, 3, 7, 1, 3, 5];
            const nums = number.replace(/-/g, '').split('').map(Number);
            
            if (nums.length !== 10) return false;
            
            let sum = 0;
            for (let i = 0; i < 9; i++) {
                sum += nums[i] * weights[i];
            }
            
            sum += Math.floor((nums[8] * 5) / 10);
            const checkDigit = (10 - (sum % 10)) % 10;
            
            return checkDigit === nums[9];
        }

        // 유효한 사업자등록번호 생성
        function generateValidBusinessNumber(prefix, middle, suffix) {
            // prefix: 3자리, middle: 2자리, suffix: 4자리
            const base9 = prefix + middle + suffix; // 9자리
            
            const weights = [1, 3, 7, 1, 3, 7, 1, 3, 5];
            const nums = base9.split('').map(Number);
            
            let sum = 0;
            for (let i = 0; i < 9; i++) {
                sum += nums[i] * weights[i];
            }
            
            sum += Math.floor((nums[8] * 5) / 10);
            const checkDigit = (10 - (sum % 10)) % 10;
            
            // 3자리-2자리-5자리 형식으로 반환 (suffix 4자리 + checkDigit 1자리 = 5자리)
            return prefix + '-' + middle + '-' + suffix + checkDigit;
        }

        // 사업자번호 유형 설정 업데이트
        function updateBusinessTypeSettings() {
            const type = document.getElementById('business-type').value;
            const countSettings = document.getElementById('count-settings');
            const maxSettings = document.getElementById('max-settings');
            
            if (type === 'max-all') {
                countSettings.classList.add('hidden');
                maxSettings.classList.remove('hidden');
            } else {
                countSettings.classList.remove('hidden');
                maxSettings.classList.add('hidden');
            }
        }
        
        // 정확한 경계값 분할을 위한 유형별 범위 정의
        const businessTypeRanges = {
            'individual-01-79': [
                { start: 1, end: 79 }  // 01-79
            ],
            'individual-90-99': [
                { start: 90, end: 99 } // 90-99
            ],
            'corporate-domestic': [
                { start: 81, end: 81 }, // 81
                { start: 85, end: 88 }  // 85-88
            ],
            'corporate-foreign': [
                { start: 84, end: 84 }  // 84
            ],
            'nonprofit': [
                { start: 82, end: 83 }  // 82-83
            ],
            'association': [
                { start: 80, end: 80 }, // 80
                { start: 89, end: 89 }  // 89
            ]
        };

        // 사업자등록번호 생성
        function generateBusinessNumbers() {
            try {
                const type = document.getElementById('business-type').value;
                
                let businessNumbers = new Set();
                let typeBreakdown = {};
                
                if (type === 'max-all') {
                    // MAX 생성 모드
                    const maxCounts = {
                        'individual-01-79': parseInt(document.getElementById('max-individual-01-79').value || 30),
                        'individual-90-99': parseInt(document.getElementById('max-individual-90-99').value || 20),
                        'corporate-domestic': parseInt(document.getElementById('max-corporate-domestic').value || 25),
                        'corporate-foreign': parseInt(document.getElementById('max-corporate-foreign').value || 10),
                        'nonprofit': parseInt(document.getElementById('max-nonprofit').value || 15),
                        'association': parseInt(document.getElementById('max-association').value || 10)
                    };
                    
                    const totalLimit = parseInt(document.getElementById('max-total-limit').value || 200);
                    let totalGenerated = 0;
                    
                    // 각 유형별로 생성
                    for (const [businessType, maxCount] of Object.entries(maxCounts)) {
                        if (maxCount > 0 && totalGenerated < totalLimit) {
                            const actualCount = Math.min(maxCount, totalLimit - totalGenerated);
                            const typeNumbers = generateNumbersByType(businessType, actualCount, fixedPrefixData);
                            typeNumbers.forEach(num => businessNumbers.add(num));
                            typeBreakdown[businessType] = typeNumbers.length;
                            totalGenerated += typeNumbers.length;
                        }
                    }
                    
                } else if (type === 'random') {
                    // 전체 랜덤 모드
                    const count = parseInt(document.getElementById('business-count').value);
                    const allTypes = Object.keys(businessTypeRanges);
                    
                    for (let i = 0; i < count; i++) {
                        const randomType = allTypes[Math.floor(Math.random() * allTypes.length)];
                        const numbers = generateNumbersByType(randomType, 1, fixedPrefixData);
                        numbers.forEach(num => businessNumbers.add(num));
                        typeBreakdown[randomType] = (typeBreakdown[randomType] || 0) + 1;
                    }
                    
                } else {
                    // 단일 유형 모드
                    const count = parseInt(document.getElementById('business-count').value);
                    const numbers = generateNumbersByType(type, count, fixedPrefixData);
                    numbers.forEach(num => businessNumbers.add(num));
                    typeBreakdown[type] = numbers.length;
                }
                
                window.generatedBusinessNumbers = Array.from(businessNumbers);
                window.businessTypeBreakdown = typeBreakdown;
                displayBusinessNumbers();
                
                const totalCount = businessNumbers.size;
                showToast(
                    currentLanguage === 'ko' ? 
                        `${totalCount}개의 사업자등록번호가 생성되었습니다` : 
                        `${totalCount} business numbers generated`, 
                    'success'
                );
            } catch (error) {
                console.error('사업자번호 생성 오류:', error);
                showToast(
                    currentLanguage === 'ko' ? 
                        '사업자번호 생성 중 오류가 발생했습니다' : 
                        'Error generating business numbers', 
                    'error'
                );
            }
        }
        
        // 유형별 사업자번호 생성
        function generateNumbersByType(type, count, fixedData = null) {
            const ranges = businessTypeRanges[type];
            if (!ranges) return [];
            
            const numbers = new Set();
            const today = new Date();
            const month = String(today.getMonth() + 1).padStart(2, '0');
            const day = String(today.getDate()).padStart(2, '0');
            
            let attempts = 0;
            const maxAttempts = count * 100; // 무한루프 방지
            
            while (numbers.size < count && attempts < maxAttempts) {
                attempts++;
                
                let prefix, middle, suffix;
                
                // 고정값이 있으면 사용, 없으면 랜덤 생성
                if (fixedData && fixedData.enabled) {
                    // 지역코드
                    if (fixedData.prefix) {
                        prefix = fixedData.prefix;
                    } else {
                        // 000도 포함하여 000-999 범위에서 랜덤 생성
                        prefix = String(Math.floor(Math.random() * 1000)).padStart(3, '0');
                    }
                    
                    // 업종코드
                    if (fixedData.middle) {
                        middle = fixedData.middle;
                    } else {
                        const range = ranges[Math.floor(Math.random() * ranges.length)];
                        const middleNum = range.start + Math.floor(Math.random() * (range.end - range.start + 1));
                        middle = String(middleNum).padStart(2, '0');
                    }
                    
                    // 일련번호
                    if (fixedData.suffix) {
                        // 고정된 일련번호가 있는 경우
                        const fixedLength = fixedData.suffix.length;
                        if (fixedLength === 4) {
                            // 4자리 모두 고정
                            suffix = fixedData.suffix;
                        } else {
                            // 일부만 고정, 나머지는 랜덤
                            const remainingDigits = 4 - fixedLength;
                            const randomPart = String(Math.floor(Math.random() * Math.pow(10, remainingDigits)))
                                .padStart(remainingDigits, '0');
                            suffix = fixedData.suffix + randomPart;
                        }
                    } else {
                        suffix = String(Math.floor(Math.random() * 9999) + 1).padStart(4, '0');
                    }
                } else {
                    // 고정값이 없는 경우 (000-999 범위로 확장)
                    prefix = String(Math.floor(Math.random() * 1000)).padStart(3, '0');
                    
                    const range = ranges[Math.floor(Math.random() * ranges.length)];
                    const middleNum = range.start + Math.floor(Math.random() * (range.end - range.start + 1));
                    middle = String(middleNum).padStart(2, '0');
                    
                    suffix = String(Math.floor(Math.random() * 9999) + 1).padStart(4, '0');
                }
                
                const businessNumber = generateValidBusinessNumber(prefix, middle, suffix);
                
                if (validateBusinessNumber(businessNumber)) {
                    numbers.add(businessNumber);
                }
            }
            
            return Array.from(numbers);
        }

        // 사업자등록번호 표시
        function displayBusinessNumbers() {
            const listElement = document.getElementById('business-numbers-list');
            const countElement = document.getElementById('business-count-display');
            
            if (!window.generatedBusinessNumbers || window.generatedBusinessNumbers.length === 0) {
                listElement.innerHTML = `
                    <p class="text-center text-neutral-500">
                        ${currentLanguage === 'ko' ? 
                            '생성 버튼을 클릭하여 사업자번호를 생성하세요' : 
                            'Click generate button to create business numbers'}
                    </p>
                `;
                countElement.textContent = '0';
                return;
            }
            
            listElement.innerHTML = window.generatedBusinessNumbers.map((number, index) => `
                <div class="flex items-center justify-between p-2 bg-white rounded border hover:border-primary-400 transition-colors">
                    <span class="font-mono text-sm">${number}</span>
                    <button onclick="copyToClipboard('${number}')" class="text-primary-600 hover:text-primary-800">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                        </svg>
                    </button>
                </div>
            `).join('');
            
            countElement.textContent = window.generatedBusinessNumbers.length;
            
            // 유형별 분류하여 표시
            updateBusinessNumbersDisplay();
        }
        
        // 개선된 사업자번호 표시 (유형별 분류)
        function updateBusinessNumbersDisplay() {
            const listElement = document.getElementById('business-numbers-list');
            const breakdownElement = document.getElementById('business-type-breakdown');
            
            if (!window.generatedBusinessNumbers || window.generatedBusinessNumbers.length === 0) {
                return;
            }
            
            // 번호별 유형 분류
            const categorizedNumbers = categorizeBusinessNumbers(window.generatedBusinessNumbers);
            
            // HTML 생성
            let html = '';
            for (const [category, numbers] of Object.entries(categorizedNumbers)) {
                if (numbers.length > 0) {
                    const categoryName = getBusinessTypeName(category);
                    html += `
                        <div class="mb-4">
                            <div class="flex items-center justify-between mb-2 pb-1 border-b border-neutral-200">
                                <h4 class="text-sm font-medium text-neutral-700">${categoryName}</h4>
                                <span class="text-xs text-neutral-500">${numbers.length}개</span>
                            </div>
                            <div class="space-y-1">
                                ${numbers.map(number => `
                                    <div class="flex items-center justify-between p-2 bg-white rounded border hover:border-primary-400 transition-colors">
                                        <span class="font-mono text-sm">${number}</span>
                                        <button onclick="copyToClipboard('${number}')" class="text-primary-600 hover:text-primary-800">
                                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                                            </svg>
                                        </button>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    `;
                }
            }
            
            if (html) {
                listElement.innerHTML = html;
            }
            
            // 유형별 요약 정보 표시
            if (breakdownElement && window.businessTypeBreakdown) {
                const breakdownText = Object.entries(window.businessTypeBreakdown)
                    .map(([type, count]) => {
                        const shortName = getBusinessTypeShortName(type);
                        return `${shortName}: ${count}`;
                    }).join(', ');
                breakdownElement.textContent = breakdownText;
            }
        }
        
        // 사업자번호를 유형별로 분류
        function categorizeBusinessNumbers(numbers) {
            const categories = {
                'individual-01-79': [],
                'individual-90-99': [],
                'corporate-domestic': [],
                'corporate-foreign': [],
                'nonprofit': [],
                'association': []
            };
            
            numbers.forEach(number => {
                const middleNum = parseInt(number.split('-')[1]);
                
                if (middleNum >= 1 && middleNum <= 79) {
                    categories['individual-01-79'].push(number);
                } else if (middleNum >= 90 && middleNum <= 99) {
                    categories['individual-90-99'].push(number);
                } else if (middleNum === 81 || (middleNum >= 85 && middleNum <= 88)) {
                    categories['corporate-domestic'].push(number);
                } else if (middleNum === 84) {
                    categories['corporate-foreign'].push(number);
                } else if (middleNum >= 82 && middleNum <= 83) {
                    categories['nonprofit'].push(number);
                } else if (middleNum === 80 || middleNum === 89) {
                    categories['association'].push(number);
                }
            });
            
            return categories;
        }
        
        // 사업자 유형 이름 반환
        function getBusinessTypeName(type) {
            const names = {
                'individual-01-79': currentLanguage === 'ko' ? '개인사업자 (01-79)' : 'Individual (01-79)',
                'individual-90-99': currentLanguage === 'ko' ? '개인사업자 (90-99)' : 'Individual (90-99)',
                'corporate-domestic': currentLanguage === 'ko' ? '법인 영리 국내 (81,85-88)' : 'Corporate Domestic (81,85-88)',
                'corporate-foreign': currentLanguage === 'ko' ? '법인 영리 해외 (84)' : 'Corporate Foreign (84)',
                'nonprofit': currentLanguage === 'ko' ? '비영리/국가 및 지자체 (82,83)' : 'Non-profit/Government (82,83)',
                'association': currentLanguage === 'ko' ? '임의단체 (80,89)' : 'Association (80,89)'
            };
            return names[type] || type;
        }
        
        // 사업자 유형 짧은 이름 반환
        function getBusinessTypeShortName(type) {
            const shortNames = {
                'individual-01-79': currentLanguage === 'ko' ? '개인(01-79)' : 'Ind(01-79)',
                'individual-90-99': currentLanguage === 'ko' ? '개인(90-99)' : 'Ind(90-99)',
                'corporate-domestic': currentLanguage === 'ko' ? '법인국내' : 'Corp-Dom',
                'corporate-foreign': currentLanguage === 'ko' ? '법인해외' : 'Corp-For',
                'nonprofit': currentLanguage === 'ko' ? '비영리' : 'Non-profit',
                'association': currentLanguage === 'ko' ? '임의단체' : 'Assoc'
            };
            return shortNames[type] || type;
        }

        // 클립보드에 복사
        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                showToast(
                    currentLanguage === 'ko' ? 
                        '클립보드에 복사되었습니다' : 
                        'Copied to clipboard', 
                    'success'
                );
            });
        }

        // 전체 사업자번호 복사
        function copyBusinessNumbers() {
            if (!window.generatedBusinessNumbers || window.generatedBusinessNumbers.length === 0) {
                showToast(
                    currentLanguage === 'ko' ? 
                        '먼저 사업자번호를 생성해주세요' : 
                        'Please generate numbers first', 
                    'error'
                );
                return;
            }
            
            const text = window.generatedBusinessNumbers.join('\n');
            navigator.clipboard.writeText(text).then(() => {
                showToast(
                    currentLanguage === 'ko' ? 
                        `${window.generatedBusinessNumbers.length}개의 번호가 복사되었습니다` : 
                        `${window.generatedBusinessNumbers.length} numbers copied`, 
                    'success'
                );
            });
        }

        // CSV 다운로드
        function downloadBusinessNumbers() {
            if (!window.generatedBusinessNumbers || window.generatedBusinessNumbers.length === 0) {
                showToast(
                    currentLanguage === 'ko' ? 
                        '먼저 사업자번호를 생성해주세요' : 
                        'Please generate numbers first', 
                    'error'
                );
                return;
            }
            
            const csv = '사업자등록번호\n' + window.generatedBusinessNumbers.join('\n');
            const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const timestamp = new Date().toISOString().split('T')[0];
            link.download = `business_numbers_${timestamp}.csv`;
            link.href = URL.createObjectURL(blob);
            link.click();
            
            showToast(
                currentLanguage === 'ko' ? 
                    'CSV 파일이 다운로드되었습니다' : 
                    'CSV file downloaded', 
                'success'
            );
        }
        
        // 고정값 관련 전역 변수
        let fixedPrefixData = {
            enabled: false,
            prefix: null,    // 3자리
            middle: null,    // 2자리
            suffix: null     // 최대 4자리
        };
        
        // 고정값 입력 유효성 검사
        function validateFixedPrefix(input) {
            const value = input.value.replace(/[^\d-]/g, ''); // 숫자와 하이픈만 허용
            input.value = value;
            
            const errorDiv = document.getElementById('fixed-prefix-error');
            const parts = value.split('-').filter(p => p);
            
            // 유효성 검사
            if (parts.length > 0) {
                // 첫 번째 부분 (지역코드): 3자리 (000도 허용)
                if (parts[0] && parts[0].length !== 3) {
                    errorDiv.textContent = currentLanguage === 'ko' ? 
                        '지역코드는 3자리여야 합니다' : 
                        'Region code must be 3 digits';
                    errorDiv.classList.remove('hidden');
                    return false;
                }
                
                // 두 번째 부분 (업종코드): 2자리
                if (parts[1] && parts[1].length !== 2) {
                    errorDiv.textContent = currentLanguage === 'ko' ? 
                        '업종코드는 2자리여야 합니다' : 
                        'Business type code must be 2 digits';
                    errorDiv.classList.remove('hidden');
                    return false;
                }
                
                // 세 번째 부분 (일련번호): 최대 4자리
                if (parts[2] && parts[2].length > 4) {
                    errorDiv.textContent = currentLanguage === 'ko' ? 
                        '일련번호는 최대 4자리까지 가능합니다' : 
                        'Serial number can be up to 4 digits';
                    errorDiv.classList.remove('hidden');
                    return false;
                }
                
                // 전체 자리수 체크 (최대 9자리)
                const totalDigits = parts.join('').length;
                if (totalDigits > 9) {
                    errorDiv.textContent = currentLanguage === 'ko' ? 
                        '전체 고정값은 최대 9자리까지 가능합니다' : 
                        'Total fixed value can be up to 9 digits';
                    errorDiv.classList.remove('hidden');
                    return false;
                }
            }
            
            errorDiv.classList.add('hidden');
            return true;
        }
        
        // 고정값 적용
        function applyFixedPrefix() {
            const input = document.getElementById('fixed-prefix');
            const value = input.value.trim();
            
            if (!value) {
                showToast(
                    currentLanguage === 'ko' ? '고정값을 입력해주세요' : 'Please enter a fixed value',
                    'error'
                );
                return;
            }
            
            if (!validateFixedPrefix(input)) {
                return;
            }
            
            const parts = value.split('-').filter(p => p);
            
            // 고정값 데이터 설정
            fixedPrefixData.enabled = true;
            fixedPrefixData.prefix = parts[0] || null;
            fixedPrefixData.middle = parts[1] || null;
            fixedPrefixData.suffix = parts[2] || null;
            
            // UI 업데이트
            const statusDiv = document.getElementById('fixed-prefix-status');
            const displaySpan = document.getElementById('fixed-prefix-display');
            
            let displayText = '';
            if (fixedPrefixData.prefix) displayText += fixedPrefixData.prefix;
            if (fixedPrefixData.middle) displayText += '-' + fixedPrefixData.middle;
            if (fixedPrefixData.suffix) displayText += '-' + fixedPrefixData.suffix;
            displayText += '-' + 'X'.repeat(9 - displayText.replace(/-/g, '').length) + 'C';
            
            displaySpan.textContent = displayText;
            statusDiv.classList.remove('hidden');
            
            showToast(
                currentLanguage === 'ko' ? 
                    `고정값이 적용되었습니다: ${displayText}` : 
                    `Fixed value applied: ${displayText}`,
                'success'
            );
        }
        
        // 고정값 초기화
        function clearFixedPrefix() {
            fixedPrefixData = {
                enabled: false,
                prefix: null,
                middle: null,
                suffix: null
            };
            
            document.getElementById('fixed-prefix').value = '';
            document.getElementById('fixed-prefix-status').classList.add('hidden');
            document.getElementById('fixed-prefix-error').classList.add('hidden');
            
            showToast(
                currentLanguage === 'ko' ? '고정값이 초기화되었습니다' : 'Fixed value cleared',
                'success'
            );
        }

        // 어드민 도구 관리 시스템
        const ADMIN_TOOLS_KEY = 'ceoplus_admin_tools_config';
        let adminToolsConfig = [];

        // 기본 어드민 도구 설정
        const defaultAdminTools = [
            {
                id: 'qr-create',
                name: '가맹점 생성 및 QR 활성화',
                nameEn: 'Create Store & Activate QR',
                desc: '새로운 가맹점을 등록하고 QR 코드를 활성화합니다',
                descEn: 'Register a new store and activate QR code',
                tag: '3개 어드민',
                tagEn: '3 Admins',
                icon: 'plus',
                subAdmins: [
                    {
                        name: '파트너 서비스 어드민',
                        nameEn: 'Partner Service Admin',
                        desc: '파트너 서비스 관리',
                        descEn: 'Partner service management',
                        url: 'https://partner.admin.example.com',
                        isInternal: true
                    },
                    {
                        name: '커머스 어드민',
                        nameEn: 'Commerce Admin',
                        desc: '상거래 플랫폼 관리',
                        descEn: 'Commerce platform management',
                        url: 'https://commerce.admin.example.com',
                        isInternal: false
                    },
                    {
                        name: 'QR 관리 어드민',
                        nameEn: 'QR Management Admin',
                        desc: 'QR 코드 생성 및 관리',
                        descEn: 'QR code generation and management',
                        url: 'https://qr.admin.example.com',
                        isInternal: true
                    }
                ]
            },
            {
                id: 'qr-recovery',
                name: '가맹점 QR 복구',
                nameEn: 'Store QR Recovery',
                desc: '손상된 QR 코드를 복구하고 재활성화합니다',
                descEn: 'Recover and reactivate damaged QR codes',
                tag: '3개 어드민',
                tagEn: '3 Admins',
                icon: 'refresh',
                subAdmins: [
                    {
                        name: 'QR 복구 어드민',
                        nameEn: 'QR Recovery Admin',
                        desc: '손상된 QR 복구 처리',
                        descEn: 'Damaged QR recovery processing',
                        url: 'https://recovery.admin.example.com',
                        isInternal: true
                    },
                    {
                        name: '매장 관리 어드민',
                        nameEn: 'Store Management Admin',
                        desc: '매장 정보 관리',
                        descEn: 'Store information management',
                        url: 'https://store.admin.example.com',
                        isInternal: false
                    },
                    {
                        name: '데이터 백업 어드민',
                        nameEn: 'Data Backup Admin',
                        desc: '데이터 백업 및 복원',
                        descEn: 'Data backup and restore',
                        url: 'https://backup.admin.example.com',
                        isInternal: true
                    }
                ]
            },
            {
                id: 'permission',
                name: '매장 권한 변경',
                nameEn: 'Store Permission Management',
                desc: '매장별 사용자 권한을 관리하고 수정합니다',
                descEn: 'Manage and modify user permissions per store',
                tag: '3개 어드민',
                tagEn: '3 Admins',
                icon: 'lock',
                subAdmins: [
                    {
                        name: '권한 관리 어드민',
                        nameEn: 'Permission Management Admin',
                        desc: '사용자 권한 설정',
                        descEn: 'User permission settings',
                        url: 'https://permission.admin.example.com',
                        isInternal: true
                    },
                    {
                        name: '사용자 관리 어드민',
                        nameEn: 'User Management Admin',
                        desc: '사용자 계정 관리',
                        descEn: 'User account management',
                        url: 'https://user.admin.example.com',
                        isInternal: false
                    },
                    {
                        name: '보안 설정 어드민',
                        nameEn: 'Security Settings Admin',
                        desc: '보안 정책 관리',
                        descEn: 'Security policy management',
                        url: 'https://security.admin.example.com',
                        isInternal: true
                    }
                ]
            }
        ];

        // 아이콘 SVG 매핑
        const iconSvg = {
            plus: '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>',
            refresh: '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>',
            lock: '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path>',
            chart: '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>',
            settings: '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>',
            users: '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"></path>',
            store: '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"></path>',
            qr: '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"></path>'
        };

        // 어드민 도구 초기화
        function initAdminTools() {
            const stored = localStorage.getItem(ADMIN_TOOLS_KEY);
            if (stored) {
                try {
                    adminToolsConfig = JSON.parse(stored);
                } catch (e) {
                    adminToolsConfig = [...defaultAdminTools];
                }
            } else {
                adminToolsConfig = [...defaultAdminTools];
            }
            renderAdminTools();
        }

        // 어드민 도구 렌더링
        function renderAdminTools() {
            const grid = document.getElementById('admin-tools-grid');
            if (!grid) return;
            
            grid.innerHTML = adminToolsConfig.map(tool => `
                <div class="card tool-card p-6" onclick="openAdminTool('${tool.id}')">
                    <div class="icon-container">
                        <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            ${iconSvg[tool.icon] || iconSvg.plus}
                        </svg>
                    </div>
                    <h3 class="text-xl font-bold text-neutral-800 mb-2">
                        ${currentLanguage === 'ko' ? tool.name : tool.nameEn}
                    </h3>
                    <p class="text-neutral-600 mb-4">
                        ${currentLanguage === 'ko' ? tool.desc : tool.descEn}
                    </p>
                    <div class="flex items-center text-sm text-neutral-500">
                        <span class="bg-primary-100 text-primary-800 px-2 py-1 rounded text-xs mr-2">
                            ${currentLanguage === 'ko' ? tool.tag : tool.tagEn}
                        </span>
                        <span>→</span>
                    </div>
                </div>
            `).join('');
        }

        // 어드민 도구 열기 (세부 어드민 목록 표시)
        function openAdminTool(toolId) {
            const tool = adminToolsConfig.find(t => t.id === toolId);
            if (!tool) return;
            
            const title = currentLanguage === 'ko' ? tool.name : tool.nameEn;
            
            let content = '<div class="space-y-4">';
            
            if (tool.subAdmins && tool.subAdmins.length > 0) {
                tool.subAdmins.forEach((admin, index) => {
                    const adminName = currentLanguage === 'ko' ? admin.name : admin.nameEn;
                    const adminDesc = currentLanguage === 'ko' ? admin.desc : admin.descEn;
                    
                    content += `
                        <div class="card p-4 cursor-pointer hover:shadow-lg transition-all" onclick="openAdminUrl('${admin.url}', '${adminName}')">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center space-x-4">
                                    <div class="w-10 h-10 bg-primary-100 rounded-lg flex items-center justify-center">
                                        <span class="font-bold text-primary-600">${index + 1}</span>
                                    </div>
                                    <div>
                                        <h4 class="font-medium text-neutral-800">${adminName}</h4>
                                        <p class="text-sm text-neutral-600">${adminDesc}</p>
                                        <p class="text-xs text-neutral-400 mt-1">${admin.url}</p>
                                    </div>
                                </div>
                                <div class="flex items-center space-x-2">
                                    ${admin.isInternal ? 
                                        '<span class="bg-yellow-100 text-yellow-800 text-xs px-2 py-1 rounded">내부</span>' : 
                                        '<span class="bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded">외부</span>'
                                    }
                                    <svg class="w-5 h-5 text-neutral-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                                    </svg>
                                </div>
                            </div>
                        </div>
                    `;
                });
            } else {
                content += `
                    <div class="text-center p-8 text-neutral-500">
                        <p>${currentLanguage === 'ko' ? '세부 어드민이 설정되지 않았습니다.' : 'No sub-admins configured.'}</p>
                        <button onclick="openAdminToolManager()" class="btn-primary mt-4">
                            ${currentLanguage === 'ko' ? '어드민 설정하기' : 'Configure Admins'}
                        </button>
                    </div>
                `;
            }
            
            content += '</div>';
            
            document.getElementById('tool-modal-title').textContent = title;
            document.getElementById('tool-modal-content').innerHTML = content;
            document.getElementById('tool-modal').classList.remove('hidden');
        }

        // 어드민 URL 열기
        function openAdminUrl(url, name) {
            try {
                logActivity('admin-tool', `${name} 열기`, 'started');
                
                const windowName = 'admin_' + name.replace(/\s/g, '_');
                const win = window.open(url, windowName, 'width=1200,height=800,menubar=yes,toolbar=yes,location=yes,status=yes,scrollbars=yes,resizable=yes');
                
                if (win) {
                    windowRefs[windowName] = win;
                    logActivity('admin-tool', `${name} 열기`, 'completed');
                    showToast(currentLanguage === 'ko' ? `${name} 도구를 새 창에서 열었습니다` : `${name} tool opened in new window`, 'success');
                }
            } catch (error) {
                console.error('어드민 URL 열기 오류:', error);
                logActivity('admin-tool', `${name} 열기`, 'failed');
                showToast(currentLanguage === 'ko' ? '도구를 여는 중 오류가 발생했습니다' : 'Error opening tool', 'error');
            }
        }

        // 어드민 도구 관리자 열기
        function openAdminToolManager() {
            renderAdminToolsList();
            document.getElementById('admin-manager-modal').classList.remove('hidden');
        }

        // 어드민 도구 관리자 닫기
        function closeAdminToolManager() {
            document.getElementById('admin-manager-modal').classList.add('hidden');
        }

        // 어드민 도구 목록 렌더링
        function renderAdminToolsList() {
            const list = document.getElementById('admin-tools-list');
            if (!list) return;
            
            list.innerHTML = adminToolsConfig.map((tool, index) => `
                <div class="border rounded-lg overflow-hidden mb-4">
                    <div class="flex items-center justify-between p-3 bg-white">
                        <div class="flex-1">
                            <div class="font-medium text-neutral-800">${tool.name}</div>
                            <div class="text-sm text-neutral-600">${tool.desc}</div>
                            <div class="text-xs text-neutral-500 mt-1">
                                ${tool.subAdmins ? `${tool.subAdmins.length}개의 세부 어드민` : '세부 어드민 없음'}
                            </div>
                        </div>
                        <div class="flex items-center space-x-2">
                            <button onclick="toggleSubAdmins(${index})" class="p-2 text-primary-600 hover:bg-primary-50 rounded-lg">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 100-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 100-4m0 4v2m0-6V4"></path>
                                </svg>
                            </button>
                            <button onclick="removeAdminTool(${index})" class="p-2 text-red-600 hover:bg-red-50 rounded-lg">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                </svg>
                            </button>
                        </div>
                    </div>
                    <div id="sub-admins-${index}" class="hidden bg-gray-50 p-3">
                        <div class="mb-3">
                            <h5 class="text-sm font-medium text-neutral-700 mb-2">세부 어드민 추가</h5>
                            <div class="grid grid-cols-1 gap-2">
                                <input type="text" id="sub-name-${index}" class="form-input text-sm" placeholder="어드민 이름">
                                <input type="text" id="sub-desc-${index}" class="form-input text-sm" placeholder="설명">
                                <input type="text" id="sub-url-${index}" class="form-input text-sm" placeholder="URL">
                                <label class="flex items-center text-sm">
                                    <input type="checkbox" id="sub-internal-${index}" class="mr-2">
                                    <span>내부 어드민</span>
                                </label>
                                <button onclick="addSubAdmin(${index})" class="btn-primary text-sm py-1">세부 어드민 추가</button>
                            </div>
                        </div>
                        ${tool.subAdmins && tool.subAdmins.length > 0 ? `
                            <div class="space-y-2">
                                <h5 class="text-sm font-medium text-neutral-700">등록된 세부 어드민</h5>
                                ${tool.subAdmins.map((sub, subIndex) => `
                                    <div class="flex items-center justify-between p-2 bg-white rounded border">
                                        <div class="flex-1">
                                            <div class="text-sm font-medium">${sub.name}</div>
                                            <div class="text-xs text-neutral-600">${sub.desc}</div>
                                            <div class="text-xs text-neutral-400">${sub.url}</div>
                                        </div>
                                        <button onclick="removeSubAdmin(${index}, ${subIndex})" class="p-1 text-red-600 hover:bg-red-50 rounded">
                                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                            </svg>
                                        </button>
                                    </div>
                                `).join('')}
                            </div>
                        ` : '<p class="text-sm text-neutral-500">세부 어드민이 없습니다.</p>'}
                    </div>
                </div>
            `).join('');
        }

        // 어드민 도구 추가
        function addAdminTool() {
            const name = document.getElementById('new-tool-name').value.trim();
            const desc = document.getElementById('new-tool-desc').value.trim();
            const tag = document.getElementById('new-tool-tag').value.trim();
            const icon = document.getElementById('new-tool-icon').value;
            
            if (!name || !desc) {
                showToast(currentLanguage === 'ko' ? '도구 이름과 설명을 입력해주세요' : 'Please enter tool name and description', 'error');
                return;
            }
            
            const newTool = {
                id: 'custom-' + Date.now(),
                name: name,
                nameEn: name,
                desc: desc,
                descEn: desc,
                tag: tag || '커스텀',
                tagEn: tag || 'Custom',
                icon: icon,
                subAdmins: []
            };
            
            adminToolsConfig.push(newTool);
            saveAdminTools();
            renderAdminTools();
            renderAdminToolsList();
            
            // 입력 필드 초기화
            document.getElementById('new-tool-name').value = '';
            document.getElementById('new-tool-desc').value = '';
            document.getElementById('new-tool-tag').value = '';
            
            showToast(currentLanguage === 'ko' ? '도구가 추가되었습니다' : 'Tool added successfully', 'success');
        }

        // 세부 어드민 토글
        function toggleSubAdmins(index) {
            const subAdminDiv = document.getElementById(`sub-admins-${index}`);
            if (subAdminDiv) {
                subAdminDiv.classList.toggle('hidden');
            }
        }

        // 세부 어드민 추가
        function addSubAdmin(toolIndex) {
            const name = document.getElementById(`sub-name-${toolIndex}`).value.trim();
            const desc = document.getElementById(`sub-desc-${toolIndex}`).value.trim();
            const url = document.getElementById(`sub-url-${toolIndex}`).value.trim();
            const isInternal = document.getElementById(`sub-internal-${toolIndex}`).checked;
            
            if (!name || !desc || !url) {
                showToast(currentLanguage === 'ko' ? '모든 필드를 입력해주세요' : 'Please fill in all fields', 'error');
                return;
            }
            
            if (!adminToolsConfig[toolIndex].subAdmins) {
                adminToolsConfig[toolIndex].subAdmins = [];
            }
            
            adminToolsConfig[toolIndex].subAdmins.push({
                name: name,
                nameEn: name,
                desc: desc,
                descEn: desc,
                url: url,
                isInternal: isInternal
            });
            
            // 태그 업데이트
            adminToolsConfig[toolIndex].tag = `${adminToolsConfig[toolIndex].subAdmins.length}개 어드민`;
            adminToolsConfig[toolIndex].tagEn = `${adminToolsConfig[toolIndex].subAdmins.length} Admins`;
            
            saveAdminTools();
            renderAdminTools();
            renderAdminToolsList();
            
            // 입력 필드 초기화
            document.getElementById(`sub-name-${toolIndex}`).value = '';
            document.getElementById(`sub-desc-${toolIndex}`).value = '';
            document.getElementById(`sub-url-${toolIndex}`).value = '';
            document.getElementById(`sub-internal-${toolIndex}`).checked = false;
            
            showToast(currentLanguage === 'ko' ? '세부 어드민이 추가되었습니다' : 'Sub-admin added successfully', 'success');
        }

        // 세부 어드민 제거
        function removeSubAdmin(toolIndex, subIndex) {
            if (confirm(currentLanguage === 'ko' ? '이 세부 어드민을 삭제하시겠습니까?' : 'Delete this sub-admin?')) {
                adminToolsConfig[toolIndex].subAdmins.splice(subIndex, 1);
                
                // 태그 업데이트
                if (adminToolsConfig[toolIndex].subAdmins.length > 0) {
                    adminToolsConfig[toolIndex].tag = `${adminToolsConfig[toolIndex].subAdmins.length}개 어드민`;
                    adminToolsConfig[toolIndex].tagEn = `${adminToolsConfig[toolIndex].subAdmins.length} Admins`;
                } else {
                    adminToolsConfig[toolIndex].tag = '세부 어드민 없음';
                    adminToolsConfig[toolIndex].tagEn = 'No Sub-admins';
                }
                
                saveAdminTools();
                renderAdminTools();
                renderAdminToolsList();
                
                showToast(currentLanguage === 'ko' ? '세부 어드민이 삭제되었습니다' : 'Sub-admin deleted', 'success');
            }
        }

        // 어드민 도구 제거
        function removeAdminTool(index) {
            if (confirm(currentLanguage === 'ko' ? '이 도구를 삭제하시겠습니까?' : 'Are you sure you want to delete this tool?')) {
                adminToolsConfig.splice(index, 1);
                saveAdminTools();
                renderAdminTools();
                renderAdminToolsList();
                showToast(currentLanguage === 'ko' ? '도구가 삭제되었습니다' : 'Tool deleted successfully', 'success');
            }
        }

        // 어드민 도구 저장
        function saveAdminTools() {
            localStorage.setItem(ADMIN_TOOLS_KEY, JSON.stringify(adminToolsConfig));
        }

        // 기본값 복원
        function loadDefaultAdminTools() {
            if (confirm(currentLanguage === 'ko' ? '기본값으로 복원하시겠습니까? 현재 설정이 삭제됩니다.' : 'Restore defaults? Current settings will be deleted.')) {
                adminToolsConfig = [...defaultAdminTools];
                saveAdminTools();
                renderAdminTools();
                renderAdminToolsList();
                showToast(currentLanguage === 'ko' ? '기본값으로 복원되었습니다' : 'Restored to defaults', 'success');
            }
        }

        // 설정 내보내기
        function exportAdminConfig() {
            const config = {
                version: '1.0',
                exportDate: new Date().toISOString(),
                tools: adminToolsConfig
            };
            
            const json = JSON.stringify(config, null, 2);
            const blob = new Blob([json], { type: 'application/json' });
            const link = document.createElement('a');
            const timestamp = new Date().toISOString().split('T')[0];
            link.download = `admin_tools_config_${timestamp}.json`;
            link.href = URL.createObjectURL(blob);
            link.click();
            
            showToast(currentLanguage === 'ko' ? '설정이 내보내졌습니다' : 'Configuration exported', 'success');
        }

        // 설정 불러오기
        function importAdminConfig(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const config = JSON.parse(e.target.result);
                    if (config.tools && Array.isArray(config.tools)) {
                        adminToolsConfig = config.tools;
                        saveAdminTools();
                        renderAdminTools();
                        showToast(currentLanguage === 'ko' ? '설정을 불러왔습니다' : 'Configuration imported', 'success');
                    } else {
                        showToast(currentLanguage === 'ko' ? '잘못된 파일 형식입니다' : 'Invalid file format', 'error');
                    }
                } catch (error) {
                    console.error('Import error:', error);
                    showToast(currentLanguage === 'ko' ? '파일을 읽을 수 없습니다' : 'Cannot read file', 'error');
                }
            };
            reader.readAsText(file);
            
            // 파일 입력 초기화
            event.target.value = '';
        }

        // 기본 설정 다운로드
        function downloadDefaultConfig() {
            const config = {
                version: '1.0',
                exportDate: new Date().toISOString(),
                tools: defaultAdminTools
            };
            
            const json = JSON.stringify(config, null, 2);
            const blob = new Blob([json], { type: 'application/json' });
            const link = document.createElement('a');
            link.download = 'default_admin_tools_config.json';
            link.href = URL.createObjectURL(blob);
            link.click();
            
            showToast(currentLanguage === 'ko' ? '기본 설정을 다운로드했습니다' : 'Default configuration downloaded', 'success');
        }

        // 페이지 로드 시 어드민 도구 초기화
        window.addEventListener('DOMContentLoaded', function() {
            initAdminTools();
        });

        // 에러 전역 처리
        window.addEventListener('error', function(event) {
            console.error('전역 에러:', event.error);
            showToast(currentLanguage === 'ko' ? '예상치 못한 오류가 발생했습니다' : 'An unexpected error occurred', 'error');
        });
    </script>

    <!-- 임시 파일 정리 스크립트 -->
    <script>
        // 개발용 임시 파일 정리
        const tempScript = document.createElement('script');
        tempScript.text = 'console.log("CEO+ Help v2.0 - 완전 개편 완료");';
        document.head.appendChild(tempScript);
    </script>
</body>
</html>