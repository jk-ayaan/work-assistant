<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CEO+ Help - 관리자 도구</title>
    <link rel="icon" type="image/jpeg" href="../favicon-32x32.jpg">
    <link rel="icon" type="image/jpeg" sizes="16x16" href="../favicon-16x16.jpg">
    <link rel="icon" type="image/jpeg" sizes="32x32" href="../favicon-32x32.jpg">
    
    <!-- TailwindCSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: {
                            50: '#fffbeb',
                            100: '#fef3c7',
                            200: '#fde68a',
                            300: '#fcd34d',
                            400: '#fbbf24',
                            500: '#f59e0b',
                            600: '#d97706',
                            700: '#b45309',
                            800: '#92400e',
                            900: '#78350f',
                        },
                        accent: {
                            50: '#fef2f2',
                            100: '#fee2e2',
                            200: '#fecaca',
                            300: '#fca5a5',
                            400: '#f87171',
                            500: '#ef4444',
                            600: '#dc2626',
                            700: '#b91c1c',
                            800: '#991b1b',
                            900: '#7f1d1d',
                        },
                        neutral: {
                            50: '#fafafa',
                            100: '#f5f5f5',
                            200: '#e5e5e5',
                            300: '#d4d4d4',
                            400: '#a3a3a3',
                            500: '#737373',
                            600: '#525252',
                            700: '#404040',
                            800: '#262626',
                            900: '#171717',
                        }
                    }
                }
            }
        }
    </script>
    
    <!-- XLSX 라이브러리 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    
    <style>
        :root {
            --header-height: 64px;
            --transition-speed: 0.3s;
        }

        /* 기본 레이아웃 */
        .app-layout {
            display: grid;
            grid-template-rows: var(--header-height) 1fr;
            grid-template-areas: 
                "header"
                "main";
            height: 100vh;
            background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%);
        }

        .header {
            grid-area: header;
            background: linear-gradient(90deg, #fbbf24 0%, #f59e0b 100%);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            z-index: 50;
        }

        .main-content {
            grid-area: main;
            overflow-y: auto;
            padding: 2rem;
        }

        /* 카드 스타일 */
        .card {
            background: white;
            border-radius: 16px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            transition: all var(--transition-speed) ease;
            border: 1px solid rgba(251, 191, 36, 0.2);
        }

        .card:hover {
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            transform: translateY(-2px);
            border-color: rgba(251, 191, 36, 0.4);
        }

        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
        }

        /* 탭 스타일 */
        .tab-button {
            position: relative;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            font-weight: 500;
            transition: all var(--transition-speed) ease;
            color: rgba(0, 0, 0, 0.7);
        }

        .tab-button:hover {
            background: rgba(255, 255, 255, 0.2);
            color: rgba(0, 0, 0, 0.9);
        }

        .tab-button.active {
            background: rgba(255, 255, 255, 0.3);
            color: #000;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .tab-button.active::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 50%;
            transform: translateX(-50%);
            width: 50%;
            height: 2px;
            background: #dc2626;
            border-radius: 1px;
        }

        /* 툴 카드 특별 스타일 */
        .tool-card {
            cursor: pointer;
            overflow: hidden;
        }

        .tool-card .icon-container {
            background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
            width: 64px;
            height: 64px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 1rem;
            box-shadow: 0 4px 8px rgba(251, 191, 36, 0.3);
        }

        .tool-card:hover .icon-container {
            transform: scale(1.05);
            box-shadow: 0 8px 16px rgba(251, 191, 36, 0.4);
        }

        /* 로딩 스피너 */
        .loading-spinner {
            border: 3px solid #fde68a;
            border-top: 3px solid #f59e0b;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* 알림 토스트 */
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            border-left: 4px solid #f59e0b;
            padding: 1rem 1.5rem;
            z-index: 1000;
            animation: slideIn 0.3s ease;
            max-width: 400px;
        }

        .toast.success {
            border-left-color: #10b981;
        }

        .toast.error {
            border-left-color: #dc2626;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        /* 탭 텍스트 반응형 처리 */
        .tab-text {
            transition: all var(--transition-speed) ease;
        }
        
        /* 중간 크기에서 텍스트 숨김 (개행되기 전) */
        @media (max-width: 1024px) {
            .tab-text {
                display: none;
            }
            
            .tab-button svg {
                margin-right: 0 !important;
            }
            
            .tab-button {
                padding: 0.5rem 0.75rem;
                min-width: 44px;
                display: flex;
                align-items: center;
                justify-content: center;
            }
        }

        /* 모바일 반응형 */
        @media (max-width: 768px) {
            .main-content {
                padding: 1rem;
            }
            
            .card-grid {
                grid-template-columns: 1fr;
                gap: 1rem;
            }
            
            .tab-container {
                overflow-x: auto;
                scrollbar-width: none;
                -ms-overflow-style: none;
                justify-content: flex-start;
            }
            
            .tab-container::-webkit-scrollbar {
                display: none;
            }
            
            .tab-text {
                display: inline; /* 모바일에서는 다시 텍스트 표시 */
            }
            
            .tab-button svg {
                margin-right: 0.5rem !important;
            }
            
            .tab-button {
                padding: 0.5rem 1rem;
                min-width: auto;
                white-space: nowrap;
            }
        }

        /* 아주 작은 모바일에서는 아이콘만 */
        @media (max-width: 480px) {
            .tab-text {
                display: none;
            }
            
            .tab-button svg {
                margin-right: 0 !important;
            }
            
            .tab-button {
                padding: 0.5rem 0.75rem;
                min-width: 44px;
            }
        }

        /* 폼 스타일 */
        .form-input {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid #e5e5e5;
            border-radius: 8px;
            transition: border-color var(--transition-speed) ease;
            background: white;
        }

        .form-input:focus {
            outline: none;
            border-color: #fbbf24;
            box-shadow: 0 0 0 3px rgba(251, 191, 36, 0.1);
        }

        .btn-primary {
            background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
            color: black;
            font-weight: 600;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            transition: all var(--transition-speed) ease;
            box-shadow: 0 2px 4px rgba(251, 191, 36, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(251, 191, 36, 0.4);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%);
            color: white;
            font-weight: 600;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            transition: all var(--transition-speed) ease;
            box-shadow: 0 2px 4px rgba(220, 38, 38, 0.3);
        }

        .btn-secondary:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(220, 38, 38, 0.4);
        }

        /* 통계 카드 */
        .stat-card {
            background: linear-gradient(135deg, white 0%, #fffbeb 100%);
            border-left: 4px solid #fbbf24;
        }

        .stat-number {
            font-size: 2rem;
            font-weight: 700;
            color: #f59e0b;
        }
    </style>
</head>

<body>
    <div class="app-layout">
        <!-- 헤더 네비게이션 -->
        <header class="header">
            <div class="flex items-center justify-between h-full px-4 lg:px-8">
                <!-- 로고 -->
                <div class="flex items-center space-x-4">
                    <img src="../logo.jpg" alt="CEO+ Help" class="w-12 h-12 rounded-lg shadow-md">
                    <div class="hidden sm:block">
                        <h1 class="text-xl font-bold text-black">CEO+</h1>
                        <p class="text-sm font-semibold text-red-600">Help</p>
                    </div>
                </div>

                <!-- 네비게이션 탭 -->
                <nav class="flex-1 mx-8">
                    <div class="tab-container flex space-x-1 justify-center">
                        <button class="tab-button active" onclick="showTab('dashboard')" id="tab-dashboard">
                            <svg class="w-5 h-5 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2-2z"></path>
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5a2 2 0 012-2h4a2 2 0 012 2v6H8V5z"></path>
                            </svg>
                            <span class="tab-text" data-ko="대시보드" data-en="Dashboard">대시보드</span>
                        </button>
                        <button class="tab-button" onclick="showTab('admin-tools')" id="tab-admin-tools">
                            <svg class="w-5 h-5 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.096 2.572-1.065z"></path>
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                            </svg>
                            <span class="tab-text" data-ko="어드민 활용" data-en="Admin Tools">어드민 활용</span>
                        </button>
                        <button class="tab-button" onclick="showTab('data-tools')" id="tab-data-tools">
                            <svg class="w-5 h-5 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                            </svg>
                            <span class="tab-text" data-ko="데이터 생성" data-en="Data Tools">데이터 생성</span>
                        </button>
                        <button class="tab-button" onclick="showTab('settings')" id="tab-settings">
                            <svg class="w-5 h-5 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 100-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 100-4m0 4v2m0-6V4"></path>
                            </svg>
                            <span class="tab-text" data-ko="설정" data-en="Settings">설정</span>
                        </button>
                    </div>
                </nav>

                <!-- 우측 유틸리티 -->
                <div class="flex items-center space-x-3">
                    <!-- 언어 선택 버튼 -->
                    <div class="relative">
                        <button class="px-3 py-1.5 rounded-lg bg-white bg-opacity-20 hover:bg-opacity-30 transition-all text-sm font-medium" onclick="toggleLanguage()">
                            <span id="current-lang" class="text-black">KOR</span>
                            <span class="text-black opacity-50 mx-1">|</span>
                            <span id="other-lang" class="text-black opacity-50">ENG</span>
                        </button>
                    </div>
                    
                    <!-- 알림 버튼 -->
                    <div class="relative">
                        <button class="p-2 rounded-lg bg-white bg-opacity-20 hover:bg-opacity-30 transition-all" onclick="showNotifications()">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18 8A6 6 0 006 8c0 7-3 9-3 9h18s-3-2-3-9z"></path>
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m13.73 21a2 2 0 01-3.46 0"></path>
                            </svg>
                        </button>
                        <span id="notification-badge" class="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center hidden">3</span>
                    </div>
                </div>
            </div>
        </header>

        <!-- 메인 콘텐츠 -->
        <main class="main-content">
            <!-- 대시보드 탭 -->
            <div id="dashboard-content" class="tab-content">
                <div class="mb-8">
                    <h2 id="dashboard-title" class="text-3xl font-bold text-neutral-800 mb-2">대시보드</h2>
                    <p id="dashboard-desc" class="text-neutral-600">CEO+ Help의 전체 현황을 확인하세요</p>
                </div>

                <!-- 통계 카드들 -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                    <div class="card stat-card p-6">
                        <div class="flex items-center justify-between">
                            <div>
                                <p id="active-sessions-label" class="text-sm font-medium text-neutral-600">활성 세션</p>
                                <p class="stat-number" id="active-sessions">12</p>
                            </div>
                            <div class="w-12 h-12 bg-primary-100 rounded-lg flex items-center justify-center">
                                <svg class="w-6 h-6 text-primary-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"></path>
                                </svg>
                            </div>
                        </div>
                    </div>

                    <div class="card stat-card p-6">
                        <div class="flex items-center justify-between">
                            <div>
                                <p id="completed-tasks-label" class="text-sm font-medium text-neutral-600">완료된 작업</p>
                                <p class="stat-number" id="completed-tasks">47</p>
                            </div>
                            <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center">
                                <svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                            </div>
                        </div>
                    </div>

                    <div class="card stat-card p-6">
                        <div class="flex items-center justify-between">
                            <div>
                                <p id="saved-tokens-label" class="text-sm font-medium text-neutral-600">저장된 토큰</p>
                                <p class="stat-number" id="token-count">8</p>
                            </div>
                            <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center">
                                <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"></path>
                                </svg>
                            </div>
                        </div>
                    </div>

                    <div class="card stat-card p-6">
                        <div class="flex items-center justify-between">
                            <div>
                                <p id="generated-files-label" class="text-sm font-medium text-neutral-600">생성된 파일</p>
                                <p class="stat-number" id="file-count">156</p>
                            </div>
                            <div class="w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center">
                                <svg class="w-6 h-6 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                                </svg>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 최근 활동 -->
                <div class="card p-6">
                    <h3 id="recent-activities-title" class="text-xl font-bold text-neutral-800 mb-4">최근 활동</h3>
                    <div id="recent-activities" class="space-y-4">
                        <div class="flex items-center space-x-4 p-3 bg-neutral-50 rounded-lg">
                            <div class="w-8 h-8 bg-primary-500 rounded-full flex items-center justify-center">
                                <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                                </svg>
                            </div>
                            <div class="flex-1">
                                <p class="font-medium text-neutral-800">QR XLSX 파일 생성</p>
                                <p class="text-sm text-neutral-600">5분 전</p>
                            </div>
                        </div>
                        
                        <div class="flex items-center space-x-4 p-3 bg-neutral-50 rounded-lg">
                            <div class="w-8 h-8 bg-green-500 rounded-full flex items-center justify-center">
                                <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                            </div>
                            <div class="flex-1">
                                <p class="font-medium text-neutral-800">토큰 동기화 완료</p>
                                <p class="text-sm text-neutral-600">12분 전</p>
                            </div>
                        </div>
                        
                        <div class="flex items-center space-x-4 p-3 bg-neutral-50 rounded-lg">
                            <div class="w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center">
                                <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                                </svg>
                            </div>
                            <div class="flex-1">
                                <p class="font-medium text-neutral-800">샘플 이미지 25개 생성</p>
                                <p class="text-sm text-neutral-600">1시간 전</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 어드민 도구 탭 -->
            <div id="admin-tools-content" class="tab-content hidden">
                <div class="mb-8">
                    <h2 id="admin-tools-title" class="text-3xl font-bold text-neutral-800 mb-2">어드민 활용</h2>
                    <p id="admin-tools-desc" class="text-neutral-600">가맹점 관리 및 시스템 운영 도구들</p>
                </div>

                <div class="card-grid">
                    <div class="card tool-card p-6" onclick="openAdminTool('qr-create')">
                        <div class="icon-container">
                            <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                            </svg>
                        </div>
                        <h3 class="text-xl font-bold text-neutral-800 mb-2">가맹점 생성 및 QR 활성화</h3>
                        <p class="text-neutral-600 mb-4">새로운 가맹점을 등록하고 QR 코드를 활성화합니다</p>
                        <div class="flex items-center text-sm text-neutral-500">
                            <span class="bg-primary-100 text-primary-800 px-2 py-1 rounded text-xs mr-2">3개 어드민</span>
                            <span>→</span>
                        </div>
                    </div>

                    <div class="card tool-card p-6" onclick="openAdminTool('qr-recovery')">
                        <div class="icon-container">
                            <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                            </svg>
                        </div>
                        <h3 class="text-xl font-bold text-neutral-800 mb-2">가맹점 QR 복구</h3>
                        <p class="text-neutral-600 mb-4">손상된 QR 코드를 복구하고 재활성화합니다</p>
                        <div class="flex items-center text-sm text-neutral-500">
                            <span class="bg-primary-100 text-primary-800 px-2 py-1 rounded text-xs mr-2">3개 어드민</span>
                            <span>→</span>
                        </div>
                    </div>

                    <div class="card tool-card p-6" onclick="openAdminTool('permission')">
                        <div class="icon-container">
                            <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path>
                            </svg>
                        </div>
                        <h3 class="text-xl font-bold text-neutral-800 mb-2">매장 권한 변경</h3>
                        <p class="text-neutral-600 mb-4">매장별 사용자 권한을 관리하고 수정합니다</p>
                        <div class="flex items-center text-sm text-neutral-500">
                            <span class="bg-primary-100 text-primary-800 px-2 py-1 rounded text-xs mr-2">3개 어드민</span>
                            <span>→</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 데이터 생성 도구 탭 -->
            <div id="data-tools-content" class="tab-content hidden">
                <div class="mb-8">
                    <h2 id="data-tools-title" class="text-3xl font-bold text-neutral-800 mb-2">데이터 생성 도구</h2>
                    <p id="data-tools-desc" class="text-neutral-600">테스트 데이터 및 샘플 파일 생성 도구들</p>
                </div>

                <div class="card-grid">
                    <div class="card tool-card p-6" onclick="openDataTool('sample-image')">
                        <div class="icon-container">
                            <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                            </svg>
                        </div>
                        <h3 class="text-xl font-bold text-neutral-800 mb-2">샘플 이미지 생성기</h3>
                        <p class="text-neutral-600 mb-4">다양한 크기와 포맷의 테스트 이미지를 생성합니다</p>
                        <div class="flex items-center text-sm text-neutral-500">
                            <span class="bg-purple-100 text-purple-800 px-2 py-1 rounded text-xs mr-2">이미지 도구</span>
                            <span>→</span>
                        </div>
                    </div>

                    <div class="card tool-card p-6" onclick="openDataTool('qr-xlsx')">
                        <div class="icon-container">
                            <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                            </svg>
                        </div>
                        <h3 class="text-xl font-bold text-neutral-800 mb-2">QR XLSX 생성기</h3>
                        <p class="text-neutral-600 mb-4">QR 코드 정보가 포함된 엑셀 파일을 생성합니다</p>
                        <div class="flex items-center text-sm text-neutral-500">
                            <span class="bg-green-100 text-green-800 px-2 py-1 rounded text-xs mr-2">엑셀 도구</span>
                            <span>→</span>
                        </div>
                    </div>

                    <div class="card tool-card p-6" onclick="openDataTool('csv-generator')">
                        <div class="icon-container">
                            <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                            </svg>
                        </div>
                        <h3 class="text-xl font-bold text-neutral-800 mb-2">CSV 생성기</h3>
                        <p class="text-neutral-600 mb-4">커스텀 CSV 파일을 생성하고 다운로드합니다</p>
                        <div class="flex items-center text-sm text-neutral-500">
                            <span class="bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs mr-2">데이터 도구</span>
                            <span>→</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 설정 탭 -->
            <div id="settings-content" class="tab-content hidden">
                <div class="mb-8">
                    <h2 id="settings-title" class="text-3xl font-bold text-neutral-800 mb-2">설정</h2>
                    <p id="settings-desc" class="text-neutral-600">시스템 설정 및 토큰 관리</p>
                </div>

                <div class="space-y-6">
                    <!-- 토큰 관리 카드 -->
                    <div class="card p-6">
                        <h3 id="token-management-title" class="text-xl font-bold text-neutral-800 mb-4">토큰 관리</h3>
                        <div class="space-y-4">
                            <div class="flex items-center justify-between p-4 bg-neutral-50 rounded-lg">
                                <div>
                                    <p class="font-medium text-neutral-800">토큰 상태</p>
                                    <p class="text-sm text-neutral-600" id="token-status-detail">토큰 확인 중...</p>
                                </div>
                                <button class="btn-primary" onclick="syncTokens()">
                                    🔄 토큰 동기화
                                </button>
                            </div>
                            <div class="flex space-x-4">
                                <button class="btn-secondary" onclick="showCookieModal()">
                                    🍪 쿠키 관리
                                </button>
                                <button class="btn-primary" onclick="exportTokens()">
                                    📤 토큰 내보내기
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- 시스템 설정 카드 -->
                    <div class="card p-6">
                        <h3 id="system-settings-title" class="text-xl font-bold text-neutral-800 mb-4">시스템 설정</h3>
                        <div class="space-y-4">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="font-medium text-neutral-800">다크 모드</p>
                                    <p class="text-sm text-neutral-600">인터페이스 테마 변경</p>
                                </div>
                                <label class="relative inline-flex items-center cursor-pointer">
                                    <input type="checkbox" class="sr-only peer" id="dark-mode-toggle">
                                    <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-primary-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-primary-600"></div>
                                </label>
                            </div>
                            
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="font-medium text-neutral-800">자동 저장</p>
                                    <p class="text-sm text-neutral-600">작업 내용 자동 저장</p>
                                </div>
                                <label class="relative inline-flex items-center cursor-pointer">
                                    <input type="checkbox" class="sr-only peer" id="auto-save-toggle" checked>
                                    <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-primary-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-primary-600"></div>
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- 정보 카드 -->
                    <div class="card p-6">
                        <h3 id="system-info-title" class="text-xl font-bold text-neutral-800 mb-4">시스템 정보</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="p-4 bg-neutral-50 rounded-lg">
                                <p class="text-sm font-medium text-neutral-600">버전</p>
                                <p class="text-lg font-bold text-neutral-800">v2.1.0</p>
                            </div>
                            <div class="p-4 bg-neutral-50 rounded-lg">
                                <p class="text-sm font-medium text-neutral-600">마지막 업데이트</p>
                                <p class="text-lg font-bold text-neutral-800">2024-08-15</p>
                            </div>
                            <div class="p-4 bg-neutral-50 rounded-lg">
                                <p class="text-sm font-medium text-neutral-600">총 사용자</p>
                                <p class="text-lg font-bold text-neutral-800">247명</p>
                            </div>
                            <div class="p-4 bg-neutral-50 rounded-lg">
                                <p class="text-sm font-medium text-neutral-600">업타임</p>
                                <p class="text-lg font-bold text-neutral-800">99.9%</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- 쿠키 관리 모달 -->
    <div id="cookie-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50">
        <div class="bg-white rounded-2xl p-8 max-w-2xl w-full m-4 max-h-[80vh] overflow-y-auto">
            <h3 class="text-2xl font-bold text-neutral-800 mb-6">🍪 쿠키 관리</h3>
            <div class="mb-6">
                <h4 class="font-medium text-neutral-700 mb-3">현재 저장된 쿠키:</h4>
                <div id="cookie-list" class="bg-neutral-100 p-4 rounded-lg text-sm font-mono max-h-40 overflow-y-auto">
                    로딩중...
                </div>
            </div>
            <div class="mb-6">
                <h4 class="font-medium text-neutral-700 mb-3">쿠키 추가/수정:</h4>
                <input id="cookie-input" type="text"
                       placeholder="name=value; domain=.example.com; path=/"
                       class="form-input mb-3">
                <button onclick="addCookie()" class="btn-primary">
                    쿠키 추가
                </button>
            </div>
            <button onclick="closeCookieModal()" class="w-full p-3 bg-neutral-300 text-neutral-700 rounded-lg hover:bg-neutral-400 transition-colors">
                닫기
            </button>
        </div>
    </div>

    <!-- 도구 상세 모달 -->
    <div id="tool-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50">
        <div class="bg-white rounded-2xl max-w-4xl w-full m-4 max-h-[90vh] overflow-hidden">
            <div class="p-6 border-b border-neutral-200 flex items-center justify-between">
                <h3 id="tool-modal-title" class="text-2xl font-bold text-neutral-800">도구</h3>
                <button onclick="closeToolModal()" class="p-2 hover:bg-neutral-100 rounded-lg transition-colors">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            <div id="tool-modal-content" class="p-6 overflow-y-auto" style="max-height: calc(90vh - 100px);">
                <!-- 도구별 콘텐츠가 여기에 로드됩니다 -->
            </div>
        </div>
    </div>

    <script>
        // 전역 변수
        let currentTab = 'dashboard';
        let windowRefs = {};
        let currentLanguage = 'ko'; // 기본 언어는 한국어
        let notificationHistory = []; // 알림 히스토리
        let maxNotifications = 50; // 최대 알림 보관 개수

        // 다국어 텍스트 데이터
        const translations = {
            ko: {
                // 헤더 및 네비게이션
                dashboard: "대시보드",
                adminTools: "어드민 활용",
                dataTools: "데이터 생성", 
                settings: "설정",
                
                // 대시보드
                dashboardTitle: "대시보드",
                dashboardDesc: "CEO+ Help의 전체 현황을 확인하세요",
                activeSessions: "활성 세션",
                completedTasks: "완료된 작업",
                savedTokens: "저장된 토큰",
                generatedFiles: "생성된 파일",
                recentActivities: "최근 활동",
                
                // 어드민 도구
                adminToolsTitle: "어드민 활용",
                adminToolsDesc: "가맹점 관리 및 시스템 운영 도구들",
                
                // 데이터 생성 도구
                dataToolsTitle: "데이터 생성 도구",
                dataToolsDesc: "테스트 데이터 및 샘플 파일 생성 도구들",
                
                // 설정
                settingsTitle: "설정",
                settingsDesc: "시스템 설정 및 토큰 관리",
                tokenManagement: "토큰 관리",
                systemSettings: "시스템 설정",
                systemInfo: "시스템 정보",
                
                // 알림 및 활동
                notifications: "알림",
                noNotifications: "새로운 알림이 없습니다",
                clearNotifications: "모든 알림 지우기",
                requestStarted: "요청 시작됨",
                requestCompleted: "요청 완료됨",
                requestFailed: "요청 실패",
                
                // 요청 타입
                adminToolRequest: "어드민 도구 실행",
                dataGenerationRequest: "데이터 생성",
                tokenSyncRequest: "토큰 동기화",
                cookieManagementRequest: "쿠키 관리",
                languageChangeRequest: "언어 변경",
                
                // 시간 표시
                justNow: "방금 전",
                minutesAgo: "분 전",
                hoursAgo: "시간 전",
                daysAgo: "일 전"
            },
            en: {
                // 헤더 및 네비게이션
                dashboard: "Dashboard",
                adminTools: "Admin Tools",
                dataTools: "Data Tools",
                settings: "Settings",
                
                // 대시보드
                dashboardTitle: "Dashboard",
                dashboardDesc: "Check the overall status of CEO+ Help",
                activeSessions: "Active Sessions",
                completedTasks: "Completed Tasks", 
                savedTokens: "Saved Tokens",
                generatedFiles: "Generated Files",
                recentActivities: "Recent Activities",
                
                // 어드민 도구
                adminToolsTitle: "Admin Tools",
                adminToolsDesc: "Store management and system operation tools",
                
                // 데이터 생성 도구
                dataToolsTitle: "Data Generation Tools",
                dataToolsDesc: "Test data and sample file generation tools",
                
                // 설정
                settingsTitle: "Settings",
                settingsDesc: "System settings and token management",
                tokenManagement: "Token Management",
                systemSettings: "System Settings", 
                systemInfo: "System Information",
                
                // 알림 및 활동
                notifications: "Notifications",
                noNotifications: "No new notifications",
                clearNotifications: "Clear all notifications",
                requestStarted: "Request started",
                requestCompleted: "Request completed",
                requestFailed: "Request failed",
                
                // 요청 타입
                adminToolRequest: "Admin tool execution",
                dataGenerationRequest: "Data generation",
                tokenSyncRequest: "Token synchronization",
                cookieManagementRequest: "Cookie management",
                languageChangeRequest: "Language change",
                
                // 시간 표시
                justNow: "Just now",
                minutesAgo: "min ago",
                hoursAgo: "hr ago",
                daysAgo: "day ago"
            }
        };
        
        // 기존 기능 데이터
        const functionData = {
            'qr-create': {
                name: '가맹점 생성 및 QR 활성화',
                admins: [
                    { name: '와칸다_신청서', url: 'https://www.google.com', desc: '가맹점 신청서 작성', isInternal: false },
                    { name: '와칸다_활성화', url: 'https://www.naver.com', desc: '가맹점 활성화 처리', isInternal: false },
                    { name: '오프라인_QR생성요청', url: 'https://admin.example.com/qr', desc: '오프라인 QR 생성', isInternal: true }
                ]
            },
            'qr-recovery': {
                name: '가맹점 QR 복구',
                admins: [
                    { name: 'QR 관리', url: 'https://admin.example.com/qr-manage', desc: 'QR 복구', isInternal: true },
                    { name: '로그 관리', url: 'https://admin.example.com/logs', desc: '로그 확인', isInternal: true },
                    { name: '가맹점 관리', url: 'https://www.kakao.com', desc: '상태 확인', isInternal: false }
                ]
            },
            'permission': {
                name: '매장 권한변경',
                admins: [
                    { name: '권한 관리', url: 'https://admin.example.com/permissions', desc: '권한 설정', isInternal: true },
                    { name: '사용자 관리', url: 'https://admin.example.com/users', desc: '역할 관리', isInternal: true },
                    { name: '감사 관리', url: 'https://www.youtube.com', desc: '변경 이력', isInternal: false }
                ]
            }
        };

        // 탭 전환 함수
        function showTab(tabName) {
            // 모든 탭 버튼 비활성화
            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // 모든 탭 콘텐츠 숨기기
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.add('hidden');
            });
            
            // 선택된 탭 활성화
            document.getElementById(`tab-${tabName}`).classList.add('active');
            document.getElementById(`${tabName}-content`).classList.remove('hidden');
            
            currentTab = tabName;
            
            // 탭 변경 시 추가 로직
            if (tabName === 'dashboard') {
                updateDashboardStats();
            }
        }

        // 대시보드 통계 업데이트
        function updateDashboardStats() {
            // 실제 데이터로 업데이트하는 로직을 여기에 구현
            document.getElementById('active-sessions').textContent = Math.floor(Math.random() * 20) + 5;
            
            // 완료된 작업 수는 성공한 알림 개수 반영
            const completedTasks = notificationHistory.filter(n => n.status === 'completed').length;
            document.getElementById('completed-tasks').textContent = completedTasks + Math.floor(Math.random() * 20) + 20;
            
            document.getElementById('token-count').textContent = Math.floor(Math.random() * 15) + 3;
            
            // 생성된 파일 수는 데이터 생성 완료 알림 개수 반영  
            const generatedFiles = notificationHistory.filter(n => n.type === 'data-generation' && n.status === 'completed').length;
            document.getElementById('file-count').textContent = generatedFiles + Math.floor(Math.random() * 100) + 50;
        }

        // 최근 활동 업데이트 (알림 히스토리 기반)
        function updateRecentActivities() {
            const container = document.getElementById('recent-activities');
            if (!container) return;
            
            const recentNotifications = notificationHistory.slice(0, 3); // 최근 3개만
            
            if (recentNotifications.length === 0) {
                container.innerHTML = `
                    <div class="text-center text-neutral-500 py-8">
                        <svg class="w-12 h-12 mx-auto mb-3 text-neutral-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path>
                        </svg>
                        <p class="text-sm">${currentLanguage === 'ko' ? '최근 활동이 없습니다' : 'No recent activities'}</p>
                    </div>
                `;
                return;
            }
            
            let activitiesHTML = '';
            recentNotifications.forEach(notification => {
                const timeAgo = getTimeAgo(notification.timestamp);
                const statusColor = getStatusColor(notification.status).replace('bg-', '').replace('-100', '-500');
                const typeIcon = getTypeIcon(notification.type);
                
                activitiesHTML += `
                    <div class="flex items-center space-x-4 p-3 bg-neutral-50 rounded-lg">
                        <div class="w-8 h-8 bg-${statusColor} rounded-full flex items-center justify-center">
                            ${typeIcon}
                        </div>
                        <div class="flex-1">
                            <p class="font-medium text-neutral-800">
                                ${getActionDisplayName(notification.type, notification.action)}
                            </p>
                            <p class="text-sm text-neutral-600">${timeAgo}</p>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = activitiesHTML;
        }

        // 어드민 도구 열기
        function openAdminTool(toolId) {
            const toolData = functionData[toolId];
            if (!toolData) return;
            
            document.getElementById('tool-modal-title').textContent = toolData.name;
            
            let adminListHTML = '<div class="space-y-4">';
            toolData.admins.forEach((admin, index) => {
                adminListHTML += `
                    <div class="card p-4 cursor-pointer hover:shadow-lg transition-all" onclick="openAdminUrl('${admin.url}', '${admin.name}', ${admin.isInternal})">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center space-x-4">
                                <div class="w-10 h-10 bg-primary-100 rounded-lg flex items-center justify-center">
                                    <span class="font-bold text-primary-600">${index + 1}</span>
                                </div>
                                <div>
                                    <h4 class="font-medium text-neutral-800">${admin.name}</h4>
                                    <p class="text-sm text-neutral-600">${admin.desc}</p>
                                    <p class="text-xs text-neutral-400 mt-1">${admin.url}</p>
                                </div>
                            </div>
                            <div class="flex items-center space-x-2">
                                ${admin.isInternal ? '<span class="bg-yellow-100 text-yellow-800 text-xs px-2 py-1 rounded">내부</span>' : '<span class="bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded">외부</span>'}
                                <svg class="w-5 h-5 text-neutral-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                                </svg>
                            </div>
                        </div>
                    </div>
                `;
            });
            adminListHTML += '</div>';
            
            document.getElementById('tool-modal-content').innerHTML = adminListHTML;
            document.getElementById('tool-modal').classList.remove('hidden');
        }

        // 어드민 URL 열기
        function openAdminUrl(url, name, isInternal) {
            try {
                // 알림 추가 - 시작
                addNotification('admin-tool', name, 'started', `URL: ${url}`);
                
                if (isInternal) {
                    // 내부 도구는 iframe으로 열기
                    showToast(`${name} 도구를 새 창에서 엽니다`, 'success');
                }
                
                const windowName = 'admin_' + name.replace(/\s/g, '_');
                const win = window.open(url, windowName, 'width=1200,height=800,menubar=yes,toolbar=yes,location=yes,status=yes,scrollbars=yes,resizable=yes');
                
                if (win) {
                    windowRefs[windowName] = win;
                    
                    // 알림 추가 - 완료
                    addNotification('admin-tool', name, 'completed', `새 창에서 열림`);
                    showToast(`${name}이(가) 새 창에서 열렸습니다`, 'success');
                } else {
                    // 알림 추가 - 실패
                    addNotification('admin-tool', name, 'failed', '팝업 차단됨');
                    showToast('팝업이 차단되었습니다. 팝업 허용 후 다시 시도하세요', 'error');
                }
            } catch (error) {
                console.error('어드민 도구 실행 오류:', error);
                addNotification('admin-tool', name, 'failed', error.message);
                showToast('도구 실행 중 오류가 발생했습니다', 'error');
            }
        }

        // 데이터 도구 열기
        function openDataTool(toolId) {
            let title, content;
            
            switch(toolId) {
                case 'sample-image':
                    title = '샘플 이미지 생성기';
                    content = getSampleImageGeneratorHTML();
                    break;
                case 'qr-xlsx':
                    title = 'QR XLSX 생성기';
                    content = getQRXlsxGeneratorHTML();
                    break;
                case 'csv-generator':
                    title = 'CSV 생성기';
                    content = getCsvGeneratorHTML();
                    break;
                default:
                    title = '도구';
                    content = '<p class="text-center text-neutral-500">도구를 찾을 수 없습니다.</p>';
            }
            
            document.getElementById('tool-modal-title').textContent = title;
            document.getElementById('tool-modal-content').innerHTML = content;
            document.getElementById('tool-modal').classList.remove('hidden');
            
            // 샘플 이미지 생성기인 경우 초기 이미지 생성
            if (toolId === 'sample-image') {
                setTimeout(generateSampleImage, 100);
            }
        }

        // 모달 닫기
        function closeToolModal() {
            document.getElementById('tool-modal').classList.add('hidden');
        }

        // 토스트 메시지 표시
        function showToast(message, type = 'success') {
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.innerHTML = `
                <div class="flex items-center">
                    <div class="flex-1">
                        <p class="font-medium text-neutral-800">${message}</p>
                    </div>
                    <button onclick="this.parentElement.parentElement.remove()" class="ml-4 text-neutral-400 hover:text-neutral-600">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
            `;
            
            document.body.appendChild(toast);
            
            setTimeout(() => {
                if (toast.parentNode) {
                    toast.remove();
                }
            }, 5000);
        }

        // 언어 변경 함수
        function toggleLanguage() {
            try {
                const previousLang = currentLanguage;
                const newLang = currentLanguage === 'ko' ? 'en' : 'ko';
                
                // 알림 추가 - 시작
                addNotification('language-change', `${previousLang.toUpperCase()} → ${newLang.toUpperCase()}`, 'started');
                
                currentLanguage = newLang;
                updateLanguageUI();
                updateAllTexts();
                
                // localStorage에 언어 설정 저장
                localStorage.setItem('preferred-language', currentLanguage);
                
                // 알림 추가 - 완료
                addNotification('language-change', `${previousLang.toUpperCase()} → ${newLang.toUpperCase()}`, 'completed');
                
                const langText = currentLanguage === 'ko' ? '한국어' : 'English';
                showToast(`언어가 ${langText}로 변경되었습니다`, 'success');
            } catch (error) {
                console.error('언어 변경 오류:', error);
                addNotification('language-change', 'Language toggle', 'failed', error.message);
                showToast('언어 변경 중 오류가 발생했습니다', 'error');
            }
        }

        // 언어 선택 UI 업데이트
        function updateLanguageUI() {
            const currentLangEl = document.getElementById('current-lang');
            const otherLangEl = document.getElementById('other-lang');
            
            if (currentLanguage === 'ko') {
                currentLangEl.textContent = 'KOR';
                currentLangEl.className = 'text-black';
                otherLangEl.textContent = 'ENG';
                otherLangEl.className = 'text-black opacity-50';
            } else {
                currentLangEl.textContent = 'ENG';
                currentLangEl.className = 'text-black';
                otherLangEl.textContent = 'KOR';
                otherLangEl.className = 'text-black opacity-50';
            }
        }

        // 모든 텍스트 업데이트
        function updateAllTexts() {
            const t = translations[currentLanguage];
            
            // 탭 텍스트 업데이트
            document.querySelectorAll('.tab-text').forEach(el => {
                const key = currentLanguage === 'ko' ? el.getAttribute('data-ko') : el.getAttribute('data-en');
                if (key) el.textContent = key;
            });
            
            // 페이지 제목들 업데이트
            updateElementText('dashboard-title', t.dashboardTitle);
            updateElementText('dashboard-desc', t.dashboardDesc);
            updateElementText('admin-tools-title', t.adminToolsTitle);  
            updateElementText('admin-tools-desc', t.adminToolsDesc);
            updateElementText('data-tools-title', t.dataToolsTitle);
            updateElementText('data-tools-desc', t.dataToolsDesc);
            updateElementText('settings-title', t.settingsTitle);
            updateElementText('settings-desc', t.settingsDesc);
            
            // 통계 카드 텍스트 업데이트
            updateElementText('active-sessions-label', t.activeSessions);
            updateElementText('completed-tasks-label', t.completedTasks);
            updateElementText('saved-tokens-label', t.savedTokens);
            updateElementText('generated-files-label', t.generatedFiles);
            updateElementText('recent-activities-title', t.recentActivities);
            
            // 설정 섹션 텍스트 업데이트
            updateElementText('token-management-title', t.tokenManagement);
            updateElementText('system-settings-title', t.systemSettings);
            updateElementText('system-info-title', t.systemInfo);
        }

        // 개별 요소 텍스트 업데이트 헬퍼 함수
        function updateElementText(id, text) {
            const element = document.getElementById(id);
            if (element) {
                element.textContent = text;
            }
        }

        // 알림 히스토리에 항목 추가
        function addNotification(type, action, status, details = null) {
            const notification = {
                id: Date.now() + Math.random(),
                type: type, // 'admin-tool', 'data-generation', 'token-sync', 'cookie-management', 'language-change'
                action: action, // 구체적인 액션명
                status: status, // 'started', 'completed', 'failed'
                details: details, // 추가 정보
                timestamp: new Date(),
                read: false
            };
            
            notificationHistory.unshift(notification);
            
            // 최대 개수 초과 시 오래된 알림 제거
            if (notificationHistory.length > maxNotifications) {
                notificationHistory = notificationHistory.slice(0, maxNotifications);
            }
            
            // localStorage에 저장
            localStorage.setItem('notificationHistory', JSON.stringify(notificationHistory));
            
            // 알림 배지 업데이트
            updateNotificationBadge();
            
            // 대시보드가 활성화되어 있으면 실시간 업데이트
            if (currentTab === 'dashboard') {
                updateRecentActivities();
            }
        }

        // 알림 배지 업데이트
        function updateNotificationBadge() {
            const badge = document.getElementById('notification-badge');
            const unreadCount = notificationHistory.filter(n => !n.read).length;
            
            if (unreadCount > 0) {
                badge.textContent = unreadCount > 99 ? '99+' : unreadCount;
                badge.classList.remove('hidden');
            } else {
                badge.classList.add('hidden');
            }
        }

        // 알림 목록 표시
        function showNotifications() {
            const t = translations[currentLanguage];
            
            // 모든 알림을 읽음으로 표시
            notificationHistory.forEach(n => n.read = true);
            localStorage.setItem('notificationHistory', JSON.stringify(notificationHistory));
            updateNotificationBadge();
            
            let notificationHTML = `
                <div class="fixed inset-0 bg-black bg-opacity-50 flex items-start justify-end z-50 pt-16 pr-4" onclick="closeNotifications()">
                    <div class="bg-white rounded-2xl w-96 max-h-96 overflow-hidden shadow-2xl" onclick="event.stopPropagation()">
                        <div class="p-4 border-b border-neutral-200 flex items-center justify-between">
                            <h3 class="text-lg font-bold text-neutral-800">${t.notifications}</h3>
                            <div class="flex items-center space-x-2">
                                <button onclick="clearAllNotifications()" class="text-xs px-3 py-1 bg-neutral-100 hover:bg-neutral-200 rounded-md text-neutral-600 transition-colors">
                                    ${t.clearNotifications}
                                </button>
                                <button onclick="closeNotifications()" class="p-1 hover:bg-neutral-100 rounded transition-colors">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                    </svg>
                                </button>
                            </div>
                        </div>
                        <div class="overflow-y-auto max-h-80">
            `;
            
            if (notificationHistory.length === 0) {
                notificationHTML += `
                    <div class="p-8 text-center text-neutral-500">
                        <svg class="w-12 h-12 mx-auto mb-3 text-neutral-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18 8A6 6 0 006 8c0 7-3 9-3 9h18s-3-2-3-9z"></path>
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m13.73 21a2 2 0 01-3.46 0"></path>
                        </svg>
                        <p>${t.noNotifications}</p>
                    </div>
                `;
            } else {
                notificationHistory.forEach(notification => {
                    const timeAgo = getTimeAgo(notification.timestamp);
                    const statusColor = getStatusColor(notification.status);
                    const statusIcon = getStatusIcon(notification.status);
                    const typeIcon = getTypeIcon(notification.type);
                    
                    notificationHTML += `
                        <div class="p-4 border-b border-neutral-100 hover:bg-neutral-50 transition-colors">
                            <div class="flex items-start space-x-3">
                                <div class="w-8 h-8 ${statusColor} rounded-full flex items-center justify-center flex-shrink-0">
                                    ${typeIcon}
                                </div>
                                <div class="flex-1 min-w-0">
                                    <p class="font-medium text-neutral-800 text-sm">
                                        ${getActionDisplayName(notification.type, notification.action)}
                                    </p>
                                    <div class="flex items-center space-x-2 mt-1">
                                        <span class="text-xs ${statusColor.replace('bg-', 'text-').replace('-100', '-600')} font-medium">
                                            ${statusIcon} ${getStatusDisplayName(notification.status)}
                                        </span>
                                        <span class="text-xs text-neutral-500">${timeAgo}</span>
                                    </div>
                                    ${notification.details ? `<p class="text-xs text-neutral-500 mt-1">${notification.details}</p>` : ''}
                                </div>
                            </div>
                        </div>
                    `;
                });
            }
            
            notificationHTML += `
                        </div>
                    </div>
                </div>
            `;
            
            // 알림 패널 표시
            const existingPanel = document.getElementById('notification-panel');
            if (existingPanel) {
                existingPanel.remove();
            }
            
            const panel = document.createElement('div');
            panel.id = 'notification-panel';
            panel.innerHTML = notificationHTML;
            document.body.appendChild(panel);
        }

        // 알림 패널 닫기
        function closeNotifications() {
            const panel = document.getElementById('notification-panel');
            if (panel) {
                panel.remove();
            }
        }

        // 모든 알림 지우기
        function clearAllNotifications() {
            if (confirm(currentLanguage === 'ko' ? '모든 알림을 삭제하시겠습니까?' : 'Are you sure you want to clear all notifications?')) {
                notificationHistory = [];
                localStorage.removeItem('notificationHistory');
                updateNotificationBadge();
                closeNotifications();
                updateRecentActivities();
                showToast(currentLanguage === 'ko' ? '모든 알림이 삭제되었습니다' : 'All notifications cleared', 'success');
            }
        }

        // 시간 표시 함수
        function getTimeAgo(timestamp) {
            const t = translations[currentLanguage];
            const now = new Date();
            const diffMs = now - new Date(timestamp);
            const diffMinutes = Math.floor(diffMs / (1000 * 60));
            const diffHours = Math.floor(diffMs / (1000 * 60 * 60));
            const diffDays = Math.floor(diffMs / (1000 * 60 * 60 * 24));
            
            if (diffMinutes < 1) return t.justNow;
            if (diffMinutes < 60) return `${diffMinutes}${t.minutesAgo}`;
            if (diffHours < 24) return `${diffHours}${t.hoursAgo}`;
            return `${diffDays}${t.daysAgo}`;
        }

        // 상태별 색상 반환
        function getStatusColor(status) {
            switch (status) {
                case 'started': return 'bg-blue-100';
                case 'completed': return 'bg-green-100';
                case 'failed': return 'bg-red-100';
                default: return 'bg-neutral-100';
            }
        }

        // 상태별 아이콘 반환
        function getStatusIcon(status) {
            switch (status) {
                case 'started': return '⏳';
                case 'completed': return '✅';
                case 'failed': return '❌';
                default: return 'ℹ️';
            }
        }

        // 타입별 아이콘 반환
        function getTypeIcon(type) {
            switch (type) {
                case 'admin-tool': return '<svg class="w-4 h-4 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.096 2.572-1.065z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>';
                case 'data-generation': return '<svg class="w-4 h-4 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>';
                case 'token-sync': return '<svg class="w-4 h-4 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1721 9z"></path></svg>';
                case 'cookie-management': return '<svg class="w-4 h-4 text-orange-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 100-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 100-4m0 4v2m0-6V4"></path></svg>';
                case 'language-change': return '<svg class="w-4 h-4 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5h12M9 3v2m1.048 9.5A18.022 18.022 0 016.412 9m6.088 9h7M11 21l5-10 5 10M12.751 5C11.783 10.77 8.07 15.61 3 18.129"></path></svg>';
                default: return '<svg class="w-4 h-4 text-neutral-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>';
            }
        }

        // 액션명 표시 함수
        function getActionDisplayName(type, action) {
            const t = translations[currentLanguage];
            
            // 타입별 기본 이름
            let baseName = '';
            switch (type) {
                case 'admin-tool': baseName = t.adminToolRequest; break;
                case 'data-generation': baseName = t.dataGenerationRequest; break;
                case 'token-sync': baseName = t.tokenSyncRequest; break;
                case 'cookie-management': baseName = t.cookieManagementRequest; break;
                case 'language-change': baseName = t.languageChangeRequest; break;
                default: baseName = action;
            }
            
            // 구체적인 액션명이 있으면 조합
            if (action && action !== type) {
                return `${baseName}: ${action}`;
            }
            
            return baseName;
        }

        // 상태명 표시 함수
        function getStatusDisplayName(status) {
            const t = translations[currentLanguage];
            switch (status) {
                case 'started': return t.requestStarted;
                case 'completed': return t.requestCompleted;
                case 'failed': return t.requestFailed;
                default: return status;
            }
        }

        // 토큰 관리 함수들
        function getStoredTokens() {
            const tokens = { localStorage: {}, sessionStorage: {}, cookies: {} };
            
            try {
                for (let i = 0; i < localStorage.length; i++) {
                    const key = localStorage.key(i);
                    if (key && (key.includes('token') || key.includes('auth') || key.includes('session'))) {
                        tokens.localStorage[key] = localStorage.getItem(key);
                    }
                }
                
                for (let i = 0; i < sessionStorage.length; i++) {
                    const key = sessionStorage.key(i);
                    if (key && (key.includes('token') || key.includes('auth') || key.includes('session'))) {
                        tokens.sessionStorage[key] = sessionStorage.getItem(key);
                    }
                }
                
                const cookies = getAllCookies();
                Object.entries(cookies).forEach(([name, value]) => {
                    if (name.includes('token') || name.includes('auth') || name.includes('session')) {
                        tokens.cookies[name] = value;
                    }
                });
            } catch (error) {
                console.error('토큰 조회 오류:', error);
            }
            
            return tokens;
        }

        function getAllCookies() {
            const cookies = {};
            document.cookie.split(';').forEach(cookie => {
                const [name, value] = cookie.trim().split('=');
                if (name) cookies[name] = value || '';
            });
            return cookies;
        }

        function syncTokens() {
            try {
                // 알림 추가 - 시작
                addNotification('token-sync', '토큰 동기화', 'started');
                
                const tokens = getStoredTokens();
                console.log('동기화할 토큰:', tokens);
                
                let syncedWindows = 0;
                Object.values(windowRefs).forEach(win => {
                    if (win && !win.closed) {
                        try {
                            win.postMessage({ type: 'SYNC_TOKENS', tokens: tokens }, '*');
                            syncedWindows++;
                        } catch (e) {
                            console.log('토큰 전송 실패:', e);
                        }
                    }
                });
                
                // 알림 추가 - 완료
                addNotification('token-sync', '토큰 동기화', 'completed', `${syncedWindows}개 창에 동기화`);
                showToast('토큰 동기화를 시도했습니다', 'success');
                updateTokenStatus();
            } catch (error) {
                console.error('토큰 동기화 오류:', error);
                addNotification('token-sync', '토큰 동기화', 'failed', error.message);
                showToast('토큰 동기화 중 오류가 발생했습니다', 'error');
            }
        }

        function updateTokenStatus() {
            try {
                const tokens = getStoredTokens();
                const totalCount = Object.keys(tokens.localStorage).length + Object.keys(tokens.sessionStorage).length + Object.keys(tokens.cookies).length;
                
                const statusEl = document.getElementById('token-status-detail');
                if (statusEl) {
                    if (totalCount > 0) {
                        statusEl.innerHTML = `✅ 토큰 ${totalCount}개 발견 (Local: ${Object.keys(tokens.localStorage).length}, Session: ${Object.keys(tokens.sessionStorage).length}, Cookie: ${Object.keys(tokens.cookies).length})`;
                    } else {
                        statusEl.innerHTML = '❌ 토큰 없음';
                    }
                }
                
                // 대시보드 토큰 카운트 업데이트
                const tokenCountEl = document.getElementById('token-count');
                if (tokenCountEl) {
                    tokenCountEl.textContent = totalCount;
                }
            } catch (error) {
                console.error('토큰 상태 업데이트 오류:', error);
                const statusEl = document.getElementById('token-status-detail');
                if (statusEl) {
                    statusEl.innerHTML = '❌ 오류 발생';
                }
            }
        }

        function exportTokens() {
            try {
                const tokens = getStoredTokens();
                const dataStr = JSON.stringify(tokens, null, 2);
                const dataBlob = new Blob([dataStr], {type: 'application/json'});
                
                const link = document.createElement('a');
                link.href = URL.createObjectURL(dataBlob);
                link.download = `tokens_${new Date().toISOString().split('T')[0]}.json`;
                link.click();
                
                showToast('토큰 정보가 다운로드되었습니다', 'success');
            } catch (error) {
                console.error('토큰 내보내기 오류:', error);
                showToast('토큰 내보내기 중 오류가 발생했습니다', 'error');
            }
        }

        // 쿠키 관리 함수들
        function showCookieModal() {
            document.getElementById('cookie-modal').classList.remove('hidden');
            updateCookieList();
        }

        function closeCookieModal() {
            document.getElementById('cookie-modal').classList.add('hidden');
        }

        function updateCookieList() {
            const cookies = getAllCookies();
            const cookieList = document.getElementById('cookie-list');
            
            if (Object.keys(cookies).length === 0) {
                cookieList.textContent = '쿠키가 없습니다.';
            } else {
                cookieList.innerHTML = Object.entries(cookies)
                    .map(([name, value]) => `<div class="mb-1"><strong>${name}</strong> = ${value}</div>`)
                    .join('');
            }
        }

        function addCookie() {
            const input = document.getElementById('cookie-input').value.trim();
            if (!input) {
                showToast('쿠키 정보를 입력해주세요', 'error');
                return;
            }
            
            try {
                // 알림 추가 - 시작
                addNotification('cookie-management', '쿠키 추가', 'started', input);
                
                const parts = input.split(';').map(p => p.trim());
                const [name, value] = parts[0].split('=');
                
                if (!name) {
                    addNotification('cookie-management', '쿠키 추가', 'failed', '쿠키 이름이 필요합니다');
                    showToast('쿠키 이름이 필요합니다', 'error');
                    return;
                }
                
                document.cookie = input;
                updateCookieList();
                document.getElementById('cookie-input').value = '';
                
                // 알림 추가 - 완료
                addNotification('cookie-management', '쿠키 추가', 'completed', `${name} 쿠키 추가됨`);
                showToast('쿠키가 추가되었습니다', 'success');
            } catch (e) {
                console.error('쿠키 추가 오류:', e);
                addNotification('cookie-management', '쿠키 추가', 'failed', e.message);
                showToast('올바른 쿠키 형식이 아닙니다', 'error');
            }
        }

        // 샘플 이미지 생성기 HTML
        function getSampleImageGeneratorHTML() {
            return `
                <div class="space-y-6">
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-neutral-700 mb-2">이미지 크기</label>
                                <select id="sample-imageSize" class="form-input">
                                    <option value="100x100">100x100</option>
                                    <option value="200x200">200x200</option>
                                    <option value="400x400" selected>400x400</option>
                                    <option value="800x600">800x600</option>
                                    <option value="1920x1080">1920x1080</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-neutral-700 mb-2">배경색</label>
                                <input type="color" id="sample-bgColor" value="#f0f0f0" class="form-input h-12">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-neutral-700 mb-2">텍스트</label>
                                <input type="text" id="sample-imageText" value="Sample Image" class="form-input">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-neutral-700 mb-2">생성할 이미지 개수</label>
                                <input type="number" id="sample-imageCount" value="5" min="1" max="100" class="form-input">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-neutral-700 mb-2">이미지 포맷</label>
                                <div class="space-y-2">
                                    <label class="flex items-center">
                                        <input type="checkbox" name="imageFormat" value="PNG" checked class="mr-2">
                                        <span>PNG</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" name="imageFormat" value="JPG" checked class="mr-2">
                                        <span>JPG</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" name="imageFormat" value="WEBP" class="mr-2">
                                        <span>WEBP</span>
                                    </label>
                                </div>
                            </div>
                            <button onclick="generateSampleImage()" class="btn-primary w-full">
                                이미지 생성하기
                            </button>
                        </div>
                        <div>
                            <div class="border-2 border-dashed border-neutral-300 rounded-lg p-6 bg-neutral-50 min-h-64 flex items-center justify-center">
                                <canvas id="sample-canvas" class="border border-neutral-200 rounded shadow-sm"></canvas>
                            </div>
                            <button id="sample-downloadBtn" onclick="downloadSampleImage()" class="btn-secondary w-full mt-4" disabled>
                                이미지 다운로드
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }

        // QR XLSX 생성기 HTML
        function getQRXlsxGeneratorHTML() {
            return `
                <div class="space-y-6">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-neutral-700 mb-2">CID</label>
                            <input type="text" id="qr-cid" value="" placeholder="빈값" class="form-input">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-neutral-700 mb-2">TID</label>
                            <input type="text" id="qr-tid" value="" placeholder="빈값" class="form-input">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-neutral-700 mb-2">지역코드</label>
                            <input type="text" id="qr-region" value="JEJU" class="form-input">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-neutral-700 mb-2">VAN</label>
                            <input type="text" id="qr-van" value="KIS" class="form-input">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-neutral-700 mb-2">휴대폰번호</label>
                            <input type="text" id="qr-phone" value="01025710628" class="form-input">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-neutral-700 mb-2">비고</label>
                            <input type="text" id="qr-remark" value="" placeholder="빈값" class="form-input">
                        </div>
                    </div>
                    
                    <button onclick="generateQRXlsx()" class="btn-primary">QR XLSX 파일 생성</button>
                    
                    <div id="qr-preview" class="mt-6 p-4 border border-primary-200 rounded-lg bg-primary-50 hidden">
                        <h4 class="font-medium text-primary-800 mb-2">생성 완료!</h4>
                        <p class="text-primary-700">XLSX 파일이 다운로드되었습니다.</p>
                    </div>
                </div>
            `;
        }

        // CSV 생성기 HTML
        function getCsvGeneratorHTML() {
            return `
                <div class="space-y-6">
                    <div>
                        <label class="block text-sm font-medium text-neutral-700 mb-2">생성할 행 수</label>
                        <input type="number" id="csv-rowCount" value="10" min="1" max="1000" class="form-input max-w-xs">
                    </div>

                    <div class="space-y-4">
                        <h4 class="text-lg font-medium text-neutral-800">열 설정</h4>
                        
                        <!-- 1열 -->
                        <div class="card p-4">
                            <div class="flex items-center justify-between mb-3">
                                <span class="font-medium">1열 (필수)</span>
                            </div>
                            <div class="space-y-3">
                                <label class="flex items-center">
                                    <input type="radio" name="col1Type" value="random" checked class="mr-2">
                                    <span>텍스트 입력</span>
                                </label>
                                <input type="text" id="col1-text" placeholder="텍스트를 입력하세요" class="form-input">
                                <label class="flex items-center">
                                    <input type="radio" name="col1Type" value="custom" class="mr-2">
                                    <span>난수발생</span>
                                </label>
                            </div>
                        </div>

                        <!-- 2열 -->
                        <div class="card p-4">
                            <div class="flex items-center justify-between mb-3">
                                <span class="font-medium">2열 포함</span>
                                <label class="flex items-center">
                                    <input type="checkbox" id="col2-enable" checked class="mr-2" onchange="toggleCsvColumn(2)">
                                    <span>사용</span>
                                </label>
                            </div>
                            <div class="space-y-3" id="col2-options">
                                <label class="flex items-center">
                                    <input type="radio" name="col2Type" value="random" checked class="mr-2">
                                    <span>텍스트 입력</span>
                                </label>
                                <input type="text" id="col2-text" placeholder="텍스트를 입력하세요" class="form-input">
                                <label class="flex items-center">
                                    <input type="radio" name="col2Type" value="custom" class="mr-2">
                                    <span>난수발생</span>
                                </label>
                            </div>
                        </div>

                        <!-- 3열 -->
                        <div class="card p-4">
                            <div class="flex items-center justify-between mb-3">
                                <span class="font-medium">3열 포함</span>
                                <label class="flex items-center">
                                    <input type="checkbox" id="col3-enable" class="mr-2" onchange="toggleCsvColumn(3)">
                                    <span>사용</span>
                                </label>
                            </div>
                            <div class="space-y-3 hidden" id="col3-options">
                                <label class="flex items-center">
                                    <input type="radio" name="col3Type" value="random" checked class="mr-2">
                                    <span>텍스트 입력</span>
                                </label>
                                <input type="text" id="col3-text" placeholder="텍스트를 입력하세요" class="form-input">
                                <label class="flex items-center">
                                    <input type="radio" name="col3Type" value="custom" class="mr-2">
                                    <span>난수발생</span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <button onclick="generateCsvFile()" class="btn-primary">CSV 미리보기</button>

                    <div id="csv-preview" class="hidden">
                        <h4 class="text-lg font-medium text-neutral-800 mb-4">CSV 미리보기</h4>
                        <div class="overflow-auto max-h-64 border border-neutral-200 rounded-lg">
                            <table class="min-w-full">
                                <thead class="bg-neutral-100">
                                    <tr>
                                        <th class="border border-neutral-300 px-4 py-2">1열</th>
                                        <th class="border border-neutral-300 px-4 py-2">2열</th>
                                        <th class="border border-neutral-300 px-4 py-2">3열</th>
                                    </tr>
                                </thead>
                                <tbody id="csv-preview-body">
                                </tbody>
                            </table>
                        </div>
                        <button onclick="downloadCsv()" class="btn-secondary mt-4">
                            CSV 다운로드
                        </button>
                    </div>
                </div>
            `;
        }

        // 샘플 이미지 생성 함수들 (기존 함수들 이어서 사용)
        function generateSampleImage() {
            try {
                // 알림 추가 - 시작
                addNotification('data-generation', '샘플 이미지 생성', 'started');
                
                const size = document.getElementById('sample-imageSize').value;
                const [width, height] = size.split('x').map(Number);
                const bgColor = document.getElementById('sample-bgColor').value;
                const text = document.getElementById('sample-imageText').value;
                const count = parseInt(document.getElementById('sample-imageCount').value) || 1;

                const formats = [];
                document.querySelectorAll('input[name="imageFormat"]:checked').forEach(el => {
                    formats.push(el.value);
                });

                if (formats.length === 0) {
                    addNotification('data-generation', '샘플 이미지 생성', 'failed', '이미지 포맷 선택 안됨');
                    showToast('최소 하나의 이미지 포맷을 선택해주세요', 'error');
                    return;
                }

                const canvas = document.getElementById('sample-canvas');
                const ctx = canvas.getContext('2d');

                canvas.width = width;
                canvas.height = height;
                canvas.style.maxWidth = '100%';
                canvas.style.height = 'auto';

                ctx.fillStyle = bgColor;
                ctx.fillRect(0, 0, width, height);

                ctx.fillStyle = '#333333';
                ctx.font = Math.max(16, width/20) + 'px Arial';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText(text, width/2, height/2 - Math.max(20, width/20));

                ctx.font = Math.max(40, width/10) + 'px Arial';
                ctx.fillText('1', width/2, height/2 + Math.max(20, width/20));

                ctx.font = Math.max(12, width/30) + 'px Arial';
                ctx.fillText(width + ' × ' + height, width/2, height - Math.max(20, width/30));

                window.sampleImageSettings = { width, height, bgColor, text, count, formats };
                document.getElementById('sample-downloadBtn').disabled = false;
                
                // 알림 추가 - 완료
                addNotification('data-generation', '샘플 이미지 생성', 'completed', `${size}, ${count}개, ${formats.join(', ')}`);
                showToast('이미지 생성 완료', 'success');
            } catch (error) {
                console.error('이미지 생성 오류:', error);
                addNotification('data-generation', '샘플 이미지 생성', 'failed', error.message);
                showToast('이미지 생성 중 오류가 발생했습니다', 'error');
            }
        }

        function downloadSampleImage() {
            try {
                const settings = window.sampleImageSettings;
                if (!settings) {
                    showToast('먼저 이미지를 생성해주세요', 'error');
                    return;
                }

                const { width, height, bgColor, text, count, formats } = settings;
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');

                canvas.width = width;
                canvas.height = height;

                for (let i = 1; i <= count; i++) {
                    ctx.fillStyle = bgColor;
                    ctx.fillRect(0, 0, width, height);

                    ctx.fillStyle = '#333333';
                    ctx.font = Math.max(16, width/20) + 'px Arial';
                    ctx.textAlign = 'center';
                    ctx.textBaseline = 'middle';
                    ctx.fillText(text, width/2, height/2 - Math.max(20, width/20));

                    ctx.font = Math.max(40, width/10) + 'px Arial';
                    ctx.fillText(i.toString(), width/2, height/2 + Math.max(20, width/20));

                    ctx.font = Math.max(12, width/30) + 'px Arial';
                    ctx.fillText(width + ' × ' + height, width/2, height - Math.max(20, width/30));

                    formats.forEach(format => {
                        const link = document.createElement('a');
                        const ext = format.toLowerCase();
                        const timestamp = new Date().toISOString().replace(/[:.]/g, '-').slice(0, -5);
                        link.download = `sample-image_${timestamp}_${i}.${ext}`;

                        if (ext === 'jpg' || ext === 'jpeg') {
                            link.href = canvas.toDataURL('image/jpeg', 0.9);
                        } else if (ext === 'webp') {
                            link.href = canvas.toDataURL('image/webp', 0.9);
                        } else {
                            link.href = canvas.toDataURL('image/png');
                        }

                        link.click();
                    });
                }

                showToast(`${count}개 이미지 × ${formats.length}개 포맷 = 총 ${count * formats.length}개 파일 다운로드 완료`, 'success');
            } catch (error) {
                console.error('다운로드 오류:', error);
                showToast('다운로드 중 오류가 발생했습니다', 'error');
            }
        }

        // QR XLSX 생성 함수
        function generateQRXlsx() {
            try {
                const cid = document.getElementById('qr-cid').value || '';
                const tid = document.getElementById('qr-tid').value || '';
                const region = document.getElementById('qr-region').value || 'JEJU';
                const van = document.getElementById('qr-van').value || 'KIS';
                const phone = document.getElementById('qr-phone').value || '01025710628';
                const remark = document.getElementById('qr-remark').value || '';

                const data = [
                    ['cid', 'tid', '지역코드', 'van', '휴대폰번호', '비고'],
                    [cid, tid, region, van, phone, remark]
                ];

                const ws = XLSX.utils.aoa_to_sheet(data);
                const wb = XLSX.utils.book_new();
                XLSX.utils.book_append_sheet(wb, ws, 'QR_Data');
                const timestamp = new Date().toISOString().split('T')[0];
                const cidPart = cid ? `_${cid}` : '';
                XLSX.writeFile(wb, `QR_Data${cidPart}_${timestamp}.xlsx`);

                document.getElementById('qr-preview').classList.remove('hidden');
                showToast('QR XLSX 파일이 생성되었습니다', 'success');
            } catch (error) {
                console.error('XLSX 생성 오류:', error);
                showToast('XLSX 파일 생성 중 오류가 발생했습니다', 'error');
            }
        }

        // CSV 생성 함수들
        function toggleCsvColumn(columnNumber) {
            const options = document.getElementById(`col${columnNumber}-options`);
            const checkbox = document.getElementById(`col${columnNumber}-enable`);

            if (checkbox && options) {
                if (checkbox.checked) {
                    options.classList.remove('hidden');
                } else {
                    options.classList.add('hidden');
                }
            }
        }

        function generateRandomString() {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
            let result = '';
            for (let i = 0; i < 10; i++) {
                result += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return result;
        }

        let csvData = [];

        function generateCsvFile() {
            try {
                const rowCount = parseInt(document.getElementById('csv-rowCount').value);

                if (rowCount <= 0 || rowCount > 1000) {
                    showToast('행 수는 1~1000 범위로 입력해주세요', 'error');
                    return;
                }

                const col2Enabled = document.getElementById('col2-enable').checked;
                const col3Enabled = document.getElementById('col3-enable').checked;

                csvData = [];

                for (let i = 0; i < rowCount; i++) {
                    const row = [];

                    // 1열
                    const col1Type = document.querySelector('input[name="col1Type"]:checked').value;
                    if (col1Type === 'random') {
                        const col1Text = document.getElementById('col1-text').value || 'Data';
                        row.push(col1Text);
                    } else {
                        row.push(generateRandomString());
                    }

                    // 2열
                    if (col2Enabled) {
                        const col2Type = document.querySelector('input[name="col2Type"]:checked').value;
                        if (col2Type === 'random') {
                            const col2Text = document.getElementById('col2-text').value || 'Data';
                            row.push(col2Text);
                        } else {
                            row.push(generateRandomString());
                        }
                    }

                    // 3열
                    if (col3Enabled) {
                        const col3Type = document.querySelector('input[name="col3Type"]:checked').value;
                        if (col3Type === 'random') {
                            const col3Text = document.getElementById('col3-text').value || 'Data';
                            row.push(col3Text);
                        } else {
                            row.push(generateRandomString());
                        }
                    }

                    csvData.push(row);
                }

                displayCsvPreview();
                showToast('CSV 미리보기가 생성되었습니다', 'success');
            } catch (error) {
                console.error('CSV 생성 오류:', error);
                showToast('CSV 파일 생성 중 오류가 발생했습니다', 'error');
            }
        }

        function displayCsvPreview() {
            const previewDiv = document.getElementById('csv-preview');
            const tbody = document.getElementById('csv-preview-body');

            if (!tbody) {
                previewDiv.classList.remove('hidden');
                return;
            }

            tbody.innerHTML = '';

            const previewRows = Math.min(10, csvData.length);
            for (let i = 0; i < previewRows; i++) {
                const tr = document.createElement('tr');
                csvData[i].forEach(cell => {
                    const td = document.createElement('td');
                    td.className = 'border border-neutral-300 px-4 py-2';
                    td.textContent = cell;
                    tr.appendChild(td);
                });
                tbody.appendChild(tr);
            }

            if (csvData.length > 10) {
                const tr = document.createElement('tr');
                const td = document.createElement('td');
                td.colSpan = csvData[0].length;
                td.className = 'border border-neutral-300 px-4 py-2 text-center text-neutral-500';
                td.textContent = `... 외 ${csvData.length - 10}개 행`;
                tr.appendChild(td);
                tbody.appendChild(tr);
            }

            previewDiv.classList.remove('hidden');
        }

        function downloadCsv() {
            if (csvData.length === 0) {
                showToast('먼저 CSV를 생성해주세요', 'error');
                return;
            }

            let csvContent = '';
            csvData.forEach(row => {
                csvContent += row.join(',') + '\n';
            });

            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            const timestamp = new Date().toISOString().replace(/[:.]/g, '-').slice(0, -5);
            const rowCount = csvData.length;
            link.setAttribute('download', `custom_data_${rowCount}rows_${timestamp}.csv`);
            link.click();

            showToast('CSV 파일이 다운로드되었습니다', 'success');
        }

        // 초기화
        document.addEventListener('DOMContentLoaded', function() {
            // 저장된 언어 설정 불러오기
            const savedLanguage = localStorage.getItem('preferred-language');
            if (savedLanguage && (savedLanguage === 'ko' || savedLanguage === 'en')) {
                currentLanguage = savedLanguage;
            }
            
            // 저장된 알림 히스토리 불러오기
            const savedNotifications = localStorage.getItem('notificationHistory');
            if (savedNotifications) {
                try {
                    notificationHistory = JSON.parse(savedNotifications);
                    // 날짜 객체 복원
                    notificationHistory.forEach(n => {
                        n.timestamp = new Date(n.timestamp);
                    });
                } catch (e) {
                    console.error('알림 히스토리 로드 실패:', e);
                    notificationHistory = [];
                }
            }
            
            // 초기 UI 설정
            updateLanguageUI();
            updateAllTexts();
            updateTokenStatus();
            updateDashboardStats();
            updateNotificationBadge();
            updateRecentActivities();
            
            // 주기적으로 토큰 상태 업데이트
            setInterval(updateTokenStatus, 30000);
            
            // 주기적으로 대시보드 통계 업데이트
            setInterval(() => {
                if (currentTab === 'dashboard') {
                    updateDashboardStats();
                    updateRecentActivities();
                }
            }, 60000);
            
            // 시작 알림 추가
            addNotification('admin-tool', 'CEO+ Help 시작', 'completed', 'v2.1 - 알림 시스템 활성화');
            
            console.log('CEO+ Help v2.1 - 알림 시스템 완료');
        });

        // 메시지 수신 처리
        window.addEventListener('message', function(event) {
            try {
                if (event.data && event.data.type === 'REQUEST_TOKENS') {
                    const tokens = getStoredTokens();
                    event.source.postMessage({
                        type: 'SYNC_TOKENS',
                        tokens: tokens
                    }, event.origin);
                }
            } catch (error) {
                console.error('메시지 처리 오류:', error);
            }
        });

        // 에러 전역 처리
        window.addEventListener('error', function(event) {
            console.error('전역 에러:', event.error);
            showToast('예상치 못한 오류가 발생했습니다', 'error');
        });
    </script>

    <!-- 임시 파일 정리 스크립트 -->
    <script>
        // 개발용 임시 파일 정리
        const tempScript = document.createElement('script');
        tempScript.text = 'console.log("CEO+ Help v2.0 - 완전 개편 완료");';
        document.head.appendChild(tempScript);
    </script>
</body>
</html>