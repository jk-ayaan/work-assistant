<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CEO+ Help - ê´€ë¦¬ì ë„êµ¬</title>
    <link rel="icon" type="image/jpeg" href="../favicon-32x32.jpg">
    <link rel="icon" type="image/jpeg" sizes="16x16" href="../favicon-16x16.jpg">
    <link rel="icon" type="image/jpeg" sizes="32x32" href="../favicon-32x32.jpg">
    
    <!-- TailwindCSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: {
                            50: '#fffbeb',
                            100: '#fef3c7',
                            200: '#fde68a',
                            300: '#fcd34d',
                            400: '#fbbf24',
                            500: '#f59e0b',
                            600: '#d97706',
                            700: '#b45309',
                            800: '#92400e',
                            900: '#78350f',
                        },
                        accent: {
                            50: '#fef2f2',
                            100: '#fee2e2',
                            200: '#fecaca',
                            300: '#fca5a5',
                            400: '#f87171',
                            500: '#ef4444',
                            600: '#dc2626',
                            700: '#b91c1c',
                            800: '#991b1b',
                            900: '#7f1d1d',
                        },
                        neutral: {
                            50: '#fafafa',
                            100: '#f5f5f5',
                            200: '#e5e5e5',
                            300: '#d4d4d4',
                            400: '#a3a3a3',
                            500: '#737373',
                            600: '#525252',
                            700: '#404040',
                            800: '#262626',
                            900: '#171717',
                        }
                    }
                }
            }
        }
    </script>
    
    <!-- XLSX ë¼ì´ë¸ŒëŸ¬ë¦¬ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    
    <style>
        :root {
            --header-height: 64px;
            --transition-speed: 0.3s;
        }

        /* ê¸°ë³¸ ë ˆì´ì•„ì›ƒ */
        .app-layout {
            display: grid;
            grid-template-rows: var(--header-height) 1fr;
            grid-template-areas: 
                "header"
                "main";
            height: 100vh;
            background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%);
        }

        /* í–„ë²„ê±° ë©”ë‰´ ë²„íŠ¼ */
        .hamburger-menu {
            display: none;
            width: 40px;
            height: 40px;
            padding: 8px;
            cursor: pointer;
            border-radius: 8px;
            transition: background 0.3s;
        }

        .hamburger-menu:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .hamburger-menu span {
            display: block;
            width: 100%;
            height: 2px;
            background: currentColor;
            margin: 5px 0;
            transition: all 0.3s;
        }

        /* ëª¨ë°”ì¼ ì‚¬ì´ë“œë°” */
        .mobile-sidebar {
            position: fixed;
            top: 0;
            left: -280px;
            width: 280px;
            height: 100vh;
            background: white;
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
            transition: left 0.3s;
            z-index: 100;
            overflow-y: auto;
        }

        .mobile-sidebar.active {
            left: 0;
        }

        .mobile-sidebar-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            z-index: 99;
        }

        .mobile-sidebar-overlay.active {
            display: block;
        }

        .mobile-nav-item {
            display: flex;
            align-items: center;
            padding: 1rem 1.5rem;
            border-bottom: 1px solid #e5e5e5;
            cursor: pointer;
            transition: background 0.2s;
        }

        .mobile-nav-item:hover {
            background: #f5f5f5;
        }

        .mobile-nav-item.active {
            background: linear-gradient(90deg, #fbbf24 0%, #f59e0b 100%);
            color: white;
        }

        .mobile-nav-item svg {
            width: 20px;
            height: 20px;
            margin-right: 12px;
        }

        /* ëª¨ë°”ì¼ ë°˜ì‘í˜• */
        @media (max-width: 768px) {
            .hamburger-menu {
                display: block;
            }

            .tab-container {
                display: none !important;
            }

            nav.flex-1 {
                display: none;
            }

            .main-content {
                padding: 1rem;
            }

            .card-grid {
                grid-template-columns: 1fr;
            }
        }

        .header {
            grid-area: header;
            background: linear-gradient(90deg, #fbbf24 0%, #f59e0b 100%);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            z-index: 50;
        }

        .main-content {
            grid-area: main;
            overflow-y: auto;
            padding: 2rem;
        }

        /* ì¹´ë“œ ìŠ¤íƒ€ì¼ */
        .card {
            background: white;
            border-radius: 16px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            transition: all var(--transition-speed) ease;
            border: 1px solid rgba(251, 191, 36, 0.2);
        }

        .card:hover {
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            transform: translateY(-2px);
            border-color: rgba(251, 191, 36, 0.4);
        }

        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
        }

        /* íƒ­ ìŠ¤íƒ€ì¼ */
        .tab-button {
            position: relative;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            font-weight: 500;
            transition: all var(--transition-speed) ease;
            color: rgba(0, 0, 0, 0.7);
        }

        .tab-button:hover {
            background: rgba(255, 255, 255, 0.2);
            color: rgba(0, 0, 0, 0.9);
        }

        .tab-button.active {
            background: rgba(255, 255, 255, 0.3);
            color: #000;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .tab-button.active::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 50%;
            transform: translateX(-50%);
            width: 50%;
            height: 2px;
            background: #dc2626;
            border-radius: 1px;
        }

        /* íˆ´ ì¹´ë“œ íŠ¹ë³„ ìŠ¤íƒ€ì¼ */
        .tool-card {
            cursor: pointer;
            overflow: hidden;
        }

        .tool-card .icon-container {
            background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
            width: 64px;
            height: 64px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 1rem;
            box-shadow: 0 4px 8px rgba(251, 191, 36, 0.3);
        }

        .tool-card:hover .icon-container {
            transform: scale(1.05);
            box-shadow: 0 8px 16px rgba(251, 191, 36, 0.4);
        }

        /* ë¡œë”© ìŠ¤í”¼ë„ˆ */
        .loading-spinner {
            border: 3px solid #fde68a;
            border-top: 3px solid #f59e0b;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* ì•Œë¦¼ í† ìŠ¤íŠ¸ */
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            border-left: 4px solid #f59e0b;
            padding: 1rem 1.5rem;
            z-index: 1000;
            animation: slideIn 0.3s ease;
            max-width: 400px;
        }

        .toast.success {
            border-left-color: #10b981;
        }

        .toast.error {
            border-left-color: #dc2626;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        /* íƒ­ í…ìŠ¤íŠ¸ ë°˜ì‘í˜• ì²˜ë¦¬ */
        .tab-text {
            transition: all var(--transition-speed) ease;
        }
        
        /* ì¤‘ê°„ í¬ê¸°ì—ì„œ í…ìŠ¤íŠ¸ ìˆ¨ê¹€ (ê°œí–‰ë˜ê¸° ì „) */
        @media (max-width: 1024px) {
            .tab-text {
                display: none;
            }
            
            .tab-button svg {
                margin-right: 0 !important;
            }
            
            .tab-button {
                padding: 0.5rem 0.75rem;
                min-width: 44px;
                display: flex;
                align-items: center;
                justify-content: center;
            }
        }

        /* ëª¨ë°”ì¼ ë°˜ì‘í˜• */
        @media (max-width: 768px) {
            .main-content {
                padding: 1rem;
            }
            
            .card-grid {
                grid-template-columns: 1fr;
                gap: 1rem;
            }
            
            .tab-container {
                overflow-x: auto;
                scrollbar-width: none;
                -ms-overflow-style: none;
                justify-content: flex-start;
            }
            
            .tab-container::-webkit-scrollbar {
                display: none;
            }
            
            .tab-text {
                display: inline; /* ëª¨ë°”ì¼ì—ì„œëŠ” ë‹¤ì‹œ í…ìŠ¤íŠ¸ í‘œì‹œ */
            }
            
            .tab-button svg {
                margin-right: 0.5rem !important;
            }
            
            .tab-button {
                padding: 0.5rem 1rem;
                min-width: auto;
                white-space: nowrap;
            }
        }

        /* ì•„ì£¼ ì‘ì€ ëª¨ë°”ì¼ì—ì„œëŠ” ì•„ì´ì½˜ë§Œ */
        @media (max-width: 480px) {
            .tab-text {
                display: none;
            }
            
            .tab-button svg {
                margin-right: 0 !important;
            }
            
            .tab-button {
                padding: 0.5rem 0.75rem;
                min-width: 44px;
            }
        }

        /* í¼ ìŠ¤íƒ€ì¼ */
        .form-input {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid #e5e5e5;
            border-radius: 8px;
            transition: border-color var(--transition-speed) ease;
            background: white;
        }

        .form-input:focus {
            outline: none;
            border-color: #fbbf24;
            box-shadow: 0 0 0 3px rgba(251, 191, 36, 0.1);
        }

        .btn-primary {
            background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
            color: black;
            font-weight: 600;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            transition: all var(--transition-speed) ease;
            box-shadow: 0 2px 4px rgba(251, 191, 36, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(251, 191, 36, 0.4);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%);
            color: white;
            font-weight: 600;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            transition: all var(--transition-speed) ease;
            box-shadow: 0 2px 4px rgba(220, 38, 38, 0.3);
        }

        .btn-secondary:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(220, 38, 38, 0.4);
        }

        /* í†µê³„ ì¹´ë“œ */
        .stat-card {
            background: linear-gradient(135deg, white 0%, #fffbeb 100%);
            border-left: 4px solid #fbbf24;
        }

        .stat-number {
            font-size: 2rem;
            font-weight: 700;
            color: #f59e0b;
        }
    </style>
</head>

<body>
    <!-- ëª¨ë°”ì¼ ì‚¬ì´ë“œë°” -->
    <div class="mobile-sidebar" id="mobileSidebar">
        <div class="p-4 bg-gradient-to-r from-primary-500 to-primary-600">
            <div class="flex items-center space-x-3">
                <img src="../logo.jpg" alt="CEO+ Help" class="w-10 h-10 rounded-lg shadow-md">
                <div>
                    <h1 class="text-lg font-bold text-white">CEO+ Help</h1>
                    <p class="text-xs text-white opacity-80">Admin Tools</p>
                </div>
            </div>
        </div>
        
        <nav class="py-2">
            <div class="mobile-nav-item active" data-tab="dashboard" onclick="showTabFromMobile('dashboard')">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2-2z"></path>
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5a2 2 0 012-2h4a2 2 0 012 2v6H8V5z"></path>
                </svg>
                <span data-ko="ëŒ€ì‹œë³´ë“œ" data-en="Dashboard">ëŒ€ì‹œë³´ë“œ</span>
            </div>
            
            <div class="mobile-nav-item" data-tab="admin-tools" onclick="showTabFromMobile('admin-tools')">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.096 2.572-1.065z"></path>
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                </svg>
                <span data-ko="ì–´ë“œë¯¼ í™œìš©" data-en="Admin Tools">ì–´ë“œë¯¼ í™œìš©</span>
            </div>
            
            <div class="mobile-nav-item" data-tab="data-tools" onclick="showTabFromMobile('data-tools')">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                </svg>
                <span data-ko="ë°ì´í„° ìƒì„±" data-en="Data Tools">ë°ì´í„° ìƒì„±</span>
            </div>
            
            <div class="mobile-nav-item" data-tab="settings" onclick="showTabFromMobile('settings')">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 100-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 100-4m0 4v2m0-6V4"></path>
                </svg>
                <span data-ko="ì„¤ì •" data-en="Settings">ì„¤ì •</span>
            </div>
        </nav>
        
        <div class="border-t border-gray-200 mt-4 pt-4 px-4">
            <button class="w-full p-3 bg-neutral-100 text-neutral-700 rounded-lg hover:bg-neutral-200 transition-colors" onclick="closeMobileSidebar()">
                <span data-ko="ë‹«ê¸°" data-en="Close">ë‹«ê¸°</span>
            </button>
        </div>
    </div>
    
    <!-- ëª¨ë°”ì¼ ì‚¬ì´ë“œë°” ì˜¤ë²„ë ˆì´ -->
    <div class="mobile-sidebar-overlay" id="mobileSidebarOverlay" onclick="closeMobileSidebar()"></div>
    
    <div class="app-layout">
        <!-- í—¤ë” ë„¤ë¹„ê²Œì´ì…˜ -->
        <header class="header">
            <div class="flex items-center justify-between h-full px-4 lg:px-8">
                <!-- ë¡œê³  -->
                <div class="flex items-center space-x-4">
                    <!-- í–„ë²„ê±° ë©”ë‰´ ë²„íŠ¼ -->
                    <div class="hamburger-menu" onclick="toggleMobileSidebar()">
                        <span></span>
                        <span></span>
                        <span></span>
                    </div>
                    <img src="../logo.jpg" alt="CEO+ Help" class="w-12 h-12 rounded-lg shadow-md">
                    <div class="hidden sm:block">
                        <h1 class="text-xl font-bold text-black">CEO+</h1>
                        <p class="text-sm font-semibold text-red-600">Help</p>
                    </div>
                </div>

                <!-- ë„¤ë¹„ê²Œì´ì…˜ íƒ­ -->
                <nav class="flex-1 mx-8">
                    <div class="tab-container flex space-x-1 justify-center">
                        <button class="tab-button active" onclick="showTab('dashboard')" id="tab-dashboard">
                            <svg class="w-5 h-5 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2-2z"></path>
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5a2 2 0 012-2h4a2 2 0 012 2v6H8V5z"></path>
                            </svg>
                            <span class="tab-text" data-ko="ëŒ€ì‹œë³´ë“œ" data-en="Dashboard">ëŒ€ì‹œë³´ë“œ</span>
                        </button>
                        <button class="tab-button" onclick="showTab('admin-tools')" id="tab-admin-tools">
                            <svg class="w-5 h-5 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.096 2.572-1.065z"></path>
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                            </svg>
                            <span class="tab-text" data-ko="ì–´ë“œë¯¼ í™œìš©" data-en="Admin Tools">ì–´ë“œë¯¼ í™œìš©</span>
                        </button>
                        <button class="tab-button" onclick="showTab('data-tools')" id="tab-data-tools">
                            <svg class="w-5 h-5 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                            </svg>
                            <span class="tab-text" data-ko="ë°ì´í„° ìƒì„±" data-en="Data Tools">ë°ì´í„° ìƒì„±</span>
                        </button>
                        <button class="tab-button" onclick="showTab('settings')" id="tab-settings">
                            <svg class="w-5 h-5 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 100-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 100-4m0 4v2m0-6V4"></path>
                            </svg>
                            <span class="tab-text" data-ko="ì„¤ì •" data-en="Settings">ì„¤ì •</span>
                        </button>
                    </div>
                </nav>

                <!-- ìš°ì¸¡ ìœ í‹¸ë¦¬í‹° -->
                <div class="flex items-center space-x-3">
                    <!-- ì–¸ì–´ ì„ íƒ ë²„íŠ¼ -->
                    <div class="relative">
                        <button class="px-3 py-1.5 rounded-lg bg-white bg-opacity-20 hover:bg-opacity-30 transition-all text-sm font-medium" onclick="toggleLanguage()">
                            <span id="current-lang" class="text-black">KOR</span>
                            <span class="text-black opacity-50 mx-1">|</span>
                            <span id="other-lang" class="text-black opacity-50">ENG</span>
                        </button>
                    </div>
                    
                    <!-- ì•Œë¦¼ ë²„íŠ¼ -->
                    <div class="relative">
                        <button class="p-2 rounded-lg bg-white bg-opacity-20 hover:bg-opacity-30 transition-all" onclick="showNotifications()">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18 8A6 6 0 006 8c0 7-3 9-3 9h18s-3-2-3-9z"></path>
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m13.73 21a2 2 0 01-3.46 0"></path>
                            </svg>
                        </button>
                        <span id="notification-badge" class="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center hidden">3</span>
                    </div>
                </div>
            </div>
        </header>

        <!-- ë©”ì¸ ì½˜í…ì¸  -->
        <main class="main-content">
            <!-- ëŒ€ì‹œë³´ë“œ íƒ­ -->
            <div id="dashboard-content" class="tab-content">
                <div class="mb-8">
                    <div class="flex items-center justify-between">
                        <div>
                            <h2 id="dashboard-title" class="text-3xl font-bold text-neutral-800 mb-2">ëŒ€ì‹œë³´ë“œ</h2>
                            <p id="dashboard-desc" class="text-neutral-600">CEO+ Helpì˜ ì „ì²´ í˜„í™©ì„ í™•ì¸í•˜ì„¸ìš”</p>
                        </div>
                        <!-- ê¸°ê°„ í•„í„° -->
                        <div class="flex items-center space-x-2">
                            <button onclick="changeDateRange('day')" id="range-day" class="px-3 py-1 rounded-lg bg-primary-100 text-primary-800 font-medium"><span data-ko="ì˜¤ëŠ˜" data-en="Today">ì˜¤ëŠ˜</span></button>
                            <button onclick="changeDateRange('week')" id="range-week" class="px-3 py-1 rounded-lg hover:bg-neutral-100"><span data-ko="ì£¼ê°„" data-en="Week">ì£¼ê°„</span></button>
                            <button onclick="changeDateRange('month')" id="range-month" class="px-3 py-1 rounded-lg hover:bg-neutral-100"><span data-ko="ì›”ê°„" data-en="Month">ì›”ê°„</span></button>
                            <button onclick="changeDateRange('year')" id="range-year" class="px-3 py-1 rounded-lg hover:bg-neutral-100"><span data-ko="ì—°ê°„" data-en="Year">ì—°ê°„</span></button>
                        </div>
                    </div>
                </div>

                <!-- í†µê³„ ì¹´ë“œë“¤ -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                    <div class="card stat-card p-6" data-ko-title="ì˜¤ëŠ˜ ì‚¬ìš©í•œ ê³ ìœ  ê¸°ëŠ¥ ìˆ˜" data-en-title="Number of unique features used today">
                        <div class="flex items-center justify-between">
                            <div>
                                <p id="active-sessions-label" class="text-sm font-medium text-neutral-600"><span data-ko="ì˜¤ëŠ˜ í™œë™" data-en="Today's Activity">ì˜¤ëŠ˜ í™œë™</span></p>
                                <p class="stat-number" id="active-sessions">0</p>
                                <p class="text-xs text-neutral-500 mt-1"><span data-ko="ê³ ìœ  ê¸°ëŠ¥ ì‚¬ìš©" data-en="Unique features used">ê³ ìœ  ê¸°ëŠ¥ ì‚¬ìš©</span></p>
                            </div>
                            <div class="w-12 h-12 bg-primary-100 rounded-lg flex items-center justify-center">
                                <svg class="w-6 h-6 text-primary-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                                </svg>
                            </div>
                        </div>
                    </div>

                    <div class="card stat-card p-6" data-ko-title="ì„ íƒí•œ ê¸°ê°„ ë™ì•ˆ ì™„ë£Œëœ ì‘ì—…" data-en-title="Tasks completed during selected period">
                        <div class="flex items-center justify-between">
                            <div>
                                <p id="completed-tasks-label" class="text-sm font-medium text-neutral-600"><span data-ko="ì™„ë£Œëœ ì‘ì—…" data-en="Completed Tasks">ì™„ë£Œëœ ì‘ì—…</span></p>
                                <p class="stat-number" id="completed-tasks">0</p>
                                <p class="text-xs text-neutral-500 mt-1"><span data-ko="ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œ" data-en="Successfully completed">ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œ</span></p>
                            </div>
                            <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center">
                                <svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                            </div>
                        </div>
                    </div>

                    <div class="card stat-card p-6" data-ko-title="í˜„ì¬ ë¸Œë¼ìš°ì €ì— ì €ì¥ëœ í† í°" data-en-title="Tokens saved in current browser">
                        <div class="flex items-center justify-between">
                            <div>
                                <p id="saved-tokens-label" class="text-sm font-medium text-neutral-600"><span data-ko="ì €ì¥ëœ í† í°" data-en="Saved Tokens">ì €ì¥ëœ í† í°</span></p>
                                <p class="stat-number" id="token-count">0</p>
                                <p class="text-xs text-neutral-500 mt-1"><span data-ko="í˜„ì¬ í™œì„±" data-en="Currently active">í˜„ì¬ í™œì„±</span></p>
                            </div>
                            <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center">
                                <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"></path>
                                </svg>
                            </div>
                        </div>
                    </div>

                    <div class="card stat-card p-6" data-ko-title="ë°ì´í„° ìƒì„± ë„êµ¬ë¡œ ìƒì„±í•œ íŒŒì¼" data-en-title="Files generated with data tools">
                        <div class="flex items-center justify-between">
                            <div>
                                <p id="generated-files-label" class="text-sm font-medium text-neutral-600"><span data-ko="ìƒì„±ëœ íŒŒì¼" data-en="Generated Files">ìƒì„±ëœ íŒŒì¼</span></p>
                                <p class="stat-number" id="file-count">0</p>
                                <p class="text-xs text-neutral-500 mt-1"><span data-ko="ë°ì´í„° íŒŒì¼" data-en="Data files">ë°ì´í„° íŒŒì¼</span></p>
                            </div>
                            <div class="w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center">
                                <svg class="w-6 h-6 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                                </svg>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ìµœê·¼ í™œë™ -->
                <div class="card p-6">
                    <div class="flex items-center justify-between mb-4">
                        <h3 id="recent-activities-title" class="text-xl font-bold text-neutral-800">ìµœê·¼ í™œë™</h3>
                        <button onclick="clearActivityHistory()" class="text-sm text-neutral-500 hover:text-red-600">
                            <span data-ko="ê¸°ë¡ ì‚­ì œ" data-en="Clear History">ê¸°ë¡ ì‚­ì œ</span>
                        </button>
                    </div>
                    <div id="recent-activities" class="space-y-4">
                        <!-- ì‹¤ì œ í™œë™ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                    </div>
                </div>
            </div>

            <!-- ì–´ë“œë¯¼ ë„êµ¬ íƒ­ -->
            <div id="admin-tools-content" class="tab-content hidden">
                <div class="mb-8">
                    <div class="flex items-center justify-between">
                        <div>
                            <h2 id="admin-tools-title" class="text-3xl font-bold text-neutral-800 mb-2">ì–´ë“œë¯¼ í™œìš©</h2>
                            <p id="admin-tools-desc" class="text-neutral-600">ê°€ë§¹ì  ê´€ë¦¬ ë° ì‹œìŠ¤í…œ ìš´ì˜ ë„êµ¬ë“¤</p>
                        </div>
                        <div class="flex gap-2">
                            <button onclick="openAdminToolManager()" class="btn-secondary">
                                <svg class="w-4 h-4 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                </svg>
                                <span data-ko="ê´€ë¦¬" data-en="Manage">ê´€ë¦¬</span>
                            </button>
                            <button onclick="exportAdminConfig()" class="btn-secondary">
                                <svg class="w-4 h-4 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path>
                                </svg>
                                <span data-ko="ë‚´ë³´ë‚´ê¸°" data-en="Export">ë‚´ë³´ë‚´ê¸°</span>
                            </button>
                            <label class="btn-primary cursor-pointer">
                                <svg class="w-4 h-4 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"></path>
                                </svg>
                                <span data-ko="ë¶ˆëŸ¬ì˜¤ê¸°" data-en="Import">ë¶ˆëŸ¬ì˜¤ê¸°</span>
                                <input type="file" accept=".json" onchange="importAdminConfig(event)" class="hidden">
                            </label>
                        </div>
                    </div>
                </div>

                <div id="admin-tools-grid" class="card-grid">
                    <!-- ë™ì ìœ¼ë¡œ ë¡œë“œë  ì–´ë“œë¯¼ ë„êµ¬ ì¹´ë“œë“¤ -->
                </div>
            </div>

            <!-- ë°ì´í„° ìƒì„± ë„êµ¬ íƒ­ -->
            <div id="data-tools-content" class="tab-content hidden">
                <div class="mb-8">
                    <h2 id="data-tools-title" class="text-3xl font-bold text-neutral-800 mb-2">ë°ì´í„° ìƒì„± ë„êµ¬</h2>
                    <p id="data-tools-desc" class="text-neutral-600">í…ŒìŠ¤íŠ¸ ë°ì´í„° ë° ìƒ˜í”Œ íŒŒì¼ ìƒì„± ë„êµ¬ë“¤</p>
                </div>

                <div class="card-grid">
                    <div class="card tool-card p-6" onclick="openDataTool('sample-image')">
                        <div class="icon-container">
                            <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                            </svg>
                        </div>
                        <h3 class="text-xl font-bold text-neutral-800 mb-2"><span data-ko="ìƒ˜í”Œ ì´ë¯¸ì§€ ìƒì„±ê¸°" data-en="Sample Image Generator">ìƒ˜í”Œ ì´ë¯¸ì§€ ìƒì„±ê¸°</span></h3>
                        <p class="text-neutral-600 mb-4"><span data-ko="ë‹¤ì–‘í•œ í¬ê¸°ì™€ í¬ë§·ì˜ í…ŒìŠ¤íŠ¸ ì´ë¯¸ì§€ë¥¼ ìƒì„±í•©ë‹ˆë‹¤" data-en="Generate test images in various sizes and formats">ë‹¤ì–‘í•œ í¬ê¸°ì™€ í¬ë§·ì˜ í…ŒìŠ¤íŠ¸ ì´ë¯¸ì§€ë¥¼ ìƒì„±í•©ë‹ˆë‹¤</span></p>
                        <div class="flex items-center text-sm text-neutral-500">
                            <span class="bg-purple-100 text-purple-800 px-2 py-1 rounded text-xs mr-2"><span data-ko="ì´ë¯¸ì§€ ë„êµ¬" data-en="Image Tool">ì´ë¯¸ì§€ ë„êµ¬</span></span>
                            <span>â†’</span>
                        </div>
                    </div>

                    <div class="card tool-card p-6" onclick="openDataTool('qr-xlsx')">
                        <div class="icon-container">
                            <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                            </svg>
                        </div>
                        <h3 class="text-xl font-bold text-neutral-800 mb-2"><span data-ko="QR XLSX ìƒì„±ê¸°" data-en="QR XLSX Generator">QR XLSX ìƒì„±ê¸°</span></h3>
                        <p class="text-neutral-600 mb-4"><span data-ko="QR ì½”ë“œ ì •ë³´ê°€ í¬í•¨ëœ ì—‘ì…€ íŒŒì¼ì„ ìƒì„±í•©ë‹ˆë‹¤" data-en="Generate Excel files with QR code information">QR ì½”ë“œ ì •ë³´ê°€ í¬í•¨ëœ ì—‘ì…€ íŒŒì¼ì„ ìƒì„±í•©ë‹ˆë‹¤</span></p>
                        <div class="flex items-center text-sm text-neutral-500">
                            <span class="bg-green-100 text-green-800 px-2 py-1 rounded text-xs mr-2"><span data-ko="ì—‘ì…€ ë„êµ¬" data-en="Excel Tool">ì—‘ì…€ ë„êµ¬</span></span>
                            <span>â†’</span>
                        </div>
                    </div>

                    <div class="card tool-card p-6" onclick="openDataTool('csv-generator')">
                        <div class="icon-container">
                            <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                            </svg>
                        </div>
                        <h3 class="text-xl font-bold text-neutral-800 mb-2"><span data-ko="CSV ìƒì„±ê¸°" data-en="CSV Generator">CSV ìƒì„±ê¸°</span></h3>
                        <p class="text-neutral-600 mb-4"><span data-ko="ì»¤ìŠ¤í…€ CSV íŒŒì¼ì„ ìƒì„±í•˜ê³  ë‹¤ìš´ë¡œë“œí•©ë‹ˆë‹¤" data-en="Generate and download custom CSV files">ì»¤ìŠ¤í…€ CSV íŒŒì¼ì„ ìƒì„±í•˜ê³  ë‹¤ìš´ë¡œë“œí•©ë‹ˆë‹¤</span></p>
                        <div class="flex items-center text-sm text-neutral-500">
                            <span class="bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs mr-2"><span data-ko="ë°ì´í„° ë„êµ¬" data-en="Data Tool">ë°ì´í„° ë„êµ¬</span></span>
                            <span>â†’</span>
                        </div>
                    </div>

                    <div class="card tool-card p-6" onclick="openDataTool('profile-generator')">
                        <div class="icon-container">
                            <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                            </svg>
                        </div>
                        <h3 class="text-xl font-bold text-neutral-800 mb-2"><span data-ko="í”„ë¡œí•„ ì´ë¯¸ì§€ ìƒì„±ê¸°" data-en="Profile Image Generator">í”„ë¡œí•„ ì´ë¯¸ì§€ ìƒì„±ê¸°</span></h3>
                        <p class="text-neutral-600 mb-4"><span data-ko="í…ìŠ¤íŠ¸ ê¸°ë°˜ í”„ë¡œí•„ ì´ë¯¸ì§€ë¥¼ í™˜ê²½ë³„ ì¹©ê³¼ í•¨ê»˜ ìƒì„±í•©ë‹ˆë‹¤" data-en="Generate text-based profile images with environment chips">í…ìŠ¤íŠ¸ ê¸°ë°˜ í”„ë¡œí•„ ì´ë¯¸ì§€ë¥¼ í™˜ê²½ë³„ ì¹©ê³¼ í•¨ê»˜ ìƒì„±í•©ë‹ˆë‹¤</span></p>
                        <div class="flex items-center text-sm text-neutral-500">
                            <span class="bg-indigo-100 text-indigo-800 px-2 py-1 rounded text-xs mr-2"><span data-ko="í”„ë¡œí•„ ë„êµ¬" data-en="Profile Tool">í”„ë¡œí•„ ë„êµ¬</span></span>
                            <span>â†’</span>
                        </div>
                    </div>

                    <div class="card tool-card p-6" onclick="openDataTool('env-badge')">
                        <div class="icon-container">
                            <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"></path>
                            </svg>
                        </div>
                        <h3 class="text-xl font-bold text-neutral-800 mb-2"><span data-ko="í™˜ê²½ ë±ƒì§€ ìƒì„±ê¸°" data-en="Environment Badge Generator">í™˜ê²½ ë±ƒì§€ ìƒì„±ê¸°</span></h3>
                        <p class="text-neutral-600 mb-4"><span data-ko="QA, ê°œë°œ, ìš´ì˜ í™˜ê²½ì„ êµ¬ë¶„í•˜ëŠ” ë±ƒì§€ë¥¼ ìƒì„±í•©ë‹ˆë‹¤" data-en="Generate badges to distinguish QA, dev, and production environments">QA, ê°œë°œ, ìš´ì˜ í™˜ê²½ì„ êµ¬ë¶„í•˜ëŠ” ë±ƒì§€ë¥¼ ìƒì„±í•©ë‹ˆë‹¤</span></p>
                        <div class="flex items-center text-sm text-neutral-500">
                            <span class="bg-amber-100 text-amber-800 px-2 py-1 rounded text-xs mr-2"><span data-ko="ë±ƒì§€ ë„êµ¬" data-en="Badge Tool">ë±ƒì§€ ë„êµ¬</span></span>
                            <span>â†’</span>
                        </div>
                    </div>

                    <div class="card tool-card p-6" onclick="openDataTool('business-number')">
                        <div class="icon-container">
                            <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"></path>
                            </svg>
                        </div>
                        <h3 class="text-xl font-bold text-neutral-800 mb-2"><span data-ko="ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸ ìƒì„±ê¸°" data-en="Business Number Generator">ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸ ìƒì„±ê¸°</span></h3>
                        <p class="text-neutral-600 mb-4"><span data-ko="ìœ íš¨í•œ í•œêµ­ ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸ë¥¼ ìƒì„±í•©ë‹ˆë‹¤" data-en="Generate valid Korean business registration numbers">ìœ íš¨í•œ í•œêµ­ ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸ë¥¼ ìƒì„±í•©ë‹ˆë‹¤</span></p>
                        <div class="flex items-center text-sm text-neutral-500">
                            <span class="bg-teal-100 text-teal-800 px-2 py-1 rounded text-xs mr-2"><span data-ko="ë²ˆí˜¸ ìƒì„±" data-en="Number Generator">ë²ˆí˜¸ ìƒì„±</span></span>
                            <span>â†’</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ì„¤ì • íƒ­ -->
            <div id="settings-content" class="tab-content hidden">
                <div class="mb-8">
                    <h2 id="settings-title" class="text-3xl font-bold text-neutral-800 mb-2">ì„¤ì •</h2>
                    <p id="settings-desc" class="text-neutral-600">ì‹œìŠ¤í…œ ì„¤ì • ë° í† í° ê´€ë¦¬</p>
                </div>

                <div class="space-y-6">
                    <!-- í† í° ê´€ë¦¬ ì¹´ë“œ -->
                    <div class="card p-6">
                        <h3 id="token-management-title" class="text-xl font-bold text-neutral-800 mb-4">í† í° ê´€ë¦¬</h3>
                        <div class="space-y-4">
                            <div class="flex items-center justify-between p-4 bg-neutral-50 rounded-lg">
                                <div>
                                    <p class="font-medium text-neutral-800"><span data-ko="í† í° ìƒíƒœ" data-en="Token Status">í† í° ìƒíƒœ</span></p>
                                    <p class="text-sm text-neutral-600" id="token-status-detail"><span data-ko="í† í° í™•ì¸ ì¤‘..." data-en="Checking tokens...">í† í° í™•ì¸ ì¤‘...</span></p>
                                </div>
                                <button class="btn-primary" onclick="syncTokens()">
                                    ğŸ”„ <span data-ko="í† í° ë™ê¸°í™”" data-en="Sync Tokens">í† í° ë™ê¸°í™”</span>
                                </button>
                            </div>
                            <div class="flex space-x-4">
                                <button class="btn-secondary" onclick="showCookieModal()">
                                    ğŸª <span data-ko="ì¿ í‚¤ ê´€ë¦¬" data-en="Manage Cookies">ì¿ í‚¤ ê´€ë¦¬</span>
                                </button>
                                <button class="btn-primary" onclick="exportTokens()">
                                    ğŸ“¤ <span data-ko="í† í° ë‚´ë³´ë‚´ê¸°" data-en="Export Tokens">í† í° ë‚´ë³´ë‚´ê¸°</span>
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- ì‹œìŠ¤í…œ ì„¤ì • ì¹´ë“œ -->
                    <div class="card p-6">
                        <h3 id="system-settings-title" class="text-xl font-bold text-neutral-800 mb-4">ì‹œìŠ¤í…œ ì„¤ì •</h3>
                        <div class="space-y-4">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="font-medium text-neutral-800"><span data-ko="ë‹¤í¬ ëª¨ë“œ" data-en="Dark Mode">ë‹¤í¬ ëª¨ë“œ</span></p>
                                    <p class="text-sm text-neutral-600"><span data-ko="ì¸í„°í˜ì´ìŠ¤ í…Œë§ˆ ë³€ê²½" data-en="Change interface theme">ì¸í„°í˜ì´ìŠ¤ í…Œë§ˆ ë³€ê²½</span></p>
                                </div>
                                <label class="relative inline-flex items-center cursor-pointer">
                                    <input type="checkbox" class="sr-only peer" id="dark-mode-toggle">
                                    <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-primary-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-primary-600"></div>
                                </label>
                            </div>
                            
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="font-medium text-neutral-800"><span data-ko="ìë™ ì €ì¥" data-en="Auto Save">ìë™ ì €ì¥</span></p>
                                    <p class="text-sm text-neutral-600"><span data-ko="ì‘ì—… ë‚´ìš© ìë™ ì €ì¥" data-en="Automatically save work">ì‘ì—… ë‚´ìš© ìë™ ì €ì¥</span></p>
                                </div>
                                <label class="relative inline-flex items-center cursor-pointer">
                                    <input type="checkbox" class="sr-only peer" id="auto-save-toggle" checked>
                                    <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-primary-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-primary-600"></div>
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- ì •ë³´ ì¹´ë“œ -->
                    <div class="card p-6">
                        <h3 id="system-info-title" class="text-xl font-bold text-neutral-800 mb-4">ì‹œìŠ¤í…œ ì •ë³´</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="p-4 bg-neutral-50 rounded-lg">
                                <p class="text-sm font-medium text-neutral-600"><span data-ko="ë²„ì „" data-en="Version">ë²„ì „</span></p>
                                <p class="text-lg font-bold text-neutral-800">v2.1.0</p>
                            </div>
                            <div class="p-4 bg-neutral-50 rounded-lg">
                                <p class="text-sm font-medium text-neutral-600"><span data-ko="ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸" data-en="Last Update">ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸</span></p>
                                <p class="text-lg font-bold text-neutral-800">2024-08-15</p>
                            </div>
                            <div class="p-4 bg-neutral-50 rounded-lg">
                                <p class="text-sm font-medium text-neutral-600"><span data-ko="ì´ ì‚¬ìš©ì" data-en="Total Users">ì´ ì‚¬ìš©ì</span></p>
                                <p class="text-lg font-bold text-neutral-800"><span data-ko="247ëª…" data-en="247">247ëª…</span></p>
                            </div>
                            <div class="p-4 bg-neutral-50 rounded-lg">
                                <p class="text-sm font-medium text-neutral-600"><span data-ko="ì—…íƒ€ì„" data-en="Uptime">ì—…íƒ€ì„</span></p>
                                <p class="text-lg font-bold text-neutral-800">99.9%</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- ì¿ í‚¤ ê´€ë¦¬ ëª¨ë‹¬ -->
    <div id="cookie-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50">
        <div class="bg-white rounded-2xl p-8 max-w-2xl w-full m-4 max-h-[80vh] overflow-y-auto">
            <h3 class="text-2xl font-bold text-neutral-800 mb-6">ğŸª <span data-ko="ì¿ í‚¤ ê´€ë¦¬" data-en="Cookie Management">ì¿ í‚¤ ê´€ë¦¬</span></h3>
            <div class="mb-6">
                <h4 class="font-medium text-neutral-700 mb-3"><span data-ko="í˜„ì¬ ì €ì¥ëœ ì¿ í‚¤:" data-en="Current Saved Cookies:">í˜„ì¬ ì €ì¥ëœ ì¿ í‚¤:</span></h4>
                <div id="cookie-list" class="bg-neutral-100 p-4 rounded-lg text-sm font-mono max-h-40 overflow-y-auto">
                    <span data-ko="ë¡œë”©ì¤‘..." data-en="Loading...">ë¡œë”©ì¤‘...</span>
                </div>
            </div>
            <div class="mb-6">
                <h4 class="font-medium text-neutral-700 mb-3"><span data-ko="ì¿ í‚¤ ì¶”ê°€/ìˆ˜ì •:" data-en="Add/Edit Cookie:">ì¿ í‚¤ ì¶”ê°€/ìˆ˜ì •:</span></h4>
                <input id="cookie-input" type="text"
                       placeholder="name=value; domain=.example.com; path=/"
                       class="form-input mb-3">
                <button onclick="addCookie()" class="btn-primary">
                    <span data-ko="ì¿ í‚¤ ì¶”ê°€" data-en="Add Cookie">ì¿ í‚¤ ì¶”ê°€</span>
                </button>
            </div>
            <button onclick="closeCookieModal()" class="w-full p-3 bg-neutral-300 text-neutral-700 rounded-lg hover:bg-neutral-400 transition-colors">
                <span data-ko="ë‹«ê¸°" data-en="Close">ë‹«ê¸°</span>
            </button>
        </div>
    </div>

    <!-- ë„êµ¬ ìƒì„¸ ëª¨ë‹¬ -->
    <div id="tool-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50">
        <div class="bg-white rounded-2xl max-w-4xl w-full m-4 max-h-[90vh] overflow-hidden">
            <div class="p-6 border-b border-neutral-200 flex items-center justify-between">
                <h3 id="tool-modal-title" class="text-2xl font-bold text-neutral-800"><span data-ko="ë„êµ¬" data-en="Tool">ë„êµ¬</span></h3>
                <button onclick="closeToolModal()" class="p-2 hover:bg-neutral-100 rounded-lg transition-colors">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            <div id="tool-modal-content" class="p-6 overflow-y-auto" style="max-height: calc(90vh - 100px);">
                <!-- ë„êµ¬ë³„ ì½˜í…ì¸ ê°€ ì—¬ê¸°ì— ë¡œë“œë©ë‹ˆë‹¤ -->
            </div>
        </div>
    </div>

    <!-- ì–´ë“œë¯¼ ë„êµ¬ ê´€ë¦¬ ëª¨ë‹¬ -->
    <div id="admin-manager-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50">
        <div class="bg-white rounded-2xl max-w-5xl w-full m-4 max-h-[90vh] overflow-hidden">
            <div class="p-6 border-b border-neutral-200 flex items-center justify-between">
                <h3 class="text-2xl font-bold text-neutral-800">
                    <span data-ko="ì–´ë“œë¯¼ ë„êµ¬ ê´€ë¦¬" data-en="Admin Tool Manager">ì–´ë“œë¯¼ ë„êµ¬ ê´€ë¦¬</span>
                </h3>
                <button onclick="closeAdminToolManager()" class="p-2 hover:bg-neutral-100 rounded-lg transition-colors">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            <div class="p-6 overflow-y-auto" style="max-height: calc(90vh - 100px);">
                <!-- ë„êµ¬ ì¶”ê°€ ì„¹ì…˜ -->
                <div class="mb-6 p-4 bg-neutral-50 rounded-lg">
                    <h4 class="font-semibold text-neutral-800 mb-4">
                        <span data-ko="ìƒˆ ë„êµ¬ ì¶”ê°€" data-en="Add New Tool">ìƒˆ ë„êµ¬ ì¶”ê°€</span>
                    </h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-neutral-700 mb-2">
                                <span data-ko="ë„êµ¬ ì´ë¦„" data-en="Tool Name">ë„êµ¬ ì´ë¦„</span>
                            </label>
                            <input type="text" id="new-tool-name" class="form-input" placeholder="ì˜ˆ: ê°€ë§¹ì  ìƒì„±">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-neutral-700 mb-2">
                                <span data-ko="íƒœê·¸" data-en="Tag">íƒœê·¸</span>
                            </label>
                            <input type="text" id="new-tool-tag" class="form-input" placeholder="ì˜ˆ: 3ê°œ ì–´ë“œë¯¼">
                        </div>
                        <div class="md:col-span-2">
                            <label class="block text-sm font-medium text-neutral-700 mb-2">
                                <span data-ko="ì„¤ëª…" data-en="Description">ì„¤ëª…</span>
                            </label>
                            <textarea id="new-tool-desc" class="form-input" rows="2" placeholder="ë„êµ¬ì˜ ê¸°ëŠ¥ì„ ì„¤ëª…í•˜ì„¸ìš”"></textarea>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-neutral-700 mb-2">
                                <span data-ko="ì•„ì´ì½˜ íƒ€ì…" data-en="Icon Type">ì•„ì´ì½˜ íƒ€ì…</span>
                            </label>
                            <select id="new-tool-icon" class="form-input">
                                <option value="plus">â• ì¶”ê°€</option>
                                <option value="refresh">ğŸ”„ ìƒˆë¡œê³ ì¹¨</option>
                                <option value="lock">ğŸ”’ ë³´ì•ˆ</option>
                                <option value="chart">ğŸ“Š ì°¨íŠ¸</option>
                                <option value="settings">âš™ï¸ ì„¤ì •</option>
                                <option value="users">ğŸ‘¥ ì‚¬ìš©ì</option>
                                <option value="store">ğŸª ë§¤ì¥</option>
                                <option value="qr">ğŸ“± QR</option>
                            </select>
                        </div>
                    </div>
                    <button onclick="addAdminTool()" class="btn-primary mt-4">
                        <span data-ko="ë„êµ¬ ì¶”ê°€" data-en="Add Tool">ë„êµ¬ ì¶”ê°€</span>
                    </button>
                </div>

                <!-- ê¸°ì¡´ ë„êµ¬ ëª©ë¡ -->
                <div>
                    <h4 class="font-semibold text-neutral-800 mb-4">
                        <span data-ko="ë“±ë¡ëœ ë„êµ¬ ëª©ë¡" data-en="Registered Tools">ë“±ë¡ëœ ë„êµ¬ ëª©ë¡</span>
                    </h4>
                    <div id="admin-tools-list" class="space-y-2">
                        <!-- ë™ì ìœ¼ë¡œ ë¡œë“œë  ë„êµ¬ ëª©ë¡ -->
                    </div>
                </div>

                <!-- ê¸°ë³¸ê°’ ë³µì› -->
                <div class="mt-6 pt-6 border-t flex justify-between">
                    <button onclick="loadDefaultAdminTools()" class="btn-secondary">
                        <span data-ko="ê¸°ë³¸ê°’ ë³µì›" data-en="Restore Defaults">ê¸°ë³¸ê°’ ë³µì›</span>
                    </button>
                    <button onclick="downloadDefaultConfig()" class="btn-secondary">
                        <span data-ko="ê¸°ë³¸ ì„¤ì • ë‹¤ìš´ë¡œë“œ" data-en="Download Default Config">ê¸°ë³¸ ì„¤ì • ë‹¤ìš´ë¡œë“œ</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ì „ì—­ ë³€ìˆ˜
        let currentTab = 'dashboard';
        let windowRefs = {};
        let currentLanguage = 'ko'; // ê¸°ë³¸ ì–¸ì–´ëŠ” í•œêµ­ì–´
        let notificationHistory = []; // ì•Œë¦¼ íˆìŠ¤í† ë¦¬
        let maxNotifications = 100; // ìµœëŒ€ ì•Œë¦¼ ë³´ê´€ ê°œìˆ˜
        let activityHistory = []; // í™œë™ íˆìŠ¤í† ë¦¬
        let maxActivities = 100; // ìµœëŒ€ í™œë™ ë³´ê´€ ê°œìˆ˜
        const ACTIVITY_STORAGE_KEY = 'ceoplus_activity_history'; // ë¡œì»¬ìŠ¤í† ë¦¬ì§€ í‚¤
        let currentDateRange = 'day'; // í˜„ì¬ ì„ íƒëœ ê¸°ê°„ í•„í„°

        // ë‹¤êµ­ì–´ í…ìŠ¤íŠ¸ ë°ì´í„°
        const translations = {
            ko: {
                // í—¤ë” ë° ë„¤ë¹„ê²Œì´ì…˜
                dashboard: "ëŒ€ì‹œë³´ë“œ",
                adminTools: "ì–´ë“œë¯¼ í™œìš©",
                dataTools: "ë°ì´í„° ìƒì„±", 
                settings: "ì„¤ì •",
                
                // ëŒ€ì‹œë³´ë“œ
                dashboardTitle: "ëŒ€ì‹œë³´ë“œ",
                dashboardDesc: "CEO+ Helpì˜ ì „ì²´ í˜„í™©ì„ í™•ì¸í•˜ì„¸ìš”",
                activeSessions: "í™œì„± ì„¸ì…˜",
                completedTasks: "ì™„ë£Œëœ ì‘ì—…",
                savedTokens: "ì €ì¥ëœ í† í°",
                generatedFiles: "ìƒì„±ëœ íŒŒì¼",
                recentActivities: "ìµœê·¼ í™œë™",
                
                // ì–´ë“œë¯¼ ë„êµ¬
                adminToolsTitle: "ì–´ë“œë¯¼ í™œìš©",
                adminToolsDesc: "ê°€ë§¹ì  ê´€ë¦¬ ë° ì‹œìŠ¤í…œ ìš´ì˜ ë„êµ¬ë“¤",
                
                // ë°ì´í„° ìƒì„± ë„êµ¬
                dataToolsTitle: "ë°ì´í„° ìƒì„± ë„êµ¬",
                dataToolsDesc: "í…ŒìŠ¤íŠ¸ ë°ì´í„° ë° ìƒ˜í”Œ íŒŒì¼ ìƒì„± ë„êµ¬ë“¤",
                
                // ì„¤ì •
                settingsTitle: "ì„¤ì •",
                settingsDesc: "ì‹œìŠ¤í…œ ì„¤ì • ë° í† í° ê´€ë¦¬",
                tokenManagement: "í† í° ê´€ë¦¬",
                systemSettings: "ì‹œìŠ¤í…œ ì„¤ì •",
                systemInfo: "ì‹œìŠ¤í…œ ì •ë³´",
                
                // ì•Œë¦¼ ë° í™œë™
                notifications: "ì•Œë¦¼",
                noNotifications: "ìƒˆë¡œìš´ ì•Œë¦¼ì´ ì—†ìŠµë‹ˆë‹¤",
                clearNotifications: "ëª¨ë“  ì•Œë¦¼ ì§€ìš°ê¸°",
                requestStarted: "ìš”ì²­ ì‹œì‘ë¨",
                requestCompleted: "ìš”ì²­ ì™„ë£Œë¨",
                requestFailed: "ìš”ì²­ ì‹¤íŒ¨",
                
                // ìš”ì²­ íƒ€ì…
                adminToolRequest: "ì–´ë“œë¯¼ ë„êµ¬ ì‹¤í–‰",
                dataGenerationRequest: "ë°ì´í„° ìƒì„±",
                tokenSyncRequest: "í† í° ë™ê¸°í™”",
                cookieManagementRequest: "ì¿ í‚¤ ê´€ë¦¬",
                languageChangeRequest: "ì–¸ì–´ ë³€ê²½",
                
                // ì‹œê°„ í‘œì‹œ
                justNow: "ë°©ê¸ˆ ì „",
                minutesAgo: "ë¶„ ì „",
                hoursAgo: "ì‹œê°„ ì „",
                daysAgo: "ì¼ ì „"
            },
            en: {
                // í—¤ë” ë° ë„¤ë¹„ê²Œì´ì…˜
                dashboard: "Dashboard",
                adminTools: "Admin Tools",
                dataTools: "Data Tools",
                settings: "Settings",
                
                // ëŒ€ì‹œë³´ë“œ
                dashboardTitle: "Dashboard",
                dashboardDesc: "Check the overall status of CEO+ Help",
                activeSessions: "Active Sessions",
                completedTasks: "Completed Tasks", 
                savedTokens: "Saved Tokens",
                generatedFiles: "Generated Files",
                recentActivities: "Recent Activities",
                
                // ì–´ë“œë¯¼ ë„êµ¬
                adminToolsTitle: "Admin Tools",
                adminToolsDesc: "Store management and system operation tools",
                
                // ë°ì´í„° ìƒì„± ë„êµ¬
                dataToolsTitle: "Data Generation Tools",
                dataToolsDesc: "Test data and sample file generation tools",
                
                // ì„¤ì •
                settingsTitle: "Settings",
                settingsDesc: "System settings and token management",
                tokenManagement: "Token Management",
                systemSettings: "System Settings", 
                systemInfo: "System Information",
                
                // ì•Œë¦¼ ë° í™œë™
                notifications: "Notifications",
                noNotifications: "No new notifications",
                clearNotifications: "Clear all notifications",
                requestStarted: "Request started",
                requestCompleted: "Request completed",
                requestFailed: "Request failed",
                
                // ìš”ì²­ íƒ€ì…
                adminToolRequest: "Admin tool execution",
                dataGenerationRequest: "Data generation",
                tokenSyncRequest: "Token synchronization",
                cookieManagementRequest: "Cookie management",
                languageChangeRequest: "Language change",
                
                // ì‹œê°„ í‘œì‹œ
                justNow: "Just now",
                minutesAgo: "min ago",
                hoursAgo: "hr ago",
                daysAgo: "day ago"
            }
        };
        
        // ê¸°ì¡´ ê¸°ëŠ¥ ë°ì´í„°
        const functionData = {
            'qr-create': {
                name: 'ê°€ë§¹ì  ìƒì„± ë° QR í™œì„±í™”',
                admins: [
                    { name: 'ì™€ì¹¸ë‹¤_ì‹ ì²­ì„œ', url: 'https://www.google.com', desc: 'ê°€ë§¹ì  ì‹ ì²­ì„œ ì‘ì„±', isInternal: false },
                    { name: 'ì™€ì¹¸ë‹¤_í™œì„±í™”', url: 'https://www.naver.com', desc: 'ê°€ë§¹ì  í™œì„±í™” ì²˜ë¦¬', isInternal: false },
                    { name: 'ì˜¤í”„ë¼ì¸_QRìƒì„±ìš”ì²­', url: 'https://admin.example.com/qr', desc: 'ì˜¤í”„ë¼ì¸ QR ìƒì„±', isInternal: true }
                ]
            },
            'qr-recovery': {
                name: 'ê°€ë§¹ì  QR ë³µêµ¬',
                admins: [
                    { name: 'QR ê´€ë¦¬', url: 'https://admin.example.com/qr-manage', desc: 'QR ë³µêµ¬', isInternal: true },
                    { name: 'ë¡œê·¸ ê´€ë¦¬', url: 'https://admin.example.com/logs', desc: 'ë¡œê·¸ í™•ì¸', isInternal: true },
                    { name: 'ê°€ë§¹ì  ê´€ë¦¬', url: 'https://www.kakao.com', desc: 'ìƒíƒœ í™•ì¸', isInternal: false }
                ]
            },
            'permission': {
                name: 'ë§¤ì¥ ê¶Œí•œë³€ê²½',
                admins: [
                    { name: 'ê¶Œí•œ ê´€ë¦¬', url: 'https://admin.example.com/permissions', desc: 'ê¶Œí•œ ì„¤ì •', isInternal: true },
                    { name: 'ì‚¬ìš©ì ê´€ë¦¬', url: 'https://admin.example.com/users', desc: 'ì—­í•  ê´€ë¦¬', isInternal: true },
                    { name: 'ê°ì‚¬ ê´€ë¦¬', url: 'https://www.youtube.com', desc: 'ë³€ê²½ ì´ë ¥', isInternal: false }
                ]
            }
        };

        // ëª¨ë°”ì¼ ì‚¬ì´ë“œë°” í† ê¸€
        function toggleMobileSidebar() {
            const sidebar = document.getElementById('mobileSidebar');
            const overlay = document.getElementById('mobileSidebarOverlay');
            
            sidebar.classList.toggle('active');
            overlay.classList.toggle('active');
        }
        
        // ëª¨ë°”ì¼ ì‚¬ì´ë“œë°” ë‹«ê¸°
        function closeMobileSidebar() {
            const sidebar = document.getElementById('mobileSidebar');
            const overlay = document.getElementById('mobileSidebarOverlay');
            
            sidebar.classList.remove('active');
            overlay.classList.remove('active');
        }
        
        // ëª¨ë°”ì¼ì—ì„œ íƒ­ ì „í™˜
        function showTabFromMobile(tabName) {
            showTab(tabName);
            closeMobileSidebar();
        }

        // íƒ­ ì „í™˜ í•¨ìˆ˜
        function showTab(tabName) {
            // ëª¨ë“  íƒ­ ë²„íŠ¼ ë¹„í™œì„±í™”
            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // ëª¨ë“  íƒ­ ì½˜í…ì¸  ìˆ¨ê¸°ê¸°
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.add('hidden');
            });
            
            // ì„ íƒëœ íƒ­ í™œì„±í™”
            const tabButton = document.getElementById(`tab-${tabName}`);
            if (tabButton) {
                tabButton.classList.add('active');
            }
            document.getElementById(`${tabName}-content`).classList.remove('hidden');
            
            // ëª¨ë°”ì¼ ë„¤ë¹„ê²Œì´ì…˜ ì—…ë°ì´íŠ¸
            document.querySelectorAll('.mobile-nav-item').forEach(item => {
                item.classList.remove('active');
                if (item.getAttribute('data-tab') === tabName) {
                    item.classList.add('active');
                }
            });
            
            currentTab = tabName;
            
            // íƒ­ ë³€ê²½ ì‹œ ì¶”ê°€ ë¡œì§
            if (tabName === 'dashboard') {
                updateDashboardStats();
            }
        }

        // ëŒ€ì‹œë³´ë“œ í†µê³„ ì—…ë°ì´íŠ¸
        function updateDashboardStats() {
            // ê¸°ê°„ë³„ í•„í„°ë§
            const now = new Date();
            const filteredActivities = getFilteredActivities(currentDateRange);
            
            // ê³ ìœ  ê¸°ëŠ¥ ì‚¬ìš© ìˆ˜
            const uniqueActions = new Set(filteredActivities.map(a => a.type + ':' + a.action)).size;
            document.getElementById('active-sessions').textContent = uniqueActions;
            
            // ì™„ë£Œëœ ì‘ì—… ìˆ˜
            const completedTasks = filteredActivities.filter(a => a.status === 'completed').length;
            document.getElementById('completed-tasks').textContent = completedTasks;
            
            // í˜„ì¬ ì €ì¥ëœ í† í° ìˆ˜ (ì‹¤ì œ í† í° ì²´í¬)
            updateTokenStatus();
            
            // ìƒì„±ëœ íŒŒì¼ ìˆ˜
            const generatedFiles = filteredActivities.filter(a => a.type === 'data-generation' && a.status === 'completed').length;
            document.getElementById('file-count').textContent = generatedFiles;
            
            // ìµœê·¼ í™œë™ ì—…ë°ì´íŠ¸
            updateRecentActivities();
        }
        
        // ê¸°ê°„ë³„ í™œë™ í•„í„°ë§
        function getFilteredActivities(range) {
            const now = new Date();
            const startDate = new Date();
            
            switch(range) {
                case 'day':
                    startDate.setHours(0, 0, 0, 0);
                    break;
                case 'week':
                    startDate.setDate(now.getDate() - 7);
                    break;
                case 'month':
                    startDate.setMonth(now.getMonth() - 1);
                    break;
                case 'year':
                    startDate.setFullYear(now.getFullYear() - 1);
                    break;
            }
            
            return activityHistory.filter(a => new Date(a.timestamp) >= startDate);
        }
        
        // ë‚ ì§œ ë²”ìœ„ ë³€ê²½
        function changeDateRange(range) {
            currentDateRange = range;
            
            // ë²„íŠ¼ ìŠ¤íƒ€ì¼ ì—…ë°ì´íŠ¸
            document.querySelectorAll('[id^="range-"]').forEach(btn => {
                btn.classList.remove('bg-primary-100', 'text-primary-800', 'font-medium');
                btn.classList.add('hover:bg-neutral-100');
            });
            
            const activeBtn = document.getElementById(`range-${range}`);
            activeBtn.classList.add('bg-primary-100', 'text-primary-800', 'font-medium');
            activeBtn.classList.remove('hover:bg-neutral-100');
            
            // í†µê³„ ì—…ë°ì´íŠ¸
            updateDashboardStats();
        }
        
        // í™œë™ ê¸°ë¡ ì‚­ì œ
        function clearActivityHistory() {
            if (confirm(currentLanguage === 'ko' ? 'ëª¨ë“  í™œë™ ê¸°ë¡ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?' : 'Delete all activity history?')) {
                activityHistory = [];
                saveActivityHistory();
                updateDashboardStats();
                showToast(currentLanguage === 'ko' ? 'í™œë™ ê¸°ë¡ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤' : 'Activity history cleared', 'success');
            }
        }

        // ìµœê·¼ í™œë™ ì—…ë°ì´íŠ¸
        function updateRecentActivities() {
            const container = document.getElementById('recent-activities');
            if (!container) return;
            
            // ì‹œê°„ ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬ í›„ ìµœê·¼ 5ê°œë§Œ
            const recentActivities = activityHistory
                .sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp))
                .slice(0, 5);
            
            if (recentActivities.length === 0) {
                container.innerHTML = `
                    <div class="text-center text-neutral-500 py-8">
                        <svg class="w-12 h-12 mx-auto mb-3 text-neutral-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path>
                        </svg>
                        <p class="text-sm">${currentLanguage === 'ko' ? 'ìµœê·¼ í™œë™ì´ ì—†ìŠµë‹ˆë‹¤' : 'No recent activities'}</p>
                    </div>
                `;
                return;
            }
            
            let activitiesHTML = '';
            recentActivities.forEach(activity => {
                const timeAgo = getTimeAgo(activity.timestamp);
                const statusColor = getActivityColor(activity.type);
                const typeIcon = getActivityIcon(activity.type);
                
                activitiesHTML += `
                    <div class="flex items-center space-x-4 p-3 bg-neutral-50 rounded-lg">
                        <div class="w-8 h-8 ${statusColor} rounded-full flex items-center justify-center">
                            ${typeIcon}
                        </div>
                        <div class="flex-1">
                            <p class="font-medium text-neutral-800">
                                ${activity.action}
                            </p>
                            <p class="text-sm text-neutral-600">${timeAgo}</p>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = activitiesHTML;
        }

        // ì–´ë“œë¯¼ ë„êµ¬ ì—´ê¸°
        function openAdminTool(toolId) {
            const toolData = functionData[toolId];
            if (!toolData) return;
            
            document.getElementById('tool-modal-title').textContent = toolData.name;
            
            let adminListHTML = '<div class="space-y-4">';
            toolData.admins.forEach((admin, index) => {
                adminListHTML += `
                    <div class="card p-4 cursor-pointer hover:shadow-lg transition-all" onclick="openAdminUrl('${admin.url}', '${admin.name}', ${admin.isInternal})">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center space-x-4">
                                <div class="w-10 h-10 bg-primary-100 rounded-lg flex items-center justify-center">
                                    <span class="font-bold text-primary-600">${index + 1}</span>
                                </div>
                                <div>
                                    <h4 class="font-medium text-neutral-800">${admin.name}</h4>
                                    <p class="text-sm text-neutral-600">${admin.desc}</p>
                                    <p class="text-xs text-neutral-400 mt-1">${admin.url}</p>
                                </div>
                            </div>
                            <div class="flex items-center space-x-2">
                                ${admin.isInternal ? '<span class="bg-yellow-100 text-yellow-800 text-xs px-2 py-1 rounded">ë‚´ë¶€</span>' : '<span class="bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded">ì™¸ë¶€</span>'}
                                <svg class="w-5 h-5 text-neutral-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                                </svg>
                            </div>
                        </div>
                    </div>
                `;
            });
            adminListHTML += '</div>';
            
            document.getElementById('tool-modal-content').innerHTML = adminListHTML;
            document.getElementById('tool-modal').classList.remove('hidden');
        }

        // ì–´ë“œë¯¼ URL ì—´ê¸°
        function openAdminUrl(url, name, isInternal) {
            try {
                // í™œë™ ê¸°ë¡
                logActivity('admin-tool', `${name} ì–´ë“œë¯¼ ì—´ê¸°`, 'started');
                
                if (isInternal) {
                    const msg = currentLanguage === 'ko' ? `${name} ë„êµ¬ë¥¼ ìƒˆ ì°½ì—ì„œ ì—½ë‹ˆë‹¤` : `Opening ${name} tool in new window`;
                    showToast(msg, 'success');
                }
                
                const windowName = 'admin_' + name.replace(/\s/g, '_');
                const win = window.open(url, windowName, 'width=1200,height=800,menubar=yes,toolbar=yes,location=yes,status=yes,scrollbars=yes,resizable=yes');
                
                if (win) {
                    windowRefs[windowName] = win;
                    
                    // í™œë™ ê¸°ë¡ - ì™„ë£Œ
                    logActivity('admin-tool', `${name} ì–´ë“œë¯¼ ì—´ê¸°`, 'completed');
                    const msg = currentLanguage === 'ko' ? `${name}ì´(ê°€) ìƒˆ ì°½ì—ì„œ ì—´ë ¸ìŠµë‹ˆë‹¤` : `${name} opened in new window`;
                    showToast(msg, 'success');
                } else {
                    // í™œë™ ê¸°ë¡ - ì‹¤íŒ¨
                    logActivity('admin-tool', `${name} ì–´ë“œë¯¼ ì—´ê¸°`, 'failed');
                    const msg = currentLanguage === 'ko' ? 'íŒì—…ì´ ì°¨ë‹¨ë˜ì—ˆìŠµë‹ˆë‹¤. íŒì—… í—ˆìš© í›„ ë‹¤ì‹œ ì‹œë„í•˜ì„¸ìš”' : 'Popup blocked. Please allow popups and try again';
                    showToast(msg, 'error');
                }
            } catch (error) {
                console.error('ì–´ë“œë¯¼ ë„êµ¬ ì‹¤í–‰ ì˜¤ë¥˜:', error);
                logActivity('admin-tool', `${name} ì–´ë“œë¯¼ ì—´ê¸°`, 'failed');
                showToast(currentLanguage === 'ko' ? 'ë„êµ¬ ì‹¤í–‰ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤' : 'Error running tool', 'error');
            }
        }

        // ë°ì´í„° ë„êµ¬ ì—´ê¸°
        function openDataTool(toolId) {
            let title, content;
            
            switch(toolId) {
                case 'sample-image':
                    title = 'ìƒ˜í”Œ ì´ë¯¸ì§€ ìƒì„±ê¸°';
                    content = getSampleImageGeneratorHTML();
                    break;
                case 'qr-xlsx':
                    title = 'QR XLSX ìƒì„±ê¸°';
                    content = getQRXlsxGeneratorHTML();
                    break;
                case 'csv-generator':
                    title = 'CSV ìƒì„±ê¸°';
                    content = getCsvGeneratorHTML();
                    break;
                case 'profile-generator':
                    title = currentLanguage === 'ko' ? 'í”„ë¡œí•„ ì´ë¯¸ì§€ ìƒì„±ê¸°' : 'Profile Image Generator';
                    content = getProfileGeneratorHTML();
                    break;
                case 'env-badge':
                    title = currentLanguage === 'ko' ? 'í™˜ê²½ ë±ƒì§€ ìƒì„±ê¸°' : 'Environment Badge Generator';
                    content = getEnvBadgeGeneratorHTML();
                    break;
                case 'business-number':
                    title = currentLanguage === 'ko' ? 'ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸ ìƒì„±ê¸°' : 'Business Number Generator';
                    content = getBusinessNumberGeneratorHTML();
                    break;
                default:
                    title = 'ë„êµ¬';
                    content = '<p class="text-center text-neutral-500">ë„êµ¬ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>';
            }
            
            document.getElementById('tool-modal-title').textContent = title;
            document.getElementById('tool-modal-content').innerHTML = content;
            document.getElementById('tool-modal').classList.remove('hidden');
            
            // ìƒ˜í”Œ ì´ë¯¸ì§€ ìƒì„±ê¸°ì¸ ê²½ìš° ì´ˆê¸° ì´ë¯¸ì§€ ìƒì„±
            if (toolId === 'sample-image') {
                setTimeout(generateSampleImage, 100);
            }
            // í”„ë¡œí•„ ìƒì„±ê¸°ì¸ ê²½ìš° ì´ˆê¸° í”„ë¦¬ë·°
            if (toolId === 'profile-generator') {
                setTimeout(generateProfilePreview, 100);
            }
            // í™˜ê²½ ë±ƒì§€ ìƒì„±ê¸°ì¸ ê²½ìš° ì´ˆê¸° í”„ë¦¬ë·°
            if (toolId === 'env-badge') {
                setTimeout(generateEnvBadgePreview, 100);
            }
            // ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸ ìƒì„±ê¸° ì´ˆê¸°í™”
            if (toolId === 'business-number') {
                setTimeout(() => {
                    window.generatedBusinessNumbers = [];
                }, 100);
            }
        }

        // ëª¨ë‹¬ ë‹«ê¸°
        function closeToolModal() {
            document.getElementById('tool-modal').classList.add('hidden');
        }

        // í† ìŠ¤íŠ¸ ë©”ì‹œì§€ í‘œì‹œ
        function showToast(message, type = 'success') {
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.innerHTML = `
                <div class="flex items-center">
                    <div class="flex-1">
                        <p class="font-medium text-neutral-800">${message}</p>
                    </div>
                    <button onclick="this.parentElement.parentElement.remove()" class="ml-4 text-neutral-400 hover:text-neutral-600">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
            `;
            
            document.body.appendChild(toast);
            
            setTimeout(() => {
                if (toast.parentNode) {
                    toast.remove();
                }
            }, 5000);
        }

        // ì–¸ì–´ ë³€ê²½ í•¨ìˆ˜
        function toggleLanguage() {
            try {
                const oldLang = currentLanguage;
                const newLang = currentLanguage === 'ko' ? 'en' : 'ko';
                
                // í™œë™ ê¸°ë¡
                logActivity('settings', `ì–¸ì–´ ë³€ê²½: ${oldLang.toUpperCase()} â†’ ${newLang.toUpperCase()}`, 'completed');
                
                // ì•Œë¦¼ ì¶”ê°€ - ì‹œì‘
                addNotification('language-change', `${oldLang.toUpperCase()} â†’ ${newLang.toUpperCase()}`, 'started');
                
                currentLanguage = newLang;
                updateLanguageUI();
                updateAllTexts();
                
                // localStorageì— ì–¸ì–´ ì„¤ì • ì €ì¥
                localStorage.setItem('preferred-language', currentLanguage);
                
                // ì•Œë¦¼ ì¶”ê°€ - ì™„ë£Œ
                addNotification('language-change', `${oldLang.toUpperCase()} â†’ ${newLang.toUpperCase()}`, 'completed');
                
                const langText = currentLanguage === 'ko' ? 'í•œêµ­ì–´' : 'English';
                const message = currentLanguage === 'ko' ? `ì–¸ì–´ê°€ ${langText}ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤` : `Language changed to ${langText}`;
                showToast(message, 'success');
            } catch (error) {
                console.error('ì–¸ì–´ ë³€ê²½ ì˜¤ë¥˜:', error);
                addNotification('language-change', 'Language toggle', 'failed', error.message);
                showToast(currentLanguage === 'ko' ? 'ì–¸ì–´ ë³€ê²½ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤' : 'Error changing language', 'error');
            }
        }

        // ì–¸ì–´ ì„ íƒ UI ì—…ë°ì´íŠ¸
        function updateLanguageUI() {
            const currentLangEl = document.getElementById('current-lang');
            const otherLangEl = document.getElementById('other-lang');
            
            if (currentLanguage === 'ko') {
                currentLangEl.textContent = 'KOR';
                currentLangEl.className = 'text-black';
                otherLangEl.textContent = 'ENG';
                otherLangEl.className = 'text-black opacity-50';
            } else {
                currentLangEl.textContent = 'ENG';
                currentLangEl.className = 'text-black';
                otherLangEl.textContent = 'KOR';
                otherLangEl.className = 'text-black opacity-50';
            }
        }

        // ëª¨ë“  í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
        function updateAllTexts() {
            const t = translations[currentLanguage];
            
            // íƒ­ í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
            document.querySelectorAll('.tab-text').forEach(el => {
                const key = currentLanguage === 'ko' ? el.getAttribute('data-ko') : el.getAttribute('data-en');
                if (key) el.textContent = key;
            });
            
            // í˜ì´ì§€ ì œëª©ë“¤ ì—…ë°ì´íŠ¸
            updateElementText('dashboard-title', t.dashboardTitle);
            updateElementText('dashboard-desc', t.dashboardDesc);
            updateElementText('admin-tools-title', t.adminToolsTitle);  
            updateElementText('admin-tools-desc', t.adminToolsDesc);
            updateElementText('data-tools-title', t.dataToolsTitle);
            updateElementText('data-tools-desc', t.dataToolsDesc);
            updateElementText('settings-title', t.settingsTitle);
            updateElementText('settings-desc', t.settingsDesc);
            
            // í†µê³„ ì¹´ë“œ í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
            updateElementText('active-sessions-label', t.activeSessions);
            updateElementText('completed-tasks-label', t.completedTasks);
            updateElementText('saved-tokens-label', t.savedTokens);
            updateElementText('generated-files-label', t.generatedFiles);
            updateElementText('recent-activities-title', t.recentActivities);
            
            // ì„¤ì • ì„¹ì…˜ í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
            updateElementText('token-management-title', t.tokenManagement);
            updateElementText('system-settings-title', t.systemSettings);
            updateElementText('system-info-title', t.systemInfo);
        }

        // ê°œë³„ ìš”ì†Œ í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸ í—¬í¼ í•¨ìˆ˜
        function updateElementText(id, text) {
            const element = document.getElementById(id);
            if (element) {
                element.textContent = text;
            }
        }

        // ì•Œë¦¼ íˆìŠ¤í† ë¦¬ì— í•­ëª© ì¶”ê°€
        function addNotification(type, action, status, details = null) {
            const notification = {
                id: Date.now() + Math.random(),
                type: type, // 'admin-tool', 'data-generation', 'token-sync', 'cookie-management', 'language-change'
                action: action, // êµ¬ì²´ì ì¸ ì•¡ì…˜ëª…
                status: status, // 'started', 'completed', 'failed'
                details: details, // ì¶”ê°€ ì •ë³´
                timestamp: new Date(),
                read: false
            };
            
            notificationHistory.unshift(notification);
            
            // ìµœëŒ€ ê°œìˆ˜ ì´ˆê³¼ ì‹œ ì˜¤ë˜ëœ ì•Œë¦¼ ì œê±°
            if (notificationHistory.length > maxNotifications) {
                notificationHistory = notificationHistory.slice(0, maxNotifications);
            }
            
            // localStorageì— ì €ì¥
            localStorage.setItem('notificationHistory', JSON.stringify(notificationHistory));
            
            // ì•Œë¦¼ ë°°ì§€ ì—…ë°ì´íŠ¸
            updateNotificationBadge();
            
            // ëŒ€ì‹œë³´ë“œê°€ í™œì„±í™”ë˜ì–´ ìˆìœ¼ë©´ ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸
            if (currentTab === 'dashboard') {
                updateRecentActivities();
            }
        }

        // ì•Œë¦¼ ë°°ì§€ ì—…ë°ì´íŠ¸
        function updateNotificationBadge() {
            const badge = document.getElementById('notification-badge');
            const unreadCount = notificationHistory.filter(n => !n.read).length;
            
            if (unreadCount > 0) {
                badge.textContent = unreadCount > 99 ? '99+' : unreadCount;
                badge.classList.remove('hidden');
            } else {
                badge.classList.add('hidden');
            }
        }

        // ì•Œë¦¼ ëª©ë¡ í‘œì‹œ (í˜„ì¬ëŠ” ìµœê·¼ í™œë™ìœ¼ë¡œ ì´ë™)
        function showNotifications() {
            // ëŒ€ì‹œë³´ë“œì˜ ìµœê·¼ í™œë™ìœ¼ë¡œ ì´ë™
            showTab('dashboard');
            setTimeout(() => {
                const recentSection = document.querySelector('#recent-activities-title');
                if (recentSection) {
                    recentSection.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }
            }, 100);
        }
        
        // ì›ë˜ ì•Œë¦¼ í•¨ìˆ˜ (í•„ìš”ì‹œ ì‚¬ìš©)
        function showNotificationsOld() {
            const t = translations[currentLanguage];
            
            // ëª¨ë“  ì•Œë¦¼ì„ ì½ìŒìœ¼ë¡œ í‘œì‹œ
            notificationHistory.forEach(n => n.read = true);
            localStorage.setItem('notificationHistory', JSON.stringify(notificationHistory));
            updateNotificationBadge();
            
            let notificationHTML = `
                <div class="fixed inset-0 bg-black bg-opacity-50 flex items-start justify-end z-50 pt-16 pr-4" onclick="closeNotifications()">
                    <div class="bg-white rounded-2xl w-96 max-h-96 overflow-hidden shadow-2xl" onclick="event.stopPropagation()">
                        <div class="p-4 border-b border-neutral-200 flex items-center justify-between">
                            <h3 class="text-lg font-bold text-neutral-800">${t.notifications}</h3>
                            <div class="flex items-center space-x-2">
                                <button onclick="clearAllNotifications()" class="text-xs px-3 py-1 bg-neutral-100 hover:bg-neutral-200 rounded-md text-neutral-600 transition-colors">
                                    ${t.clearNotifications}
                                </button>
                                <button onclick="closeNotifications()" class="p-1 hover:bg-neutral-100 rounded transition-colors">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                    </svg>
                                </button>
                            </div>
                        </div>
                        <div class="overflow-y-auto max-h-80">
            `;
            
            if (notificationHistory.length === 0) {
                notificationHTML += `
                    <div class="p-8 text-center text-neutral-500">
                        <svg class="w-12 h-12 mx-auto mb-3 text-neutral-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18 8A6 6 0 006 8c0 7-3 9-3 9h18s-3-2-3-9z"></path>
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m13.73 21a2 2 0 01-3.46 0"></path>
                        </svg>
                        <p>${t.noNotifications}</p>
                    </div>
                `;
            } else {
                notificationHistory.forEach(notification => {
                    const timeAgo = getTimeAgo(notification.timestamp);
                    const statusColor = getStatusColor(notification.status);
                    const statusIcon = getStatusIcon(notification.status);
                    const typeIcon = getTypeIcon(notification.type);
                    
                    notificationHTML += `
                        <div class="p-4 border-b border-neutral-100 hover:bg-neutral-50 transition-colors">
                            <div class="flex items-start space-x-3">
                                <div class="w-8 h-8 ${statusColor} rounded-full flex items-center justify-center flex-shrink-0">
                                    ${typeIcon}
                                </div>
                                <div class="flex-1 min-w-0">
                                    <p class="font-medium text-neutral-800 text-sm">
                                        ${getActionDisplayName(notification.type, notification.action)}
                                    </p>
                                    <div class="flex items-center space-x-2 mt-1">
                                        <span class="text-xs ${statusColor.replace('bg-', 'text-').replace('-100', '-600')} font-medium">
                                            ${statusIcon} ${getStatusDisplayName(notification.status)}
                                        </span>
                                        <span class="text-xs text-neutral-500">${timeAgo}</span>
                                    </div>
                                    ${notification.details ? `<p class="text-xs text-neutral-500 mt-1">${notification.details}</p>` : ''}
                                </div>
                            </div>
                        </div>
                    `;
                });
            }
            
            notificationHTML += `
                        </div>
                    </div>
                </div>
            `;
            
            // ì•Œë¦¼ íŒ¨ë„ í‘œì‹œ
            const existingPanel = document.getElementById('notification-panel');
            if (existingPanel) {
                existingPanel.remove();
            }
            
            const panel = document.createElement('div');
            panel.id = 'notification-panel';
            panel.innerHTML = notificationHTML;
            document.body.appendChild(panel);
        }

        // ì•Œë¦¼ íŒ¨ë„ ë‹«ê¸°
        function closeNotifications() {
            const panel = document.getElementById('notification-panel');
            if (panel) {
                panel.remove();
            }
        }

        // ëª¨ë“  ì•Œë¦¼ ì§€ìš°ê¸°
        function clearAllNotifications() {
            if (confirm(currentLanguage === 'ko' ? 'ëª¨ë“  ì•Œë¦¼ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?' : 'Are you sure you want to clear all notifications?')) {
                notificationHistory = [];
                localStorage.removeItem('notificationHistory');
                updateNotificationBadge();
                closeNotifications();
                updateRecentActivities();
                showToast(currentLanguage === 'ko' ? 'ëª¨ë“  ì•Œë¦¼ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤' : 'All notifications cleared', 'success');
            }
        }

        // í™œë™ íˆìŠ¤í† ë¦¬ ê´€ë¦¬ í•¨ìˆ˜ë“¤
        function loadActivityHistory() {
            const saved = localStorage.getItem(ACTIVITY_STORAGE_KEY);
            if (saved) {
                try {
                    activityHistory = JSON.parse(saved);
                    // ë‚ ì§œ ê°ì²´ ë³µì›
                    activityHistory.forEach(a => {
                        a.timestamp = new Date(a.timestamp);
                    });
                } catch (e) {
                    console.error('í™œë™ íˆìŠ¤í† ë¦¬ ë¡œë“œ ì‹¤íŒ¨:', e);
                    activityHistory = [];
                }
            }
        }
        
        function saveActivityHistory() {
            try {
                // ìµœëŒ€ ê°œìˆ˜ ì œí•œ
                if (activityHistory.length > maxActivities) {
                    activityHistory = activityHistory.slice(-maxActivities);
                }
                localStorage.setItem(ACTIVITY_STORAGE_KEY, JSON.stringify(activityHistory));
            } catch (e) {
                console.error('í™œë™ íˆìŠ¤í† ë¦¬ ì €ì¥ ì‹¤íŒ¨:', e);
            }
        }
        
        // í™œë™ ê¸°ë¡ í•¨ìˆ˜
        function logActivity(type, action, status = 'completed') {
            const activity = {
                id: Date.now() + '_' + Math.random().toString(36).substr(2, 9),
                type: type,
                action: action,
                status: status,
                timestamp: new Date(),
                language: currentLanguage
            };
            
            activityHistory.push(activity);
            saveActivityHistory();
            
            // ëŒ€ì‹œë³´ë“œì— ìˆìœ¼ë©´ ì—…ë°ì´íŠ¸
            if (currentTab === 'dashboard') {
                updateDashboardStats();
            }
        }
        
        // í™œë™ ì•„ì´ì½˜ ê°€ì ¸ì˜¤ê¸°
        function getActivityIcon(type) {
            const icons = {
                'admin-tool': '<svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.096 2.572-1.065z"></path></svg>',
                'data-generation': '<svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>',
                'token-sync': '<svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"></path></svg>',
                'settings': '<svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 100-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 100-4m0 4v2m0-6V4"></path></svg>',
                'system': '<svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path></svg>'
            };
            return icons[type] || '<svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>';
        }
        
        // í™œë™ ìƒ‰ìƒ ê°€ì ¸ì˜¤ê¸°
        function getActivityColor(type) {
            const colors = {
                'admin-tool': 'bg-primary-500',
                'data-generation': 'bg-green-500',
                'token-sync': 'bg-blue-500',
                'settings': 'bg-purple-500',
                'system': 'bg-gray-500'
            };
            return colors[type] || 'bg-neutral-500';
        }

        // ì‹œê°„ í‘œì‹œ í•¨ìˆ˜
        function getTimeAgo(timestamp) {
            const t = translations[currentLanguage];
            const now = new Date();
            const diffMs = now - new Date(timestamp);
            const diffMinutes = Math.floor(diffMs / (1000 * 60));
            const diffHours = Math.floor(diffMs / (1000 * 60 * 60));
            const diffDays = Math.floor(diffMs / (1000 * 60 * 60 * 24));
            
            if (diffMinutes < 1) return t.justNow;
            if (diffMinutes < 60) return `${diffMinutes}${t.minutesAgo}`;
            if (diffHours < 24) return `${diffHours}${t.hoursAgo}`;
            return `${diffDays}${t.daysAgo}`;
        }

        // ìƒíƒœë³„ ìƒ‰ìƒ ë°˜í™˜
        function getStatusColor(status) {
            switch (status) {
                case 'started': return 'bg-blue-100';
                case 'completed': return 'bg-green-100';
                case 'failed': return 'bg-red-100';
                default: return 'bg-neutral-100';
            }
        }

        // ìƒíƒœë³„ ì•„ì´ì½˜ ë°˜í™˜
        function getStatusIcon(status) {
            switch (status) {
                case 'started': return 'â³';
                case 'completed': return 'âœ…';
                case 'failed': return 'âŒ';
                default: return 'â„¹ï¸';
            }
        }

        // íƒ€ì…ë³„ ì•„ì´ì½˜ ë°˜í™˜
        function getTypeIcon(type) {
            switch (type) {
                case 'admin-tool': return '<svg class="w-4 h-4 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.096 2.572-1.065z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>';
                case 'data-generation': return '<svg class="w-4 h-4 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>';
                case 'token-sync': return '<svg class="w-4 h-4 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1721 9z"></path></svg>';
                case 'cookie-management': return '<svg class="w-4 h-4 text-orange-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 100-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 100-4m0 4v2m0-6V4"></path></svg>';
                case 'language-change': return '<svg class="w-4 h-4 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5h12M9 3v2m1.048 9.5A18.022 18.022 0 016.412 9m6.088 9h7M11 21l5-10 5 10M12.751 5C11.783 10.77 8.07 15.61 3 18.129"></path></svg>';
                default: return '<svg class="w-4 h-4 text-neutral-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>';
            }
        }

        // ì•¡ì…˜ëª… í‘œì‹œ í•¨ìˆ˜
        function getActionDisplayName(type, action) {
            const t = translations[currentLanguage];
            
            // íƒ€ì…ë³„ ê¸°ë³¸ ì´ë¦„
            let baseName = '';
            switch (type) {
                case 'admin-tool': baseName = t.adminToolRequest; break;
                case 'data-generation': baseName = t.dataGenerationRequest; break;
                case 'token-sync': baseName = t.tokenSyncRequest; break;
                case 'cookie-management': baseName = t.cookieManagementRequest; break;
                case 'language-change': baseName = t.languageChangeRequest; break;
                default: baseName = action;
            }
            
            // êµ¬ì²´ì ì¸ ì•¡ì…˜ëª…ì´ ìˆìœ¼ë©´ ì¡°í•©
            if (action && action !== type) {
                return `${baseName}: ${action}`;
            }
            
            return baseName;
        }

        // ìƒíƒœëª… í‘œì‹œ í•¨ìˆ˜
        function getStatusDisplayName(status) {
            const t = translations[currentLanguage];
            switch (status) {
                case 'started': return t.requestStarted;
                case 'completed': return t.requestCompleted;
                case 'failed': return t.requestFailed;
                default: return status;
            }
        }

        // í† í° ê´€ë¦¬ í•¨ìˆ˜ë“¤
        function getStoredTokens() {
            const tokens = { localStorage: {}, sessionStorage: {}, cookies: {} };
            
            try {
                for (let i = 0; i < localStorage.length; i++) {
                    const key = localStorage.key(i);
                    if (key && (key.includes('token') || key.includes('auth') || key.includes('session'))) {
                        tokens.localStorage[key] = localStorage.getItem(key);
                    }
                }
                
                for (let i = 0; i < sessionStorage.length; i++) {
                    const key = sessionStorage.key(i);
                    if (key && (key.includes('token') || key.includes('auth') || key.includes('session'))) {
                        tokens.sessionStorage[key] = sessionStorage.getItem(key);
                    }
                }
                
                const cookies = getAllCookies();
                Object.entries(cookies).forEach(([name, value]) => {
                    if (name.includes('token') || name.includes('auth') || name.includes('session')) {
                        tokens.cookies[name] = value;
                    }
                });
            } catch (error) {
                console.error('í† í° ì¡°íšŒ ì˜¤ë¥˜:', error);
            }
            
            return tokens;
        }

        function getAllCookies() {
            const cookies = {};
            document.cookie.split(';').forEach(cookie => {
                const [name, value] = cookie.trim().split('=');
                if (name) cookies[name] = value || '';
            });
            return cookies;
        }

        function syncTokens() {
            try {
                const tokens = getStoredTokens();
                const tokenCount = Object.keys(tokens.localStorage).length + 
                                   Object.keys(tokens.sessionStorage).length + 
                                   Object.keys(tokens.cookies).length;
                
                console.log('ë™ê¸°í™”í•  í† í°:', tokens);
                
                let syncedWindows = 0;
                Object.values(windowRefs).forEach(win => {
                    if (win && !win.closed) {
                        try {
                            win.postMessage({ type: 'SYNC_TOKENS', tokens: tokens }, '*');
                            syncedWindows++;
                        } catch (e) {
                            console.log('í† í° ì „ì†¡ ì‹¤íŒ¨:', e);
                        }
                    }
                });
                
                logActivity('token-sync', `í† í° ${tokenCount}ê°œ ë™ê¸°í™” (${syncedWindows}ê°œ ì°½)`, 'completed');
                const msg = currentLanguage === 'ko' ? `í† í° ${tokenCount}ê°œê°€ ë™ê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤` : `${tokenCount} tokens synchronized`;
                showToast(msg, 'success');
                updateTokenStatus();
            } catch (error) {
                console.error('í† í° ë™ê¸°í™” ì˜¤ë¥˜:', error);
                logActivity('token-sync', 'í† í° ë™ê¸°í™” ì‹¤íŒ¨', 'failed');
                showToast(currentLanguage === 'ko' ? 'í† í° ë™ê¸°í™” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤' : 'Error synchronizing tokens', 'error');
            }
        }

        function updateTokenStatus() {
            try {
                const tokens = getStoredTokens();
                const totalCount = Object.keys(tokens.localStorage).length + Object.keys(tokens.sessionStorage).length + Object.keys(tokens.cookies).length;
                
                const statusEl = document.getElementById('token-status-detail');
                if (statusEl) {
                    if (totalCount > 0) {
                        const foundText = currentLanguage === 'ko' ? `âœ… í† í° ${totalCount}ê°œ ë°œê²¬` : `âœ… ${totalCount} tokens found`;
                        statusEl.innerHTML = `${foundText} (Local: ${Object.keys(tokens.localStorage).length}, Session: ${Object.keys(tokens.sessionStorage).length}, Cookie: ${Object.keys(tokens.cookies).length})`;
                    } else {
                        statusEl.innerHTML = currentLanguage === 'ko' ? 'âŒ í† í° ì—†ìŒ' : 'âŒ No tokens';
                    }
                }
                
                // ëŒ€ì‹œë³´ë“œ í† í° ì¹´ìš´íŠ¸ ì—…ë°ì´íŠ¸
                const tokenCountEl = document.getElementById('token-count');
                if (tokenCountEl) {
                    tokenCountEl.textContent = totalCount;
                }
                
                return totalCount;
            } catch (error) {
                console.error('í† í° ìƒíƒœ ì—…ë°ì´íŠ¸ ì˜¤ë¥˜:', error);
                const statusEl = document.getElementById('token-status-detail');
                if (statusEl) {
                    statusEl.innerHTML = currentLanguage === 'ko' ? 'âŒ ì˜¤ë¥˜ ë°œìƒ' : 'âŒ Error occurred';
                }
                return 0;
            }
        }

        function exportTokens() {
            try {
                const tokens = getStoredTokens();
                const dataStr = JSON.stringify(tokens, null, 2);
                const dataBlob = new Blob([dataStr], {type: 'application/json'});
                
                const link = document.createElement('a');
                link.href = URL.createObjectURL(dataBlob);
                link.download = `tokens_${new Date().toISOString().split('T')[0]}.json`;
                link.click();
                
                showToast(currentLanguage === 'ko' ? 'í† í° ì •ë³´ê°€ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤' : 'Token information downloaded', 'success');
            } catch (error) {
                console.error('í† í° ë‚´ë³´ë‚´ê¸° ì˜¤ë¥˜:', error);
                showToast(currentLanguage === 'ko' ? 'í† í° ë‚´ë³´ë‚´ê¸° ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤' : 'Error exporting tokens', 'error');
            }
        }

        // ì¿ í‚¤ ê´€ë¦¬ í•¨ìˆ˜ë“¤
        function showCookieModal() {
            document.getElementById('cookie-modal').classList.remove('hidden');
            updateCookieList();
        }

        function closeCookieModal() {
            document.getElementById('cookie-modal').classList.add('hidden');
        }

        function updateCookieList() {
            const cookies = getAllCookies();
            const cookieList = document.getElementById('cookie-list');
            
            if (Object.keys(cookies).length === 0) {
                cookieList.textContent = currentLanguage === 'ko' ? 'ì¿ í‚¤ê°€ ì—†ìŠµë‹ˆë‹¤.' : 'No cookies.';
            } else {
                cookieList.innerHTML = Object.entries(cookies)
                    .map(([name, value]) => `<div class="mb-1"><strong>${name}</strong> = ${value}</div>`)
                    .join('');
            }
        }

        function addCookie() {
            const input = document.getElementById('cookie-input').value.trim();
            if (!input) {
                showToast(currentLanguage === 'ko' ? 'ì¿ í‚¤ ì •ë³´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”' : 'Please enter cookie information', 'error');
                return;
            }
            
            try {
                // ì•Œë¦¼ ì¶”ê°€ - ì‹œì‘
                addNotification('cookie-management', 'ì¿ í‚¤ ì¶”ê°€', 'started', input);
                
                const parts = input.split(';').map(p => p.trim());
                const [name, value] = parts[0].split('=');
                
                if (!name) {
                    addNotification('cookie-management', 'ì¿ í‚¤ ì¶”ê°€', 'failed', 'ì¿ í‚¤ ì´ë¦„ì´ í•„ìš”í•©ë‹ˆë‹¤');
                    showToast(currentLanguage === 'ko' ? 'ì¿ í‚¤ ì´ë¦„ì´ í•„ìš”í•©ë‹ˆë‹¤' : 'Cookie name is required', 'error');
                    return;
                }
                
                document.cookie = input;
                updateCookieList();
                document.getElementById('cookie-input').value = '';
                
                // ì•Œë¦¼ ì¶”ê°€ - ì™„ë£Œ
                addNotification('cookie-management', 'ì¿ í‚¤ ì¶”ê°€', 'completed', `${name} ì¿ í‚¤ ì¶”ê°€ë¨`);
                showToast(currentLanguage === 'ko' ? 'ì¿ í‚¤ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤' : 'Cookie added', 'success');
            } catch (e) {
                console.error('ì¿ í‚¤ ì¶”ê°€ ì˜¤ë¥˜:', e);
                addNotification('cookie-management', 'ì¿ í‚¤ ì¶”ê°€', 'failed', e.message);
                showToast(currentLanguage === 'ko' ? 'ì˜¬ë°”ë¥¸ ì¿ í‚¤ í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤' : 'Invalid cookie format', 'error');
            }
        }

        // ìƒ˜í”Œ ì´ë¯¸ì§€ ìƒì„±ê¸° HTML
        function getSampleImageGeneratorHTML() {
            return `
                <div class="space-y-6">
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-neutral-700 mb-2">ì´ë¯¸ì§€ í¬ê¸°</label>
                                <select id="sample-imageSize" class="form-input">
                                    <option value="100x100">100x100</option>
                                    <option value="200x200">200x200</option>
                                    <option value="400x400" selected>400x400</option>
                                    <option value="800x600">800x600</option>
                                    <option value="1920x1080">1920x1080</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-neutral-700 mb-2">ë°°ê²½ìƒ‰</label>
                                <input type="color" id="sample-bgColor" value="#f0f0f0" class="form-input h-12">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-neutral-700 mb-2">í…ìŠ¤íŠ¸</label>
                                <input type="text" id="sample-imageText" value="Sample Image" class="form-input">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-neutral-700 mb-2">ìƒì„±í•  ì´ë¯¸ì§€ ê°œìˆ˜</label>
                                <input type="number" id="sample-imageCount" value="5" min="1" max="100" class="form-input">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-neutral-700 mb-2">ì´ë¯¸ì§€ í¬ë§·</label>
                                <div class="space-y-2">
                                    <label class="flex items-center">
                                        <input type="checkbox" name="imageFormat" value="PNG" checked class="mr-2">
                                        <span>PNG</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" name="imageFormat" value="JPG" checked class="mr-2">
                                        <span>JPG</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" name="imageFormat" value="WEBP" class="mr-2">
                                        <span>WEBP</span>
                                    </label>
                                </div>
                            </div>
                            <button onclick="generateSampleImage()" class="btn-primary w-full">
                                ì´ë¯¸ì§€ ìƒì„±í•˜ê¸°
                            </button>
                        </div>
                        <div>
                            <div class="border-2 border-dashed border-neutral-300 rounded-lg p-6 bg-neutral-50 min-h-64 flex items-center justify-center">
                                <canvas id="sample-canvas" class="border border-neutral-200 rounded shadow-sm"></canvas>
                            </div>
                            <button id="sample-downloadBtn" onclick="downloadSampleImage()" class="btn-secondary w-full mt-4" disabled>
                                ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }

        // QR XLSX ìƒì„±ê¸° HTML
        function getQRXlsxGeneratorHTML() {
            return `
                <div class="space-y-6">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-neutral-700 mb-2">CID</label>
                            <input type="text" id="qr-cid" value="" placeholder="ë¹ˆê°’" class="form-input">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-neutral-700 mb-2">TID</label>
                            <input type="text" id="qr-tid" value="" placeholder="ë¹ˆê°’" class="form-input">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-neutral-700 mb-2">ì§€ì—­ì½”ë“œ</label>
                            <input type="text" id="qr-region" value="JEJU" class="form-input">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-neutral-700 mb-2">VAN</label>
                            <input type="text" id="qr-van" value="KIS" class="form-input">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-neutral-700 mb-2">íœ´ëŒ€í°ë²ˆí˜¸</label>
                            <input type="text" id="qr-phone" value="01025710628" class="form-input">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-neutral-700 mb-2">ë¹„ê³ </label>
                            <input type="text" id="qr-remark" value="" placeholder="ë¹ˆê°’" class="form-input">
                        </div>
                    </div>
                    
                    <button onclick="generateQRXlsx()" class="btn-primary">QR XLSX íŒŒì¼ ìƒì„±</button>
                    
                    <div id="qr-preview" class="mt-6 p-4 border border-primary-200 rounded-lg bg-primary-50 hidden">
                        <h4 class="font-medium text-primary-800 mb-2">ìƒì„± ì™„ë£Œ!</h4>
                        <p class="text-primary-700">XLSX íŒŒì¼ì´ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤.</p>
                    </div>
                </div>
            `;
        }

        // CSV ìƒì„±ê¸° HTML
        function getCsvGeneratorHTML() {
            return `
                <div class="space-y-6">
                    <div>
                        <label class="block text-sm font-medium text-neutral-700 mb-2">ìƒì„±í•  í–‰ ìˆ˜</label>
                        <input type="number" id="csv-rowCount" value="10" min="1" max="1000" class="form-input max-w-xs">
                    </div>

                    <div class="space-y-4">
                        <h4 class="text-lg font-medium text-neutral-800">ì—´ ì„¤ì •</h4>
                        
                        <!-- 1ì—´ -->
                        <div class="card p-4">
                            <div class="flex items-center justify-between mb-3">
                                <span class="font-medium">1ì—´ (í•„ìˆ˜)</span>
                            </div>
                            <div class="space-y-3">
                                <label class="flex items-center">
                                    <input type="radio" name="col1Type" value="random" checked class="mr-2">
                                    <span>í…ìŠ¤íŠ¸ ì…ë ¥</span>
                                </label>
                                <input type="text" id="col1-text" placeholder="í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”" class="form-input">
                                <label class="flex items-center">
                                    <input type="radio" name="col1Type" value="custom" class="mr-2">
                                    <span>ë‚œìˆ˜ë°œìƒ</span>
                                </label>
                            </div>
                        </div>

                        <!-- 2ì—´ -->
                        <div class="card p-4">
                            <div class="flex items-center justify-between mb-3">
                                <span class="font-medium">2ì—´ í¬í•¨</span>
                                <label class="flex items-center">
                                    <input type="checkbox" id="col2-enable" checked class="mr-2" onchange="toggleCsvColumn(2)">
                                    <span>ì‚¬ìš©</span>
                                </label>
                            </div>
                            <div class="space-y-3" id="col2-options">
                                <label class="flex items-center">
                                    <input type="radio" name="col2Type" value="random" checked class="mr-2">
                                    <span>í…ìŠ¤íŠ¸ ì…ë ¥</span>
                                </label>
                                <input type="text" id="col2-text" placeholder="í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”" class="form-input">
                                <label class="flex items-center">
                                    <input type="radio" name="col2Type" value="custom" class="mr-2">
                                    <span>ë‚œìˆ˜ë°œìƒ</span>
                                </label>
                            </div>
                        </div>

                        <!-- 3ì—´ -->
                        <div class="card p-4">
                            <div class="flex items-center justify-between mb-3">
                                <span class="font-medium">3ì—´ í¬í•¨</span>
                                <label class="flex items-center">
                                    <input type="checkbox" id="col3-enable" class="mr-2" onchange="toggleCsvColumn(3)">
                                    <span>ì‚¬ìš©</span>
                                </label>
                            </div>
                            <div class="space-y-3 hidden" id="col3-options">
                                <label class="flex items-center">
                                    <input type="radio" name="col3Type" value="random" checked class="mr-2">
                                    <span>í…ìŠ¤íŠ¸ ì…ë ¥</span>
                                </label>
                                <input type="text" id="col3-text" placeholder="í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”" class="form-input">
                                <label class="flex items-center">
                                    <input type="radio" name="col3Type" value="custom" class="mr-2">
                                    <span>ë‚œìˆ˜ë°œìƒ</span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <button onclick="generateCsvFile()" class="btn-primary">CSV ë¯¸ë¦¬ë³´ê¸°</button>

                    <div id="csv-preview" class="hidden">
                        <h4 class="text-lg font-medium text-neutral-800 mb-4">CSV ë¯¸ë¦¬ë³´ê¸°</h4>
                        <div class="overflow-auto max-h-64 border border-neutral-200 rounded-lg">
                            <table class="min-w-full">
                                <thead class="bg-neutral-100">
                                    <tr>
                                        <th class="border border-neutral-300 px-4 py-2">1ì—´</th>
                                        <th class="border border-neutral-300 px-4 py-2">2ì—´</th>
                                        <th class="border border-neutral-300 px-4 py-2">3ì—´</th>
                                    </tr>
                                </thead>
                                <tbody id="csv-preview-body">
                                </tbody>
                            </table>
                        </div>
                        <button onclick="downloadCsv()" class="btn-secondary mt-4">
                            CSV ë‹¤ìš´ë¡œë“œ
                        </button>
                    </div>
                </div>
            `;
        }

        // ìƒ˜í”Œ ì´ë¯¸ì§€ ìƒì„± í•¨ìˆ˜ë“¤ (ê¸°ì¡´ í•¨ìˆ˜ë“¤ ì´ì–´ì„œ ì‚¬ìš©)
        function generateSampleImage() {
            try {
                // ì•Œë¦¼ ì¶”ê°€ - ì‹œì‘
                logActivity('data-generation', 'ìƒ˜í”Œ ì´ë¯¸ì§€ ìƒì„± ì‹œì‘', 'started');
                
                const size = document.getElementById('sample-imageSize').value;
                const [width, height] = size.split('x').map(Number);
                const bgColor = document.getElementById('sample-bgColor').value;
                const text = document.getElementById('sample-imageText').value;
                const count = parseInt(document.getElementById('sample-imageCount').value) || 1;

                const formats = [];
                document.querySelectorAll('input[name="imageFormat"]:checked').forEach(el => {
                    formats.push(el.value);
                });

                if (formats.length === 0) {
                    logActivity('data-generation', 'ìƒ˜í”Œ ì´ë¯¸ì§€ ìƒì„± ì‹¤íŒ¨', 'failed');
                    showToast(currentLanguage === 'ko' ? 'ìµœì†Œ í•˜ë‚˜ì˜ ì´ë¯¸ì§€ í¬ë§·ì„ ì„ íƒí•´ì£¼ì„¸ìš”' : 'Please select at least one image format', 'error');
                    return;
                }

                const canvas = document.getElementById('sample-canvas');
                const ctx = canvas.getContext('2d');

                canvas.width = width;
                canvas.height = height;
                canvas.style.maxWidth = '100%';
                canvas.style.height = 'auto';

                ctx.fillStyle = bgColor;
                ctx.fillRect(0, 0, width, height);

                ctx.fillStyle = '#333333';
                ctx.font = Math.max(16, width/20) + 'px Arial';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText(text, width/2, height/2 - Math.max(20, width/20));

                ctx.font = Math.max(40, width/10) + 'px Arial';
                ctx.fillText('1', width/2, height/2 + Math.max(20, width/20));

                ctx.font = Math.max(12, width/30) + 'px Arial';
                ctx.fillText(width + ' Ã— ' + height, width/2, height - Math.max(20, width/30));

                window.sampleImageSettings = { width, height, bgColor, text, count, formats };
                document.getElementById('sample-downloadBtn').disabled = false;
                
                // ì•Œë¦¼ ì¶”ê°€ - ì™„ë£Œ
                logActivity('data-generation', `ìƒ˜í”Œ ì´ë¯¸ì§€ ${count}ê°œ ìƒì„± (${size})`, 'completed');
                showToast(currentLanguage === 'ko' ? 'ì´ë¯¸ì§€ ìƒì„± ì™„ë£Œ' : 'Image generation complete', 'success');
            } catch (error) {
                console.error('ì´ë¯¸ì§€ ìƒì„± ì˜¤ë¥˜:', error);
                logActivity('data-generation', 'ìƒ˜í”Œ ì´ë¯¸ì§€ ìƒì„± ì‹¤íŒ¨', 'failed');
                showToast(currentLanguage === 'ko' ? 'ì´ë¯¸ì§€ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤' : 'Error generating image', 'error');
            }
        }

        function downloadSampleImage() {
            try {
                const settings = window.sampleImageSettings;
                if (!settings) {
                    showToast(currentLanguage === 'ko' ? 'ë¨¼ì € ì´ë¯¸ì§€ë¥¼ ìƒì„±í•´ì£¼ì„¸ìš”' : 'Please generate an image first', 'error');
                    return;
                }

                const { width, height, bgColor, text, count, formats } = settings;
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');

                canvas.width = width;
                canvas.height = height;

                for (let i = 1; i <= count; i++) {
                    ctx.fillStyle = bgColor;
                    ctx.fillRect(0, 0, width, height);

                    ctx.fillStyle = '#333333';
                    ctx.font = Math.max(16, width/20) + 'px Arial';
                    ctx.textAlign = 'center';
                    ctx.textBaseline = 'middle';
                    ctx.fillText(text, width/2, height/2 - Math.max(20, width/20));

                    ctx.font = Math.max(40, width/10) + 'px Arial';
                    ctx.fillText(i.toString(), width/2, height/2 + Math.max(20, width/20));

                    ctx.font = Math.max(12, width/30) + 'px Arial';
                    ctx.fillText(width + ' Ã— ' + height, width/2, height - Math.max(20, width/30));

                    formats.forEach(format => {
                        const link = document.createElement('a');
                        const ext = format.toLowerCase();
                        const timestamp = new Date().toISOString().replace(/[:.]/g, '-').slice(0, -5);
                        link.download = `sample-image_${timestamp}_${i}.${ext}`;

                        if (ext === 'jpg' || ext === 'jpeg') {
                            link.href = canvas.toDataURL('image/jpeg', 0.9);
                        } else if (ext === 'webp') {
                            link.href = canvas.toDataURL('image/webp', 0.9);
                        } else {
                            link.href = canvas.toDataURL('image/png');
                        }

                        link.click();
                    });
                }

                const msg = currentLanguage === 'ko' ? `${count}ê°œ ì´ë¯¸ì§€ Ã— ${formats.length}ê°œ í¬ë§· = ì´ ${count * formats.length}ê°œ íŒŒì¼ ë‹¤ìš´ë¡œë“œ ì™„ë£Œ` : `${count} images Ã— ${formats.length} formats = ${count * formats.length} files downloaded`;
                showToast(msg, 'success');
            } catch (error) {
                console.error('ë‹¤ìš´ë¡œë“œ ì˜¤ë¥˜:', error);
                showToast(currentLanguage === 'ko' ? 'ë‹¤ìš´ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤' : 'Error during download', 'error');
            }
        }

        // QR XLSX ìƒì„± í•¨ìˆ˜
        function generateQRXlsx() {
            try {
                const cid = document.getElementById('qr-cid').value || '';
                const tid = document.getElementById('qr-tid').value || '';
                const region = document.getElementById('qr-region').value || 'JEJU';
                const van = document.getElementById('qr-van').value || 'KIS';
                const phone = document.getElementById('qr-phone').value || '01025710628';
                const remark = document.getElementById('qr-remark').value || '';

                const data = [
                    ['cid', 'tid', 'ì§€ì—­ì½”ë“œ', 'van', 'íœ´ëŒ€í°ë²ˆí˜¸', 'ë¹„ê³ '],
                    [cid, tid, region, van, phone, remark]
                ];

                const ws = XLSX.utils.aoa_to_sheet(data);
                const wb = XLSX.utils.book_new();
                XLSX.utils.book_append_sheet(wb, ws, 'QR_Data');
                const timestamp = new Date().toISOString().split('T')[0];
                const cidPart = cid ? `_${cid}` : '';
                XLSX.writeFile(wb, `QR_Data${cidPart}_${timestamp}.xlsx`);

                document.getElementById('qr-preview').classList.remove('hidden');
                showToast(currentLanguage === 'ko' ? 'QR XLSX íŒŒì¼ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤' : 'QR XLSX file generated', 'success');
            } catch (error) {
                console.error('XLSX ìƒì„± ì˜¤ë¥˜:', error);
                showToast(currentLanguage === 'ko' ? 'XLSX íŒŒì¼ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤' : 'Error generating XLSX file', 'error');
            }
        }

        // CSV ìƒì„± í•¨ìˆ˜ë“¤
        function toggleCsvColumn(columnNumber) {
            const options = document.getElementById(`col${columnNumber}-options`);
            const checkbox = document.getElementById(`col${columnNumber}-enable`);

            if (checkbox && options) {
                if (checkbox.checked) {
                    options.classList.remove('hidden');
                } else {
                    options.classList.add('hidden');
                }
            }
        }

        function generateRandomString() {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
            let result = '';
            for (let i = 0; i < 10; i++) {
                result += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return result;
        }

        let csvData = [];

        function generateCsvFile() {
            try {
                const rowCount = parseInt(document.getElementById('csv-rowCount').value);

                if (rowCount <= 0 || rowCount > 1000) {
                    showToast(currentLanguage === 'ko' ? 'í–‰ ìˆ˜ëŠ” 1~1000 ë²”ìœ„ë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”' : 'Please enter row count between 1-1000', 'error');
                    return;
                }

                const col2Enabled = document.getElementById('col2-enable').checked;
                const col3Enabled = document.getElementById('col3-enable').checked;

                csvData = [];

                for (let i = 0; i < rowCount; i++) {
                    const row = [];

                    // 1ì—´
                    const col1Type = document.querySelector('input[name="col1Type"]:checked').value;
                    if (col1Type === 'random') {
                        const col1Text = document.getElementById('col1-text').value || 'Data';
                        row.push(col1Text);
                    } else {
                        row.push(generateRandomString());
                    }

                    // 2ì—´
                    if (col2Enabled) {
                        const col2Type = document.querySelector('input[name="col2Type"]:checked').value;
                        if (col2Type === 'random') {
                            const col2Text = document.getElementById('col2-text').value || 'Data';
                            row.push(col2Text);
                        } else {
                            row.push(generateRandomString());
                        }
                    }

                    // 3ì—´
                    if (col3Enabled) {
                        const col3Type = document.querySelector('input[name="col3Type"]:checked').value;
                        if (col3Type === 'random') {
                            const col3Text = document.getElementById('col3-text').value || 'Data';
                            row.push(col3Text);
                        } else {
                            row.push(generateRandomString());
                        }
                    }

                    csvData.push(row);
                }

                displayCsvPreview();
                showToast(currentLanguage === 'ko' ? 'CSV ë¯¸ë¦¬ë³´ê¸°ê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤' : 'CSV preview generated', 'success');
            } catch (error) {
                console.error('CSV ìƒì„± ì˜¤ë¥˜:', error);
                showToast(currentLanguage === 'ko' ? 'CSV íŒŒì¼ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤' : 'Error generating CSV file', 'error');
            }
        }

        function displayCsvPreview() {
            const previewDiv = document.getElementById('csv-preview');
            const tbody = document.getElementById('csv-preview-body');

            if (!tbody) {
                previewDiv.classList.remove('hidden');
                return;
            }

            tbody.innerHTML = '';

            const previewRows = Math.min(10, csvData.length);
            for (let i = 0; i < previewRows; i++) {
                const tr = document.createElement('tr');
                csvData[i].forEach(cell => {
                    const td = document.createElement('td');
                    td.className = 'border border-neutral-300 px-4 py-2';
                    td.textContent = cell;
                    tr.appendChild(td);
                });
                tbody.appendChild(tr);
            }

            if (csvData.length > 10) {
                const tr = document.createElement('tr');
                const td = document.createElement('td');
                td.colSpan = csvData[0].length;
                td.className = 'border border-neutral-300 px-4 py-2 text-center text-neutral-500';
                td.textContent = `... ì™¸ ${csvData.length - 10}ê°œ í–‰`;
                tr.appendChild(td);
                tbody.appendChild(tr);
            }

            previewDiv.classList.remove('hidden');
        }

        function downloadCsv() {
            if (csvData.length === 0) {
                showToast(currentLanguage === 'ko' ? 'ë¨¼ì € CSVë¥¼ ìƒì„±í•´ì£¼ì„¸ìš”' : 'Please generate CSV first', 'error');
                return;
            }

            let csvContent = '';
            csvData.forEach(row => {
                csvContent += row.join(',') + '\n';
            });

            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            const timestamp = new Date().toISOString().replace(/[:.]/g, '-').slice(0, -5);
            const rowCount = csvData.length;
            link.setAttribute('download', `custom_data_${rowCount}rows_${timestamp}.csv`);
            link.click();

            showToast(currentLanguage === 'ko' ? 'CSV íŒŒì¼ì´ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤' : 'CSV file downloaded', 'success');
        }

        // ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', function() {
            // ì €ì¥ëœ ì–¸ì–´ ì„¤ì • ë¶ˆëŸ¬ì˜¤ê¸°
            const savedLanguage = localStorage.getItem('preferred-language');
            if (savedLanguage && (savedLanguage === 'ko' || savedLanguage === 'en')) {
                currentLanguage = savedLanguage;
            }
            
            // í™œë™ íˆìŠ¤í† ë¦¬ ë¶ˆëŸ¬ì˜¤ê¸°
            loadActivityHistory();
            
            // ì´ˆê¸° UI ì„¤ì •
            updateLanguageUI();
            updateAllTexts();
            updateTokenStatus();
            updateDashboardStats();
            updateRecentActivities();
            
            // ì£¼ê¸°ì ìœ¼ë¡œ í† í° ìƒíƒœ ì—…ë°ì´íŠ¸ (ìë™ ê°±ì‹  ì—†ìŒ)
            // setInterval(updateTokenStatus, 30000); // ì£¼ì„ ì²˜ë¦¬
            
            console.log('CEO+ Help v2.1 - ì‹œìŠ¤í…œ ì‹œì‘');
        });

        // ë©”ì‹œì§€ ìˆ˜ì‹  ì²˜ë¦¬
        window.addEventListener('message', function(event) {
            try {
                if (event.data && event.data.type === 'REQUEST_TOKENS') {
                    const tokens = getStoredTokens();
                    event.source.postMessage({
                        type: 'SYNC_TOKENS',
                        tokens: tokens
                    }, event.origin);
                }
            } catch (error) {
                console.error('ë©”ì‹œì§€ ì²˜ë¦¬ ì˜¤ë¥˜:', error);
            }
        });

        // ì—ëŸ¬ ì „ì—­ ì²˜ë¦¬
        window.addEventListener('error', function(event) {
            console.error('ì „ì—­ ì—ëŸ¬:', event.error);
            showToast(currentLanguage === 'ko' ? 'ì˜ˆìƒì¹˜ ëª»í•œ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤' : 'An unexpected error occurred', 'error');
        });

        // í”„ë¡œí•„ ì´ë¯¸ì§€ ìƒì„±ê¸° HTML
        function getProfileGeneratorHTML() {
            return `
                <div class="space-y-6">
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-neutral-700 mb-2">${currentLanguage === 'ko' ? 'ë©”ì¸ í…ìŠ¤íŠ¸' : 'Main Text'}</label>
                                <input type="text" id="profile-mainText" value="PQA|1247" placeholder="${currentLanguage === 'ko' ? 'í…ìŠ¤íŠ¸ ì…ë ¥ (| ë¡œ ì¤„ë°”ê¿ˆ)' : 'Enter text (| for line break)'}" class="form-input" oninput="generateProfilePreview()">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-neutral-700 mb-2">${currentLanguage === 'ko' ? 'í…ìŠ¤íŠ¸ í¬ê¸°' : 'Text Size'}</label>
                                <input type="range" id="profile-textSize" min="50" max="200" value="120" class="w-full" oninput="document.getElementById('profile-textSizeLabel').textContent = this.value; generateProfilePreview()">
                                <span id="profile-textSizeLabel" class="text-sm text-neutral-600">120</span>
                            </div>
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-neutral-700 mb-2">${currentLanguage === 'ko' ? 'ë°°ê²½ìƒ‰' : 'Background'}</label>
                                    <input type="color" id="profile-bgColor" value="#4a5568" class="form-input h-12 w-full" onchange="generateProfilePreview()">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-neutral-700 mb-2">${currentLanguage === 'ko' ? 'í…ìŠ¤íŠ¸ ìƒ‰' : 'Text Color'}</label>
                                    <input type="color" id="profile-textColor" value="#ffffff" class="form-input h-12 w-full" onchange="generateProfilePreview()">
                                </div>
                            </div>
                            
                            <div class="border-t pt-4">
                                <h4 class="font-medium text-neutral-800 mb-3">${currentLanguage === 'ko' ? 'í™˜ê²½ ì¹© ì„¤ì •' : 'Environment Chip Settings'}</h4>
                                <div class="mb-3">
                                    <label class="block text-sm font-medium text-neutral-700 mb-2">${currentLanguage === 'ko' ? 'ì¹© í…ìŠ¤íŠ¸ í¬ê¸°' : 'Chip Text Size'}</label>
                                    <input type="range" id="chip-textSize" min="8" max="20" value="12" class="w-full" oninput="updateChipSizeLabel()">
                                    <span id="chip-textSizeLabel" class="text-sm text-neutral-600">12px</span>
                                </div>
                                <div class="grid grid-cols-2 gap-3">
                                    <!-- ì¢Œìƒë‹¨ ì¹© -->
                                    <div class="p-3 border rounded">
                                        <label class="flex items-center mb-2">
                                            <input type="checkbox" id="chip-tl-enabled" class="mr-2" onchange="generateProfilePreview()">
                                            <span class="text-sm">${currentLanguage === 'ko' ? 'ì¢Œìƒë‹¨' : 'Top-Left'}</span>
                                        </label>
                                        <input type="text" id="chip-tl-text" placeholder="QA" class="form-input text-xs mb-1" oninput="generateProfilePreview()">
                                        <div class="flex gap-1">
                                            <input type="color" id="chip-tl-bg" value="#ff6b6b" class="w-full h-8" onchange="generateProfilePreview()">
                                            <input type="color" id="chip-tl-color" value="#ffffff" class="w-full h-8" onchange="generateProfilePreview()">
                                        </div>
                                    </div>
                                    <!-- ìš°ìƒë‹¨ ì¹© -->
                                    <div class="p-3 border rounded">
                                        <label class="flex items-center mb-2">
                                            <input type="checkbox" id="chip-tr-enabled" class="mr-2" onchange="generateProfilePreview()">
                                            <span class="text-sm">${currentLanguage === 'ko' ? 'ìš°ìƒë‹¨' : 'Top-Right'}</span>
                                        </label>
                                        <input type="text" id="chip-tr-text" placeholder="STAGE" class="form-input text-xs mb-1" oninput="generateProfilePreview()">
                                        <div class="flex gap-1">
                                            <input type="color" id="chip-tr-bg" value="#4ecdc4" class="w-full h-8" onchange="generateProfilePreview()">
                                            <input type="color" id="chip-tr-color" value="#ffffff" class="w-full h-8" onchange="generateProfilePreview()">
                                        </div>
                                    </div>
                                    <!-- ì¢Œí•˜ë‹¨ ì¹© -->
                                    <div class="p-3 border rounded">
                                        <label class="flex items-center mb-2">
                                            <input type="checkbox" id="chip-bl-enabled" class="mr-2" onchange="generateProfilePreview()">
                                            <span class="text-sm">${currentLanguage === 'ko' ? 'ì¢Œí•˜ë‹¨' : 'Bottom-Left'}</span>
                                        </label>
                                        <input type="text" id="chip-bl-text" placeholder="TEST" class="form-input text-xs mb-1" oninput="generateProfilePreview()">
                                        <div class="flex gap-1">
                                            <input type="color" id="chip-bl-bg" value="#f7b731" class="w-full h-8" onchange="generateProfilePreview()">
                                            <input type="color" id="chip-bl-color" value="#ffffff" class="w-full h-8" onchange="generateProfilePreview()">
                                        </div>
                                    </div>
                                    <!-- ìš°í•˜ë‹¨ ì¹© -->
                                    <div class="p-3 border rounded">
                                        <label class="flex items-center mb-2">
                                            <input type="checkbox" id="chip-br-enabled" class="mr-2" onchange="generateProfilePreview()">
                                            <span class="text-sm">${currentLanguage === 'ko' ? 'ìš°í•˜ë‹¨' : 'Bottom-Right'}</span>
                                        </label>
                                        <input type="text" id="chip-br-text" placeholder="v2.0" class="form-input text-xs mb-1" oninput="generateProfilePreview()">
                                        <div class="flex gap-1">
                                            <input type="color" id="chip-br-bg" value="#5f27cd" class="w-full h-8" onchange="generateProfilePreview()">
                                            <input type="color" id="chip-br-color" value="#ffffff" class="w-full h-8" onchange="generateProfilePreview()">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <button onclick="generateProfilePreview()" class="btn-primary w-full">
                                ${currentLanguage === 'ko' ? 'í”„ë¡œí•„ ìƒì„±í•˜ê¸°' : 'Generate Profile'}
                            </button>
                        </div>
                        
                        <div>
                            <div class="border-2 border-dashed border-neutral-300 rounded-lg p-6 bg-neutral-50 min-h-64 flex items-center justify-center">
                                <canvas id="profile-canvas" width="300" height="300" class="border border-neutral-200 rounded shadow-sm"></canvas>
                            </div>
                            <button onclick="downloadProfileImage()" class="btn-secondary w-full mt-4">
                                ${currentLanguage === 'ko' ? 'ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ (1080x1080)' : 'Download Image (1080x1080)'}
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }

        // í™˜ê²½ ë±ƒì§€ ìƒì„±ê¸° HTML
        function getEnvBadgeGeneratorHTML() {
            return `
                <div class="space-y-6">
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-neutral-700 mb-2">${currentLanguage === 'ko' ? 'í™˜ê²½ ì„ íƒ' : 'Select Environment'}</label>
                                <select id="badge-env" class="form-input" onchange="updateBadgePreset()">
                                    <option value="dev">Development</option>
                                    <option value="qa">QA/Test</option>
                                    <option value="stage">Staging</option>
                                    <option value="prod">Production</option>
                                    <option value="custom">${currentLanguage === 'ko' ? 'ì»¤ìŠ¤í…€' : 'Custom'}</option>
                                </select>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-neutral-700 mb-2">${currentLanguage === 'ko' ? 'ë±ƒì§€ í…ìŠ¤íŠ¸' : 'Badge Text'}</label>
                                <input type="text" id="badge-text" value="DEV" class="form-input">
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-neutral-700 mb-2">${currentLanguage === 'ko' ? 'ë±ƒì§€ ìŠ¤íƒ€ì¼' : 'Badge Style'}</label>
                                <div class="space-y-2">
                                    <label class="flex items-center">
                                        <input type="radio" name="badgeStyle" value="rounded" checked class="mr-2">
                                        <span>${currentLanguage === 'ko' ? 'ë‘¥ê·¼ ëª¨ì„œë¦¬' : 'Rounded'}</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="radio" name="badgeStyle" value="square" class="mr-2">
                                        <span>${currentLanguage === 'ko' ? 'ì‚¬ê°í˜•' : 'Square'}</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="radio" name="badgeStyle" value="circle" class="mr-2">
                                        <span>${currentLanguage === 'ko' ? 'ì›í˜•' : 'Circle'}</span>
                                    </label>
                                </div>
                            </div>
                            
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-neutral-700 mb-2">${currentLanguage === 'ko' ? 'ë°°ê²½ìƒ‰' : 'Background'}</label>
                                    <input type="color" id="badge-bgColor" value="#ff6b6b" class="form-input h-12 w-full">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-neutral-700 mb-2">${currentLanguage === 'ko' ? 'í…ìŠ¤íŠ¸ ìƒ‰' : 'Text Color'}</label>
                                    <input type="color" id="badge-textColor" value="#ffffff" class="form-input h-12 w-full">
                                </div>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-neutral-700 mb-2">${currentLanguage === 'ko' ? 'í¬ê¸°' : 'Size'}</label>
                                <div class="grid grid-cols-3 gap-2">
                                    <button class="btn-secondary" onclick="setBadgeSize('small')">${currentLanguage === 'ko' ? 'ì‘ê²Œ' : 'Small'}</button>
                                    <button class="btn-secondary" onclick="setBadgeSize('medium')">${currentLanguage === 'ko' ? 'ë³´í†µ' : 'Medium'}</button>
                                    <button class="btn-secondary" onclick="setBadgeSize('large')">${currentLanguage === 'ko' ? 'í¬ê²Œ' : 'Large'}</button>
                                </div>
                            </div>
                            
                            <button onclick="generateEnvBadgePreview()" class="btn-primary w-full">
                                ${currentLanguage === 'ko' ? 'ë±ƒì§€ ìƒì„±í•˜ê¸°' : 'Generate Badge'}
                            </button>
                        </div>
                        
                        <div>
                            <div class="border-2 border-dashed border-neutral-300 rounded-lg p-6 bg-neutral-50 min-h-64 flex items-center justify-center">
                                <canvas id="badge-canvas" width="200" height="200" class="border border-neutral-200 rounded shadow-sm"></canvas>
                            </div>
                            <div class="mt-4 space-y-2">
                                <button onclick="downloadBadgeImage('png')" class="btn-secondary w-full">
                                    ${currentLanguage === 'ko' ? 'PNGë¡œ ë‹¤ìš´ë¡œë“œ' : 'Download as PNG'}
                                </button>
                                <button onclick="downloadBadgeImage('svg')" class="btn-primary w-full">
                                    ${currentLanguage === 'ko' ? 'SVGë¡œ ë‹¤ìš´ë¡œë“œ' : 'Download as SVG'}
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // ì¹© í…ìŠ¤íŠ¸ í¬ê¸° ë ˆì´ë¸” ì—…ë°ì´íŠ¸
        function updateChipSizeLabel() {
            const size = document.getElementById('chip-textSize').value;
            document.getElementById('chip-textSizeLabel').textContent = size + 'px';
            generateProfilePreview();
        }

        // í”„ë¡œí•„ ì´ë¯¸ì§€ ìƒì„± í•¨ìˆ˜
        function generateProfilePreview() {
            try {
                const canvas = document.getElementById('profile-canvas');
                if (!canvas) {
                    console.log('Canvas not found');
                    return;
                }
                
                const ctx = canvas.getContext('2d');
                const mainText = document.getElementById('profile-mainText')?.value || 'PROFILE';
                const textSize = parseInt(document.getElementById('profile-textSize')?.value || 120);
                const bgColor = document.getElementById('profile-bgColor')?.value || '#4a5568';
                const textColor = document.getElementById('profile-textColor')?.value || '#ffffff';
                const chipTextSize = parseInt(document.getElementById('chip-textSize')?.value || 12);
                
                // í…ìŠ¤íŠ¸ í¬ê¸° ë ˆì´ë¸” ì—…ë°ì´íŠ¸
                const textSizeLabel = document.getElementById('profile-textSizeLabel');
                if (textSizeLabel) {
                    textSizeLabel.textContent = textSize;
                }
                
                // ìº”ë²„ìŠ¤ ì´ˆê¸°í™”
                ctx.fillStyle = bgColor;
                ctx.fillRect(0, 0, 300, 300);
                
                // ë©”ì¸ í…ìŠ¤íŠ¸ ê·¸ë¦¬ê¸°
                ctx.save();
                ctx.fillStyle = textColor;
                ctx.font = `bold ${textSize}px Arial`;
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                
                const lines = mainText.split('|');
                const lineHeight = textSize * 1.2;
                const startY = 150 - ((lines.length - 1) * lineHeight) / 2;
                
                lines.forEach((line, index) => {
                    ctx.fillText(line.trim(), 150, startY + (index * lineHeight));
                });
                ctx.restore();
                
                // ì¹© ê·¸ë¦¬ê¸°
                const chips = [
                    { id: 'tl', x: 10, y: 10, align: 'left', vAlign: 'top' },
                    { id: 'tr', x: 290, y: 10, align: 'right', vAlign: 'top' },
                    { id: 'bl', x: 10, y: 290, align: 'left', vAlign: 'bottom' },
                    { id: 'br', x: 290, y: 290, align: 'right', vAlign: 'bottom' }
                ];
                
                chips.forEach(chip => {
                    const enabledEl = document.getElementById(`chip-${chip.id}-enabled`);
                    const textEl = document.getElementById(`chip-${chip.id}-text`);
                    const bgEl = document.getElementById(`chip-${chip.id}-bg`);
                    const colorEl = document.getElementById(`chip-${chip.id}-color`);
                    
                    console.log(`Checking chip ${chip.id}:`, {
                        enabled: enabledEl?.checked,
                        text: textEl?.value,
                        hasElements: !!(enabledEl && textEl && bgEl && colorEl)
                    });
                    
                    if (enabledEl && enabledEl.checked && textEl && bgEl && colorEl) {
                        // Use input value or placeholder as fallback
                        const text = textEl.value.trim() || textEl.getAttribute('placeholder') || '';
                        const bg = bgEl.value || '#ff6b6b';
                        const color = colorEl.value || '#ffffff';
                        
                        console.log(`Drawing chip ${chip.id}:`, { text, bg, color, placeholder: textEl.getAttribute('placeholder') });
                        
                        if (text) {
                            ctx.save();
                            
                            // ì¹© í…ìŠ¤íŠ¸ ì„¤ì •
                            ctx.font = `bold ${chipTextSize}px Arial`;
                            const metrics = ctx.measureText(text);
                            const padding = chipTextSize * 0.8;
                            const chipWidth = metrics.width + padding * 2;
                            const chipHeight = chipTextSize * 2;
                            
                            let chipX = chip.x;
                            let chipY = chip.y;
                            
                            // ì •ë ¬ ì²˜ë¦¬
                            if (chip.align === 'right') {
                                chipX = chip.x - chipWidth;
                            }
                            
                            if (chip.vAlign === 'bottom') {
                                chipY = chip.y - chipHeight;
                            }
                            
                            console.log(`Chip position ${chip.id}:`, { x: chipX, y: chipY, width: chipWidth, height: chipHeight });
                            
                            // ì¹© ë°°ê²½ ê·¸ë¦¬ê¸° (ë‘¥ê·¼ ëª¨ì„œë¦¬)
                            ctx.fillStyle = bg;
                            const radius = Math.min(4, chipHeight * 0.2);
                            
                            ctx.beginPath();
                            ctx.moveTo(chipX + radius, chipY);
                            ctx.lineTo(chipX + chipWidth - radius, chipY);
                            ctx.quadraticCurveTo(chipX + chipWidth, chipY, chipX + chipWidth, chipY + radius);
                            ctx.lineTo(chipX + chipWidth, chipY + chipHeight - radius);
                            ctx.quadraticCurveTo(chipX + chipWidth, chipY + chipHeight, chipX + chipWidth - radius, chipY + chipHeight);
                            ctx.lineTo(chipX + radius, chipY + chipHeight);
                            ctx.quadraticCurveTo(chipX, chipY + chipHeight, chipX, chipY + chipHeight - radius);
                            ctx.lineTo(chipX, chipY + radius);
                            ctx.quadraticCurveTo(chipX, chipY, chipX + radius, chipY);
                            ctx.closePath();
                            ctx.fill();
                            
                            // ì¹© í…ìŠ¤íŠ¸ ê·¸ë¦¬ê¸°
                            ctx.fillStyle = color;
                            ctx.font = `bold ${chipTextSize}px Arial`;
                            ctx.textAlign = 'center';
                            ctx.textBaseline = 'middle';
                            ctx.fillText(text, chipX + chipWidth/2, chipY + chipHeight/2);
                            
                            ctx.restore();
                        }
                    }
                });
                
                console.log('Profile preview generated');
                
            } catch (error) {
                console.error('í”„ë¡œí•„ ìƒì„± ì˜¤ë¥˜:', error);
            }
        }

        // í”„ë¡œí•„ ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ
        function downloadProfileImage() {
            try {
                const sourceCanvas = document.getElementById('profile-canvas');
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                
                canvas.width = 1080;
                canvas.height = 1080;
                
                // ê³ í•´ìƒë„ë¡œ ë‹¤ì‹œ ê·¸ë¦¬ê¸°
                const scale = 1080 / 300;
                ctx.scale(scale, scale);
                ctx.drawImage(sourceCanvas, 0, 0);
                
                const link = document.createElement('a');
                const mainText = document.getElementById('profile-mainText').value || 'PROFILE';
                const timestamp = new Date().toISOString().replace(/[:.]/g, '-').slice(0, -5);
                link.download = `profile_${mainText.replace(/[|\\s]/g, '_')}_${timestamp}.png`;
                link.href = canvas.toDataURL('image/png');
                link.click();
                
                showToast(currentLanguage === 'ko' ? 'í”„ë¡œí•„ ì´ë¯¸ì§€ê°€ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤' : 'Profile image downloaded', 'success');
            } catch (error) {
                console.error('ë‹¤ìš´ë¡œë“œ ì˜¤ë¥˜:', error);
                showToast(currentLanguage === 'ko' ? 'ë‹¤ìš´ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤' : 'Error downloading image', 'error');
            }
        }

        // í™˜ê²½ ë±ƒì§€ í”„ë¦¬ì…‹ ì—…ë°ì´íŠ¸
        function updateBadgePreset() {
            const env = document.getElementById('badge-env').value;
            const presets = {
                dev: { text: 'DEV', bg: '#4a5568', color: '#ffffff' },
                qa: { text: 'QA', bg: '#ff6b6b', color: '#ffffff' },
                stage: { text: 'STAGE', bg: '#f7b731', color: '#ffffff' },
                prod: { text: 'PROD', bg: '#00d2d3', color: '#ffffff' }
            };
            
            if (presets[env]) {
                document.getElementById('badge-text').value = presets[env].text;
                document.getElementById('badge-bgColor').value = presets[env].bg;
                document.getElementById('badge-textColor').value = presets[env].color;
                generateEnvBadgePreview();
            }
        }

        // ë±ƒì§€ í¬ê¸° ì„¤ì •
        let badgeSize = 'medium';
        function setBadgeSize(size) {
            badgeSize = size;
            generateEnvBadgePreview();
        }

        // í™˜ê²½ ë±ƒì§€ ìƒì„±
        function generateEnvBadgePreview() {
            try {
                const canvas = document.getElementById('badge-canvas');
                if (!canvas) return;
                
                const ctx = canvas.getContext('2d');
                const text = document.getElementById('badge-text').value || 'BADGE';
                const bgColor = document.getElementById('badge-bgColor').value;
                const textColor = document.getElementById('badge-textColor').value;
                const style = document.querySelector('input[name="badgeStyle"]:checked').value;
                
                // í¬ê¸° ì„¤ì •
                const sizes = {
                    small: { font: 14, padding: 8, height: 30 },
                    medium: { font: 18, padding: 12, height: 40 },
                    large: { font: 24, padding: 16, height: 50 }
                };
                const size = sizes[badgeSize];
                
                // ìº”ë²„ìŠ¤ ì´ˆê¸°í™”
                ctx.clearRect(0, 0, 200, 200);
                
                // í…ìŠ¤íŠ¸ í¬ê¸° ê³„ì‚°
                ctx.font = `bold ${size.font}px Arial`;
                const metrics = ctx.measureText(text);
                const width = metrics.width + size.padding * 2;
                
                // ìœ„ì¹˜ ê³„ì‚°
                const x = (200 - width) / 2;
                const y = (200 - size.height) / 2;
                
                // ë±ƒì§€ ë°°ê²½ ê·¸ë¦¬ê¸°
                ctx.fillStyle = bgColor;
                ctx.beginPath();
                
                if (style === 'rounded') {
                    ctx.roundRect(x, y, width, size.height, 8);
                } else if (style === 'circle') {
                    const radius = Math.max(width, size.height) / 2;
                    ctx.arc(100, 100, radius, 0, Math.PI * 2);
                } else {
                    ctx.rect(x, y, width, size.height);
                }
                ctx.fill();
                
                // í…ìŠ¤íŠ¸ ê·¸ë¦¬ê¸°
                ctx.fillStyle = textColor;
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                
                if (style === 'circle') {
                    ctx.fillText(text, 100, 100);
                } else {
                    ctx.fillText(text, x + width/2, y + size.height/2);
                }
                
                showToast(currentLanguage === 'ko' ? 'ë±ƒì§€ ìƒì„± ì™„ë£Œ' : 'Badge generated', 'success');
            } catch (error) {
                console.error('ë±ƒì§€ ìƒì„± ì˜¤ë¥˜:', error);
                showToast(currentLanguage === 'ko' ? 'ë±ƒì§€ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤' : 'Error generating badge', 'error');
            }
        }

        // ë±ƒì§€ ë‹¤ìš´ë¡œë“œ
        function downloadBadgeImage(format) {
            try {
                if (format === 'png') {
                    const canvas = document.getElementById('badge-canvas');
                    const link = document.createElement('a');
                    const text = document.getElementById('badge-text').value || 'BADGE';
                    const timestamp = new Date().toISOString().replace(/[:.]/g, '-').slice(0, -5);
                    link.download = `badge_${text}_${timestamp}.png`;
                    link.href = canvas.toDataURL('image/png');
                    link.click();
                } else if (format === 'svg') {
                    // SVG ìƒì„±
                    const text = document.getElementById('badge-text').value || 'BADGE';
                    const bgColor = document.getElementById('badge-bgColor').value;
                    const textColor = document.getElementById('badge-textColor').value;
                    const style = document.querySelector('input[name="badgeStyle"]:checked').value;
                    
                    let svg = `<svg xmlns="http://www.w3.org/2000/svg" width="200" height="60">`;
                    
                    if (style === 'rounded') {
                        svg += `<rect x="10" y="10" width="180" height="40" rx="8" fill="${bgColor}"/>`;
                    } else if (style === 'circle') {
                        svg += `<circle cx="100" cy="30" r="25" fill="${bgColor}"/>`;
                    } else {
                        svg += `<rect x="10" y="10" width="180" height="40" fill="${bgColor}"/>`;
                    }
                    
                    svg += `<text x="100" y="30" text-anchor="middle" dominant-baseline="middle" fill="${textColor}" font-family="Arial" font-weight="bold" font-size="18">${text}</text>`;
                    svg += `</svg>`;
                    
                    const blob = new Blob([svg], { type: 'image/svg+xml' });
                    const link = document.createElement('a');
                    const timestamp = new Date().toISOString().replace(/[:.]/g, '-').slice(0, -5);
                    link.download = `badge_${text}_${timestamp}.svg`;
                    link.href = URL.createObjectURL(blob);
                    link.click();
                }
                
                showToast(currentLanguage === 'ko' ? 'ë±ƒì§€ê°€ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤' : 'Badge downloaded', 'success');
            } catch (error) {
                console.error('ë‹¤ìš´ë¡œë“œ ì˜¤ë¥˜:', error);
                showToast(currentLanguage === 'ko' ? 'ë‹¤ìš´ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤' : 'Error downloading badge', 'error');
            }
        }

        // ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸ ìƒì„±ê¸° HTML
        function getBusinessNumberGeneratorHTML() {
            return `
                <div class="space-y-6">
                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                        <p class="text-sm text-blue-800">
                            ${currentLanguage === 'ko' ? 
                                'âœ… ìƒì„±ëœ ë²ˆí˜¸ëŠ” ì²´í¬ì„¬ ê²€ì¦ì„ í†µê³¼í•œ ìœ íš¨í•œ í˜•ì‹ì˜ ë²ˆí˜¸ì…ë‹ˆë‹¤.' : 
                                'âœ… Generated numbers are valid format numbers that pass checksum verification.'}
                        </p>
                    </div>
                    
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-neutral-700 mb-2">
                                    ${currentLanguage === 'ko' ? 'ì‚¬ì—…ì ìœ í˜•' : 'Business Type'}
                                </label>
                                <select id="business-type" class="form-input" onchange="updateBusinessTypeSettings()">
                                    <option value="individual-01-79">${currentLanguage === 'ko' ? 'ê°œì¸ì‚¬ì—…ì (01-79)' : 'Individual (01-79)'}</option>
                                    <option value="individual-90-99">${currentLanguage === 'ko' ? 'ê°œì¸ì‚¬ì—…ì (90-99)' : 'Individual (90-99)'}</option>
                                    <option value="corporate-domestic">${currentLanguage === 'ko' ? 'ë²•ì¸ ì˜ë¦¬ êµ­ë‚´ (81,85-88)' : 'Corporate Domestic (81,85-88)'}</option>
                                    <option value="corporate-foreign">${currentLanguage === 'ko' ? 'ë²•ì¸ ì˜ë¦¬ í•´ì™¸ (84)' : 'Corporate Foreign (84)'}</option>
                                    <option value="nonprofit">${currentLanguage === 'ko' ? 'ë¹„ì˜ë¦¬/êµ­ê°€ ë° ì§€ìì²´ (82,83)' : 'Non-profit/Government (82,83)'}</option>
                                    <option value="association">${currentLanguage === 'ko' ? 'ì„ì˜ë‹¨ì²´ (80,89)' : 'Association (80,89)'}</option>
                                    <option value="random">${currentLanguage === 'ko' ? 'ì „ì²´ ëœë¤' : 'All Random'}</option>
                                    <option value="max-all">${currentLanguage === 'ko' ? 'ì „ì²´ MAX ìƒì„± (ëª¨ë“  ìœ í˜•)' : 'MAX Generation (All Types)'}</option>
                                </select>
                            </div>
                            
                            <div id="count-settings">
                                <label class="block text-sm font-medium text-neutral-700 mb-2">
                                    ${currentLanguage === 'ko' ? 'ìƒì„± ê°œìˆ˜' : 'Count'}
                                </label>
                                <select id="business-count" class="form-input">
                                    <option value="5">5${currentLanguage === 'ko' ? 'ê°œ' : ''}</option>
                                    <option value="10" selected>10${currentLanguage === 'ko' ? 'ê°œ' : ''}</option>
                                    <option value="20">20${currentLanguage === 'ko' ? 'ê°œ' : ''}</option>
                                    <option value="50">50${currentLanguage === 'ko' ? 'ê°œ' : ''}</option>
                                    <option value="100">100${currentLanguage === 'ko' ? 'ê°œ' : ''}</option>
                                </select>
                            </div>
                            
                            <div id="max-settings" class="hidden">
                                <div class="bg-yellow-50 border border-yellow-200 rounded p-3 mb-3">
                                    <p class="text-xs text-yellow-800">${currentLanguage === 'ko' ? 'MAX ìƒì„± ëª¨ë“œ: ê° ìœ í˜•ë³„ ìµœëŒ€ ìƒì„±ëŸ‰ ì„¤ì •' : 'MAX Generation Mode: Set maximum count per type'}</p>
                                </div>
                                
                                <div class="space-y-3 text-sm">
                                    <div class="flex justify-between items-center">
                                        <span>${currentLanguage === 'ko' ? 'ê°œì¸ì‚¬ì—…ì (01-79)' : 'Individual (01-79)'}</span>
                                        <input type="number" id="max-individual-01-79" min="0" max="200" value="30" class="w-16 text-xs p-1 border rounded">
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span>${currentLanguage === 'ko' ? 'ê°œì¸ì‚¬ì—…ì (90-99)' : 'Individual (90-99)'}</span>
                                        <input type="number" id="max-individual-90-99" min="0" max="50" value="20" class="w-16 text-xs p-1 border rounded">
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span>${currentLanguage === 'ko' ? 'ë²•ì¸ ì˜ë¦¬ êµ­ë‚´' : 'Corporate Domestic'}</span>
                                        <input type="number" id="max-corporate-domestic" min="0" max="100" value="25" class="w-16 text-xs p-1 border rounded">
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span>${currentLanguage === 'ko' ? 'ë²•ì¸ ì˜ë¦¬ í•´ì™¸' : 'Corporate Foreign'}</span>
                                        <input type="number" id="max-corporate-foreign" min="0" max="30" value="10" class="w-16 text-xs p-1 border rounded">
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span>${currentLanguage === 'ko' ? 'ë¹„ì˜ë¦¬/êµ­ê°€Â·ì§€ìì²´' : 'Non-profit/Gov'}</span>
                                        <input type="number" id="max-nonprofit" min="0" max="50" value="15" class="w-16 text-xs p-1 border rounded">
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span>${currentLanguage === 'ko' ? 'ì„ì˜ë‹¨ì²´' : 'Association'}</span>
                                        <input type="number" id="max-association" min="0" max="50" value="10" class="w-16 text-xs p-1 border rounded">
                                    </div>
                                    
                                    <div class="border-t pt-2 mt-3">
                                        <div class="flex justify-between items-center font-medium">
                                            <span>${currentLanguage === 'ko' ? 'ì „ì²´ ìƒì„± ìƒí•œ' : 'Total Generation Limit'}</span>
                                            <input type="number" id="max-total-limit" min="50" max="500" value="200" class="w-16 text-xs p-1 border rounded font-medium">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="border-t pt-4">
                                <details class="group">
                                    <summary class="cursor-pointer flex items-center justify-between text-sm font-medium text-neutral-700 hover:text-neutral-900">
                                        <span>âš™ï¸ ${currentLanguage === 'ko' ? 'ê³ ê¸‰ ì„¤ì • (ì•ìë¦¬ ê³ ì •)' : 'Advanced Settings (Fix Prefix)'}</span>
                                        <svg class="w-4 h-4 transition-transform group-open:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                                        </svg>
                                    </summary>
                                    <div class="mt-4 space-y-3">
                                        <div class="bg-amber-50 border border-amber-200 rounded p-3">
                                            <p class="text-xs text-amber-800">
                                                ${currentLanguage === 'ko' ? 
                                                    'ğŸ’¡ ìµœëŒ€ 9ìë¦¬ê¹Œì§€ ê³ ì • ê°€ëŠ¥ (ë§ˆì§€ë§‰ 1ìë¦¬ëŠ” ì²´í¬ë””ì§€íŠ¸)' : 
                                                    'ğŸ’¡ Fix up to 9 digits (last digit is checksum)'}
                                            </p>
                                        </div>
                                        
                                        <div>
                                            <label class="block text-sm font-medium text-neutral-700 mb-2">
                                                ${currentLanguage === 'ko' ? 'ê³ ì •ê°’ ì…ë ¥' : 'Fixed Value Input'}
                                            </label>
                                            <input type="text" 
                                                   id="fixed-prefix" 
                                                   class="form-input" 
                                                   placeholder="${currentLanguage === 'ko' ? 'ì˜ˆ: 123 ë˜ëŠ” 123-45 ë˜ëŠ” 123-45-6789' : 'e.g., 123 or 123-45 or 123-45-6789'}"
                                                   maxlength="13"
                                                   oninput="validateFixedPrefix(this)">
                                            <div id="fixed-prefix-help" class="mt-1 text-xs text-neutral-500">
                                                ${currentLanguage === 'ko' ? 
                                                    'ì…ë ¥ í˜•ì‹: XXX (ì§€ì—­) ë˜ëŠ” XXX-XX (ì§€ì—­-ì—…ì¢…) ë˜ëŠ” XXX-XX-XXXX (ì§€ì—­-ì—…ì¢…-ì¼ë ¨ë²ˆí˜¸)' : 
                                                    'Format: XXX (region) or XXX-XX (region-type) or XXX-XX-XXXX (region-type-serial)'}
                                            </div>
                                            <div id="fixed-prefix-error" class="mt-1 text-xs text-red-600 hidden"></div>
                                        </div>
                                        
                                        <div class="flex gap-2">
                                            <button onclick="applyFixedPrefix()" class="btn-secondary text-sm py-1 px-3">
                                                âœ“ ${currentLanguage === 'ko' ? 'ì ìš©' : 'Apply'}
                                            </button>
                                            <button onclick="clearFixedPrefix()" class="btn-secondary text-sm py-1 px-3">
                                                âœ— ${currentLanguage === 'ko' ? 'ì´ˆê¸°í™”' : 'Clear'}
                                            </button>
                                        </div>
                                        
                                        <div id="fixed-prefix-status" class="hidden">
                                            <div class="bg-green-50 border border-green-200 rounded p-2">
                                                <p class="text-xs text-green-800">
                                                    <span class="font-medium">${currentLanguage === 'ko' ? 'ê³ ì •ê°’ ì ìš©ë¨:' : 'Fixed value applied:'}</span>
                                                    <span id="fixed-prefix-display" class="ml-1"></span>
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                </details>
                            </div>
                            
                            <button onclick="generateBusinessNumbers()" class="btn-primary w-full">
                                ğŸ² ${currentLanguage === 'ko' ? 'ì‚¬ì—…ìë²ˆí˜¸ ìƒì„±' : 'Generate Numbers'}
                            </button>
                            
                            <div class="flex gap-2">
                                <button onclick="copyBusinessNumbers()" class="btn-secondary flex-1">
                                    ğŸ“‹ ${currentLanguage === 'ko' ? 'ì „ì²´ ë³µì‚¬' : 'Copy All'}
                                </button>
                                <button onclick="downloadBusinessNumbers()" class="btn-secondary flex-1">
                                    ğŸ’¾ ${currentLanguage === 'ko' ? 'CSV ë‹¤ìš´ë¡œë“œ' : 'Download CSV'}
                                </button>
                            </div>
                        </div>
                        
                        <div class="lg:col-span-2">
                            <div class="bg-neutral-50 border border-neutral-200 rounded-lg p-4 h-96 overflow-y-auto">
                                <div id="business-numbers-list" class="space-y-2">
                                    <p class="text-center text-neutral-500">
                                        ${currentLanguage === 'ko' ? 
                                            'ìƒì„± ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ ì‚¬ì—…ìë²ˆí˜¸ë¥¼ ìƒì„±í•˜ì„¸ìš”' : 
                                            'Click generate button to create business numbers'}
                                    </p>
                                </div>
                            </div>
                            <div class="mt-2 flex justify-between text-sm text-neutral-600">
                                <span><span id="business-count-display">0</span> ${currentLanguage === 'ko' ? 'ê°œ ìƒì„±ë¨' : 'numbers generated'}</span>
                                <span id="business-type-breakdown" class="text-xs"></span>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸ ìœ íš¨ì„± ê²€ì‚¬
        function validateBusinessNumber(number) {
            const weights = [1, 3, 7, 1, 3, 7, 1, 3, 5];
            const nums = number.replace(/-/g, '').split('').map(Number);
            
            if (nums.length !== 10) return false;
            
            let sum = 0;
            for (let i = 0; i < 9; i++) {
                sum += nums[i] * weights[i];
            }
            
            sum += Math.floor((nums[8] * 5) / 10);
            const checkDigit = (10 - (sum % 10)) % 10;
            
            return checkDigit === nums[9];
        }

        // ìœ íš¨í•œ ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸ ìƒì„±
        function generateValidBusinessNumber(prefix, middle, suffix) {
            // prefix: 3ìë¦¬, middle: 2ìë¦¬, suffix: 4ìë¦¬
            const base9 = prefix + middle + suffix; // 9ìë¦¬
            
            const weights = [1, 3, 7, 1, 3, 7, 1, 3, 5];
            const nums = base9.split('').map(Number);
            
            let sum = 0;
            for (let i = 0; i < 9; i++) {
                sum += nums[i] * weights[i];
            }
            
            sum += Math.floor((nums[8] * 5) / 10);
            const checkDigit = (10 - (sum % 10)) % 10;
            
            // 3ìë¦¬-2ìë¦¬-5ìë¦¬ í˜•ì‹ìœ¼ë¡œ ë°˜í™˜ (suffix 4ìë¦¬ + checkDigit 1ìë¦¬ = 5ìë¦¬)
            return prefix + '-' + middle + '-' + suffix + checkDigit;
        }

        // ì‚¬ì—…ìë²ˆí˜¸ ìœ í˜• ì„¤ì • ì—…ë°ì´íŠ¸
        function updateBusinessTypeSettings() {
            const type = document.getElementById('business-type').value;
            const countSettings = document.getElementById('count-settings');
            const maxSettings = document.getElementById('max-settings');
            
            if (type === 'max-all') {
                countSettings.classList.add('hidden');
                maxSettings.classList.remove('hidden');
            } else {
                countSettings.classList.remove('hidden');
                maxSettings.classList.add('hidden');
            }
        }
        
        // ì •í™•í•œ ê²½ê³„ê°’ ë¶„í• ì„ ìœ„í•œ ìœ í˜•ë³„ ë²”ìœ„ ì •ì˜
        const businessTypeRanges = {
            'individual-01-79': [
                { start: 1, end: 79 }  // 01-79
            ],
            'individual-90-99': [
                { start: 90, end: 99 } // 90-99
            ],
            'corporate-domestic': [
                { start: 81, end: 81 }, // 81
                { start: 85, end: 88 }  // 85-88
            ],
            'corporate-foreign': [
                { start: 84, end: 84 }  // 84
            ],
            'nonprofit': [
                { start: 82, end: 83 }  // 82-83
            ],
            'association': [
                { start: 80, end: 80 }, // 80
                { start: 89, end: 89 }  // 89
            ]
        };

        // ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸ ìƒì„±
        function generateBusinessNumbers() {
            try {
                const type = document.getElementById('business-type').value;
                
                let businessNumbers = new Set();
                let typeBreakdown = {};
                
                if (type === 'max-all') {
                    // MAX ìƒì„± ëª¨ë“œ
                    const maxCounts = {
                        'individual-01-79': parseInt(document.getElementById('max-individual-01-79').value || 30),
                        'individual-90-99': parseInt(document.getElementById('max-individual-90-99').value || 20),
                        'corporate-domestic': parseInt(document.getElementById('max-corporate-domestic').value || 25),
                        'corporate-foreign': parseInt(document.getElementById('max-corporate-foreign').value || 10),
                        'nonprofit': parseInt(document.getElementById('max-nonprofit').value || 15),
                        'association': parseInt(document.getElementById('max-association').value || 10)
                    };
                    
                    const totalLimit = parseInt(document.getElementById('max-total-limit').value || 200);
                    let totalGenerated = 0;
                    
                    // ê° ìœ í˜•ë³„ë¡œ ìƒì„±
                    for (const [businessType, maxCount] of Object.entries(maxCounts)) {
                        if (maxCount > 0 && totalGenerated < totalLimit) {
                            const actualCount = Math.min(maxCount, totalLimit - totalGenerated);
                            const typeNumbers = generateNumbersByType(businessType, actualCount, fixedPrefixData);
                            typeNumbers.forEach(num => businessNumbers.add(num));
                            typeBreakdown[businessType] = typeNumbers.length;
                            totalGenerated += typeNumbers.length;
                        }
                    }
                    
                } else if (type === 'random') {
                    // ì „ì²´ ëœë¤ ëª¨ë“œ
                    const count = parseInt(document.getElementById('business-count').value);
                    const allTypes = Object.keys(businessTypeRanges);
                    
                    for (let i = 0; i < count; i++) {
                        const randomType = allTypes[Math.floor(Math.random() * allTypes.length)];
                        const numbers = generateNumbersByType(randomType, 1, fixedPrefixData);
                        numbers.forEach(num => businessNumbers.add(num));
                        typeBreakdown[randomType] = (typeBreakdown[randomType] || 0) + 1;
                    }
                    
                } else {
                    // ë‹¨ì¼ ìœ í˜• ëª¨ë“œ
                    const count = parseInt(document.getElementById('business-count').value);
                    const numbers = generateNumbersByType(type, count, fixedPrefixData);
                    numbers.forEach(num => businessNumbers.add(num));
                    typeBreakdown[type] = numbers.length;
                }
                
                window.generatedBusinessNumbers = Array.from(businessNumbers);
                window.businessTypeBreakdown = typeBreakdown;
                displayBusinessNumbers();
                
                const totalCount = businessNumbers.size;
                showToast(
                    currentLanguage === 'ko' ? 
                        `${totalCount}ê°œì˜ ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸ê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤` : 
                        `${totalCount} business numbers generated`, 
                    'success'
                );
            } catch (error) {
                console.error('ì‚¬ì—…ìë²ˆí˜¸ ìƒì„± ì˜¤ë¥˜:', error);
                showToast(
                    currentLanguage === 'ko' ? 
                        'ì‚¬ì—…ìë²ˆí˜¸ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤' : 
                        'Error generating business numbers', 
                    'error'
                );
            }
        }
        
        // ìœ í˜•ë³„ ì‚¬ì—…ìë²ˆí˜¸ ìƒì„±
        function generateNumbersByType(type, count, fixedData = null) {
            const ranges = businessTypeRanges[type];
            if (!ranges) return [];
            
            const numbers = new Set();
            const today = new Date();
            const month = String(today.getMonth() + 1).padStart(2, '0');
            const day = String(today.getDate()).padStart(2, '0');
            
            let attempts = 0;
            const maxAttempts = count * 100; // ë¬´í•œë£¨í”„ ë°©ì§€
            
            while (numbers.size < count && attempts < maxAttempts) {
                attempts++;
                
                let prefix, middle, suffix;
                
                // ê³ ì •ê°’ì´ ìˆìœ¼ë©´ ì‚¬ìš©, ì—†ìœ¼ë©´ ëœë¤ ìƒì„±
                if (fixedData && fixedData.enabled) {
                    // ì§€ì—­ì½”ë“œ
                    if (fixedData.prefix) {
                        prefix = fixedData.prefix;
                    } else {
                        // 000ë„ í¬í•¨í•˜ì—¬ 000-999 ë²”ìœ„ì—ì„œ ëœë¤ ìƒì„±
                        prefix = String(Math.floor(Math.random() * 1000)).padStart(3, '0');
                    }
                    
                    // ì—…ì¢…ì½”ë“œ
                    if (fixedData.middle) {
                        middle = fixedData.middle;
                    } else {
                        const range = ranges[Math.floor(Math.random() * ranges.length)];
                        const middleNum = range.start + Math.floor(Math.random() * (range.end - range.start + 1));
                        middle = String(middleNum).padStart(2, '0');
                    }
                    
                    // ì¼ë ¨ë²ˆí˜¸
                    if (fixedData.suffix) {
                        // ê³ ì •ëœ ì¼ë ¨ë²ˆí˜¸ê°€ ìˆëŠ” ê²½ìš°
                        const fixedLength = fixedData.suffix.length;
                        if (fixedLength === 4) {
                            // 4ìë¦¬ ëª¨ë‘ ê³ ì •
                            suffix = fixedData.suffix;
                        } else {
                            // ì¼ë¶€ë§Œ ê³ ì •, ë‚˜ë¨¸ì§€ëŠ” ëœë¤
                            const remainingDigits = 4 - fixedLength;
                            const randomPart = String(Math.floor(Math.random() * Math.pow(10, remainingDigits)))
                                .padStart(remainingDigits, '0');
                            suffix = fixedData.suffix + randomPart;
                        }
                    } else {
                        suffix = String(Math.floor(Math.random() * 9999) + 1).padStart(4, '0');
                    }
                } else {
                    // ê³ ì •ê°’ì´ ì—†ëŠ” ê²½ìš° (000-999 ë²”ìœ„ë¡œ í™•ì¥)
                    prefix = String(Math.floor(Math.random() * 1000)).padStart(3, '0');
                    
                    const range = ranges[Math.floor(Math.random() * ranges.length)];
                    const middleNum = range.start + Math.floor(Math.random() * (range.end - range.start + 1));
                    middle = String(middleNum).padStart(2, '0');
                    
                    suffix = String(Math.floor(Math.random() * 9999) + 1).padStart(4, '0');
                }
                
                const businessNumber = generateValidBusinessNumber(prefix, middle, suffix);
                
                if (validateBusinessNumber(businessNumber)) {
                    numbers.add(businessNumber);
                }
            }
            
            return Array.from(numbers);
        }

        // ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸ í‘œì‹œ
        function displayBusinessNumbers() {
            const listElement = document.getElementById('business-numbers-list');
            const countElement = document.getElementById('business-count-display');
            
            if (!window.generatedBusinessNumbers || window.generatedBusinessNumbers.length === 0) {
                listElement.innerHTML = `
                    <p class="text-center text-neutral-500">
                        ${currentLanguage === 'ko' ? 
                            'ìƒì„± ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ ì‚¬ì—…ìë²ˆí˜¸ë¥¼ ìƒì„±í•˜ì„¸ìš”' : 
                            'Click generate button to create business numbers'}
                    </p>
                `;
                countElement.textContent = '0';
                return;
            }
            
            listElement.innerHTML = window.generatedBusinessNumbers.map((number, index) => `
                <div class="flex items-center justify-between p-2 bg-white rounded border hover:border-primary-400 transition-colors">
                    <span class="font-mono text-sm">${number}</span>
                    <button onclick="copyToClipboard('${number}')" class="text-primary-600 hover:text-primary-800">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                        </svg>
                    </button>
                </div>
            `).join('');
            
            countElement.textContent = window.generatedBusinessNumbers.length;
            
            // ìœ í˜•ë³„ ë¶„ë¥˜í•˜ì—¬ í‘œì‹œ
            updateBusinessNumbersDisplay();
        }
        
        // ê°œì„ ëœ ì‚¬ì—…ìë²ˆí˜¸ í‘œì‹œ (ìœ í˜•ë³„ ë¶„ë¥˜)
        function updateBusinessNumbersDisplay() {
            const listElement = document.getElementById('business-numbers-list');
            const breakdownElement = document.getElementById('business-type-breakdown');
            
            if (!window.generatedBusinessNumbers || window.generatedBusinessNumbers.length === 0) {
                return;
            }
            
            // ë²ˆí˜¸ë³„ ìœ í˜• ë¶„ë¥˜
            const categorizedNumbers = categorizeBusinessNumbers(window.generatedBusinessNumbers);
            
            // HTML ìƒì„±
            let html = '';
            for (const [category, numbers] of Object.entries(categorizedNumbers)) {
                if (numbers.length > 0) {
                    const categoryName = getBusinessTypeName(category);
                    html += `
                        <div class="mb-4">
                            <div class="flex items-center justify-between mb-2 pb-1 border-b border-neutral-200">
                                <h4 class="text-sm font-medium text-neutral-700">${categoryName}</h4>
                                <span class="text-xs text-neutral-500">${numbers.length}ê°œ</span>
                            </div>
                            <div class="space-y-1">
                                ${numbers.map(number => `
                                    <div class="flex items-center justify-between p-2 bg-white rounded border hover:border-primary-400 transition-colors">
                                        <span class="font-mono text-sm">${number}</span>
                                        <button onclick="copyToClipboard('${number}')" class="text-primary-600 hover:text-primary-800">
                                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                                            </svg>
                                        </button>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    `;
                }
            }
            
            if (html) {
                listElement.innerHTML = html;
            }
            
            // ìœ í˜•ë³„ ìš”ì•½ ì •ë³´ í‘œì‹œ
            if (breakdownElement && window.businessTypeBreakdown) {
                const breakdownText = Object.entries(window.businessTypeBreakdown)
                    .map(([type, count]) => {
                        const shortName = getBusinessTypeShortName(type);
                        return `${shortName}: ${count}`;
                    }).join(', ');
                breakdownElement.textContent = breakdownText;
            }
        }
        
        // ì‚¬ì—…ìë²ˆí˜¸ë¥¼ ìœ í˜•ë³„ë¡œ ë¶„ë¥˜
        function categorizeBusinessNumbers(numbers) {
            const categories = {
                'individual-01-79': [],
                'individual-90-99': [],
                'corporate-domestic': [],
                'corporate-foreign': [],
                'nonprofit': [],
                'association': []
            };
            
            numbers.forEach(number => {
                const middleNum = parseInt(number.split('-')[1]);
                
                if (middleNum >= 1 && middleNum <= 79) {
                    categories['individual-01-79'].push(number);
                } else if (middleNum >= 90 && middleNum <= 99) {
                    categories['individual-90-99'].push(number);
                } else if (middleNum === 81 || (middleNum >= 85 && middleNum <= 88)) {
                    categories['corporate-domestic'].push(number);
                } else if (middleNum === 84) {
                    categories['corporate-foreign'].push(number);
                } else if (middleNum >= 82 && middleNum <= 83) {
                    categories['nonprofit'].push(number);
                } else if (middleNum === 80 || middleNum === 89) {
                    categories['association'].push(number);
                }
            });
            
            return categories;
        }
        
        // ì‚¬ì—…ì ìœ í˜• ì´ë¦„ ë°˜í™˜
        function getBusinessTypeName(type) {
            const names = {
                'individual-01-79': currentLanguage === 'ko' ? 'ê°œì¸ì‚¬ì—…ì (01-79)' : 'Individual (01-79)',
                'individual-90-99': currentLanguage === 'ko' ? 'ê°œì¸ì‚¬ì—…ì (90-99)' : 'Individual (90-99)',
                'corporate-domestic': currentLanguage === 'ko' ? 'ë²•ì¸ ì˜ë¦¬ êµ­ë‚´ (81,85-88)' : 'Corporate Domestic (81,85-88)',
                'corporate-foreign': currentLanguage === 'ko' ? 'ë²•ì¸ ì˜ë¦¬ í•´ì™¸ (84)' : 'Corporate Foreign (84)',
                'nonprofit': currentLanguage === 'ko' ? 'ë¹„ì˜ë¦¬/êµ­ê°€ ë° ì§€ìì²´ (82,83)' : 'Non-profit/Government (82,83)',
                'association': currentLanguage === 'ko' ? 'ì„ì˜ë‹¨ì²´ (80,89)' : 'Association (80,89)'
            };
            return names[type] || type;
        }
        
        // ì‚¬ì—…ì ìœ í˜• ì§§ì€ ì´ë¦„ ë°˜í™˜
        function getBusinessTypeShortName(type) {
            const shortNames = {
                'individual-01-79': currentLanguage === 'ko' ? 'ê°œì¸(01-79)' : 'Ind(01-79)',
                'individual-90-99': currentLanguage === 'ko' ? 'ê°œì¸(90-99)' : 'Ind(90-99)',
                'corporate-domestic': currentLanguage === 'ko' ? 'ë²•ì¸êµ­ë‚´' : 'Corp-Dom',
                'corporate-foreign': currentLanguage === 'ko' ? 'ë²•ì¸í•´ì™¸' : 'Corp-For',
                'nonprofit': currentLanguage === 'ko' ? 'ë¹„ì˜ë¦¬' : 'Non-profit',
                'association': currentLanguage === 'ko' ? 'ì„ì˜ë‹¨ì²´' : 'Assoc'
            };
            return shortNames[type] || type;
        }

        // í´ë¦½ë³´ë“œì— ë³µì‚¬
        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                showToast(
                    currentLanguage === 'ko' ? 
                        'í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤' : 
                        'Copied to clipboard', 
                    'success'
                );
            });
        }

        // ì „ì²´ ì‚¬ì—…ìë²ˆí˜¸ ë³µì‚¬
        function copyBusinessNumbers() {
            if (!window.generatedBusinessNumbers || window.generatedBusinessNumbers.length === 0) {
                showToast(
                    currentLanguage === 'ko' ? 
                        'ë¨¼ì € ì‚¬ì—…ìë²ˆí˜¸ë¥¼ ìƒì„±í•´ì£¼ì„¸ìš”' : 
                        'Please generate numbers first', 
                    'error'
                );
                return;
            }
            
            const text = window.generatedBusinessNumbers.join('\n');
            navigator.clipboard.writeText(text).then(() => {
                showToast(
                    currentLanguage === 'ko' ? 
                        `${window.generatedBusinessNumbers.length}ê°œì˜ ë²ˆí˜¸ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤` : 
                        `${window.generatedBusinessNumbers.length} numbers copied`, 
                    'success'
                );
            });
        }

        // CSV ë‹¤ìš´ë¡œë“œ
        function downloadBusinessNumbers() {
            if (!window.generatedBusinessNumbers || window.generatedBusinessNumbers.length === 0) {
                showToast(
                    currentLanguage === 'ko' ? 
                        'ë¨¼ì € ì‚¬ì—…ìë²ˆí˜¸ë¥¼ ìƒì„±í•´ì£¼ì„¸ìš”' : 
                        'Please generate numbers first', 
                    'error'
                );
                return;
            }
            
            const csv = 'ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸\n' + window.generatedBusinessNumbers.join('\n');
            const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const timestamp = new Date().toISOString().split('T')[0];
            link.download = `business_numbers_${timestamp}.csv`;
            link.href = URL.createObjectURL(blob);
            link.click();
            
            showToast(
                currentLanguage === 'ko' ? 
                    'CSV íŒŒì¼ì´ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤' : 
                    'CSV file downloaded', 
                'success'
            );
        }
        
        // ê³ ì •ê°’ ê´€ë ¨ ì „ì—­ ë³€ìˆ˜
        let fixedPrefixData = {
            enabled: false,
            prefix: null,    // 3ìë¦¬
            middle: null,    // 2ìë¦¬
            suffix: null     // ìµœëŒ€ 4ìë¦¬
        };
        
        // ê³ ì •ê°’ ì…ë ¥ ìœ íš¨ì„± ê²€ì‚¬
        function validateFixedPrefix(input) {
            const value = input.value.replace(/[^\d-]/g, ''); // ìˆ«ìì™€ í•˜ì´í”ˆë§Œ í—ˆìš©
            input.value = value;
            
            const errorDiv = document.getElementById('fixed-prefix-error');
            const parts = value.split('-').filter(p => p);
            
            // ìœ íš¨ì„± ê²€ì‚¬
            if (parts.length > 0) {
                // ì²« ë²ˆì§¸ ë¶€ë¶„ (ì§€ì—­ì½”ë“œ): 3ìë¦¬ (000ë„ í—ˆìš©)
                if (parts[0] && parts[0].length !== 3) {
                    errorDiv.textContent = currentLanguage === 'ko' ? 
                        'ì§€ì—­ì½”ë“œëŠ” 3ìë¦¬ì—¬ì•¼ í•©ë‹ˆë‹¤' : 
                        'Region code must be 3 digits';
                    errorDiv.classList.remove('hidden');
                    return false;
                }
                
                // ë‘ ë²ˆì§¸ ë¶€ë¶„ (ì—…ì¢…ì½”ë“œ): 2ìë¦¬
                if (parts[1] && parts[1].length !== 2) {
                    errorDiv.textContent = currentLanguage === 'ko' ? 
                        'ì—…ì¢…ì½”ë“œëŠ” 2ìë¦¬ì—¬ì•¼ í•©ë‹ˆë‹¤' : 
                        'Business type code must be 2 digits';
                    errorDiv.classList.remove('hidden');
                    return false;
                }
                
                // ì„¸ ë²ˆì§¸ ë¶€ë¶„ (ì¼ë ¨ë²ˆí˜¸): ìµœëŒ€ 4ìë¦¬
                if (parts[2] && parts[2].length > 4) {
                    errorDiv.textContent = currentLanguage === 'ko' ? 
                        'ì¼ë ¨ë²ˆí˜¸ëŠ” ìµœëŒ€ 4ìë¦¬ê¹Œì§€ ê°€ëŠ¥í•©ë‹ˆë‹¤' : 
                        'Serial number can be up to 4 digits';
                    errorDiv.classList.remove('hidden');
                    return false;
                }
                
                // ì „ì²´ ìë¦¬ìˆ˜ ì²´í¬ (ìµœëŒ€ 9ìë¦¬)
                const totalDigits = parts.join('').length;
                if (totalDigits > 9) {
                    errorDiv.textContent = currentLanguage === 'ko' ? 
                        'ì „ì²´ ê³ ì •ê°’ì€ ìµœëŒ€ 9ìë¦¬ê¹Œì§€ ê°€ëŠ¥í•©ë‹ˆë‹¤' : 
                        'Total fixed value can be up to 9 digits';
                    errorDiv.classList.remove('hidden');
                    return false;
                }
            }
            
            errorDiv.classList.add('hidden');
            return true;
        }
        
        // ê³ ì •ê°’ ì ìš©
        function applyFixedPrefix() {
            const input = document.getElementById('fixed-prefix');
            const value = input.value.trim();
            
            if (!value) {
                showToast(
                    currentLanguage === 'ko' ? 'ê³ ì •ê°’ì„ ì…ë ¥í•´ì£¼ì„¸ìš”' : 'Please enter a fixed value',
                    'error'
                );
                return;
            }
            
            if (!validateFixedPrefix(input)) {
                return;
            }
            
            const parts = value.split('-').filter(p => p);
            
            // ê³ ì •ê°’ ë°ì´í„° ì„¤ì •
            fixedPrefixData.enabled = true;
            fixedPrefixData.prefix = parts[0] || null;
            fixedPrefixData.middle = parts[1] || null;
            fixedPrefixData.suffix = parts[2] || null;
            
            // UI ì—…ë°ì´íŠ¸
            const statusDiv = document.getElementById('fixed-prefix-status');
            const displaySpan = document.getElementById('fixed-prefix-display');
            
            let displayText = '';
            if (fixedPrefixData.prefix) displayText += fixedPrefixData.prefix;
            if (fixedPrefixData.middle) displayText += '-' + fixedPrefixData.middle;
            if (fixedPrefixData.suffix) displayText += '-' + fixedPrefixData.suffix;
            displayText += '-' + 'X'.repeat(9 - displayText.replace(/-/g, '').length) + 'C';
            
            displaySpan.textContent = displayText;
            statusDiv.classList.remove('hidden');
            
            showToast(
                currentLanguage === 'ko' ? 
                    `ê³ ì •ê°’ì´ ì ìš©ë˜ì—ˆìŠµë‹ˆë‹¤: ${displayText}` : 
                    `Fixed value applied: ${displayText}`,
                'success'
            );
        }
        
        // ê³ ì •ê°’ ì´ˆê¸°í™”
        function clearFixedPrefix() {
            fixedPrefixData = {
                enabled: false,
                prefix: null,
                middle: null,
                suffix: null
            };
            
            document.getElementById('fixed-prefix').value = '';
            document.getElementById('fixed-prefix-status').classList.add('hidden');
            document.getElementById('fixed-prefix-error').classList.add('hidden');
            
            showToast(
                currentLanguage === 'ko' ? 'ê³ ì •ê°’ì´ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤' : 'Fixed value cleared',
                'success'
            );
        }

        // ì–´ë“œë¯¼ ë„êµ¬ ê´€ë¦¬ ì‹œìŠ¤í…œ
        const ADMIN_TOOLS_KEY = 'ceoplus_admin_tools_config';
        let adminToolsConfig = [];

        // ê¸°ë³¸ ì–´ë“œë¯¼ ë„êµ¬ ì„¤ì •
        const defaultAdminTools = [
            {
                id: 'qr-create',
                name: 'ê°€ë§¹ì  ìƒì„± ë° QR í™œì„±í™”',
                nameEn: 'Create Store & Activate QR',
                desc: 'ìƒˆë¡œìš´ ê°€ë§¹ì ì„ ë“±ë¡í•˜ê³  QR ì½”ë“œë¥¼ í™œì„±í™”í•©ë‹ˆë‹¤',
                descEn: 'Register a new store and activate QR code',
                tag: '3ê°œ ì–´ë“œë¯¼',
                tagEn: '3 Admins',
                icon: 'plus',
                subAdmins: [
                    {
                        name: 'íŒŒíŠ¸ë„ˆ ì„œë¹„ìŠ¤ ì–´ë“œë¯¼',
                        nameEn: 'Partner Service Admin',
                        desc: 'íŒŒíŠ¸ë„ˆ ì„œë¹„ìŠ¤ ê´€ë¦¬',
                        descEn: 'Partner service management',
                        url: 'https://partner.admin.example.com',
                        isInternal: true
                    },
                    {
                        name: 'ì»¤ë¨¸ìŠ¤ ì–´ë“œë¯¼',
                        nameEn: 'Commerce Admin',
                        desc: 'ìƒê±°ë˜ í”Œë«í¼ ê´€ë¦¬',
                        descEn: 'Commerce platform management',
                        url: 'https://commerce.admin.example.com',
                        isInternal: false
                    },
                    {
                        name: 'QR ê´€ë¦¬ ì–´ë“œë¯¼',
                        nameEn: 'QR Management Admin',
                        desc: 'QR ì½”ë“œ ìƒì„± ë° ê´€ë¦¬',
                        descEn: 'QR code generation and management',
                        url: 'https://qr.admin.example.com',
                        isInternal: true
                    }
                ]
            },
            {
                id: 'qr-recovery',
                name: 'ê°€ë§¹ì  QR ë³µêµ¬',
                nameEn: 'Store QR Recovery',
                desc: 'ì†ìƒëœ QR ì½”ë“œë¥¼ ë³µêµ¬í•˜ê³  ì¬í™œì„±í™”í•©ë‹ˆë‹¤',
                descEn: 'Recover and reactivate damaged QR codes',
                tag: '3ê°œ ì–´ë“œë¯¼',
                tagEn: '3 Admins',
                icon: 'refresh',
                subAdmins: [
                    {
                        name: 'QR ë³µêµ¬ ì–´ë“œë¯¼',
                        nameEn: 'QR Recovery Admin',
                        desc: 'ì†ìƒëœ QR ë³µêµ¬ ì²˜ë¦¬',
                        descEn: 'Damaged QR recovery processing',
                        url: 'https://recovery.admin.example.com',
                        isInternal: true
                    },
                    {
                        name: 'ë§¤ì¥ ê´€ë¦¬ ì–´ë“œë¯¼',
                        nameEn: 'Store Management Admin',
                        desc: 'ë§¤ì¥ ì •ë³´ ê´€ë¦¬',
                        descEn: 'Store information management',
                        url: 'https://store.admin.example.com',
                        isInternal: false
                    },
                    {
                        name: 'ë°ì´í„° ë°±ì—… ì–´ë“œë¯¼',
                        nameEn: 'Data Backup Admin',
                        desc: 'ë°ì´í„° ë°±ì—… ë° ë³µì›',
                        descEn: 'Data backup and restore',
                        url: 'https://backup.admin.example.com',
                        isInternal: true
                    }
                ]
            },
            {
                id: 'permission',
                name: 'ë§¤ì¥ ê¶Œí•œ ë³€ê²½',
                nameEn: 'Store Permission Management',
                desc: 'ë§¤ì¥ë³„ ì‚¬ìš©ì ê¶Œí•œì„ ê´€ë¦¬í•˜ê³  ìˆ˜ì •í•©ë‹ˆë‹¤',
                descEn: 'Manage and modify user permissions per store',
                tag: '3ê°œ ì–´ë“œë¯¼',
                tagEn: '3 Admins',
                icon: 'lock',
                subAdmins: [
                    {
                        name: 'ê¶Œí•œ ê´€ë¦¬ ì–´ë“œë¯¼',
                        nameEn: 'Permission Management Admin',
                        desc: 'ì‚¬ìš©ì ê¶Œí•œ ì„¤ì •',
                        descEn: 'User permission settings',
                        url: 'https://permission.admin.example.com',
                        isInternal: true
                    },
                    {
                        name: 'ì‚¬ìš©ì ê´€ë¦¬ ì–´ë“œë¯¼',
                        nameEn: 'User Management Admin',
                        desc: 'ì‚¬ìš©ì ê³„ì • ê´€ë¦¬',
                        descEn: 'User account management',
                        url: 'https://user.admin.example.com',
                        isInternal: false
                    },
                    {
                        name: 'ë³´ì•ˆ ì„¤ì • ì–´ë“œë¯¼',
                        nameEn: 'Security Settings Admin',
                        desc: 'ë³´ì•ˆ ì •ì±… ê´€ë¦¬',
                        descEn: 'Security policy management',
                        url: 'https://security.admin.example.com',
                        isInternal: true
                    }
                ]
            }
        ];

        // ì•„ì´ì½˜ SVG ë§¤í•‘
        const iconSvg = {
            plus: '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>',
            refresh: '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>',
            lock: '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path>',
            chart: '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>',
            settings: '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>',
            users: '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"></path>',
            store: '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"></path>',
            qr: '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"></path>'
        };

        // ì–´ë“œë¯¼ ë„êµ¬ ì´ˆê¸°í™”
        function initAdminTools() {
            const stored = localStorage.getItem(ADMIN_TOOLS_KEY);
            if (stored) {
                try {
                    adminToolsConfig = JSON.parse(stored);
                } catch (e) {
                    adminToolsConfig = [...defaultAdminTools];
                }
            } else {
                adminToolsConfig = [...defaultAdminTools];
            }
            renderAdminTools();
        }

        // ì–´ë“œë¯¼ ë„êµ¬ ë Œë”ë§
        function renderAdminTools() {
            const grid = document.getElementById('admin-tools-grid');
            if (!grid) return;
            
            grid.innerHTML = adminToolsConfig.map(tool => `
                <div class="card tool-card p-6" onclick="openAdminTool('${tool.id}')">
                    <div class="icon-container">
                        <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            ${iconSvg[tool.icon] || iconSvg.plus}
                        </svg>
                    </div>
                    <h3 class="text-xl font-bold text-neutral-800 mb-2">
                        ${currentLanguage === 'ko' ? tool.name : tool.nameEn}
                    </h3>
                    <p class="text-neutral-600 mb-4">
                        ${currentLanguage === 'ko' ? tool.desc : tool.descEn}
                    </p>
                    <div class="flex items-center text-sm text-neutral-500">
                        <span class="bg-primary-100 text-primary-800 px-2 py-1 rounded text-xs mr-2">
                            ${currentLanguage === 'ko' ? tool.tag : tool.tagEn}
                        </span>
                        <span>â†’</span>
                    </div>
                </div>
            `).join('');
        }

        // ì–´ë“œë¯¼ ë„êµ¬ ì—´ê¸° (ì„¸ë¶€ ì–´ë“œë¯¼ ëª©ë¡ í‘œì‹œ)
        function openAdminTool(toolId) {
            const tool = adminToolsConfig.find(t => t.id === toolId);
            if (!tool) return;
            
            const title = currentLanguage === 'ko' ? tool.name : tool.nameEn;
            
            let content = '<div class="space-y-4">';
            
            if (tool.subAdmins && tool.subAdmins.length > 0) {
                tool.subAdmins.forEach((admin, index) => {
                    const adminName = currentLanguage === 'ko' ? admin.name : admin.nameEn;
                    const adminDesc = currentLanguage === 'ko' ? admin.desc : admin.descEn;
                    
                    content += `
                        <div class="card p-4 cursor-pointer hover:shadow-lg transition-all" onclick="openAdminUrl('${admin.url}', '${adminName}')">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center space-x-4">
                                    <div class="w-10 h-10 bg-primary-100 rounded-lg flex items-center justify-center">
                                        <span class="font-bold text-primary-600">${index + 1}</span>
                                    </div>
                                    <div>
                                        <h4 class="font-medium text-neutral-800">${adminName}</h4>
                                        <p class="text-sm text-neutral-600">${adminDesc}</p>
                                        <p class="text-xs text-neutral-400 mt-1">${admin.url}</p>
                                    </div>
                                </div>
                                <div class="flex items-center space-x-2">
                                    ${admin.isInternal ? 
                                        '<span class="bg-yellow-100 text-yellow-800 text-xs px-2 py-1 rounded">ë‚´ë¶€</span>' : 
                                        '<span class="bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded">ì™¸ë¶€</span>'
                                    }
                                    <svg class="w-5 h-5 text-neutral-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                                    </svg>
                                </div>
                            </div>
                        </div>
                    `;
                });
            } else {
                content += `
                    <div class="text-center p-8 text-neutral-500">
                        <p>${currentLanguage === 'ko' ? 'ì„¸ë¶€ ì–´ë“œë¯¼ì´ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.' : 'No sub-admins configured.'}</p>
                        <button onclick="openAdminToolManager()" class="btn-primary mt-4">
                            ${currentLanguage === 'ko' ? 'ì–´ë“œë¯¼ ì„¤ì •í•˜ê¸°' : 'Configure Admins'}
                        </button>
                    </div>
                `;
            }
            
            content += '</div>';
            
            document.getElementById('tool-modal-title').textContent = title;
            document.getElementById('tool-modal-content').innerHTML = content;
            document.getElementById('tool-modal').classList.remove('hidden');
        }

        // ì–´ë“œë¯¼ URL ì—´ê¸°
        function openAdminUrl(url, name) {
            try {
                logActivity('admin-tool', `${name} ì—´ê¸°`, 'started');
                
                const windowName = 'admin_' + name.replace(/\s/g, '_');
                const win = window.open(url, windowName, 'width=1200,height=800,menubar=yes,toolbar=yes,location=yes,status=yes,scrollbars=yes,resizable=yes');
                
                if (win) {
                    windowRefs[windowName] = win;
                    logActivity('admin-tool', `${name} ì—´ê¸°`, 'completed');
                    showToast(currentLanguage === 'ko' ? `${name} ë„êµ¬ë¥¼ ìƒˆ ì°½ì—ì„œ ì—´ì—ˆìŠµë‹ˆë‹¤` : `${name} tool opened in new window`, 'success');
                }
            } catch (error) {
                console.error('ì–´ë“œë¯¼ URL ì—´ê¸° ì˜¤ë¥˜:', error);
                logActivity('admin-tool', `${name} ì—´ê¸°`, 'failed');
                showToast(currentLanguage === 'ko' ? 'ë„êµ¬ë¥¼ ì—¬ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤' : 'Error opening tool', 'error');
            }
        }

        // ì–´ë“œë¯¼ ë„êµ¬ ê´€ë¦¬ì ì—´ê¸°
        function openAdminToolManager() {
            renderAdminToolsList();
            document.getElementById('admin-manager-modal').classList.remove('hidden');
        }

        // ì–´ë“œë¯¼ ë„êµ¬ ê´€ë¦¬ì ë‹«ê¸°
        function closeAdminToolManager() {
            document.getElementById('admin-manager-modal').classList.add('hidden');
        }

        // ì–´ë“œë¯¼ ë„êµ¬ ëª©ë¡ ë Œë”ë§
        function renderAdminToolsList() {
            const list = document.getElementById('admin-tools-list');
            if (!list) return;
            
            list.innerHTML = adminToolsConfig.map((tool, index) => `
                <div class="border rounded-lg overflow-hidden mb-4">
                    <div class="flex items-center justify-between p-3 bg-white">
                        <div class="flex-1">
                            <div class="font-medium text-neutral-800">${tool.name}</div>
                            <div class="text-sm text-neutral-600">${tool.desc}</div>
                            <div class="text-xs text-neutral-500 mt-1">
                                ${tool.subAdmins ? `${tool.subAdmins.length}ê°œì˜ ì„¸ë¶€ ì–´ë“œë¯¼` : 'ì„¸ë¶€ ì–´ë“œë¯¼ ì—†ìŒ'}
                            </div>
                        </div>
                        <div class="flex items-center space-x-2">
                            <button onclick="toggleSubAdmins(${index})" class="p-2 text-primary-600 hover:bg-primary-50 rounded-lg">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 100-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 100-4m0 4v2m0-6V4"></path>
                                </svg>
                            </button>
                            <button onclick="removeAdminTool(${index})" class="p-2 text-red-600 hover:bg-red-50 rounded-lg">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                </svg>
                            </button>
                        </div>
                    </div>
                    <div id="sub-admins-${index}" class="hidden bg-gray-50 p-3">
                        <div class="mb-3">
                            <h5 class="text-sm font-medium text-neutral-700 mb-2">ì„¸ë¶€ ì–´ë“œë¯¼ ì¶”ê°€</h5>
                            <div class="grid grid-cols-1 gap-2">
                                <input type="text" id="sub-name-${index}" class="form-input text-sm" placeholder="ì–´ë“œë¯¼ ì´ë¦„">
                                <input type="text" id="sub-desc-${index}" class="form-input text-sm" placeholder="ì„¤ëª…">
                                <input type="text" id="sub-url-${index}" class="form-input text-sm" placeholder="URL">
                                <label class="flex items-center text-sm">
                                    <input type="checkbox" id="sub-internal-${index}" class="mr-2">
                                    <span>ë‚´ë¶€ ì–´ë“œë¯¼</span>
                                </label>
                                <button onclick="addSubAdmin(${index})" class="btn-primary text-sm py-1">ì„¸ë¶€ ì–´ë“œë¯¼ ì¶”ê°€</button>
                            </div>
                        </div>
                        ${tool.subAdmins && tool.subAdmins.length > 0 ? `
                            <div class="space-y-2">
                                <h5 class="text-sm font-medium text-neutral-700">ë“±ë¡ëœ ì„¸ë¶€ ì–´ë“œë¯¼</h5>
                                ${tool.subAdmins.map((sub, subIndex) => `
                                    <div class="flex items-center justify-between p-2 bg-white rounded border">
                                        <div class="flex-1">
                                            <div class="text-sm font-medium">${sub.name}</div>
                                            <div class="text-xs text-neutral-600">${sub.desc}</div>
                                            <div class="text-xs text-neutral-400">${sub.url}</div>
                                        </div>
                                        <button onclick="removeSubAdmin(${index}, ${subIndex})" class="p-1 text-red-600 hover:bg-red-50 rounded">
                                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                            </svg>
                                        </button>
                                    </div>
                                `).join('')}
                            </div>
                        ` : '<p class="text-sm text-neutral-500">ì„¸ë¶€ ì–´ë“œë¯¼ì´ ì—†ìŠµë‹ˆë‹¤.</p>'}
                    </div>
                </div>
            `).join('');
        }

        // ì–´ë“œë¯¼ ë„êµ¬ ì¶”ê°€
        function addAdminTool() {
            const name = document.getElementById('new-tool-name').value.trim();
            const desc = document.getElementById('new-tool-desc').value.trim();
            const tag = document.getElementById('new-tool-tag').value.trim();
            const icon = document.getElementById('new-tool-icon').value;
            
            if (!name || !desc) {
                showToast(currentLanguage === 'ko' ? 'ë„êµ¬ ì´ë¦„ê³¼ ì„¤ëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”' : 'Please enter tool name and description', 'error');
                return;
            }
            
            const newTool = {
                id: 'custom-' + Date.now(),
                name: name,
                nameEn: name,
                desc: desc,
                descEn: desc,
                tag: tag || 'ì»¤ìŠ¤í…€',
                tagEn: tag || 'Custom',
                icon: icon,
                subAdmins: []
            };
            
            adminToolsConfig.push(newTool);
            saveAdminTools();
            renderAdminTools();
            renderAdminToolsList();
            
            // ì…ë ¥ í•„ë“œ ì´ˆê¸°í™”
            document.getElementById('new-tool-name').value = '';
            document.getElementById('new-tool-desc').value = '';
            document.getElementById('new-tool-tag').value = '';
            
            showToast(currentLanguage === 'ko' ? 'ë„êµ¬ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤' : 'Tool added successfully', 'success');
        }

        // ì„¸ë¶€ ì–´ë“œë¯¼ í† ê¸€
        function toggleSubAdmins(index) {
            const subAdminDiv = document.getElementById(`sub-admins-${index}`);
            if (subAdminDiv) {
                subAdminDiv.classList.toggle('hidden');
            }
        }

        // ì„¸ë¶€ ì–´ë“œë¯¼ ì¶”ê°€
        function addSubAdmin(toolIndex) {
            const name = document.getElementById(`sub-name-${toolIndex}`).value.trim();
            const desc = document.getElementById(`sub-desc-${toolIndex}`).value.trim();
            const url = document.getElementById(`sub-url-${toolIndex}`).value.trim();
            const isInternal = document.getElementById(`sub-internal-${toolIndex}`).checked;
            
            if (!name || !desc || !url) {
                showToast(currentLanguage === 'ko' ? 'ëª¨ë“  í•„ë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”' : 'Please fill in all fields', 'error');
                return;
            }
            
            if (!adminToolsConfig[toolIndex].subAdmins) {
                adminToolsConfig[toolIndex].subAdmins = [];
            }
            
            adminToolsConfig[toolIndex].subAdmins.push({
                name: name,
                nameEn: name,
                desc: desc,
                descEn: desc,
                url: url,
                isInternal: isInternal
            });
            
            // íƒœê·¸ ì—…ë°ì´íŠ¸
            adminToolsConfig[toolIndex].tag = `${adminToolsConfig[toolIndex].subAdmins.length}ê°œ ì–´ë“œë¯¼`;
            adminToolsConfig[toolIndex].tagEn = `${adminToolsConfig[toolIndex].subAdmins.length} Admins`;
            
            saveAdminTools();
            renderAdminTools();
            renderAdminToolsList();
            
            // ì…ë ¥ í•„ë“œ ì´ˆê¸°í™”
            document.getElementById(`sub-name-${toolIndex}`).value = '';
            document.getElementById(`sub-desc-${toolIndex}`).value = '';
            document.getElementById(`sub-url-${toolIndex}`).value = '';
            document.getElementById(`sub-internal-${toolIndex}`).checked = false;
            
            showToast(currentLanguage === 'ko' ? 'ì„¸ë¶€ ì–´ë“œë¯¼ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤' : 'Sub-admin added successfully', 'success');
        }

        // ì„¸ë¶€ ì–´ë“œë¯¼ ì œê±°
        function removeSubAdmin(toolIndex, subIndex) {
            if (confirm(currentLanguage === 'ko' ? 'ì´ ì„¸ë¶€ ì–´ë“œë¯¼ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?' : 'Delete this sub-admin?')) {
                adminToolsConfig[toolIndex].subAdmins.splice(subIndex, 1);
                
                // íƒœê·¸ ì—…ë°ì´íŠ¸
                if (adminToolsConfig[toolIndex].subAdmins.length > 0) {
                    adminToolsConfig[toolIndex].tag = `${adminToolsConfig[toolIndex].subAdmins.length}ê°œ ì–´ë“œë¯¼`;
                    adminToolsConfig[toolIndex].tagEn = `${adminToolsConfig[toolIndex].subAdmins.length} Admins`;
                } else {
                    adminToolsConfig[toolIndex].tag = 'ì„¸ë¶€ ì–´ë“œë¯¼ ì—†ìŒ';
                    adminToolsConfig[toolIndex].tagEn = 'No Sub-admins';
                }
                
                saveAdminTools();
                renderAdminTools();
                renderAdminToolsList();
                
                showToast(currentLanguage === 'ko' ? 'ì„¸ë¶€ ì–´ë“œë¯¼ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤' : 'Sub-admin deleted', 'success');
            }
        }

        // ì–´ë“œë¯¼ ë„êµ¬ ì œê±°
        function removeAdminTool(index) {
            if (confirm(currentLanguage === 'ko' ? 'ì´ ë„êµ¬ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?' : 'Are you sure you want to delete this tool?')) {
                adminToolsConfig.splice(index, 1);
                saveAdminTools();
                renderAdminTools();
                renderAdminToolsList();
                showToast(currentLanguage === 'ko' ? 'ë„êµ¬ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤' : 'Tool deleted successfully', 'success');
            }
        }

        // ì–´ë“œë¯¼ ë„êµ¬ ì €ì¥
        function saveAdminTools() {
            localStorage.setItem(ADMIN_TOOLS_KEY, JSON.stringify(adminToolsConfig));
        }

        // ê¸°ë³¸ê°’ ë³µì›
        function loadDefaultAdminTools() {
            if (confirm(currentLanguage === 'ko' ? 'ê¸°ë³¸ê°’ìœ¼ë¡œ ë³µì›í•˜ì‹œê² ìŠµë‹ˆê¹Œ? í˜„ì¬ ì„¤ì •ì´ ì‚­ì œë©ë‹ˆë‹¤.' : 'Restore defaults? Current settings will be deleted.')) {
                adminToolsConfig = [...defaultAdminTools];
                saveAdminTools();
                renderAdminTools();
                renderAdminToolsList();
                showToast(currentLanguage === 'ko' ? 'ê¸°ë³¸ê°’ìœ¼ë¡œ ë³µì›ë˜ì—ˆìŠµë‹ˆë‹¤' : 'Restored to defaults', 'success');
            }
        }

        // ì„¤ì • ë‚´ë³´ë‚´ê¸°
        function exportAdminConfig() {
            const config = {
                version: '1.0',
                exportDate: new Date().toISOString(),
                tools: adminToolsConfig
            };
            
            const json = JSON.stringify(config, null, 2);
            const blob = new Blob([json], { type: 'application/json' });
            const link = document.createElement('a');
            const timestamp = new Date().toISOString().split('T')[0];
            link.download = `admin_tools_config_${timestamp}.json`;
            link.href = URL.createObjectURL(blob);
            link.click();
            
            showToast(currentLanguage === 'ko' ? 'ì„¤ì •ì´ ë‚´ë³´ë‚´ì¡ŒìŠµë‹ˆë‹¤' : 'Configuration exported', 'success');
        }

        // ì„¤ì • ë¶ˆëŸ¬ì˜¤ê¸°
        function importAdminConfig(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const config = JSON.parse(e.target.result);
                    if (config.tools && Array.isArray(config.tools)) {
                        adminToolsConfig = config.tools;
                        saveAdminTools();
                        renderAdminTools();
                        showToast(currentLanguage === 'ko' ? 'ì„¤ì •ì„ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤' : 'Configuration imported', 'success');
                    } else {
                        showToast(currentLanguage === 'ko' ? 'ì˜ëª»ëœ íŒŒì¼ í˜•ì‹ì…ë‹ˆë‹¤' : 'Invalid file format', 'error');
                    }
                } catch (error) {
                    console.error('Import error:', error);
                    showToast(currentLanguage === 'ko' ? 'íŒŒì¼ì„ ì½ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤' : 'Cannot read file', 'error');
                }
            };
            reader.readAsText(file);
            
            // íŒŒì¼ ì…ë ¥ ì´ˆê¸°í™”
            event.target.value = '';
        }

        // ê¸°ë³¸ ì„¤ì • ë‹¤ìš´ë¡œë“œ
        function downloadDefaultConfig() {
            const config = {
                version: '1.0',
                exportDate: new Date().toISOString(),
                tools: defaultAdminTools
            };
            
            const json = JSON.stringify(config, null, 2);
            const blob = new Blob([json], { type: 'application/json' });
            const link = document.createElement('a');
            link.download = 'default_admin_tools_config.json';
            link.href = URL.createObjectURL(blob);
            link.click();
            
            showToast(currentLanguage === 'ko' ? 'ê¸°ë³¸ ì„¤ì •ì„ ë‹¤ìš´ë¡œë“œí–ˆìŠµë‹ˆë‹¤' : 'Default configuration downloaded', 'success');
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì–´ë“œë¯¼ ë„êµ¬ ì´ˆê¸°í™”
        window.addEventListener('DOMContentLoaded', function() {
            initAdminTools();
        });

        // ì—ëŸ¬ ì „ì—­ ì²˜ë¦¬
        window.addEventListener('error', function(event) {
            console.error('ì „ì—­ ì—ëŸ¬:', event.error);
            showToast(currentLanguage === 'ko' ? 'ì˜ˆìƒì¹˜ ëª»í•œ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤' : 'An unexpected error occurred', 'error');
        });
    </script>

    <!-- ì„ì‹œ íŒŒì¼ ì •ë¦¬ ìŠ¤í¬ë¦½íŠ¸ -->
    <script>
        // ê°œë°œìš© ì„ì‹œ íŒŒì¼ ì •ë¦¬
        const tempScript = document.createElement('script');
        tempScript.text = 'console.log("CEO+ Help v2.0 - ì™„ì „ ê°œí¸ ì™„ë£Œ");';
        document.head.appendChild(tempScript);
    </script>
</body>
</html>