<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì‚¬ì¥ë‹˜ í”ŒëŸ¬ìŠ¤ í—¬í”„ì„¼í„°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .function-selected {
            background-color: #dbeafe !important;
            border-left: 4px solid #3b82f6 !important;
        }
        .admin-selected {
            background-color: #dcfce7 !important;
            border-left: 4px solid #22c55e !important;
        }
        .tab-active {
            background-color: #3b82f6 !important;
            color: white !important;
        }
        .sidebar-collapsed {
            width: 3.5rem !important;
        }
        .sidebar-collapsed .sidebar-text {
            display: none;
        }
        .sidebar-collapsed .sidebar-icon {
            margin: 0 auto;
        }
        .functions-collapsed .sidebar-functions {
            display: none !important;
        }
        .data-generator-collapsed .data-generator-functions {
            display: none !important;
        }
        .function-toggle {
            cursor: pointer;
            user-select: none;
            transition: background-color 0.2s;
        }
        .function-toggle:hover {
            background: #f3f4f6;
        }
        .toggle-btn {
            position: absolute;
            right: -12px;
            top: 50%;
            transform: translateY(-50%);
            width: 24px;
            height: 24px;
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 10;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        .toggle-btn:hover {
            background: #f3f4f6;
        }
        .sidebar-transition {
            transition: width 0.3s ease;
        }
        .admin-panel-collapsed {
            width: 3.5rem !important;
        }
        .admin-panel-collapsed .admin-text {
            display: none !important;
        }
        .admin-panel-collapsed .admin-item > div {
            justify-content: center !important;
        }
        .admin-panel-collapsed .bg-blue-100 {
            margin: 0 auto;
        }
    </style>
</head>
<body class="bg-gray-50">
    <div class="flex h-screen">
        <!-- 1ê³„ì¸µ: ê¸°ëŠ¥ ëª©ë¡ -->
        <div id="function-sidebar" class="w-80 bg-white border-r border-gray-200 flex flex-col sidebar-transition relative">
            <button class="toggle-btn" onclick="toggleFunctionSidebar()">
                <span id="function-toggle-icon">â€¹</span>
            </button>
            
            <!-- í—¤ë” -->
            <div class="p-4 border-b border-gray-200">
                <h2 class="text-lg font-semibold text-gray-800 sidebar-text">ì‚¬ì¥ë‹˜ í”ŒëŸ¬ìŠ¤ í—¬í”„ì„¼í„°</h2>
                <p class="text-sm text-gray-500 mt-1 sidebar-text">ìˆ˜í–‰í•  ì‘ì—…ì„ ì„ íƒí•˜ì„¸ìš”</p>
                <div class="mt-2 sidebar-text">
                    <button id="cookie-sync-btn" class="px-3 py-1 text-xs bg-purple-600 text-white rounded hover:bg-purple-700">
                        ğŸª ì¿ í‚¤ ë™ê¸°í™”
                    </button>
                    <button id="token-sync-btn" class="px-3 py-1 text-xs bg-green-600 text-white rounded hover:bg-green-700 ml-2">
                        ğŸ”„ í† í° ë™ê¸°í™”
                    </button>
                    <span id="token-status" class="text-xs text-gray-400 ml-2 block mt-1">ìƒíƒœ: í™•ì¸ì¤‘...</span>
                </div>
            </div>
            
            <!-- ì–´ë“œë¯¼ ê¸°ëŠ¥ ëª©ë¡ í† ê¸€ í—¤ë” -->
            <div class="function-toggle px-4 py-2 bg-gray-50 border-b border-gray-200 flex items-center justify-between sidebar-text" onclick="toggleFunctions()">
                <span class="font-medium text-gray-700">ì–´ë“œë¯¼ ê¸°ëŠ¥ ëª©ë¡</span>
                <span id="function-arrow" class="text-gray-500">â–²</span>
            </div>
            
            <!-- ì–´ë“œë¯¼ ê¸°ëŠ¥ëª©ë¡ í† ê¸€ í—¤ë” -->
            <div class="function-toggle px-4 py-2 bg-gray-50 border-b border-gray-200 flex items-center justify-between sidebar-text" onclick="toggleAdminFunctions()">
                <span class="font-medium text-gray-700">ì–´ë“œë¯¼ ê¸°ëŠ¥ëª©ë¡</span>
                <span id="admin-functions-arrow" class="text-gray-500">â–¼</span>
            </div>
            
            <!-- ì–´ë“œë¯¼ ê¸°ëŠ¥ ëª©ë¡ -->
            <div class="admin-functions" style="display: none;">
                <div class="function-item p-4 cursor-pointer border-b border-gray-100 hover:bg-blue-50" data-function="qr-create" onclick="openAdminFunction('qr-create')">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-3">
                            <div class="text-blue-600 sidebar-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.096 2.572-1.065z" />
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                                </svg>
                            </div>
                            <div class="sidebar-text">
                                <div class="font-medium text-gray-800">ê°€ë§¹ì  ìƒì„± ë° QR í™œì„±í™”</div>
                                <div class="text-xs text-gray-500 mt-1">3ê°œ ì–´ë“œë¯¼ ì—°ê´€</div>
                            </div>
                        </div>
                        <div class="text-gray-400 sidebar-text">â†’</div>
                    </div>
                </div>

                <div class="function-item p-4 cursor-pointer border-b border-gray-100 hover:bg-blue-50" data-function="qr-recovery" onclick="openAdminFunction('qr-recovery')">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-3">
                            <div class="text-blue-600 sidebar-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
                                </svg>
                            </div>
                            <div class="sidebar-text">
                                <div class="font-medium text-gray-800">ê°€ë§¹ì  QR ë³µêµ¬</div>
                                <div class="text-xs text-gray-500 mt-1">3ê°œ ì–´ë“œë¯¼ ì—°ê´€</div>
                            </div>
                        </div>
                        <div class="text-gray-400 sidebar-text">â†’</div>
                    </div>
                </div>

                <div class="function-item p-4 cursor-pointer border-b border-gray-100 hover:bg-blue-50" data-function="permission" onclick="openAdminFunction('permission')">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-3">
                            <div class="text-blue-600 sidebar-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
                                </svg>
                            </div>
                            <div class="sidebar-text">
                                <div class="font-medium text-gray-800">ë§¤ì¥ ê¶Œí•œë³€ê²½</div>
                                <div class="text-xs text-gray-500 mt-1">3ê°œ ì–´ë“œë¯¼ ì—°ê´€</div>
                            </div>
                        </div>
                        <div class="text-gray-400 sidebar-text">â†’</div>
                    </div>
                </div>
            </div>

            <!-- ë°ì´í„° ìƒì„± í† ê¸€ í—¤ë” -->
            <div class="function-toggle px-4 py-2 bg-gray-50 border-b border-gray-200 flex items-center justify-between sidebar-text" onclick="toggleDataGenerator()">
                <span class="font-medium text-gray-700">ë°ì´í„° ìƒì„±</span>
                <span id="data-generator-arrow" class="text-gray-500">â–¼</span>
            </div>
            
            <!-- ë°ì´í„° ìƒì„± ëª©ë¡ -->
            <div class="data-generator-functions" style="display: none;">
                <div class="function-item p-4 cursor-pointer border-b border-gray-100 hover:bg-blue-50" data-function="sample-image-generator" onclick="openDirectTool('sample-image-generator')">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-3">
                            <div class="text-purple-600 sidebar-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
                                </svg>
                            </div>
                            <div class="sidebar-text">
                                <div class="font-medium text-gray-800">ìƒ˜í”Œ ì´ë¯¸ì§€ ìƒì„±</div>
                                <div class="text-xs text-gray-500 mt-1">ì´ë¯¸ì§€ ìƒì„± ë„êµ¬</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="function-item p-4 cursor-pointer border-b border-gray-100 hover:bg-blue-50" data-function="qr-xlsx-generator" onclick="openDirectTool('qr-xlsx-generator')">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-3">
                            <div class="text-green-600 sidebar-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                                </svg>
                            </div>
                            <div class="sidebar-text">
                                <div class="font-medium text-gray-800">QR XLSX ìƒì„±</div>
                                <div class="text-xs text-gray-500 mt-1">QR ì—‘ì…€ íŒŒì¼ ìƒì„±</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="function-item p-4 cursor-pointer border-b border-gray-100 hover:bg-blue-50" data-function="csv-generator" onclick="openDirectTool('csv-generator')">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-3">
                            <div class="text-blue-600 sidebar-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                                </svg>
                            </div>
                            <div class="sidebar-text">
                                <div class="font-medium text-gray-800">CSV ìƒì„±</div>
                                <div class="text-xs text-gray-500 mt-1">CSV íŒŒì¼ ìƒì„± ë„êµ¬</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 2ê³„ì¸µ: ì–´ë“œë¯¼ ëª©ë¡ -->
        <div id="admin-panel" class="w-80 bg-white border-r border-gray-200 flex-col hidden sidebar-transition relative">
            <button class="toggle-btn" onclick="toggleAdminPanel()">
                <span id="admin-toggle-icon">â€¹</span>
            </button>
            <div class="p-4 border-b border-gray-200">
                <h3 class="text-lg font-semibold text-gray-800 admin-text">ì–´ë“œë¯¼ ëª©ë¡</h3>
                <p class="text-sm text-gray-500 mt-1 admin-text" id="function-name">ì„ íƒëœ ê¸°ëŠ¥</p>
            </div>
            <div class="flex-1 overflow-y-auto" id="admin-list">
                <!-- ì–´ë“œë¯¼ ëª©ë¡ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
            </div>
        </div>

        <!-- 3ê³„ì¸µ: ì½˜í…ì¸  ì˜ì—­ -->
        <div class="flex-1 flex flex-col">
            <!-- íƒ­ í—¤ë” -->
            <div id="tab-header" class="bg-white border-b border-gray-200 hidden">
                <div class="flex items-center p-2">
                    <div id="tab-list" class="flex-1 flex items-center space-x-1 overflow-x-auto">
                        <!-- íƒ­ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
                    </div>
                    <button id="new-tab-btn" class="px-3 py-1 text-sm bg-gray-200 rounded hover:bg-gray-300 ml-2">
                        + ìƒˆ íƒ­
                    </button>
                    <button id="new-window-btn" class="px-3 py-1 text-sm bg-blue-500 text-white rounded hover:bg-blue-600 ml-2">
                        + ìƒˆ ì°½
                    </button>
                </div>
            </div>
            
            <!-- ì½˜í…ì¸  ì˜ì—­ -->
            <div class="flex-1 bg-white relative" id="content-container">
                <div id="empty-state" class="flex items-center justify-center h-full">
                    <div class="text-center">
                        <div class="text-6xl mb-4">ğŸ–¥ï¸</div>
                        <h3 class="text-xl font-medium text-gray-500 mb-2">ì–´ë“œë¯¼ì„ ì„ íƒí•˜ì„¸ìš”</h3>
                        <p class="text-gray-400">ë¨¼ì € ìˆ˜í–‰í•  ê¸°ëŠ¥ì„ ì„ íƒí•œ í›„ ì–´ë“œë¯¼ì„ ì„ íƒí•˜ì„¸ìš”</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ì¿ í‚¤ ë™ê¸°í™” ëª¨ë‹¬ -->
    <div id="cookie-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50">
        <div class="bg-white rounded-lg p-6 max-w-2xl w-full m-4 max-h-[80vh] overflow-y-auto">
            <h3 class="text-lg font-semibold mb-4">ğŸª ì¿ í‚¤ ê´€ë¦¬</h3>
            <div class="mb-4">
                <h4 class="font-medium mb-2">í˜„ì¬ ì €ì¥ëœ ì¿ í‚¤:</h4>
                <div id="cookie-list" class="bg-gray-100 p-3 rounded text-sm font-mono max-h-40 overflow-y-auto">
                    ë¡œë”©ì¤‘...
                </div>
            </div>
            <div class="mb-4">
                <h4 class="font-medium mb-2">ì¿ í‚¤ ì¶”ê°€/ìˆ˜ì •:</h4>
                <input id="cookie-input" type="text" 
                       placeholder="name=value; domain=.example.com; path=/" 
                       class="w-full p-2 border rounded text-sm">
                <button onclick="addCookie()" class="mt-2 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">
                    ì¿ í‚¤ ì¶”ê°€
                </button>
            </div>
            <button onclick="closeCookieModal()" class="w-full p-3 bg-gray-300 text-gray-700 rounded hover:bg-gray-400">
                ë‹«ê¸°
            </button>
        </div>
    </div>

    <script>
        // ì „ì—­ ë³€ìˆ˜
        const functionData = {
            'qr-create': {
                name: 'ê°€ë§¹ì  ìƒì„± ë° QR í™œì„±í™”',
                admins: [
                    {
                        name: 'ì™€ì¹¸ë‹¤_ì‹ ì²­ì„œ',
                        url: 'https://www.google.com',
                        desc: 'ê°€ë§¹ì  ì‹ ì²­ì„œ ì‘ì„±',
                        isInternal: false
                    },
                    {
                        name: 'ì™€ì¹¸ë‹¤_í™œì„±í™”',
                        url: 'https://www.naver.com',
                        desc: 'ê°€ë§¹ì  í™œì„±í™” ì²˜ë¦¬',
                        isInternal: false
                    },
                    {
                        name: 'ì˜¤í”„ë¼ì¸_QRìƒì„±ìš”ì²­',
                        url: 'https://admin.example.com/qr',
                        desc: 'ì˜¤í”„ë¼ì¸ QR ìƒì„±',
                        isInternal: true
                    }
                ]
            },
            'qr-recovery': {
                name: 'ê°€ë§¹ì  QR ë³µêµ¬',
                admins: [
                    {
                        name: 'QR ê´€ë¦¬',
                        url: 'https://admin.example.com/qr-manage',
                        desc: 'QR ë³µêµ¬',
                        isInternal: true
                    },
                    {
                        name: 'ë¡œê·¸ ê´€ë¦¬',
                        url: 'https://admin.example.com/logs',
                        desc: 'ë¡œê·¸ í™•ì¸',
                        isInternal: true
                    },
                    {
                        name: 'ê°€ë§¹ì  ê´€ë¦¬',
                        url: 'https://www.kakao.com',
                        desc: 'ìƒíƒœ í™•ì¸',
                        isInternal: false
                    }
                ]
            },
            'permission': {
                name: 'ë§¤ì¥ ê¶Œí•œë³€ê²½',
                admins: [
                    {
                        name: 'ê¶Œí•œ ê´€ë¦¬',
                        url: 'https://admin.example.com/permissions',
                        desc: 'ê¶Œí•œ ì„¤ì •',
                        isInternal: true
                    },
                    {
                        name: 'ì‚¬ìš©ì ê´€ë¦¬',
                        url: 'https://admin.example.com/users',
                        desc: 'ì—­í•  ê´€ë¦¬',
                        isInternal: true
                    },
                    {
                        name: 'ê°ì‚¬ ê´€ë¦¬',
                        url: 'https://www.youtube.com',
                        desc: 'ë³€ê²½ ì´ë ¥',
                        isInternal: false
                    }
                ]
            },
            'data-generator': {
                name: 'ë°ì´í„° ìƒì„±',
                admins: [
                    {
                        name: 'ìƒ˜í”Œ ì´ë¯¸ì§€ ìƒì„±ê¸°',
                        url: 'data:text/html;charset=utf-8,' + encodeURIComponent(getDataGeneratorHTML()),
                        desc: 'ë‹¤ì–‘í•œ í¬ë§·ì˜ ìƒ˜í”Œ ì´ë¯¸ì§€ ìƒì„±',
                        isInternal: true
                    },
                    {
                        name: 'QR XLSX ìƒì„±ê¸°',
                        url: 'data:text/html;charset=utf-8,' + encodeURIComponent(getDataGeneratorHTML()),
                        desc: 'QR ë°ì´í„° XLSX íŒŒì¼ ìƒì„±',
                        isInternal: true
                    },
                    {
                        name: 'CSV ìƒì„±ê¸°',
                        url: 'data:text/html;charset=utf-8,' + encodeURIComponent(getDataGeneratorHTML()),
                        desc: 'ì»¤ìŠ¤í…€ CSV íŒŒì¼ ìƒì„±',
                        isInternal: true
                    }
                ]
            }
        };

        let selectedFunction = null;
        let selectedAdmin = null;
        let windowRefs = {};
        let tabs = [];
        let activeTabId = null;
        let tabCounter = 0;

        // ìƒ˜í”Œ ì´ë¯¸ì§€ ìƒì„±ê¸° HTML
        function getSampleImageGeneratorHTML() {
            return '<div class="h-full overflow-auto bg-white">' +
                '<div class="p-6 border-b border-gray-200">' +
                    '<h1 class="text-2xl font-bold text-gray-800">ìƒ˜í”Œ ì´ë¯¸ì§€ ìƒì„±ê¸°</h1>' +
                    '<p class="text-gray-600 mt-2">ë‹¤ì–‘í•œ í¬ë§·ì˜ ìƒ˜í”Œ ì´ë¯¸ì§€ë¥¼ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>' +
                '</div>' +
                '<div class="p-6">' +
                    '<div class="max-w-2xl mx-auto">' +
                        '<div class="grid grid-cols-1 md:grid-cols-2 gap-6">' +
                            '<div class="space-y-4">' +
                                '<div>' +
                                    '<label class="block text-sm font-medium text-gray-700 mb-2">ì´ë¯¸ì§€ í¬ê¸°</label>' +
                                    '<select id="sample-imageSize" class="w-full px-3 py-2 border border-gray-300 rounded-md">' +
                                        '<option value="100x100">100x100</option>' +
                                        '<option value="200x200">200x200</option>' +
                                        '<option value="400x400" selected>400x400</option>' +
                                        '<option value="800x600">800x600</option>' +
                                        '<option value="1920x1080">1920x1080</option>' +
                                    '</select>' +
                                '</div>' +
                                '<div>' +
                                    '<label class="block text-sm font-medium text-gray-700 mb-2">ë°°ê²½ìƒ‰</label>' +
                                    '<input type="color" id="sample-bgColor" value="#f0f0f0" class="w-full h-10 border border-gray-300 rounded-md">' +
                                '</div>' +
                                '<div>' +
                                    '<label class="block text-sm font-medium text-gray-700 mb-2">í…ìŠ¤íŠ¸</label>' +
                                    '<input type="text" id="sample-imageText" value="Sample Image" class="w-full px-3 py-2 border border-gray-300 rounded-md">' +
                                '</div>' +
                                '<button onclick="generateSampleImage()" class="w-full bg-purple-600 text-white py-2 px-4 rounded-md hover:bg-purple-700">' +
                                    'ì´ë¯¸ì§€ ìƒì„±' +
                                '</button>' +
                            '</div>' +
                            '<div>' +
                                '<div class="border border-gray-300 rounded-md p-4 bg-gray-50 min-h-64 flex items-center justify-center">' +
                                    '<canvas id="sample-canvas" class="border border-gray-200"></canvas>' +
                                '</div>' +
                                '<button id="sample-downloadBtn" onclick="downloadSampleImage()" class="w-full mt-4 bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700 disabled:opacity-50" disabled>' +
                                    'ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ' +
                                '</button>' +
                            '</div>' +
                        '</div>' +
                    '</div>' +
                '</div>' +
                '<script>' +
                    'function generateSampleImage() {' +
                        'const canvas = document.getElementById("sample-canvas");' +
                        'const ctx = canvas.getContext("2d");' +
                        'const size = document.getElementById("sample-imageSize").value;' +
                        'const [width, height] = size.split("x").map(Number);' +
                        'const bgColor = document.getElementById("sample-bgColor").value;' +
                        'const text = document.getElementById("sample-imageText").value;' +
                        'canvas.width = width;' +
                        'canvas.height = height;' +
                        'canvas.style.maxWidth = "100%";' +
                        'canvas.style.height = "auto";' +
                        'ctx.fillStyle = bgColor;' +
                        'ctx.fillRect(0, 0, width, height);' +
                        'ctx.fillStyle = "#333333";' +
                        'ctx.font = Math.max(16, width/20) + "px Arial";' +
                        'ctx.textAlign = "center";' +
                        'ctx.textBaseline = "middle";' +
                        'ctx.fillText(text, width/2, height/2);' +
                        'ctx.font = Math.max(12, width/30) + "px Arial";' +
                        'ctx.fillText(width + " Ã— " + height, width/2, height/2 + Math.max(30, width/15));' +
                        'document.getElementById("sample-downloadBtn").disabled = false;' +
                    '}' +
                    'function downloadSampleImage() {' +
                        'const canvas = document.getElementById("sample-canvas");' +
                        'const link = document.createElement("a");' +
                        'link.download = "sample-image.png";' +
                        'link.href = canvas.toDataURL();' +
                        'link.click();' +
                    '}' +
                    'setTimeout(generateSampleImage, 100);' +
                '</script>' +
            '</div>';
        }

        // QR XLSX ìƒì„±ê¸° HTML
        function getQRXlsxGeneratorHTML() {
            return '<div class="h-full overflow-auto bg-white">' +
                '<div class="p-6 border-b border-gray-200">' +
                    '<h1 class="text-2xl font-bold text-gray-800">QR XLSX ìƒì„±ê¸°</h1>' +
                    '<p class="text-gray-600 mt-2">QR ì½”ë“œ ì •ë³´ê°€ í¬í•¨ëœ XLSX íŒŒì¼ì„ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>' +
                '</div>' +
                '<div class="p-6">' +
                    '<div class="max-w-4xl mx-auto space-y-6">' +
                        '<div class="grid grid-cols-1 md:grid-cols-2 gap-6">' +
                            '<div>' +
                                '<label class="block text-sm font-medium text-gray-700 mb-2">ìƒì„±í•  QR ê°œìˆ˜</label>' +
                                '<input type="number" id="qr-count" value="10" min="1" max="1000" class="w-full px-3 py-2 border border-gray-300 rounded-md">' +
                            '</div>' +
                            '<div>' +
                                '<label class="block text-sm font-medium text-gray-700 mb-2">ë² ì´ìŠ¤ URL</label>' +
                                '<input type="text" id="qr-baseUrl" value="https://example.com/qr/" class="w-full px-3 py-2 border border-gray-300 rounded-md">' +
                            '</div>' +
                        '</div>' +
                        '<button onclick="generateQRXlsx()" class="bg-green-600 text-white py-3 px-6 rounded-md hover:bg-green-700">QR XLSX íŒŒì¼ ìƒì„±</button>' +
                        '<div id="qr-preview" class="mt-6 p-4 border border-gray-300 rounded-md bg-gray-50 hidden">' +
                            '<h3 class="text-lg font-medium mb-4">ìƒì„± ì™„ë£Œ!</h3>' +
                            '<p>XLSX íŒŒì¼ì´ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤.</p>' +
                        '</div>' +
                    '</div>' +
                '</div>' +
                '<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>' +
                '<script>' +
                    'function generateQRXlsx() {' +
                        'const count = parseInt(document.getElementById("qr-count").value);' +
                        'const baseText = document.getElementById("qr-baseUrl").value;' +
                        'const data = [["ID", "QR_Data", "Created_At"]];' +
                        'for (let i = 1; i <= count; i++) {' +
                            'data.push([i, baseText + i.toString().padStart(4, "0"), new Date().toISOString()]);' +
                        '}' +
                        'const ws = XLSX.utils.aoa_to_sheet(data);' +
                        'const wb = XLSX.utils.book_new();' +
                        'XLSX.utils.book_append_sheet(wb, ws, "QR_Data");' +
                        'XLSX.writeFile(wb, "QR_Data_" + new Date().toISOString().split("T")[0] + ".xlsx");' +
                        'document.getElementById("qr-preview").classList.remove("hidden");' +
                    '}' +
                '</script>' +
            '</div>';
        }

        // CSV ìƒì„±ê¸° HTML  
        function getCsvGeneratorHTML() {
            return '<div class="h-full overflow-auto bg-white">' +
                '<div class="p-6 border-b border-gray-200">' +
                    '<h1 class="text-2xl font-bold text-gray-800">CSV ìƒì„±ê¸°</h1>' +
                    '<p class="text-gray-600 mt-2">ì»¤ìŠ¤í…€ CSV íŒŒì¼ì„ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>' +
                '</div>' +
                '<div class="p-6">' +
                    '<div class="max-w-4xl mx-auto space-y-6">' +
                        '<div class="grid grid-cols-1 md:grid-cols-2 gap-6">' +
                            '<div>' +
                                '<label class="block text-sm font-medium text-gray-700 mb-2">ë°ì´í„° í–‰ ìˆ˜</label>' +
                                '<input type="number" id="csv-rowCount" value="10" min="1" max="1000" class="w-full px-3 py-2 border border-gray-300 rounded-md">' +
                            '</div>' +
                            '<div>' +
                                '<label class="block text-sm font-medium text-gray-700 mb-2">ì»¬ëŸ¼ í—¤ë” (ì½¤ë§ˆë¡œ êµ¬ë¶„)</label>' +
                                '<input type="text" id="csv-headers" value="ID,Name,Email,Phone" class="w-full px-3 py-2 border border-gray-300 rounded-md">' +
                            '</div>' +
                        '</div>' +
                        '<button onclick="generateCsvFile()" class="bg-blue-600 text-white py-3 px-6 rounded-md hover:bg-blue-700">CSV íŒŒì¼ ìƒì„±</button>' +
                        '<div id="csv-preview" class="mt-6 p-4 border border-gray-300 rounded-md bg-gray-50 hidden">' +
                            '<h3 class="text-lg font-medium mb-4">ìƒì„± ì™„ë£Œ!</h3>' +
                            '<p>CSV íŒŒì¼ì´ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤.</p>' +
                        '</div>' +
                    '</div>' +
                '</div>' +
                '<script>' +
                    'function generateCsvFile() {' +
                        'const rowCount = parseInt(document.getElementById("csv-rowCount").value);' +
                        'const headers = document.getElementById("csv-headers").value.split(",").map(h => h.trim());' +
                        'let csvContent = headers.join(",") + "\\n";' +
                        'for (let i = 1; i <= rowCount; i++) {' +
                            'const row = headers.map(header => {' +
                                'if (header.toLowerCase().includes("id")) return i;' +
                                'if (header.toLowerCase().includes("name")) return "Sample" + i;' +
                                'if (header.toLowerCase().includes("email")) return "sample" + i + "@example.com";' +
                                'if (header.toLowerCase().includes("phone")) return "010-1234-567" + (i % 10);' +
                                'return "Data" + i;' +
                            '});' +
                            'csvContent += row.join(",") + "\\n";' +
                        '}' +
                        'const blob = new Blob([csvContent], { type: "text/csv;charset=utf-8;" });' +
                        'const link = document.createElement("a");' +
                        'const url = URL.createObjectURL(blob);' +
                        'link.setAttribute("href", url);' +
                        'link.setAttribute("download", "custom_data_" + new Date().toISOString().split("T")[0] + ".csv");' +
                        'link.click();' +
                        'document.getElementById("csv-preview").classList.remove("hidden");' +
                    '}' +
                '</script>' +
            '</div>';
        }

        // ì¿ í‚¤ ê´€ë¦¬ í•¨ìˆ˜
        function getAllCookies() {
            const cookies = {};
            document.cookie.split(';').forEach(cookie => {
                const [name, value] = cookie.trim().split('=');
                if (name) cookies[name] = value;
            });
            return cookies;
        }

        function setCookie(name, value, options = {}) {
            let cookieString = name + '=' + value;
            
            if (options.domain) cookieString += '; domain=' + options.domain;
            if (options.path) cookieString += '; path=' + options.path;
            if (options.expires) cookieString += '; expires=' + options.expires;
            if (options.maxAge) cookieString += '; max-age=' + options.maxAge;
            if (options.secure) cookieString += '; secure';
            if (options.sameSite) cookieString += '; samesite=' + options.sameSite;
            
            document.cookie = cookieString;
        }

        function showCookieModal() {
            const modal = document.getElementById('cookie-modal');
            modal.classList.remove('hidden');
            updateCookieList();
        }

        function closeCookieModal() {
            document.getElementById('cookie-modal').classList.add('hidden');
        }

        function updateCookieList() {
            const cookies = getAllCookies();
            const cookieList = document.getElementById('cookie-list');
            
            if (Object.keys(cookies).length === 0) {
                cookieList.textContent = 'ì¿ í‚¤ê°€ ì—†ìŠµë‹ˆë‹¤.';
            } else {
                cookieList.innerHTML = Object.entries(cookies)
                    .map(([name, value]) => '<div>' + name + '=' + value + '</div>')
                    .join('');
            }
        }

        function addCookie() {
            const input = document.getElementById('cookie-input').value.trim();
            if (!input) return;
            
            try {
                // ê°„ë‹¨í•œ ì¿ í‚¤ íŒŒì‹±
                const parts = input.split(';').map(p => p.trim());
                const [name, value] = parts[0].split('=');
                
                const options = {};
                parts.slice(1).forEach(part => {
                    const [key, val] = part.split('=');
                    options[key.toLowerCase()] = val || true;
                });
                
                setCookie(name, value, options);
                updateCookieList();
                document.getElementById('cookie-input').value = '';
                alert('ì¿ í‚¤ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.');
            } catch (e) {
                alert('ì˜¬ë°”ë¥¸ ì¿ í‚¤ í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤.');
            }
        }

        // í† í° ê´€ë¦¬ í•¨ìˆ˜
        function getStoredTokens() {
            const tokens = {
                localStorage: {},
                sessionStorage: {},
                cookies: {}
            };
            
            // localStorage í† í°
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                if (key && (key.includes('token') || key.includes('auth') || key.includes('session'))) {
                    tokens.localStorage[key] = localStorage.getItem(key);
                }
            }
            
            // sessionStorage í† í°
            for (let i = 0; i < sessionStorage.length; i++) {
                const key = sessionStorage.key(i);
                if (key && (key.includes('token') || key.includes('auth') || key.includes('session'))) {
                    tokens.sessionStorage[key] = sessionStorage.getItem(key);
                }
            }
            
            // ì¿ í‚¤ í† í°
            const cookies = getAllCookies();
            Object.entries(cookies).forEach(([name, value]) => {
                if (name.includes('token') || name.includes('auth') || name.includes('session')) {
                    tokens.cookies[name] = value;
                }
            });
            
            return tokens;
        }

        function updateTokenStatus() {
            const tokens = getStoredTokens();
            const statusEl = document.getElementById('token-status');
            
            const totalCount = 
                Object.keys(tokens.localStorage).length + 
                Object.keys(tokens.sessionStorage).length + 
                Object.keys(tokens.cookies).length;
            
            if (totalCount > 0) {
                statusEl.innerHTML = 
                    '<span class="text-green-600">âœ… í† í° ' + totalCount + 'ê°œ ë°œê²¬</span>' +
                    '<span class="text-xs text-gray-500 block">' +
                        'Local: ' + Object.keys(tokens.localStorage).length + ', ' +
                        'Session: ' + Object.keys(tokens.sessionStorage).length + ', ' +
                        'Cookie: ' + Object.keys(tokens.cookies).length +
                    '</span>';
            } else {
                statusEl.innerHTML = '<span class="text-red-600">âŒ í† í° ì—†ìŒ</span>';
            }
        }

        function syncTokens() {
            const tokens = getStoredTokens();
            console.log('ë™ê¸°í™”í•  í† í°:', tokens);
            
            // ì—´ë ¤ìˆëŠ” ëª¨ë“  ì°½ì— í† í° ì „ì†¡ ì‹œë„
            Object.values(windowRefs).forEach(win => {
                if (win && !win.closed) {
                    try {
                        win.postMessage({
                            type: 'SYNC_TOKENS',
                            tokens: tokens
                        }, '*');
                    } catch (e) {
                        console.log('í† í° ì „ì†¡ ì‹¤íŒ¨:', e);
                    }
                }
            });
            
            alert('í† í° ë™ê¸°í™”ë¥¼ ì‹œë„í–ˆìŠµë‹ˆë‹¤. ê°œë°œì ì½˜ì†”ì„ í™•ì¸í•˜ì„¸ìš”.');
        }

        // UI í•¨ìˆ˜
        function selectFunction(funcId, element) {
            selectedFunction = funcId;
            selectedAdmin = null;

            document.querySelectorAll('.function-item').forEach(item => {
                item.classList.remove('function-selected');
            });
            element.classList.add('function-selected');

            const adminPanel = document.getElementById('admin-panel');
            adminPanel.classList.remove('hidden');
            adminPanel.classList.add('flex');

            document.getElementById('function-name').textContent = functionData[funcId].name;

            const adminList = document.getElementById('admin-list');
            adminList.innerHTML = '';

            functionData[funcId].admins.forEach((admin, index) => {
                const adminItem = document.createElement('div');
                adminItem.className = 'admin-item p-4 cursor-pointer border-b border-gray-100 hover:bg-green-50';
                adminItem.innerHTML = 
                    '<div class="flex items-center justify-between">' +
                        '<span class="bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded flex-shrink-0">' + (index + 1) + '</span>' +
                        '<div class="flex-1 ml-3 admin-text">' +
                            '<div class="font-medium text-gray-800 flex items-center space-x-2">' +
                                '<span>' + admin.name + '</span>' +
                                (admin.isInternal ? '<span class="bg-yellow-100 text-yellow-800 text-xs px-2 py-1 rounded">ë‚´ë¶€</span>' : '') +
                            '</div>' +
                            '<div class="text-sm text-gray-500 mt-1">' + admin.desc + '</div>' +
                            '<div class="text-xs text-gray-400 mt-1 truncate">' + admin.url + '</div>' +
                        '</div>' +
                        '<div class="text-gray-400 admin-text ml-2">â†’</div>' +
                    '</div>';

                adminItem.addEventListener('click', () => selectAdmin(admin, adminItem));
                adminList.appendChild(adminItem);
            });
        }

        function selectAdmin(admin, element) {
            selectedAdmin = admin;

            document.querySelectorAll('.admin-item').forEach(item => {
                item.classList.remove('admin-selected');
            });
            element.classList.add('admin-selected');

            openAdminPage(admin);
        }

        function openAdminPage(admin) {
            if (admin.isInternal) {
                // ë‚´ë¶€ ì–´ë“œë¯¼ì€ íƒ­ìœ¼ë¡œ ì—´ê¸°
                createTab(admin);
            } else {
                // ì™¸ë¶€ ì‚¬ì´íŠ¸ëŠ” ìƒˆ ì°½ìœ¼ë¡œ ì—´ê¸°
                const windowName = 'admin_' + admin.name.replace(/\s/g, '_');
                const windowFeatures = 'width=1200,height=800,menubar=yes,toolbar=yes,location=yes,status=yes,scrollbars=yes,resizable=yes';
                
                const win = window.open(admin.url, windowName, windowFeatures);
                windowRefs[windowName] = win;
                
                // ë¹ˆ ìƒíƒœ í™”ë©´ ì—…ë°ì´íŠ¸
                const emptyState = document.getElementById('empty-state');
                emptyState.innerHTML = 
                    '<div class="text-center">' +
                        '<div class="text-6xl mb-4">ğŸªŸ</div>' +
                        '<h3 class="text-xl font-medium text-gray-700 mb-2">' + admin.name + '</h3>' +
                        '<p class="text-gray-500 mb-4">ìƒˆ ì°½ì—ì„œ ì—´ë ¸ìŠµë‹ˆë‹¤</p>' +
                        '<div class="space-y-2">' +
                            '<button onclick="focusWindow(&quot;' + windowName + '&quot;)" class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">' +
                                'ì°½ìœ¼ë¡œ ì´ë™' +
                            '</button>' +
                        '</div>' +
                    '</div>';
            }
        }

        // íƒ­ ê´€ë¦¬ í•¨ìˆ˜ë“¤
        function createTab(admin) {
            const tabId = ++tabCounter;
            const tab = {
                id: tabId,
                admin: admin,
                active: false
            };
            tabs.push(tab);
            
            // íƒ­ í—¤ë” ì¶”ê°€
            const tabElement = document.createElement('div');
            tabElement.id = 'tab-' + tabId;
            tabElement.className = 'flex items-center px-3 py-1 bg-gray-200 rounded cursor-pointer hover:bg-gray-300';
            tabElement.innerHTML = 
                '<span class="text-sm truncate max-w-[150px]">' + admin.name + '</span>' +
                '<button class="ml-2 text-xs hover:text-red-500" onclick="closeTab(' + tabId + ')">Ã—</button>';
            tabElement.addEventListener('click', (e) => {
                if (e.target.tagName !== 'BUTTON') {
                    activateTab(tabId);
                }
            });
            
            document.getElementById('tab-list').appendChild(tabElement);
            
            // íƒ­ ì½˜í…ì¸  ì¶”ê°€
            const tabContent = document.createElement('div');
            tabContent.id = 'tab-content-' + tabId;
            tabContent.className = 'absolute inset-0 bg-white hidden flex flex-col';
            tabContent.innerHTML = 
                '<div class="bg-gray-100 p-2 border-b flex items-center space-x-2 flex-shrink-0">' +
                    '<button class="nav-btn px-2 py-1 bg-gray-200 rounded text-xs hover:bg-gray-300" onclick="navigateTab(' + tabId + ', &quot;back&quot;)">â†</button>' +
                    '<button class="nav-btn px-2 py-1 bg-gray-200 rounded text-xs hover:bg-gray-300" onclick="navigateTab(' + tabId + ', &quot;forward&quot;)">â†’</button>' +
                    '<button class="nav-btn px-2 py-1 bg-gray-200 rounded text-xs hover:bg-gray-300" onclick="navigateTab(' + tabId + ', &quot;refresh&quot;)">âŸ³</button>' +
                    '<input class="address-bar flex-1 px-2 py-1 border rounded text-xs" value="' + admin.url + '" id="address-' + tabId + '" onkeypress="handleAddressKeypress(event, ' + tabId + ')">' +
                    '<button class="nav-btn px-2 py-1 bg-blue-500 text-white rounded text-xs hover:bg-blue-600" onclick="navigateTab(' + tabId + ', &quot;go&quot;)">ì´ë™</button>' +
                    '<button class="nav-btn px-2 py-1 bg-green-500 text-white rounded text-xs hover:bg-green-600" onclick="openInNewWindow(&quot;' + admin.url + '&quot;)">ğŸªŸ</button>' +
                '</div>' +
                '<div class="flex-1 relative">' +
                    '<iframe src="' + admin.url + '" ' +
                            'class="w-full h-full border-0" ' +
                            'id="iframe-' + tabId + '" ' +
                            'sandbox="allow-same-origin allow-scripts allow-popups allow-forms">' +
                    '</iframe>' +
                '</div>';
            
            document.getElementById('content-container').appendChild(tabContent);
            
            // íƒ­ í—¤ë” í‘œì‹œ
            document.getElementById('tab-header').classList.remove('hidden');
            document.getElementById('empty-state').classList.add('hidden');
            
            // íƒ­ í™œì„±í™”
            activateTab(tabId);
            
            // 401 ì—ëŸ¬ ì²˜ë¦¬ë¥¼ ìœ„í•œ ë¦¬ìŠ¤ë„ˆ
            const iframe = document.getElementById('iframe-' + tabId);
            iframe.addEventListener('load', () => {
                handleIframeLoad(iframe, admin);
            });
        }
        
        function activateTab(tabId) {
            activeTabId = tabId;
            
            // ëª¨ë“  íƒ­ ë¹„í™œì„±í™”
            tabs.forEach(tab => {
                document.getElementById('tab-' + tab.id).classList.remove('tab-active');
                document.getElementById('tab-content-' + tab.id).classList.add('hidden');
                tab.active = false;
            });
            
            // ì„ íƒëœ íƒ­ í™œì„±í™”
            const selectedTab = tabs.find(t => t.id === tabId);
            if (selectedTab) {
                document.getElementById('tab-' + tabId).classList.add('tab-active');
                document.getElementById('tab-content-' + tabId).classList.remove('hidden');
                selectedTab.active = true;
            }
        }
        
        function closeTab(tabId) {
            const index = tabs.findIndex(t => t.id === tabId);
            if (index > -1) {
                tabs.splice(index, 1);
                document.getElementById('tab-' + tabId).remove();
                document.getElementById('tab-content-' + tabId).remove();
                
                if (tabs.length === 0) {
                    document.getElementById('tab-header').classList.add('hidden');
                    document.getElementById('empty-state').classList.remove('hidden');
                } else if (activeTabId === tabId) {
                    activateTab(tabs[tabs.length - 1].id);
                }
            }
        }
        
        function handleIframeLoad(iframe, admin) {
            try {
                // ë™ì¼ ì¶œì²˜ì¼ ë•Œë§Œ ì ‘ê·¼ ê°€ëŠ¥
                const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
                
                // 401 ì—ëŸ¬ ì²´í¬
                if (iframeDoc.title.includes('401') || iframeDoc.body.textContent.includes('Unauthorized')) {
                    console.log('401 ì—ëŸ¬ ê°ì§€ë¨');
                    
                    // íŒ í‘œì‹œ
                    const tipDiv = document.createElement('div');
                    tipDiv.className = 'absolute top-0 left-0 right-0 bg-yellow-50 border-b border-yellow-200 p-3';
                    tipDiv.innerHTML = `
                        <div class="flex items-center justify-between">
                            <div class="flex items-center space-x-2">
                                <span class="text-yellow-600">âš ï¸</span>
                                <span class="text-sm text-yellow-800">401 ì—ëŸ¬ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì¿ í‚¤ ë™ê¸°í™”ë¥¼ ì‹œë„í•˜ê±°ë‚˜ í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•˜ì„¸ìš”.</span>
                            </div>
                            <button onclick="this.parentElement.parentElement.remove()" class="text-yellow-600 hover:text-yellow-800">Ã—</button>
                        </div>
                    `;
                    iframe.parentElement.appendChild(tipDiv);
                }
            } catch (e) {
                // Cross-origin ì œí•œìœ¼ë¡œ ì ‘ê·¼ ë¶ˆê°€
                console.log('iframe ì½˜í…ì¸  ì ‘ê·¼ ë¶ˆê°€ (cross-origin)');
            }
        }
        
        // ë„¤ë¹„ê²Œì´ì…˜ í•¨ìˆ˜ë“¤
        function navigateTab(tabId, action) {
            const iframe = document.getElementById('iframe-' + tabId);
            const addressBar = document.getElementById('address-' + tabId);
            
            switch (action) {
                case 'back':
                    try {
                        iframe.contentWindow.history.back();
                    } catch (e) {
                        console.log('ë’¤ë¡œê°€ê¸° ì‹¤íŒ¨:', e);
                    }
                    break;
                case 'forward':
                    try {
                        iframe.contentWindow.history.forward();
                    } catch (e) {
                        console.log('ì•ìœ¼ë¡œê°€ê¸° ì‹¤íŒ¨:', e);
                    }
                    break;
                case 'refresh':
                    iframe.src = iframe.src;
                    break;
                case 'go':
                    const url = addressBar.value;
                    if (url && url.trim()) {
                        iframe.src = url.trim();
                    }
                    break;
            }
        }
        
        function handleAddressKeypress(event, tabId) {
            if (event.key === 'Enter') {
                navigateTab(tabId, 'go');
            }
        }
        
        function openInNewWindow(url) {
            const windowFeatures = 'width=1200,height=800,menubar=yes,toolbar=yes,location=yes,status=yes,scrollbars=yes,resizable=yes';
            window.open(url, '_blank', windowFeatures);
        }
        
        function focusWindow(windowName) {
            const win = windowRefs[windowName];
            if (win && !win.closed) {
                win.focus();
            } else {
                alert('ì°½ì´ ë‹«í˜”ìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì„ íƒí•´ì£¼ì„¸ìš”.');
            }
        }

        // ì‚¬ì´ë“œë°” í† ê¸€ í•¨ìˆ˜ë“¤
        function toggleFunctionSidebar() {
            const sidebar = document.getElementById('function-sidebar');
            const adminPanel = document.getElementById('admin-panel');
            const icon = document.getElementById('function-toggle-icon');
            
            sidebar.classList.toggle('sidebar-collapsed');
            
            if (sidebar.classList.contains('sidebar-collapsed')) {
                icon.textContent = 'â€º';
                // ê¸°ëŠ¥ ëª©ë¡ì´ ì ‘íˆë©´ ì–´ë“œë¯¼ íŒ¨ë„ë„ ìˆ¨ê¹€
                adminPanel.classList.add('hidden');
                adminPanel.classList.remove('flex');
            } else {
                icon.textContent = 'â€¹';
            }
        }
        
        function toggleFunctions() {
            const sidebar = document.getElementById('function-sidebar');
            const arrow = document.getElementById('function-arrow');
            
            sidebar.classList.toggle('functions-collapsed');
            
            if (sidebar.classList.contains('functions-collapsed')) {
                arrow.textContent = 'â–¼';
            } else {
                arrow.textContent = 'â–²';
            }
        }
        
        function toggleDataGenerator() {
            const dataGeneratorFunctions = document.querySelector('.data-generator-functions');
            const arrow = document.getElementById('data-generator-arrow');
            
            if (dataGeneratorFunctions.style.display === 'none') {
                dataGeneratorFunctions.style.display = 'block';
                arrow.textContent = 'â–²';
            } else {
                dataGeneratorFunctions.style.display = 'none';
                arrow.textContent = 'â–¼';
            }
        }

        function toggleAdminFunctions() {
            const adminFunctions = document.querySelector('.admin-functions');
            const arrow = document.getElementById('admin-functions-arrow');
            
            if (adminFunctions.style.display === 'none') {
                adminFunctions.style.display = 'block';
                arrow.textContent = 'â–²';
            } else {
                adminFunctions.style.display = 'none';
                arrow.textContent = 'â–¼';
            }
        }

        function openAdminFunction(functionId) {
            // ì–´ë“œë¯¼ íŒ¨ë„ ìˆ¨ê¸°ê¸°
            const adminPanel = document.getElementById('admin-panel');
            adminPanel.classList.add('hidden');
            
            // ë¹ˆ ìƒíƒœ ìˆ¨ê¸°ê¸°
            const emptyState = document.getElementById('empty-state');
            if (emptyState) {
                emptyState.style.display = 'none';
            }
            
            // ê¸°ì¡´ ì½˜í…ì¸  ì •ë¦¬
            const contentContainer = document.getElementById('content-container');
            let webPageUrl = '';
            let title = '';
            
            switch(functionId) {
                case 'qr-create':
                    webPageUrl = 'https://example.com/qr-create'; // ì‹¤ì œ URLë¡œ êµì²´ í•„ìš”
                    title = 'ê°€ë§¹ì  ìƒì„± ë° QR í™œì„±í™”';
                    break;
                case 'qr-recovery':
                    webPageUrl = 'https://example.com/qr-recovery'; // ì‹¤ì œ URLë¡œ êµì²´ í•„ìš”
                    title = 'ê°€ë§¹ì  QR ë³µêµ¬';
                    break;
                case 'permission':
                    webPageUrl = 'https://example.com/permission'; // ì‹¤ì œ URLë¡œ êµì²´ í•„ìš”
                    title = 'ë§¤ì¥ ê¶Œí•œë³€ê²½';
                    break;
                default:
                    contentContainer.innerHTML = '<div class="p-8 text-center">ê¸°ëŠ¥ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</div>';
                    return;
            }
            
            // iframeìœ¼ë¡œ ì›¹í˜ì´ì§€ í‘œì‹œ
            contentContainer.innerHTML = 
                '<div class="w-full h-full bg-white">' +
                    '<div class="border-b p-4 bg-gray-50">' +
                        '<h2 class="text-lg font-semibold text-gray-800">' + title + '</h2>' +
                    '</div>' +
                    '<iframe src="' + webPageUrl + '" class="w-full h-full border-0" style="height: calc(100vh - 120px);"></iframe>' +
                '</div>';
        }

        // ì§ì ‘ ë„êµ¬ ì—´ê¸° í•¨ìˆ˜ (2ë‹¨ê³„ ë©”ë‰´ ì—†ì´ ë°”ë¡œ ë„êµ¬ í‘œì‹œ)
        function openDirectTool(toolId) {
            // ì–´ë“œë¯¼ íŒ¨ë„ ìˆ¨ê¸°ê¸°
            const adminPanel = document.getElementById('admin-panel');
            adminPanel.classList.add('hidden');
            
            // ë¹ˆ ìƒíƒœ ìˆ¨ê¸°ê¸°
            const emptyState = document.getElementById('empty-state');
            if (emptyState) {
                emptyState.style.display = 'none';
            }
            
            // ê¸°ì¡´ ì½˜í…ì¸  ì •ë¦¬
            const contentContainer = document.getElementById('content-container');
            let toolHTML = '';
            
            switch(toolId) {
                case 'sample-image-generator':
                    toolHTML = getSampleImageGeneratorHTML();
                    break;
                case 'qr-xlsx-generator':
                    toolHTML = getQRXlsxGeneratorHTML();
                    break;
                case 'csv-generator':
                    toolHTML = getCsvGeneratorHTML();
                    break;
                default:
                    toolHTML = '<div class="p-8 text-center">ë„êµ¬ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</div>';
            }
            
            // ë©”ì¸ ì½˜í…ì¸  ì˜ì—­ì— ë„êµ¬ í‘œì‹œ
            contentContainer.innerHTML = toolHTML;
        }
        
        function toggleAdminPanel() {
            const panel = document.getElementById('admin-panel');
            const icon = document.getElementById('admin-toggle-icon');
            
            panel.classList.toggle('admin-panel-collapsed');
            
            if (panel.classList.contains('admin-panel-collapsed')) {
                icon.textContent = 'â€º';
            } else {
                icon.textContent = 'â€¹';
            }
        }

        // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
        document.addEventListener('DOMContentLoaded', function() {
            // ê¸°ëŠ¥ ì„ íƒ
            document.querySelectorAll('.function-item').forEach(item => {
                item.addEventListener('click', () => {
                    const funcId = item.dataset.function;
                    selectFunction(funcId, item);
                });
            });

            // ì¿ í‚¤ ë™ê¸°í™” ë²„íŠ¼
            document.getElementById('cookie-sync-btn').addEventListener('click', showCookieModal);

            // í† í° ë™ê¸°í™” ë²„íŠ¼
            document.getElementById('token-sync-btn').addEventListener('click', syncTokens);
            
            // ìƒˆ íƒ­ ë²„íŠ¼
            document.getElementById('new-tab-btn').addEventListener('click', function() {
                if (selectedAdmin) {
                    createTab(selectedAdmin);
                } else {
                    alert('ë¨¼ì € ì–´ë“œë¯¼ì„ ì„ íƒí•˜ì„¸ìš”.');
                }
            });
            
            // ìƒˆ ì°½ ë²„íŠ¼
            document.getElementById('new-window-btn').addEventListener('click', function() {
                if (selectedAdmin) {
                    openInNewWindow(selectedAdmin.url);
                } else {
                    alert('ë¨¼ì € ì–´ë“œë¯¼ì„ ì„ íƒí•˜ì„¸ìš”.');
                }
            });

            // ì´ˆê¸°í™”
            updateTokenStatus();
            
            // ì£¼ê¸°ì ìœ¼ë¡œ í† í° ìƒíƒœ ì—…ë°ì´íŠ¸
            setInterval(updateTokenStatus, 5000);
        });

        // ë©”ì‹œì§€ ìˆ˜ì‹  (ë‹¤ë¥¸ ì°½ì—ì„œì˜ í† í° ë™ê¸°í™” ìš”ì²­)
        window.addEventListener('message', function(event) {
            if (event.data && event.data.type === 'REQUEST_TOKENS') {
                const tokens = getStoredTokens();
                event.source.postMessage({
                    type: 'SYNC_TOKENS',
                    tokens: tokens
                }, event.origin);
            }
        });
        
        // ê¸€ë¡œë²Œ í•¨ìˆ˜ë“¤ (onclickì—ì„œ ì‚¬ìš©)
        window.closeTab = closeTab;
        window.focusWindow = focusWindow;
        window.navigateTab = navigateTab;
        window.handleAddressKeypress = handleAddressKeypress;
        window.openInNewWindow = openInNewWindow;
        window.toggleFunctions = toggleFunctions;
    </script>
</body>
</html>