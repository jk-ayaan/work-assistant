<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CEO+ Help - ê´€ë¦¬ì ë„êµ¬</title>
    <link rel="icon" type="image/jpeg" href="../favicon-32x32.jpg">
    <link rel="icon" type="image/jpeg" sizes="16x16" href="../favicon-16x16.jpg">
    <link rel="icon" type="image/jpeg" sizes="32x32" href="../favicon-32x32.jpg">
    
    <!-- TailwindCSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: {
                            50: '#fffbeb',
                            100: '#fef3c7',
                            200: '#fde68a',
                            300: '#fcd34d',
                            400: '#fbbf24',
                            500: '#f59e0b',
                            600: '#d97706',
                            700: '#b45309',
                            800: '#92400e',
                            900: '#78350f',
                        },
                        accent: {
                            50: '#fef2f2',
                            100: '#fee2e2',
                            200: '#fecaca',
                            300: '#fca5a5',
                            400: '#f87171',
                            500: '#ef4444',
                            600: '#dc2626',
                            700: '#b91c1c',
                            800: '#991b1b',
                            900: '#7f1d1d',
                        },
                        neutral: {
                            50: '#fafafa',
                            100: '#f5f5f5',
                            200: '#e5e5e5',
                            300: '#d4d4d4',
                            400: '#a3a3a3',
                            500: '#737373',
                            600: '#525252',
                            700: '#404040',
                            800: '#262626',
                            900: '#171717',
                        }
                    }
                }
            }
        }
    </script>
    
    <!-- XLSX ë¼ì´ë¸ŒëŸ¬ë¦¬ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    
    <style>
        :root {
            --header-height: 64px;
            --transition-speed: 0.3s;
        }

        /* ê¸°ë³¸ ë ˆì´ì•„ì›ƒ */
        .app-layout {
            display: grid;
            grid-template-rows: var(--header-height) 1fr;
            grid-template-areas: 
                "header"
                "main";
            height: 100vh;
            background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%);
        }

        .header {
            grid-area: header;
            background: linear-gradient(90deg, #fbbf24 0%, #f59e0b 100%);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            z-index: 50;
        }

        .main-content {
            grid-area: main;
            overflow-y: auto;
            padding: 2rem;
        }

        /* ì¹´ë“œ ìŠ¤íƒ€ì¼ */
        .card {
            background: white;
            border-radius: 16px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            transition: all var(--transition-speed) ease;
            border: 1px solid rgba(251, 191, 36, 0.2);
        }

        .card:hover {
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            transform: translateY(-2px);
            border-color: rgba(251, 191, 36, 0.4);
        }

        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
        }

        /* íƒ­ ìŠ¤íƒ€ì¼ */
        .tab-button {
            position: relative;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            font-weight: 500;
            transition: all var(--transition-speed) ease;
            color: rgba(0, 0, 0, 0.7);
        }

        .tab-button:hover {
            background: rgba(255, 255, 255, 0.2);
            color: rgba(0, 0, 0, 0.9);
        }

        .tab-button.active {
            background: rgba(255, 255, 255, 0.3);
            color: #000;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .tab-button.active::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 50%;
            transform: translateX(-50%);
            width: 50%;
            height: 2px;
            background: #dc2626;
            border-radius: 1px;
        }

        /* íˆ´ ì¹´ë“œ íŠ¹ë³„ ìŠ¤íƒ€ì¼ */
        .tool-card {
            cursor: pointer;
            overflow: hidden;
        }

        .tool-card .icon-container {
            background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
            width: 64px;
            height: 64px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 1rem;
            box-shadow: 0 4px 8px rgba(251, 191, 36, 0.3);
        }

        .tool-card:hover .icon-container {
            transform: scale(1.05);
            box-shadow: 0 8px 16px rgba(251, 191, 36, 0.4);
        }

        /* ë¡œë”© ìŠ¤í”¼ë„ˆ */
        .loading-spinner {
            border: 3px solid #fde68a;
            border-top: 3px solid #f59e0b;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* ì•Œë¦¼ í† ìŠ¤íŠ¸ */
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            border-left: 4px solid #f59e0b;
            padding: 1rem 1.5rem;
            z-index: 1000;
            animation: slideIn 0.3s ease;
            max-width: 400px;
        }

        .toast.success {
            border-left-color: #10b981;
        }

        .toast.error {
            border-left-color: #dc2626;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        /* íƒ­ í…ìŠ¤íŠ¸ ë°˜ì‘í˜• ì²˜ë¦¬ */
        .tab-text {
            transition: all var(--transition-speed) ease;
        }
        
        /* ì¤‘ê°„ í¬ê¸°ì—ì„œ í…ìŠ¤íŠ¸ ìˆ¨ê¹€ (ê°œí–‰ë˜ê¸° ì „) */
        @media (max-width: 1024px) {
            .tab-text {
                display: none;
            }
            
            .tab-button svg {
                margin-right: 0 !important;
            }
            
            .tab-button {
                padding: 0.5rem 0.75rem;
                min-width: 44px;
                display: flex;
                align-items: center;
                justify-content: center;
            }
        }

        /* ëª¨ë°”ì¼ ë°˜ì‘í˜• */
        @media (max-width: 768px) {
            .main-content {
                padding: 1rem;
            }
            
            .card-grid {
                grid-template-columns: 1fr;
                gap: 1rem;
            }
            
            .tab-container {
                overflow-x: auto;
                scrollbar-width: none;
                -ms-overflow-style: none;
                justify-content: flex-start;
            }
            
            .tab-container::-webkit-scrollbar {
                display: none;
            }
            
            .tab-text {
                display: inline; /* ëª¨ë°”ì¼ì—ì„œëŠ” ë‹¤ì‹œ í…ìŠ¤íŠ¸ í‘œì‹œ */
            }
            
            .tab-button svg {
                margin-right: 0.5rem !important;
            }
            
            .tab-button {
                padding: 0.5rem 1rem;
                min-width: auto;
                white-space: nowrap;
            }
        }

        /* ì•„ì£¼ ì‘ì€ ëª¨ë°”ì¼ì—ì„œëŠ” ì•„ì´ì½˜ë§Œ */
        @media (max-width: 480px) {
            .tab-text {
                display: none;
            }
            
            .tab-button svg {
                margin-right: 0 !important;
            }
            
            .tab-button {
                padding: 0.5rem 0.75rem;
                min-width: 44px;
            }
        }

        /* í¼ ìŠ¤íƒ€ì¼ */
        .form-input {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid #e5e5e5;
            border-radius: 8px;
            transition: border-color var(--transition-speed) ease;
            background: white;
        }

        .form-input:focus {
            outline: none;
            border-color: #fbbf24;
            box-shadow: 0 0 0 3px rgba(251, 191, 36, 0.1);
        }

        .btn-primary {
            background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
            color: black;
            font-weight: 600;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            transition: all var(--transition-speed) ease;
            box-shadow: 0 2px 4px rgba(251, 191, 36, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(251, 191, 36, 0.4);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%);
            color: white;
            font-weight: 600;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            transition: all var(--transition-speed) ease;
            box-shadow: 0 2px 4px rgba(220, 38, 38, 0.3);
        }

        .btn-secondary:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(220, 38, 38, 0.4);
        }

        /* í†µê³„ ì¹´ë“œ */
        .stat-card {
            background: linear-gradient(135deg, white 0%, #fffbeb 100%);
            border-left: 4px solid #fbbf24;
        }

        .stat-number {
            font-size: 2rem;
            font-weight: 700;
            color: #f59e0b;
        }
    </style>
</head>

<body>
    <div class="app-layout">
        <!-- í—¤ë” ë„¤ë¹„ê²Œì´ì…˜ -->
        <header class="header">
            <div class="flex items-center justify-between h-full px-4 lg:px-8">
                <!-- ë¡œê³  -->
                <div class="flex items-center space-x-4">
                    <img src="../logo.jpg" alt="CEO+ Help" class="w-12 h-12 rounded-lg shadow-md">
                    <div class="hidden sm:block">
                        <h1 class="text-xl font-bold text-black">CEO+</h1>
                        <p class="text-sm font-semibold text-red-600">Help</p>
                    </div>
                </div>

                <!-- ë„¤ë¹„ê²Œì´ì…˜ íƒ­ -->
                <nav class="flex-1 mx-8">
                    <div class="tab-container flex space-x-1 justify-center">
                        <button class="tab-button active" onclick="showTab('dashboard')" id="tab-dashboard">
                            <svg class="w-5 h-5 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2-2z"></path>
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5a2 2 0 012-2h4a2 2 0 012 2v6H8V5z"></path>
                            </svg>
                            <span class="tab-text" data-ko="ëŒ€ì‹œë³´ë“œ" data-en="Dashboard">ëŒ€ì‹œë³´ë“œ</span>
                        </button>
                        <button class="tab-button" onclick="showTab('admin-tools')" id="tab-admin-tools">
                            <svg class="w-5 h-5 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.096 2.572-1.065z"></path>
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                            </svg>
                            <span class="tab-text" data-ko="ì–´ë“œë¯¼ í™œìš©" data-en="Admin Tools">ì–´ë“œë¯¼ í™œìš©</span>
                        </button>
                        <button class="tab-button" onclick="showTab('data-tools')" id="tab-data-tools">
                            <svg class="w-5 h-5 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                            </svg>
                            <span class="tab-text" data-ko="ë°ì´í„° ìƒì„±" data-en="Data Tools">ë°ì´í„° ìƒì„±</span>
                        </button>
                        <button class="tab-button" onclick="showTab('settings')" id="tab-settings">
                            <svg class="w-5 h-5 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 100-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 100-4m0 4v2m0-6V4"></path>
                            </svg>
                            <span class="tab-text" data-ko="ì„¤ì •" data-en="Settings">ì„¤ì •</span>
                        </button>
                    </div>
                </nav>

                <!-- ìš°ì¸¡ ìœ í‹¸ë¦¬í‹° -->
                <div class="flex items-center space-x-3">
                    <!-- ì–¸ì–´ ì„ íƒ ë²„íŠ¼ -->
                    <div class="relative">
                        <button class="px-3 py-1.5 rounded-lg bg-white bg-opacity-20 hover:bg-opacity-30 transition-all text-sm font-medium" onclick="toggleLanguage()">
                            <span id="current-lang" class="text-black">KOR</span>
                            <span class="text-black opacity-50 mx-1">|</span>
                            <span id="other-lang" class="text-black opacity-50">ENG</span>
                        </button>
                    </div>
                    
                    <!-- ì•Œë¦¼ ë²„íŠ¼ -->
                    <div class="relative">
                        <button class="p-2 rounded-lg bg-white bg-opacity-20 hover:bg-opacity-30 transition-all" onclick="showNotifications()">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18 8A6 6 0 006 8c0 7-3 9-3 9h18s-3-2-3-9z"></path>
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m13.73 21a2 2 0 01-3.46 0"></path>
                            </svg>
                        </button>
                        <span id="notification-badge" class="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center hidden">3</span>
                    </div>
                </div>
            </div>
        </header>

        <!-- ë©”ì¸ ì½˜í…ì¸  -->
        <main class="main-content">
            <!-- ëŒ€ì‹œë³´ë“œ íƒ­ -->
            <div id="dashboard-content" class="tab-content">
                <div class="mb-8">
                    <h2 id="dashboard-title" class="text-3xl font-bold text-neutral-800 mb-2">ëŒ€ì‹œë³´ë“œ</h2>
                    <p id="dashboard-desc" class="text-neutral-600">CEO+ Helpì˜ ì „ì²´ í˜„í™©ì„ í™•ì¸í•˜ì„¸ìš”</p>
                </div>

                <!-- í†µê³„ ì¹´ë“œë“¤ -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                    <div class="card stat-card p-6">
                        <div class="flex items-center justify-between">
                            <div>
                                <p id="active-sessions-label" class="text-sm font-medium text-neutral-600">í™œì„± ì„¸ì…˜</p>
                                <p class="stat-number" id="active-sessions">12</p>
                            </div>
                            <div class="w-12 h-12 bg-primary-100 rounded-lg flex items-center justify-center">
                                <svg class="w-6 h-6 text-primary-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"></path>
                                </svg>
                            </div>
                        </div>
                    </div>

                    <div class="card stat-card p-6">
                        <div class="flex items-center justify-between">
                            <div>
                                <p id="completed-tasks-label" class="text-sm font-medium text-neutral-600">ì™„ë£Œëœ ì‘ì—…</p>
                                <p class="stat-number" id="completed-tasks">47</p>
                            </div>
                            <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center">
                                <svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                            </div>
                        </div>
                    </div>

                    <div class="card stat-card p-6">
                        <div class="flex items-center justify-between">
                            <div>
                                <p id="saved-tokens-label" class="text-sm font-medium text-neutral-600">ì €ì¥ëœ í† í°</p>
                                <p class="stat-number" id="token-count">8</p>
                            </div>
                            <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center">
                                <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"></path>
                                </svg>
                            </div>
                        </div>
                    </div>

                    <div class="card stat-card p-6">
                        <div class="flex items-center justify-between">
                            <div>
                                <p id="generated-files-label" class="text-sm font-medium text-neutral-600">ìƒì„±ëœ íŒŒì¼</p>
                                <p class="stat-number" id="file-count">156</p>
                            </div>
                            <div class="w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center">
                                <svg class="w-6 h-6 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                                </svg>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ìµœê·¼ í™œë™ -->
                <div class="card p-6">
                    <h3 id="recent-activities-title" class="text-xl font-bold text-neutral-800 mb-4">ìµœê·¼ í™œë™</h3>
                    <div id="recent-activities" class="space-y-4">
                        <div class="flex items-center space-x-4 p-3 bg-neutral-50 rounded-lg">
                            <div class="w-8 h-8 bg-primary-500 rounded-full flex items-center justify-center">
                                <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                                </svg>
                            </div>
                            <div class="flex-1">
                                <p class="font-medium text-neutral-800">QR XLSX íŒŒì¼ ìƒì„±</p>
                                <p class="text-sm text-neutral-600">5ë¶„ ì „</p>
                            </div>
                        </div>
                        
                        <div class="flex items-center space-x-4 p-3 bg-neutral-50 rounded-lg">
                            <div class="w-8 h-8 bg-green-500 rounded-full flex items-center justify-center">
                                <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                            </div>
                            <div class="flex-1">
                                <p class="font-medium text-neutral-800">í† í° ë™ê¸°í™” ì™„ë£Œ</p>
                                <p class="text-sm text-neutral-600">12ë¶„ ì „</p>
                            </div>
                        </div>
                        
                        <div class="flex items-center space-x-4 p-3 bg-neutral-50 rounded-lg">
                            <div class="w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center">
                                <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                                </svg>
                            </div>
                            <div class="flex-1">
                                <p class="font-medium text-neutral-800">ìƒ˜í”Œ ì´ë¯¸ì§€ 25ê°œ ìƒì„±</p>
                                <p class="text-sm text-neutral-600">1ì‹œê°„ ì „</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ì–´ë“œë¯¼ ë„êµ¬ íƒ­ -->
            <div id="admin-tools-content" class="tab-content hidden">
                <div class="mb-8">
                    <h2 id="admin-tools-title" class="text-3xl font-bold text-neutral-800 mb-2">ì–´ë“œë¯¼ í™œìš©</h2>
                    <p id="admin-tools-desc" class="text-neutral-600">ê°€ë§¹ì  ê´€ë¦¬ ë° ì‹œìŠ¤í…œ ìš´ì˜ ë„êµ¬ë“¤</p>
                </div>

                <div class="card-grid">
                    <div class="card tool-card p-6" onclick="openAdminTool('qr-create')">
                        <div class="icon-container">
                            <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                            </svg>
                        </div>
                        <h3 class="text-xl font-bold text-neutral-800 mb-2">ê°€ë§¹ì  ìƒì„± ë° QR í™œì„±í™”</h3>
                        <p class="text-neutral-600 mb-4">ìƒˆë¡œìš´ ê°€ë§¹ì ì„ ë“±ë¡í•˜ê³  QR ì½”ë“œë¥¼ í™œì„±í™”í•©ë‹ˆë‹¤</p>
                        <div class="flex items-center text-sm text-neutral-500">
                            <span class="bg-primary-100 text-primary-800 px-2 py-1 rounded text-xs mr-2">3ê°œ ì–´ë“œë¯¼</span>
                            <span>â†’</span>
                        </div>
                    </div>

                    <div class="card tool-card p-6" onclick="openAdminTool('qr-recovery')">
                        <div class="icon-container">
                            <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                            </svg>
                        </div>
                        <h3 class="text-xl font-bold text-neutral-800 mb-2">ê°€ë§¹ì  QR ë³µêµ¬</h3>
                        <p class="text-neutral-600 mb-4">ì†ìƒëœ QR ì½”ë“œë¥¼ ë³µêµ¬í•˜ê³  ì¬í™œì„±í™”í•©ë‹ˆë‹¤</p>
                        <div class="flex items-center text-sm text-neutral-500">
                            <span class="bg-primary-100 text-primary-800 px-2 py-1 rounded text-xs mr-2">3ê°œ ì–´ë“œë¯¼</span>
                            <span>â†’</span>
                        </div>
                    </div>

                    <div class="card tool-card p-6" onclick="openAdminTool('permission')">
                        <div class="icon-container">
                            <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path>
                            </svg>
                        </div>
                        <h3 class="text-xl font-bold text-neutral-800 mb-2">ë§¤ì¥ ê¶Œí•œ ë³€ê²½</h3>
                        <p class="text-neutral-600 mb-4">ë§¤ì¥ë³„ ì‚¬ìš©ì ê¶Œí•œì„ ê´€ë¦¬í•˜ê³  ìˆ˜ì •í•©ë‹ˆë‹¤</p>
                        <div class="flex items-center text-sm text-neutral-500">
                            <span class="bg-primary-100 text-primary-800 px-2 py-1 rounded text-xs mr-2">3ê°œ ì–´ë“œë¯¼</span>
                            <span>â†’</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ë°ì´í„° ìƒì„± ë„êµ¬ íƒ­ -->
            <div id="data-tools-content" class="tab-content hidden">
                <div class="mb-8">
                    <h2 id="data-tools-title" class="text-3xl font-bold text-neutral-800 mb-2">ë°ì´í„° ìƒì„± ë„êµ¬</h2>
                    <p id="data-tools-desc" class="text-neutral-600">í…ŒìŠ¤íŠ¸ ë°ì´í„° ë° ìƒ˜í”Œ íŒŒì¼ ìƒì„± ë„êµ¬ë“¤</p>
                </div>

                <div class="card-grid">
                    <div class="card tool-card p-6" onclick="openDataTool('sample-image')">
                        <div class="icon-container">
                            <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                            </svg>
                        </div>
                        <h3 class="text-xl font-bold text-neutral-800 mb-2">ìƒ˜í”Œ ì´ë¯¸ì§€ ìƒì„±ê¸°</h3>
                        <p class="text-neutral-600 mb-4">ë‹¤ì–‘í•œ í¬ê¸°ì™€ í¬ë§·ì˜ í…ŒìŠ¤íŠ¸ ì´ë¯¸ì§€ë¥¼ ìƒì„±í•©ë‹ˆë‹¤</p>
                        <div class="flex items-center text-sm text-neutral-500">
                            <span class="bg-purple-100 text-purple-800 px-2 py-1 rounded text-xs mr-2">ì´ë¯¸ì§€ ë„êµ¬</span>
                            <span>â†’</span>
                        </div>
                    </div>

                    <div class="card tool-card p-6" onclick="openDataTool('qr-xlsx')">
                        <div class="icon-container">
                            <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                            </svg>
                        </div>
                        <h3 class="text-xl font-bold text-neutral-800 mb-2">QR XLSX ìƒì„±ê¸°</h3>
                        <p class="text-neutral-600 mb-4">QR ì½”ë“œ ì •ë³´ê°€ í¬í•¨ëœ ì—‘ì…€ íŒŒì¼ì„ ìƒì„±í•©ë‹ˆë‹¤</p>
                        <div class="flex items-center text-sm text-neutral-500">
                            <span class="bg-green-100 text-green-800 px-2 py-1 rounded text-xs mr-2">ì—‘ì…€ ë„êµ¬</span>
                            <span>â†’</span>
                        </div>
                    </div>

                    <div class="card tool-card p-6" onclick="openDataTool('csv-generator')">
                        <div class="icon-container">
                            <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                            </svg>
                        </div>
                        <h3 class="text-xl font-bold text-neutral-800 mb-2">CSV ìƒì„±ê¸°</h3>
                        <p class="text-neutral-600 mb-4">ì»¤ìŠ¤í…€ CSV íŒŒì¼ì„ ìƒì„±í•˜ê³  ë‹¤ìš´ë¡œë“œí•©ë‹ˆë‹¤</p>
                        <div class="flex items-center text-sm text-neutral-500">
                            <span class="bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs mr-2">ë°ì´í„° ë„êµ¬</span>
                            <span>â†’</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ì„¤ì • íƒ­ -->
            <div id="settings-content" class="tab-content hidden">
                <div class="mb-8">
                    <h2 id="settings-title" class="text-3xl font-bold text-neutral-800 mb-2">ì„¤ì •</h2>
                    <p id="settings-desc" class="text-neutral-600">ì‹œìŠ¤í…œ ì„¤ì • ë° í† í° ê´€ë¦¬</p>
                </div>

                <div class="space-y-6">
                    <!-- í† í° ê´€ë¦¬ ì¹´ë“œ -->
                    <div class="card p-6">
                        <h3 id="token-management-title" class="text-xl font-bold text-neutral-800 mb-4">í† í° ê´€ë¦¬</h3>
                        <div class="space-y-4">
                            <div class="flex items-center justify-between p-4 bg-neutral-50 rounded-lg">
                                <div>
                                    <p class="font-medium text-neutral-800">í† í° ìƒíƒœ</p>
                                    <p class="text-sm text-neutral-600" id="token-status-detail">í† í° í™•ì¸ ì¤‘...</p>
                                </div>
                                <button class="btn-primary" onclick="syncTokens()">
                                    ğŸ”„ í† í° ë™ê¸°í™”
                                </button>
                            </div>
                            <div class="flex space-x-4">
                                <button class="btn-secondary" onclick="showCookieModal()">
                                    ğŸª ì¿ í‚¤ ê´€ë¦¬
                                </button>
                                <button class="btn-primary" onclick="exportTokens()">
                                    ğŸ“¤ í† í° ë‚´ë³´ë‚´ê¸°
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- ì‹œìŠ¤í…œ ì„¤ì • ì¹´ë“œ -->
                    <div class="card p-6">
                        <h3 id="system-settings-title" class="text-xl font-bold text-neutral-800 mb-4">ì‹œìŠ¤í…œ ì„¤ì •</h3>
                        <div class="space-y-4">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="font-medium text-neutral-800">ë‹¤í¬ ëª¨ë“œ</p>
                                    <p class="text-sm text-neutral-600">ì¸í„°í˜ì´ìŠ¤ í…Œë§ˆ ë³€ê²½</p>
                                </div>
                                <label class="relative inline-flex items-center cursor-pointer">
                                    <input type="checkbox" class="sr-only peer" id="dark-mode-toggle">
                                    <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-primary-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-primary-600"></div>
                                </label>
                            </div>
                            
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="font-medium text-neutral-800">ìë™ ì €ì¥</p>
                                    <p class="text-sm text-neutral-600">ì‘ì—… ë‚´ìš© ìë™ ì €ì¥</p>
                                </div>
                                <label class="relative inline-flex items-center cursor-pointer">
                                    <input type="checkbox" class="sr-only peer" id="auto-save-toggle" checked>
                                    <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-primary-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-primary-600"></div>
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- ì •ë³´ ì¹´ë“œ -->
                    <div class="card p-6">
                        <h3 id="system-info-title" class="text-xl font-bold text-neutral-800 mb-4">ì‹œìŠ¤í…œ ì •ë³´</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="p-4 bg-neutral-50 rounded-lg">
                                <p class="text-sm font-medium text-neutral-600">ë²„ì „</p>
                                <p class="text-lg font-bold text-neutral-800">v2.1.0</p>
                            </div>
                            <div class="p-4 bg-neutral-50 rounded-lg">
                                <p class="text-sm font-medium text-neutral-600">ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸</p>
                                <p class="text-lg font-bold text-neutral-800">2024-08-15</p>
                            </div>
                            <div class="p-4 bg-neutral-50 rounded-lg">
                                <p class="text-sm font-medium text-neutral-600">ì´ ì‚¬ìš©ì</p>
                                <p class="text-lg font-bold text-neutral-800">247ëª…</p>
                            </div>
                            <div class="p-4 bg-neutral-50 rounded-lg">
                                <p class="text-sm font-medium text-neutral-600">ì—…íƒ€ì„</p>
                                <p class="text-lg font-bold text-neutral-800">99.9%</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- ì¿ í‚¤ ê´€ë¦¬ ëª¨ë‹¬ -->
    <div id="cookie-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50">
        <div class="bg-white rounded-2xl p-8 max-w-2xl w-full m-4 max-h-[80vh] overflow-y-auto">
            <h3 class="text-2xl font-bold text-neutral-800 mb-6">ğŸª ì¿ í‚¤ ê´€ë¦¬</h3>
            <div class="mb-6">
                <h4 class="font-medium text-neutral-700 mb-3">í˜„ì¬ ì €ì¥ëœ ì¿ í‚¤:</h4>
                <div id="cookie-list" class="bg-neutral-100 p-4 rounded-lg text-sm font-mono max-h-40 overflow-y-auto">
                    ë¡œë”©ì¤‘...
                </div>
            </div>
            <div class="mb-6">
                <h4 class="font-medium text-neutral-700 mb-3">ì¿ í‚¤ ì¶”ê°€/ìˆ˜ì •:</h4>
                <input id="cookie-input" type="text"
                       placeholder="name=value; domain=.example.com; path=/"
                       class="form-input mb-3">
                <button onclick="addCookie()" class="btn-primary">
                    ì¿ í‚¤ ì¶”ê°€
                </button>
            </div>
            <button onclick="closeCookieModal()" class="w-full p-3 bg-neutral-300 text-neutral-700 rounded-lg hover:bg-neutral-400 transition-colors">
                ë‹«ê¸°
            </button>
        </div>
    </div>

    <!-- ë„êµ¬ ìƒì„¸ ëª¨ë‹¬ -->
    <div id="tool-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50">
        <div class="bg-white rounded-2xl max-w-4xl w-full m-4 max-h-[90vh] overflow-hidden">
            <div class="p-6 border-b border-neutral-200 flex items-center justify-between">
                <h3 id="tool-modal-title" class="text-2xl font-bold text-neutral-800">ë„êµ¬</h3>
                <button onclick="closeToolModal()" class="p-2 hover:bg-neutral-100 rounded-lg transition-colors">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            <div id="tool-modal-content" class="p-6 overflow-y-auto" style="max-height: calc(90vh - 100px);">
                <!-- ë„êµ¬ë³„ ì½˜í…ì¸ ê°€ ì—¬ê¸°ì— ë¡œë“œë©ë‹ˆë‹¤ -->
            </div>
        </div>
    </div>

    <script>
        // ì „ì—­ ë³€ìˆ˜
        let currentTab = 'dashboard';
        let windowRefs = {};
        let currentLanguage = 'ko'; // ê¸°ë³¸ ì–¸ì–´ëŠ” í•œêµ­ì–´
        let notificationHistory = []; // ì•Œë¦¼ íˆìŠ¤í† ë¦¬
        let maxNotifications = 50; // ìµœëŒ€ ì•Œë¦¼ ë³´ê´€ ê°œìˆ˜

        // ë‹¤êµ­ì–´ í…ìŠ¤íŠ¸ ë°ì´í„°
        const translations = {
            ko: {
                // í—¤ë” ë° ë„¤ë¹„ê²Œì´ì…˜
                dashboard: "ëŒ€ì‹œë³´ë“œ",
                adminTools: "ì–´ë“œë¯¼ í™œìš©",
                dataTools: "ë°ì´í„° ìƒì„±", 
                settings: "ì„¤ì •",
                
                // ëŒ€ì‹œë³´ë“œ
                dashboardTitle: "ëŒ€ì‹œë³´ë“œ",
                dashboardDesc: "CEO+ Helpì˜ ì „ì²´ í˜„í™©ì„ í™•ì¸í•˜ì„¸ìš”",
                activeSessions: "í™œì„± ì„¸ì…˜",
                completedTasks: "ì™„ë£Œëœ ì‘ì—…",
                savedTokens: "ì €ì¥ëœ í† í°",
                generatedFiles: "ìƒì„±ëœ íŒŒì¼",
                recentActivities: "ìµœê·¼ í™œë™",
                
                // ì–´ë“œë¯¼ ë„êµ¬
                adminToolsTitle: "ì–´ë“œë¯¼ í™œìš©",
                adminToolsDesc: "ê°€ë§¹ì  ê´€ë¦¬ ë° ì‹œìŠ¤í…œ ìš´ì˜ ë„êµ¬ë“¤",
                
                // ë°ì´í„° ìƒì„± ë„êµ¬
                dataToolsTitle: "ë°ì´í„° ìƒì„± ë„êµ¬",
                dataToolsDesc: "í…ŒìŠ¤íŠ¸ ë°ì´í„° ë° ìƒ˜í”Œ íŒŒì¼ ìƒì„± ë„êµ¬ë“¤",
                
                // ì„¤ì •
                settingsTitle: "ì„¤ì •",
                settingsDesc: "ì‹œìŠ¤í…œ ì„¤ì • ë° í† í° ê´€ë¦¬",
                tokenManagement: "í† í° ê´€ë¦¬",
                systemSettings: "ì‹œìŠ¤í…œ ì„¤ì •",
                systemInfo: "ì‹œìŠ¤í…œ ì •ë³´",
                
                // ì•Œë¦¼ ë° í™œë™
                notifications: "ì•Œë¦¼",
                noNotifications: "ìƒˆë¡œìš´ ì•Œë¦¼ì´ ì—†ìŠµë‹ˆë‹¤",
                clearNotifications: "ëª¨ë“  ì•Œë¦¼ ì§€ìš°ê¸°",
                requestStarted: "ìš”ì²­ ì‹œì‘ë¨",
                requestCompleted: "ìš”ì²­ ì™„ë£Œë¨",
                requestFailed: "ìš”ì²­ ì‹¤íŒ¨",
                
                // ìš”ì²­ íƒ€ì…
                adminToolRequest: "ì–´ë“œë¯¼ ë„êµ¬ ì‹¤í–‰",
                dataGenerationRequest: "ë°ì´í„° ìƒì„±",
                tokenSyncRequest: "í† í° ë™ê¸°í™”",
                cookieManagementRequest: "ì¿ í‚¤ ê´€ë¦¬",
                languageChangeRequest: "ì–¸ì–´ ë³€ê²½",
                
                // ì‹œê°„ í‘œì‹œ
                justNow: "ë°©ê¸ˆ ì „",
                minutesAgo: "ë¶„ ì „",
                hoursAgo: "ì‹œê°„ ì „",
                daysAgo: "ì¼ ì „"
            },
            en: {
                // í—¤ë” ë° ë„¤ë¹„ê²Œì´ì…˜
                dashboard: "Dashboard",
                adminTools: "Admin Tools",
                dataTools: "Data Tools",
                settings: "Settings",
                
                // ëŒ€ì‹œë³´ë“œ
                dashboardTitle: "Dashboard",
                dashboardDesc: "Check the overall status of CEO+ Help",
                activeSessions: "Active Sessions",
                completedTasks: "Completed Tasks", 
                savedTokens: "Saved Tokens",
                generatedFiles: "Generated Files",
                recentActivities: "Recent Activities",
                
                // ì–´ë“œë¯¼ ë„êµ¬
                adminToolsTitle: "Admin Tools",
                adminToolsDesc: "Store management and system operation tools",
                
                // ë°ì´í„° ìƒì„± ë„êµ¬
                dataToolsTitle: "Data Generation Tools",
                dataToolsDesc: "Test data and sample file generation tools",
                
                // ì„¤ì •
                settingsTitle: "Settings",
                settingsDesc: "System settings and token management",
                tokenManagement: "Token Management",
                systemSettings: "System Settings", 
                systemInfo: "System Information",
                
                // ì•Œë¦¼ ë° í™œë™
                notifications: "Notifications",
                noNotifications: "No new notifications",
                clearNotifications: "Clear all notifications",
                requestStarted: "Request started",
                requestCompleted: "Request completed",
                requestFailed: "Request failed",
                
                // ìš”ì²­ íƒ€ì…
                adminToolRequest: "Admin tool execution",
                dataGenerationRequest: "Data generation",
                tokenSyncRequest: "Token synchronization",
                cookieManagementRequest: "Cookie management",
                languageChangeRequest: "Language change",
                
                // ì‹œê°„ í‘œì‹œ
                justNow: "Just now",
                minutesAgo: "min ago",
                hoursAgo: "hr ago",
                daysAgo: "day ago"
            }
        };
        
        // ê¸°ì¡´ ê¸°ëŠ¥ ë°ì´í„°
        const functionData = {
            'qr-create': {
                name: 'ê°€ë§¹ì  ìƒì„± ë° QR í™œì„±í™”',
                admins: [
                    { name: 'ì™€ì¹¸ë‹¤_ì‹ ì²­ì„œ', url: 'https://www.google.com', desc: 'ê°€ë§¹ì  ì‹ ì²­ì„œ ì‘ì„±', isInternal: false },
                    { name: 'ì™€ì¹¸ë‹¤_í™œì„±í™”', url: 'https://www.naver.com', desc: 'ê°€ë§¹ì  í™œì„±í™” ì²˜ë¦¬', isInternal: false },
                    { name: 'ì˜¤í”„ë¼ì¸_QRìƒì„±ìš”ì²­', url: 'https://admin.example.com/qr', desc: 'ì˜¤í”„ë¼ì¸ QR ìƒì„±', isInternal: true }
                ]
            },
            'qr-recovery': {
                name: 'ê°€ë§¹ì  QR ë³µêµ¬',
                admins: [
                    { name: 'QR ê´€ë¦¬', url: 'https://admin.example.com/qr-manage', desc: 'QR ë³µêµ¬', isInternal: true },
                    { name: 'ë¡œê·¸ ê´€ë¦¬', url: 'https://admin.example.com/logs', desc: 'ë¡œê·¸ í™•ì¸', isInternal: true },
                    { name: 'ê°€ë§¹ì  ê´€ë¦¬', url: 'https://www.kakao.com', desc: 'ìƒíƒœ í™•ì¸', isInternal: false }
                ]
            },
            'permission': {
                name: 'ë§¤ì¥ ê¶Œí•œë³€ê²½',
                admins: [
                    { name: 'ê¶Œí•œ ê´€ë¦¬', url: 'https://admin.example.com/permissions', desc: 'ê¶Œí•œ ì„¤ì •', isInternal: true },
                    { name: 'ì‚¬ìš©ì ê´€ë¦¬', url: 'https://admin.example.com/users', desc: 'ì—­í•  ê´€ë¦¬', isInternal: true },
                    { name: 'ê°ì‚¬ ê´€ë¦¬', url: 'https://www.youtube.com', desc: 'ë³€ê²½ ì´ë ¥', isInternal: false }
                ]
            }
        };

        // íƒ­ ì „í™˜ í•¨ìˆ˜
        function showTab(tabName) {
            // ëª¨ë“  íƒ­ ë²„íŠ¼ ë¹„í™œì„±í™”
            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // ëª¨ë“  íƒ­ ì½˜í…ì¸  ìˆ¨ê¸°ê¸°
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.add('hidden');
            });
            
            // ì„ íƒëœ íƒ­ í™œì„±í™”
            document.getElementById(`tab-${tabName}`).classList.add('active');
            document.getElementById(`${tabName}-content`).classList.remove('hidden');
            
            currentTab = tabName;
            
            // íƒ­ ë³€ê²½ ì‹œ ì¶”ê°€ ë¡œì§
            if (tabName === 'dashboard') {
                updateDashboardStats();
            }
        }

        // ëŒ€ì‹œë³´ë“œ í†µê³„ ì—…ë°ì´íŠ¸
        function updateDashboardStats() {
            // ì‹¤ì œ ë°ì´í„°ë¡œ ì—…ë°ì´íŠ¸í•˜ëŠ” ë¡œì§ì„ ì—¬ê¸°ì— êµ¬í˜„
            document.getElementById('active-sessions').textContent = Math.floor(Math.random() * 20) + 5;
            
            // ì™„ë£Œëœ ì‘ì—… ìˆ˜ëŠ” ì„±ê³µí•œ ì•Œë¦¼ ê°œìˆ˜ ë°˜ì˜
            const completedTasks = notificationHistory.filter(n => n.status === 'completed').length;
            document.getElementById('completed-tasks').textContent = completedTasks + Math.floor(Math.random() * 20) + 20;
            
            document.getElementById('token-count').textContent = Math.floor(Math.random() * 15) + 3;
            
            // ìƒì„±ëœ íŒŒì¼ ìˆ˜ëŠ” ë°ì´í„° ìƒì„± ì™„ë£Œ ì•Œë¦¼ ê°œìˆ˜ ë°˜ì˜  
            const generatedFiles = notificationHistory.filter(n => n.type === 'data-generation' && n.status === 'completed').length;
            document.getElementById('file-count').textContent = generatedFiles + Math.floor(Math.random() * 100) + 50;
        }

        // ìµœê·¼ í™œë™ ì—…ë°ì´íŠ¸ (ì•Œë¦¼ íˆìŠ¤í† ë¦¬ ê¸°ë°˜)
        function updateRecentActivities() {
            const container = document.getElementById('recent-activities');
            if (!container) return;
            
            const recentNotifications = notificationHistory.slice(0, 3); // ìµœê·¼ 3ê°œë§Œ
            
            if (recentNotifications.length === 0) {
                container.innerHTML = `
                    <div class="text-center text-neutral-500 py-8">
                        <svg class="w-12 h-12 mx-auto mb-3 text-neutral-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path>
                        </svg>
                        <p class="text-sm">${currentLanguage === 'ko' ? 'ìµœê·¼ í™œë™ì´ ì—†ìŠµë‹ˆë‹¤' : 'No recent activities'}</p>
                    </div>
                `;
                return;
            }
            
            let activitiesHTML = '';
            recentNotifications.forEach(notification => {
                const timeAgo = getTimeAgo(notification.timestamp);
                const statusColor = getStatusColor(notification.status).replace('bg-', '').replace('-100', '-500');
                const typeIcon = getTypeIcon(notification.type);
                
                activitiesHTML += `
                    <div class="flex items-center space-x-4 p-3 bg-neutral-50 rounded-lg">
                        <div class="w-8 h-8 bg-${statusColor} rounded-full flex items-center justify-center">
                            ${typeIcon}
                        </div>
                        <div class="flex-1">
                            <p class="font-medium text-neutral-800">
                                ${getActionDisplayName(notification.type, notification.action)}
                            </p>
                            <p class="text-sm text-neutral-600">${timeAgo}</p>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = activitiesHTML;
        }

        // ì–´ë“œë¯¼ ë„êµ¬ ì—´ê¸°
        function openAdminTool(toolId) {
            const toolData = functionData[toolId];
            if (!toolData) return;
            
            document.getElementById('tool-modal-title').textContent = toolData.name;
            
            let adminListHTML = '<div class="space-y-4">';
            toolData.admins.forEach((admin, index) => {
                adminListHTML += `
                    <div class="card p-4 cursor-pointer hover:shadow-lg transition-all" onclick="openAdminUrl('${admin.url}', '${admin.name}', ${admin.isInternal})">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center space-x-4">
                                <div class="w-10 h-10 bg-primary-100 rounded-lg flex items-center justify-center">
                                    <span class="font-bold text-primary-600">${index + 1}</span>
                                </div>
                                <div>
                                    <h4 class="font-medium text-neutral-800">${admin.name}</h4>
                                    <p class="text-sm text-neutral-600">${admin.desc}</p>
                                    <p class="text-xs text-neutral-400 mt-1">${admin.url}</p>
                                </div>
                            </div>
                            <div class="flex items-center space-x-2">
                                ${admin.isInternal ? '<span class="bg-yellow-100 text-yellow-800 text-xs px-2 py-1 rounded">ë‚´ë¶€</span>' : '<span class="bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded">ì™¸ë¶€</span>'}
                                <svg class="w-5 h-5 text-neutral-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                                </svg>
                            </div>
                        </div>
                    </div>
                `;
            });
            adminListHTML += '</div>';
            
            document.getElementById('tool-modal-content').innerHTML = adminListHTML;
            document.getElementById('tool-modal').classList.remove('hidden');
        }

        // ì–´ë“œë¯¼ URL ì—´ê¸°
        function openAdminUrl(url, name, isInternal) {
            try {
                // ì•Œë¦¼ ì¶”ê°€ - ì‹œì‘
                addNotification('admin-tool', name, 'started', `URL: ${url}`);
                
                if (isInternal) {
                    // ë‚´ë¶€ ë„êµ¬ëŠ” iframeìœ¼ë¡œ ì—´ê¸°
                    showToast(`${name} ë„êµ¬ë¥¼ ìƒˆ ì°½ì—ì„œ ì—½ë‹ˆë‹¤`, 'success');
                }
                
                const windowName = 'admin_' + name.replace(/\s/g, '_');
                const win = window.open(url, windowName, 'width=1200,height=800,menubar=yes,toolbar=yes,location=yes,status=yes,scrollbars=yes,resizable=yes');
                
                if (win) {
                    windowRefs[windowName] = win;
                    
                    // ì•Œë¦¼ ì¶”ê°€ - ì™„ë£Œ
                    addNotification('admin-tool', name, 'completed', `ìƒˆ ì°½ì—ì„œ ì—´ë¦¼`);
                    showToast(`${name}ì´(ê°€) ìƒˆ ì°½ì—ì„œ ì—´ë ¸ìŠµë‹ˆë‹¤`, 'success');
                } else {
                    // ì•Œë¦¼ ì¶”ê°€ - ì‹¤íŒ¨
                    addNotification('admin-tool', name, 'failed', 'íŒì—… ì°¨ë‹¨ë¨');
                    showToast('íŒì—…ì´ ì°¨ë‹¨ë˜ì—ˆìŠµë‹ˆë‹¤. íŒì—… í—ˆìš© í›„ ë‹¤ì‹œ ì‹œë„í•˜ì„¸ìš”', 'error');
                }
            } catch (error) {
                console.error('ì–´ë“œë¯¼ ë„êµ¬ ì‹¤í–‰ ì˜¤ë¥˜:', error);
                addNotification('admin-tool', name, 'failed', error.message);
                showToast('ë„êµ¬ ì‹¤í–‰ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤', 'error');
            }
        }

        // ë°ì´í„° ë„êµ¬ ì—´ê¸°
        function openDataTool(toolId) {
            let title, content;
            
            switch(toolId) {
                case 'sample-image':
                    title = 'ìƒ˜í”Œ ì´ë¯¸ì§€ ìƒì„±ê¸°';
                    content = getSampleImageGeneratorHTML();
                    break;
                case 'qr-xlsx':
                    title = 'QR XLSX ìƒì„±ê¸°';
                    content = getQRXlsxGeneratorHTML();
                    break;
                case 'csv-generator':
                    title = 'CSV ìƒì„±ê¸°';
                    content = getCsvGeneratorHTML();
                    break;
                default:
                    title = 'ë„êµ¬';
                    content = '<p class="text-center text-neutral-500">ë„êµ¬ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>';
            }
            
            document.getElementById('tool-modal-title').textContent = title;
            document.getElementById('tool-modal-content').innerHTML = content;
            document.getElementById('tool-modal').classList.remove('hidden');
            
            // ìƒ˜í”Œ ì´ë¯¸ì§€ ìƒì„±ê¸°ì¸ ê²½ìš° ì´ˆê¸° ì´ë¯¸ì§€ ìƒì„±
            if (toolId === 'sample-image') {
                setTimeout(generateSampleImage, 100);
            }
        }

        // ëª¨ë‹¬ ë‹«ê¸°
        function closeToolModal() {
            document.getElementById('tool-modal').classList.add('hidden');
        }

        // í† ìŠ¤íŠ¸ ë©”ì‹œì§€ í‘œì‹œ
        function showToast(message, type = 'success') {
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.innerHTML = `
                <div class="flex items-center">
                    <div class="flex-1">
                        <p class="font-medium text-neutral-800">${message}</p>
                    </div>
                    <button onclick="this.parentElement.parentElement.remove()" class="ml-4 text-neutral-400 hover:text-neutral-600">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
            `;
            
            document.body.appendChild(toast);
            
            setTimeout(() => {
                if (toast.parentNode) {
                    toast.remove();
                }
            }, 5000);
        }

        // ì–¸ì–´ ë³€ê²½ í•¨ìˆ˜
        function toggleLanguage() {
            try {
                const previousLang = currentLanguage;
                const newLang = currentLanguage === 'ko' ? 'en' : 'ko';
                
                // ì•Œë¦¼ ì¶”ê°€ - ì‹œì‘
                addNotification('language-change', `${previousLang.toUpperCase()} â†’ ${newLang.toUpperCase()}`, 'started');
                
                currentLanguage = newLang;
                updateLanguageUI();
                updateAllTexts();
                
                // localStorageì— ì–¸ì–´ ì„¤ì • ì €ì¥
                localStorage.setItem('preferred-language', currentLanguage);
                
                // ì•Œë¦¼ ì¶”ê°€ - ì™„ë£Œ
                addNotification('language-change', `${previousLang.toUpperCase()} â†’ ${newLang.toUpperCase()}`, 'completed');
                
                const langText = currentLanguage === 'ko' ? 'í•œêµ­ì–´' : 'English';
                showToast(`ì–¸ì–´ê°€ ${langText}ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤`, 'success');
            } catch (error) {
                console.error('ì–¸ì–´ ë³€ê²½ ì˜¤ë¥˜:', error);
                addNotification('language-change', 'Language toggle', 'failed', error.message);
                showToast('ì–¸ì–´ ë³€ê²½ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤', 'error');
            }
        }

        // ì–¸ì–´ ì„ íƒ UI ì—…ë°ì´íŠ¸
        function updateLanguageUI() {
            const currentLangEl = document.getElementById('current-lang');
            const otherLangEl = document.getElementById('other-lang');
            
            if (currentLanguage === 'ko') {
                currentLangEl.textContent = 'KOR';
                currentLangEl.className = 'text-black';
                otherLangEl.textContent = 'ENG';
                otherLangEl.className = 'text-black opacity-50';
            } else {
                currentLangEl.textContent = 'ENG';
                currentLangEl.className = 'text-black';
                otherLangEl.textContent = 'KOR';
                otherLangEl.className = 'text-black opacity-50';
            }
        }

        // ëª¨ë“  í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
        function updateAllTexts() {
            const t = translations[currentLanguage];
            
            // íƒ­ í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
            document.querySelectorAll('.tab-text').forEach(el => {
                const key = currentLanguage === 'ko' ? el.getAttribute('data-ko') : el.getAttribute('data-en');
                if (key) el.textContent = key;
            });
            
            // í˜ì´ì§€ ì œëª©ë“¤ ì—…ë°ì´íŠ¸
            updateElementText('dashboard-title', t.dashboardTitle);
            updateElementText('dashboard-desc', t.dashboardDesc);
            updateElementText('admin-tools-title', t.adminToolsTitle);  
            updateElementText('admin-tools-desc', t.adminToolsDesc);
            updateElementText('data-tools-title', t.dataToolsTitle);
            updateElementText('data-tools-desc', t.dataToolsDesc);
            updateElementText('settings-title', t.settingsTitle);
            updateElementText('settings-desc', t.settingsDesc);
            
            // í†µê³„ ì¹´ë“œ í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
            updateElementText('active-sessions-label', t.activeSessions);
            updateElementText('completed-tasks-label', t.completedTasks);
            updateElementText('saved-tokens-label', t.savedTokens);
            updateElementText('generated-files-label', t.generatedFiles);
            updateElementText('recent-activities-title', t.recentActivities);
            
            // ì„¤ì • ì„¹ì…˜ í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
            updateElementText('token-management-title', t.tokenManagement);
            updateElementText('system-settings-title', t.systemSettings);
            updateElementText('system-info-title', t.systemInfo);
        }

        // ê°œë³„ ìš”ì†Œ í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸ í—¬í¼ í•¨ìˆ˜
        function updateElementText(id, text) {
            const element = document.getElementById(id);
            if (element) {
                element.textContent = text;
            }
        }

        // ì•Œë¦¼ íˆìŠ¤í† ë¦¬ì— í•­ëª© ì¶”ê°€
        function addNotification(type, action, status, details = null) {
            const notification = {
                id: Date.now() + Math.random(),
                type: type, // 'admin-tool', 'data-generation', 'token-sync', 'cookie-management', 'language-change'
                action: action, // êµ¬ì²´ì ì¸ ì•¡ì…˜ëª…
                status: status, // 'started', 'completed', 'failed'
                details: details, // ì¶”ê°€ ì •ë³´
                timestamp: new Date(),
                read: false
            };
            
            notificationHistory.unshift(notification);
            
            // ìµœëŒ€ ê°œìˆ˜ ì´ˆê³¼ ì‹œ ì˜¤ë˜ëœ ì•Œë¦¼ ì œê±°
            if (notificationHistory.length > maxNotifications) {
                notificationHistory = notificationHistory.slice(0, maxNotifications);
            }
            
            // localStorageì— ì €ì¥
            localStorage.setItem('notificationHistory', JSON.stringify(notificationHistory));
            
            // ì•Œë¦¼ ë°°ì§€ ì—…ë°ì´íŠ¸
            updateNotificationBadge();
            
            // ëŒ€ì‹œë³´ë“œê°€ í™œì„±í™”ë˜ì–´ ìˆìœ¼ë©´ ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸
            if (currentTab === 'dashboard') {
                updateRecentActivities();
            }
        }

        // ì•Œë¦¼ ë°°ì§€ ì—…ë°ì´íŠ¸
        function updateNotificationBadge() {
            const badge = document.getElementById('notification-badge');
            const unreadCount = notificationHistory.filter(n => !n.read).length;
            
            if (unreadCount > 0) {
                badge.textContent = unreadCount > 99 ? '99+' : unreadCount;
                badge.classList.remove('hidden');
            } else {
                badge.classList.add('hidden');
            }
        }

        // ì•Œë¦¼ ëª©ë¡ í‘œì‹œ
        function showNotifications() {
            const t = translations[currentLanguage];
            
            // ëª¨ë“  ì•Œë¦¼ì„ ì½ìŒìœ¼ë¡œ í‘œì‹œ
            notificationHistory.forEach(n => n.read = true);
            localStorage.setItem('notificationHistory', JSON.stringify(notificationHistory));
            updateNotificationBadge();
            
            let notificationHTML = `
                <div class="fixed inset-0 bg-black bg-opacity-50 flex items-start justify-end z-50 pt-16 pr-4" onclick="closeNotifications()">
                    <div class="bg-white rounded-2xl w-96 max-h-96 overflow-hidden shadow-2xl" onclick="event.stopPropagation()">
                        <div class="p-4 border-b border-neutral-200 flex items-center justify-between">
                            <h3 class="text-lg font-bold text-neutral-800">${t.notifications}</h3>
                            <div class="flex items-center space-x-2">
                                <button onclick="clearAllNotifications()" class="text-xs px-3 py-1 bg-neutral-100 hover:bg-neutral-200 rounded-md text-neutral-600 transition-colors">
                                    ${t.clearNotifications}
                                </button>
                                <button onclick="closeNotifications()" class="p-1 hover:bg-neutral-100 rounded transition-colors">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                    </svg>
                                </button>
                            </div>
                        </div>
                        <div class="overflow-y-auto max-h-80">
            `;
            
            if (notificationHistory.length === 0) {
                notificationHTML += `
                    <div class="p-8 text-center text-neutral-500">
                        <svg class="w-12 h-12 mx-auto mb-3 text-neutral-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18 8A6 6 0 006 8c0 7-3 9-3 9h18s-3-2-3-9z"></path>
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m13.73 21a2 2 0 01-3.46 0"></path>
                        </svg>
                        <p>${t.noNotifications}</p>
                    </div>
                `;
            } else {
                notificationHistory.forEach(notification => {
                    const timeAgo = getTimeAgo(notification.timestamp);
                    const statusColor = getStatusColor(notification.status);
                    const statusIcon = getStatusIcon(notification.status);
                    const typeIcon = getTypeIcon(notification.type);
                    
                    notificationHTML += `
                        <div class="p-4 border-b border-neutral-100 hover:bg-neutral-50 transition-colors">
                            <div class="flex items-start space-x-3">
                                <div class="w-8 h-8 ${statusColor} rounded-full flex items-center justify-center flex-shrink-0">
                                    ${typeIcon}
                                </div>
                                <div class="flex-1 min-w-0">
                                    <p class="font-medium text-neutral-800 text-sm">
                                        ${getActionDisplayName(notification.type, notification.action)}
                                    </p>
                                    <div class="flex items-center space-x-2 mt-1">
                                        <span class="text-xs ${statusColor.replace('bg-', 'text-').replace('-100', '-600')} font-medium">
                                            ${statusIcon} ${getStatusDisplayName(notification.status)}
                                        </span>
                                        <span class="text-xs text-neutral-500">${timeAgo}</span>
                                    </div>
                                    ${notification.details ? `<p class="text-xs text-neutral-500 mt-1">${notification.details}</p>` : ''}
                                </div>
                            </div>
                        </div>
                    `;
                });
            }
            
            notificationHTML += `
                        </div>
                    </div>
                </div>
            `;
            
            // ì•Œë¦¼ íŒ¨ë„ í‘œì‹œ
            const existingPanel = document.getElementById('notification-panel');
            if (existingPanel) {
                existingPanel.remove();
            }
            
            const panel = document.createElement('div');
            panel.id = 'notification-panel';
            panel.innerHTML = notificationHTML;
            document.body.appendChild(panel);
        }

        // ì•Œë¦¼ íŒ¨ë„ ë‹«ê¸°
        function closeNotifications() {
            const panel = document.getElementById('notification-panel');
            if (panel) {
                panel.remove();
            }
        }

        // ëª¨ë“  ì•Œë¦¼ ì§€ìš°ê¸°
        function clearAllNotifications() {
            if (confirm(currentLanguage === 'ko' ? 'ëª¨ë“  ì•Œë¦¼ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?' : 'Are you sure you want to clear all notifications?')) {
                notificationHistory = [];
                localStorage.removeItem('notificationHistory');
                updateNotificationBadge();
                closeNotifications();
                updateRecentActivities();
                showToast(currentLanguage === 'ko' ? 'ëª¨ë“  ì•Œë¦¼ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤' : 'All notifications cleared', 'success');
            }
        }

        // ì‹œê°„ í‘œì‹œ í•¨ìˆ˜
        function getTimeAgo(timestamp) {
            const t = translations[currentLanguage];
            const now = new Date();
            const diffMs = now - new Date(timestamp);
            const diffMinutes = Math.floor(diffMs / (1000 * 60));
            const diffHours = Math.floor(diffMs / (1000 * 60 * 60));
            const diffDays = Math.floor(diffMs / (1000 * 60 * 60 * 24));
            
            if (diffMinutes < 1) return t.justNow;
            if (diffMinutes < 60) return `${diffMinutes}${t.minutesAgo}`;
            if (diffHours < 24) return `${diffHours}${t.hoursAgo}`;
            return `${diffDays}${t.daysAgo}`;
        }

        // ìƒíƒœë³„ ìƒ‰ìƒ ë°˜í™˜
        function getStatusColor(status) {
            switch (status) {
                case 'started': return 'bg-blue-100';
                case 'completed': return 'bg-green-100';
                case 'failed': return 'bg-red-100';
                default: return 'bg-neutral-100';
            }
        }

        // ìƒíƒœë³„ ì•„ì´ì½˜ ë°˜í™˜
        function getStatusIcon(status) {
            switch (status) {
                case 'started': return 'â³';
                case 'completed': return 'âœ…';
                case 'failed': return 'âŒ';
                default: return 'â„¹ï¸';
            }
        }

        // íƒ€ì…ë³„ ì•„ì´ì½˜ ë°˜í™˜
        function getTypeIcon(type) {
            switch (type) {
                case 'admin-tool': return '<svg class="w-4 h-4 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.096 2.572-1.065z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>';
                case 'data-generation': return '<svg class="w-4 h-4 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>';
                case 'token-sync': return '<svg class="w-4 h-4 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1721 9z"></path></svg>';
                case 'cookie-management': return '<svg class="w-4 h-4 text-orange-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 100-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 100-4m0 4v2m0-6V4"></path></svg>';
                case 'language-change': return '<svg class="w-4 h-4 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5h12M9 3v2m1.048 9.5A18.022 18.022 0 016.412 9m6.088 9h7M11 21l5-10 5 10M12.751 5C11.783 10.77 8.07 15.61 3 18.129"></path></svg>';
                default: return '<svg class="w-4 h-4 text-neutral-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>';
            }
        }

        // ì•¡ì…˜ëª… í‘œì‹œ í•¨ìˆ˜
        function getActionDisplayName(type, action) {
            const t = translations[currentLanguage];
            
            // íƒ€ì…ë³„ ê¸°ë³¸ ì´ë¦„
            let baseName = '';
            switch (type) {
                case 'admin-tool': baseName = t.adminToolRequest; break;
                case 'data-generation': baseName = t.dataGenerationRequest; break;
                case 'token-sync': baseName = t.tokenSyncRequest; break;
                case 'cookie-management': baseName = t.cookieManagementRequest; break;
                case 'language-change': baseName = t.languageChangeRequest; break;
                default: baseName = action;
            }
            
            // êµ¬ì²´ì ì¸ ì•¡ì…˜ëª…ì´ ìˆìœ¼ë©´ ì¡°í•©
            if (action && action !== type) {
                return `${baseName}: ${action}`;
            }
            
            return baseName;
        }

        // ìƒíƒœëª… í‘œì‹œ í•¨ìˆ˜
        function getStatusDisplayName(status) {
            const t = translations[currentLanguage];
            switch (status) {
                case 'started': return t.requestStarted;
                case 'completed': return t.requestCompleted;
                case 'failed': return t.requestFailed;
                default: return status;
            }
        }

        // í† í° ê´€ë¦¬ í•¨ìˆ˜ë“¤
        function getStoredTokens() {
            const tokens = { localStorage: {}, sessionStorage: {}, cookies: {} };
            
            try {
                for (let i = 0; i < localStorage.length; i++) {
                    const key = localStorage.key(i);
                    if (key && (key.includes('token') || key.includes('auth') || key.includes('session'))) {
                        tokens.localStorage[key] = localStorage.getItem(key);
                    }
                }
                
                for (let i = 0; i < sessionStorage.length; i++) {
                    const key = sessionStorage.key(i);
                    if (key && (key.includes('token') || key.includes('auth') || key.includes('session'))) {
                        tokens.sessionStorage[key] = sessionStorage.getItem(key);
                    }
                }
                
                const cookies = getAllCookies();
                Object.entries(cookies).forEach(([name, value]) => {
                    if (name.includes('token') || name.includes('auth') || name.includes('session')) {
                        tokens.cookies[name] = value;
                    }
                });
            } catch (error) {
                console.error('í† í° ì¡°íšŒ ì˜¤ë¥˜:', error);
            }
            
            return tokens;
        }

        function getAllCookies() {
            const cookies = {};
            document.cookie.split(';').forEach(cookie => {
                const [name, value] = cookie.trim().split('=');
                if (name) cookies[name] = value || '';
            });
            return cookies;
        }

        function syncTokens() {
            try {
                // ì•Œë¦¼ ì¶”ê°€ - ì‹œì‘
                addNotification('token-sync', 'í† í° ë™ê¸°í™”', 'started');
                
                const tokens = getStoredTokens();
                console.log('ë™ê¸°í™”í•  í† í°:', tokens);
                
                let syncedWindows = 0;
                Object.values(windowRefs).forEach(win => {
                    if (win && !win.closed) {
                        try {
                            win.postMessage({ type: 'SYNC_TOKENS', tokens: tokens }, '*');
                            syncedWindows++;
                        } catch (e) {
                            console.log('í† í° ì „ì†¡ ì‹¤íŒ¨:', e);
                        }
                    }
                });
                
                // ì•Œë¦¼ ì¶”ê°€ - ì™„ë£Œ
                addNotification('token-sync', 'í† í° ë™ê¸°í™”', 'completed', `${syncedWindows}ê°œ ì°½ì— ë™ê¸°í™”`);
                showToast('í† í° ë™ê¸°í™”ë¥¼ ì‹œë„í–ˆìŠµë‹ˆë‹¤', 'success');
                updateTokenStatus();
            } catch (error) {
                console.error('í† í° ë™ê¸°í™” ì˜¤ë¥˜:', error);
                addNotification('token-sync', 'í† í° ë™ê¸°í™”', 'failed', error.message);
                showToast('í† í° ë™ê¸°í™” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤', 'error');
            }
        }

        function updateTokenStatus() {
            try {
                const tokens = getStoredTokens();
                const totalCount = Object.keys(tokens.localStorage).length + Object.keys(tokens.sessionStorage).length + Object.keys(tokens.cookies).length;
                
                const statusEl = document.getElementById('token-status-detail');
                if (statusEl) {
                    if (totalCount > 0) {
                        statusEl.innerHTML = `âœ… í† í° ${totalCount}ê°œ ë°œê²¬ (Local: ${Object.keys(tokens.localStorage).length}, Session: ${Object.keys(tokens.sessionStorage).length}, Cookie: ${Object.keys(tokens.cookies).length})`;
                    } else {
                        statusEl.innerHTML = 'âŒ í† í° ì—†ìŒ';
                    }
                }
                
                // ëŒ€ì‹œë³´ë“œ í† í° ì¹´ìš´íŠ¸ ì—…ë°ì´íŠ¸
                const tokenCountEl = document.getElementById('token-count');
                if (tokenCountEl) {
                    tokenCountEl.textContent = totalCount;
                }
            } catch (error) {
                console.error('í† í° ìƒíƒœ ì—…ë°ì´íŠ¸ ì˜¤ë¥˜:', error);
                const statusEl = document.getElementById('token-status-detail');
                if (statusEl) {
                    statusEl.innerHTML = 'âŒ ì˜¤ë¥˜ ë°œìƒ';
                }
            }
        }

        function exportTokens() {
            try {
                const tokens = getStoredTokens();
                const dataStr = JSON.stringify(tokens, null, 2);
                const dataBlob = new Blob([dataStr], {type: 'application/json'});
                
                const link = document.createElement('a');
                link.href = URL.createObjectURL(dataBlob);
                link.download = `tokens_${new Date().toISOString().split('T')[0]}.json`;
                link.click();
                
                showToast('í† í° ì •ë³´ê°€ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤', 'success');
            } catch (error) {
                console.error('í† í° ë‚´ë³´ë‚´ê¸° ì˜¤ë¥˜:', error);
                showToast('í† í° ë‚´ë³´ë‚´ê¸° ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤', 'error');
            }
        }

        // ì¿ í‚¤ ê´€ë¦¬ í•¨ìˆ˜ë“¤
        function showCookieModal() {
            document.getElementById('cookie-modal').classList.remove('hidden');
            updateCookieList();
        }

        function closeCookieModal() {
            document.getElementById('cookie-modal').classList.add('hidden');
        }

        function updateCookieList() {
            const cookies = getAllCookies();
            const cookieList = document.getElementById('cookie-list');
            
            if (Object.keys(cookies).length === 0) {
                cookieList.textContent = 'ì¿ í‚¤ê°€ ì—†ìŠµë‹ˆë‹¤.';
            } else {
                cookieList.innerHTML = Object.entries(cookies)
                    .map(([name, value]) => `<div class="mb-1"><strong>${name}</strong> = ${value}</div>`)
                    .join('');
            }
        }

        function addCookie() {
            const input = document.getElementById('cookie-input').value.trim();
            if (!input) {
                showToast('ì¿ í‚¤ ì •ë³´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”', 'error');
                return;
            }
            
            try {
                // ì•Œë¦¼ ì¶”ê°€ - ì‹œì‘
                addNotification('cookie-management', 'ì¿ í‚¤ ì¶”ê°€', 'started', input);
                
                const parts = input.split(';').map(p => p.trim());
                const [name, value] = parts[0].split('=');
                
                if (!name) {
                    addNotification('cookie-management', 'ì¿ í‚¤ ì¶”ê°€', 'failed', 'ì¿ í‚¤ ì´ë¦„ì´ í•„ìš”í•©ë‹ˆë‹¤');
                    showToast('ì¿ í‚¤ ì´ë¦„ì´ í•„ìš”í•©ë‹ˆë‹¤', 'error');
                    return;
                }
                
                document.cookie = input;
                updateCookieList();
                document.getElementById('cookie-input').value = '';
                
                // ì•Œë¦¼ ì¶”ê°€ - ì™„ë£Œ
                addNotification('cookie-management', 'ì¿ í‚¤ ì¶”ê°€', 'completed', `${name} ì¿ í‚¤ ì¶”ê°€ë¨`);
                showToast('ì¿ í‚¤ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤', 'success');
            } catch (e) {
                console.error('ì¿ í‚¤ ì¶”ê°€ ì˜¤ë¥˜:', e);
                addNotification('cookie-management', 'ì¿ í‚¤ ì¶”ê°€', 'failed', e.message);
                showToast('ì˜¬ë°”ë¥¸ ì¿ í‚¤ í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤', 'error');
            }
        }

        // ìƒ˜í”Œ ì´ë¯¸ì§€ ìƒì„±ê¸° HTML
        function getSampleImageGeneratorHTML() {
            return `
                <div class="space-y-6">
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-neutral-700 mb-2">ì´ë¯¸ì§€ í¬ê¸°</label>
                                <select id="sample-imageSize" class="form-input">
                                    <option value="100x100">100x100</option>
                                    <option value="200x200">200x200</option>
                                    <option value="400x400" selected>400x400</option>
                                    <option value="800x600">800x600</option>
                                    <option value="1920x1080">1920x1080</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-neutral-700 mb-2">ë°°ê²½ìƒ‰</label>
                                <input type="color" id="sample-bgColor" value="#f0f0f0" class="form-input h-12">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-neutral-700 mb-2">í…ìŠ¤íŠ¸</label>
                                <input type="text" id="sample-imageText" value="Sample Image" class="form-input">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-neutral-700 mb-2">ìƒì„±í•  ì´ë¯¸ì§€ ê°œìˆ˜</label>
                                <input type="number" id="sample-imageCount" value="5" min="1" max="100" class="form-input">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-neutral-700 mb-2">ì´ë¯¸ì§€ í¬ë§·</label>
                                <div class="space-y-2">
                                    <label class="flex items-center">
                                        <input type="checkbox" name="imageFormat" value="PNG" checked class="mr-2">
                                        <span>PNG</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" name="imageFormat" value="JPG" checked class="mr-2">
                                        <span>JPG</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" name="imageFormat" value="WEBP" class="mr-2">
                                        <span>WEBP</span>
                                    </label>
                                </div>
                            </div>
                            <button onclick="generateSampleImage()" class="btn-primary w-full">
                                ì´ë¯¸ì§€ ìƒì„±í•˜ê¸°
                            </button>
                        </div>
                        <div>
                            <div class="border-2 border-dashed border-neutral-300 rounded-lg p-6 bg-neutral-50 min-h-64 flex items-center justify-center">
                                <canvas id="sample-canvas" class="border border-neutral-200 rounded shadow-sm"></canvas>
                            </div>
                            <button id="sample-downloadBtn" onclick="downloadSampleImage()" class="btn-secondary w-full mt-4" disabled>
                                ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }

        // QR XLSX ìƒì„±ê¸° HTML
        function getQRXlsxGeneratorHTML() {
            return `
                <div class="space-y-6">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-neutral-700 mb-2">CID</label>
                            <input type="text" id="qr-cid" value="" placeholder="ë¹ˆê°’" class="form-input">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-neutral-700 mb-2">TID</label>
                            <input type="text" id="qr-tid" value="" placeholder="ë¹ˆê°’" class="form-input">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-neutral-700 mb-2">ì§€ì—­ì½”ë“œ</label>
                            <input type="text" id="qr-region" value="JEJU" class="form-input">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-neutral-700 mb-2">VAN</label>
                            <input type="text" id="qr-van" value="KIS" class="form-input">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-neutral-700 mb-2">íœ´ëŒ€í°ë²ˆí˜¸</label>
                            <input type="text" id="qr-phone" value="01025710628" class="form-input">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-neutral-700 mb-2">ë¹„ê³ </label>
                            <input type="text" id="qr-remark" value="" placeholder="ë¹ˆê°’" class="form-input">
                        </div>
                    </div>
                    
                    <button onclick="generateQRXlsx()" class="btn-primary">QR XLSX íŒŒì¼ ìƒì„±</button>
                    
                    <div id="qr-preview" class="mt-6 p-4 border border-primary-200 rounded-lg bg-primary-50 hidden">
                        <h4 class="font-medium text-primary-800 mb-2">ìƒì„± ì™„ë£Œ!</h4>
                        <p class="text-primary-700">XLSX íŒŒì¼ì´ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤.</p>
                    </div>
                </div>
            `;
        }

        // CSV ìƒì„±ê¸° HTML
        function getCsvGeneratorHTML() {
            return `
                <div class="space-y-6">
                    <div>
                        <label class="block text-sm font-medium text-neutral-700 mb-2">ìƒì„±í•  í–‰ ìˆ˜</label>
                        <input type="number" id="csv-rowCount" value="10" min="1" max="1000" class="form-input max-w-xs">
                    </div>

                    <div class="space-y-4">
                        <h4 class="text-lg font-medium text-neutral-800">ì—´ ì„¤ì •</h4>
                        
                        <!-- 1ì—´ -->
                        <div class="card p-4">
                            <div class="flex items-center justify-between mb-3">
                                <span class="font-medium">1ì—´ (í•„ìˆ˜)</span>
                            </div>
                            <div class="space-y-3">
                                <label class="flex items-center">
                                    <input type="radio" name="col1Type" value="random" checked class="mr-2">
                                    <span>í…ìŠ¤íŠ¸ ì…ë ¥</span>
                                </label>
                                <input type="text" id="col1-text" placeholder="í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”" class="form-input">
                                <label class="flex items-center">
                                    <input type="radio" name="col1Type" value="custom" class="mr-2">
                                    <span>ë‚œìˆ˜ë°œìƒ</span>
                                </label>
                            </div>
                        </div>

                        <!-- 2ì—´ -->
                        <div class="card p-4">
                            <div class="flex items-center justify-between mb-3">
                                <span class="font-medium">2ì—´ í¬í•¨</span>
                                <label class="flex items-center">
                                    <input type="checkbox" id="col2-enable" checked class="mr-2" onchange="toggleCsvColumn(2)">
                                    <span>ì‚¬ìš©</span>
                                </label>
                            </div>
                            <div class="space-y-3" id="col2-options">
                                <label class="flex items-center">
                                    <input type="radio" name="col2Type" value="random" checked class="mr-2">
                                    <span>í…ìŠ¤íŠ¸ ì…ë ¥</span>
                                </label>
                                <input type="text" id="col2-text" placeholder="í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”" class="form-input">
                                <label class="flex items-center">
                                    <input type="radio" name="col2Type" value="custom" class="mr-2">
                                    <span>ë‚œìˆ˜ë°œìƒ</span>
                                </label>
                            </div>
                        </div>

                        <!-- 3ì—´ -->
                        <div class="card p-4">
                            <div class="flex items-center justify-between mb-3">
                                <span class="font-medium">3ì—´ í¬í•¨</span>
                                <label class="flex items-center">
                                    <input type="checkbox" id="col3-enable" class="mr-2" onchange="toggleCsvColumn(3)">
                                    <span>ì‚¬ìš©</span>
                                </label>
                            </div>
                            <div class="space-y-3 hidden" id="col3-options">
                                <label class="flex items-center">
                                    <input type="radio" name="col3Type" value="random" checked class="mr-2">
                                    <span>í…ìŠ¤íŠ¸ ì…ë ¥</span>
                                </label>
                                <input type="text" id="col3-text" placeholder="í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”" class="form-input">
                                <label class="flex items-center">
                                    <input type="radio" name="col3Type" value="custom" class="mr-2">
                                    <span>ë‚œìˆ˜ë°œìƒ</span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <button onclick="generateCsvFile()" class="btn-primary">CSV ë¯¸ë¦¬ë³´ê¸°</button>

                    <div id="csv-preview" class="hidden">
                        <h4 class="text-lg font-medium text-neutral-800 mb-4">CSV ë¯¸ë¦¬ë³´ê¸°</h4>
                        <div class="overflow-auto max-h-64 border border-neutral-200 rounded-lg">
                            <table class="min-w-full">
                                <thead class="bg-neutral-100">
                                    <tr>
                                        <th class="border border-neutral-300 px-4 py-2">1ì—´</th>
                                        <th class="border border-neutral-300 px-4 py-2">2ì—´</th>
                                        <th class="border border-neutral-300 px-4 py-2">3ì—´</th>
                                    </tr>
                                </thead>
                                <tbody id="csv-preview-body">
                                </tbody>
                            </table>
                        </div>
                        <button onclick="downloadCsv()" class="btn-secondary mt-4">
                            CSV ë‹¤ìš´ë¡œë“œ
                        </button>
                    </div>
                </div>
            `;
        }

        // ìƒ˜í”Œ ì´ë¯¸ì§€ ìƒì„± í•¨ìˆ˜ë“¤ (ê¸°ì¡´ í•¨ìˆ˜ë“¤ ì´ì–´ì„œ ì‚¬ìš©)
        function generateSampleImage() {
            try {
                // ì•Œë¦¼ ì¶”ê°€ - ì‹œì‘
                addNotification('data-generation', 'ìƒ˜í”Œ ì´ë¯¸ì§€ ìƒì„±', 'started');
                
                const size = document.getElementById('sample-imageSize').value;
                const [width, height] = size.split('x').map(Number);
                const bgColor = document.getElementById('sample-bgColor').value;
                const text = document.getElementById('sample-imageText').value;
                const count = parseInt(document.getElementById('sample-imageCount').value) || 1;

                const formats = [];
                document.querySelectorAll('input[name="imageFormat"]:checked').forEach(el => {
                    formats.push(el.value);
                });

                if (formats.length === 0) {
                    addNotification('data-generation', 'ìƒ˜í”Œ ì´ë¯¸ì§€ ìƒì„±', 'failed', 'ì´ë¯¸ì§€ í¬ë§· ì„ íƒ ì•ˆë¨');
                    showToast('ìµœì†Œ í•˜ë‚˜ì˜ ì´ë¯¸ì§€ í¬ë§·ì„ ì„ íƒí•´ì£¼ì„¸ìš”', 'error');
                    return;
                }

                const canvas = document.getElementById('sample-canvas');
                const ctx = canvas.getContext('2d');

                canvas.width = width;
                canvas.height = height;
                canvas.style.maxWidth = '100%';
                canvas.style.height = 'auto';

                ctx.fillStyle = bgColor;
                ctx.fillRect(0, 0, width, height);

                ctx.fillStyle = '#333333';
                ctx.font = Math.max(16, width/20) + 'px Arial';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText(text, width/2, height/2 - Math.max(20, width/20));

                ctx.font = Math.max(40, width/10) + 'px Arial';
                ctx.fillText('1', width/2, height/2 + Math.max(20, width/20));

                ctx.font = Math.max(12, width/30) + 'px Arial';
                ctx.fillText(width + ' Ã— ' + height, width/2, height - Math.max(20, width/30));

                window.sampleImageSettings = { width, height, bgColor, text, count, formats };
                document.getElementById('sample-downloadBtn').disabled = false;
                
                // ì•Œë¦¼ ì¶”ê°€ - ì™„ë£Œ
                addNotification('data-generation', 'ìƒ˜í”Œ ì´ë¯¸ì§€ ìƒì„±', 'completed', `${size}, ${count}ê°œ, ${formats.join(', ')}`);
                showToast('ì´ë¯¸ì§€ ìƒì„± ì™„ë£Œ', 'success');
            } catch (error) {
                console.error('ì´ë¯¸ì§€ ìƒì„± ì˜¤ë¥˜:', error);
                addNotification('data-generation', 'ìƒ˜í”Œ ì´ë¯¸ì§€ ìƒì„±', 'failed', error.message);
                showToast('ì´ë¯¸ì§€ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤', 'error');
            }
        }

        function downloadSampleImage() {
            try {
                const settings = window.sampleImageSettings;
                if (!settings) {
                    showToast('ë¨¼ì € ì´ë¯¸ì§€ë¥¼ ìƒì„±í•´ì£¼ì„¸ìš”', 'error');
                    return;
                }

                const { width, height, bgColor, text, count, formats } = settings;
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');

                canvas.width = width;
                canvas.height = height;

                for (let i = 1; i <= count; i++) {
                    ctx.fillStyle = bgColor;
                    ctx.fillRect(0, 0, width, height);

                    ctx.fillStyle = '#333333';
                    ctx.font = Math.max(16, width/20) + 'px Arial';
                    ctx.textAlign = 'center';
                    ctx.textBaseline = 'middle';
                    ctx.fillText(text, width/2, height/2 - Math.max(20, width/20));

                    ctx.font = Math.max(40, width/10) + 'px Arial';
                    ctx.fillText(i.toString(), width/2, height/2 + Math.max(20, width/20));

                    ctx.font = Math.max(12, width/30) + 'px Arial';
                    ctx.fillText(width + ' Ã— ' + height, width/2, height - Math.max(20, width/30));

                    formats.forEach(format => {
                        const link = document.createElement('a');
                        const ext = format.toLowerCase();
                        const timestamp = new Date().toISOString().replace(/[:.]/g, '-').slice(0, -5);
                        link.download = `sample-image_${timestamp}_${i}.${ext}`;

                        if (ext === 'jpg' || ext === 'jpeg') {
                            link.href = canvas.toDataURL('image/jpeg', 0.9);
                        } else if (ext === 'webp') {
                            link.href = canvas.toDataURL('image/webp', 0.9);
                        } else {
                            link.href = canvas.toDataURL('image/png');
                        }

                        link.click();
                    });
                }

                showToast(`${count}ê°œ ì´ë¯¸ì§€ Ã— ${formats.length}ê°œ í¬ë§· = ì´ ${count * formats.length}ê°œ íŒŒì¼ ë‹¤ìš´ë¡œë“œ ì™„ë£Œ`, 'success');
            } catch (error) {
                console.error('ë‹¤ìš´ë¡œë“œ ì˜¤ë¥˜:', error);
                showToast('ë‹¤ìš´ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤', 'error');
            }
        }

        // QR XLSX ìƒì„± í•¨ìˆ˜
        function generateQRXlsx() {
            try {
                const cid = document.getElementById('qr-cid').value || '';
                const tid = document.getElementById('qr-tid').value || '';
                const region = document.getElementById('qr-region').value || 'JEJU';
                const van = document.getElementById('qr-van').value || 'KIS';
                const phone = document.getElementById('qr-phone').value || '01025710628';
                const remark = document.getElementById('qr-remark').value || '';

                const data = [
                    ['cid', 'tid', 'ì§€ì—­ì½”ë“œ', 'van', 'íœ´ëŒ€í°ë²ˆí˜¸', 'ë¹„ê³ '],
                    [cid, tid, region, van, phone, remark]
                ];

                const ws = XLSX.utils.aoa_to_sheet(data);
                const wb = XLSX.utils.book_new();
                XLSX.utils.book_append_sheet(wb, ws, 'QR_Data');
                const timestamp = new Date().toISOString().split('T')[0];
                const cidPart = cid ? `_${cid}` : '';
                XLSX.writeFile(wb, `QR_Data${cidPart}_${timestamp}.xlsx`);

                document.getElementById('qr-preview').classList.remove('hidden');
                showToast('QR XLSX íŒŒì¼ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤', 'success');
            } catch (error) {
                console.error('XLSX ìƒì„± ì˜¤ë¥˜:', error);
                showToast('XLSX íŒŒì¼ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤', 'error');
            }
        }

        // CSV ìƒì„± í•¨ìˆ˜ë“¤
        function toggleCsvColumn(columnNumber) {
            const options = document.getElementById(`col${columnNumber}-options`);
            const checkbox = document.getElementById(`col${columnNumber}-enable`);

            if (checkbox && options) {
                if (checkbox.checked) {
                    options.classList.remove('hidden');
                } else {
                    options.classList.add('hidden');
                }
            }
        }

        function generateRandomString() {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
            let result = '';
            for (let i = 0; i < 10; i++) {
                result += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return result;
        }

        let csvData = [];

        function generateCsvFile() {
            try {
                const rowCount = parseInt(document.getElementById('csv-rowCount').value);

                if (rowCount <= 0 || rowCount > 1000) {
                    showToast('í–‰ ìˆ˜ëŠ” 1~1000 ë²”ìœ„ë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”', 'error');
                    return;
                }

                const col2Enabled = document.getElementById('col2-enable').checked;
                const col3Enabled = document.getElementById('col3-enable').checked;

                csvData = [];

                for (let i = 0; i < rowCount; i++) {
                    const row = [];

                    // 1ì—´
                    const col1Type = document.querySelector('input[name="col1Type"]:checked').value;
                    if (col1Type === 'random') {
                        const col1Text = document.getElementById('col1-text').value || 'Data';
                        row.push(col1Text);
                    } else {
                        row.push(generateRandomString());
                    }

                    // 2ì—´
                    if (col2Enabled) {
                        const col2Type = document.querySelector('input[name="col2Type"]:checked').value;
                        if (col2Type === 'random') {
                            const col2Text = document.getElementById('col2-text').value || 'Data';
                            row.push(col2Text);
                        } else {
                            row.push(generateRandomString());
                        }
                    }

                    // 3ì—´
                    if (col3Enabled) {
                        const col3Type = document.querySelector('input[name="col3Type"]:checked').value;
                        if (col3Type === 'random') {
                            const col3Text = document.getElementById('col3-text').value || 'Data';
                            row.push(col3Text);
                        } else {
                            row.push(generateRandomString());
                        }
                    }

                    csvData.push(row);
                }

                displayCsvPreview();
                showToast('CSV ë¯¸ë¦¬ë³´ê¸°ê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤', 'success');
            } catch (error) {
                console.error('CSV ìƒì„± ì˜¤ë¥˜:', error);
                showToast('CSV íŒŒì¼ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤', 'error');
            }
        }

        function displayCsvPreview() {
            const previewDiv = document.getElementById('csv-preview');
            const tbody = document.getElementById('csv-preview-body');

            if (!tbody) {
                previewDiv.classList.remove('hidden');
                return;
            }

            tbody.innerHTML = '';

            const previewRows = Math.min(10, csvData.length);
            for (let i = 0; i < previewRows; i++) {
                const tr = document.createElement('tr');
                csvData[i].forEach(cell => {
                    const td = document.createElement('td');
                    td.className = 'border border-neutral-300 px-4 py-2';
                    td.textContent = cell;
                    tr.appendChild(td);
                });
                tbody.appendChild(tr);
            }

            if (csvData.length > 10) {
                const tr = document.createElement('tr');
                const td = document.createElement('td');
                td.colSpan = csvData[0].length;
                td.className = 'border border-neutral-300 px-4 py-2 text-center text-neutral-500';
                td.textContent = `... ì™¸ ${csvData.length - 10}ê°œ í–‰`;
                tr.appendChild(td);
                tbody.appendChild(tr);
            }

            previewDiv.classList.remove('hidden');
        }

        function downloadCsv() {
            if (csvData.length === 0) {
                showToast('ë¨¼ì € CSVë¥¼ ìƒì„±í•´ì£¼ì„¸ìš”', 'error');
                return;
            }

            let csvContent = '';
            csvData.forEach(row => {
                csvContent += row.join(',') + '\n';
            });

            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            const timestamp = new Date().toISOString().replace(/[:.]/g, '-').slice(0, -5);
            const rowCount = csvData.length;
            link.setAttribute('download', `custom_data_${rowCount}rows_${timestamp}.csv`);
            link.click();

            showToast('CSV íŒŒì¼ì´ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤', 'success');
        }

        // ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', function() {
            // ì €ì¥ëœ ì–¸ì–´ ì„¤ì • ë¶ˆëŸ¬ì˜¤ê¸°
            const savedLanguage = localStorage.getItem('preferred-language');
            if (savedLanguage && (savedLanguage === 'ko' || savedLanguage === 'en')) {
                currentLanguage = savedLanguage;
            }
            
            // ì €ì¥ëœ ì•Œë¦¼ íˆìŠ¤í† ë¦¬ ë¶ˆëŸ¬ì˜¤ê¸°
            const savedNotifications = localStorage.getItem('notificationHistory');
            if (savedNotifications) {
                try {
                    notificationHistory = JSON.parse(savedNotifications);
                    // ë‚ ì§œ ê°ì²´ ë³µì›
                    notificationHistory.forEach(n => {
                        n.timestamp = new Date(n.timestamp);
                    });
                } catch (e) {
                    console.error('ì•Œë¦¼ íˆìŠ¤í† ë¦¬ ë¡œë“œ ì‹¤íŒ¨:', e);
                    notificationHistory = [];
                }
            }
            
            // ì´ˆê¸° UI ì„¤ì •
            updateLanguageUI();
            updateAllTexts();
            updateTokenStatus();
            updateDashboardStats();
            updateNotificationBadge();
            updateRecentActivities();
            
            // ì£¼ê¸°ì ìœ¼ë¡œ í† í° ìƒíƒœ ì—…ë°ì´íŠ¸
            setInterval(updateTokenStatus, 30000);
            
            // ì£¼ê¸°ì ìœ¼ë¡œ ëŒ€ì‹œë³´ë“œ í†µê³„ ì—…ë°ì´íŠ¸
            setInterval(() => {
                if (currentTab === 'dashboard') {
                    updateDashboardStats();
                    updateRecentActivities();
                }
            }, 60000);
            
            // ì‹œì‘ ì•Œë¦¼ ì¶”ê°€
            addNotification('admin-tool', 'CEO+ Help ì‹œì‘', 'completed', 'v2.1 - ì•Œë¦¼ ì‹œìŠ¤í…œ í™œì„±í™”');
            
            console.log('CEO+ Help v2.1 - ì•Œë¦¼ ì‹œìŠ¤í…œ ì™„ë£Œ');
        });

        // ë©”ì‹œì§€ ìˆ˜ì‹  ì²˜ë¦¬
        window.addEventListener('message', function(event) {
            try {
                if (event.data && event.data.type === 'REQUEST_TOKENS') {
                    const tokens = getStoredTokens();
                    event.source.postMessage({
                        type: 'SYNC_TOKENS',
                        tokens: tokens
                    }, event.origin);
                }
            } catch (error) {
                console.error('ë©”ì‹œì§€ ì²˜ë¦¬ ì˜¤ë¥˜:', error);
            }
        });

        // ì—ëŸ¬ ì „ì—­ ì²˜ë¦¬
        window.addEventListener('error', function(event) {
            console.error('ì „ì—­ ì—ëŸ¬:', event.error);
            showToast('ì˜ˆìƒì¹˜ ëª»í•œ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤', 'error');
        });
    </script>

    <!-- ì„ì‹œ íŒŒì¼ ì •ë¦¬ ìŠ¤í¬ë¦½íŠ¸ -->
    <script>
        // ê°œë°œìš© ì„ì‹œ íŒŒì¼ ì •ë¦¬
        const tempScript = document.createElement('script');
        tempScript.text = 'console.log("CEO+ Help v2.0 - ì™„ì „ ê°œí¸ ì™„ë£Œ");';
        document.head.appendChild(tempScript);
    </script>
</body>
</html>