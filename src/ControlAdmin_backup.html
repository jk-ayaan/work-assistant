<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì‚¬ì¥ë‹˜ í”ŒëŸ¬ìŠ¤ í—¬í”„ì„¼í„°</title>
    <link rel="icon" type="image/jpeg" href="../favicon-32x32.jpg">
    <link rel="icon" type="image/jpeg" sizes="16x16" href="../favicon-16x16.jpg">
    <link rel="icon" type="image/jpeg" sizes="32x32" href="../favicon-32x32.jpg">
    <!-- TailwindCSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: {
                            50: '#eff6ff',
                            100: '#dbeafe',
                            200: '#bfdbfe',
                            300: '#93c5fd',
                            400: '#60a5fa',
                            500: '#3b82f6',
                            600: '#2563eb',
                            700: '#1d4ed8',
                            800: '#1e40af',
                            900: '#1e3a8a',
                        },
                        surface: {
                            50: '#fafafa',
                            100: '#f5f5f5',
                            200: '#e5e5e5',
                            300: '#d4d4d4',
                            400: '#a3a3a3',
                            500: '#737373',
                        }
                    }
                }
            }
        }
    </script>
    <!-- XLSX ë¼ì´ë¸ŒëŸ¬ë¦¬ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        /* Modern responsive design variables */
        :root {
            --sidebar-width: 320px;
            --admin-panel-width: 320px;
            --collapsed-width: 56px;
            --mobile-breakpoint: 768px;
            --transition-speed: 0.3s;
        }

        /* Responsive grid layout */
        .app-container {
            display: grid;
            grid-template-columns: var(--sidebar-width) var(--admin-panel-width) 1fr;
            grid-template-areas: "sidebar admin content";
            height: 100vh;
            transition: grid-template-columns var(--transition-speed) ease;
        }

        /* Mobile layout */
        @media (max-width: 768px) {
            .app-container {
                grid-template-columns: 1fr;
                grid-template-areas: "content";
            }
            
            .sidebar-mobile-overlay {
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(0, 0, 0, 0.5);
                z-index: 40;
                display: none;
            }
            
            .sidebar-mobile-overlay.active {
                display: block;
            }
            
            .mobile-sidebar {
                position: fixed;
                top: 0;
                left: -100%;
                width: 280px;
                height: 100vh;
                z-index: 50;
                transition: left var(--transition-speed) ease;
                background: white;
                box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
            }
            
            .mobile-sidebar.active {
                left: 0;
            }
            
            .mobile-header {
                display: flex;
                align-items: center;
                justify-content: between;
                padding: 1rem;
                background: white;
                border-bottom: 1px solid #e5e7eb;
                position: sticky;
                top: 0;
                z-index: 30;
            }
            
            .hamburger-btn {
                display: block;
                padding: 8px;
                background: none;
                border: none;
                cursor: pointer;
            }
            
            .hamburger-btn span {
                display: block;
                width: 20px;
                height: 2px;
                background: #374151;
                margin: 3px 0;
                transition: 0.3s;
            }
        }

        @media (min-width: 769px) {
            .mobile-header {
                display: none;
            }
            
            .hamburger-btn {
                display: none;
            }
        }

        /* Enhanced animations and transitions */
        .function-selected {
            background: linear-gradient(90deg, #dbeafe 0%, #eff6ff 100%) !important;
            border-left: 4px solid #2563eb !important;
            transform: translateX(2px);
            box-shadow: 0 2px 8px rgba(37, 99, 235, 0.15);
        }
        
        .admin-selected {
            background: linear-gradient(90deg, #dcfce7 0%, #f0fdf4 100%) !important;
            border-left: 4px solid #16a34a !important;
            transform: translateX(2px);
            box-shadow: 0 2px 8px rgba(22, 163, 74, 0.15);
        }
        
        .tab-active {
            background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%) !important;
            color: white !important;
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
        }

        /* Improved sidebar styles */
        .sidebar-collapsed {
            width: var(--collapsed-width) !important;
        }
        
        .sidebar-collapsed .sidebar-text {
            opacity: 0;
            transform: translateX(-10px);
            transition: opacity 0.2s ease, transform 0.2s ease;
            pointer-events: none;
        }
        
        .sidebar-collapsed .sidebar-icon {
            margin: 0 auto;
            transform: scale(1.1);
            transition: transform 0.2s ease;
        }

        /* Enhanced hover effects */
        .function-toggle {
            cursor: pointer;
            user-select: none;
            transition: all 0.2s ease;
            border-radius: 8px;
            margin: 2px 8px;
        }
        
        .function-toggle:hover {
            background: linear-gradient(90deg, #f8fafc 0%, #f1f5f9 100%);
            transform: translateX(2px);
        }

        /* Modern toggle button */
        .toggle-btn {
            position: absolute;
            right: -12px;
            top: 50%;
            transform: translateY(-50%);
            width: 28px;
            height: 28px;
            background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
            border: 1px solid #e2e8f0;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 10;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            transition: all 0.2s ease;
        }
        
        .toggle-btn:hover {
            background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);
            transform: translateY(-50%) scale(1.05);
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
        }

        /* Smooth transitions for all interactive elements */
        .sidebar-transition {
            transition: all var(--transition-speed) cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .admin-panel-collapsed {
            width: var(--collapsed-width) !important;
        }
        
        .admin-panel-collapsed .admin-text {
            opacity: 0;
            transform: translateX(-10px);
            transition: opacity 0.2s ease, transform 0.2s ease;
            pointer-events: none;
        }
        
        .admin-panel-collapsed .admin-item > div {
            justify-content: center !important;
        }
        
        .admin-panel-collapsed .bg-blue-100 {
            margin: 0 auto;
        }
        .loading-spinner {
            border: 2px solid #f3f3f3;
            border-top: 2px solid #3498db;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .error-container {
            background: #fef2f2;
            border: 1px solid #fecaca;
            border-radius: 8px;
            padding: 16px;
            margin: 16px;
        }
        .success-toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #10b981;
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            z-index: 1000;
            animation: slideIn 0.3s ease;
        }
        @keyframes slideIn {
            from { transform: translateX(100%); }
            to { transform: translateX(0); }
        }
    </style>
</head>
<body class="bg-surface-50">
    <!-- Mobile Header -->
    <div class="mobile-header">
        <button class="hamburger-btn" onclick="toggleMobileSidebar()">
            <span></span>
            <span></span>
            <span></span>
        </button>
        <div class="flex items-center space-x-3">
            <img src="../logo.jpg" alt="ë¡œê³ " class="w-8 h-8 rounded-lg">
            <h1 class="text-lg font-semibold text-gray-800">ì‚¬ì¥ë‹˜ í”ŒëŸ¬ìŠ¤ í—¬í”„ì„¼í„°</h1>
        </div>
    </div>

    <!-- Mobile Sidebar Overlay -->
    <div class="sidebar-mobile-overlay" onclick="toggleMobileSidebar()"></div>

    <div class="app-container">
        <!-- 1ê³„ì¸µ: ê¸°ëŠ¥ ëª©ë¡ -->
        <div id="function-sidebar" class="mobile-sidebar bg-white border-r border-gray-200 flex flex-col sidebar-transition relative" style="grid-area: sidebar;">
            <button class="toggle-btn" onclick="toggleFunctionSidebar()">
                <span id="function-toggle-icon">â€¹</span>
            </button>

            <!-- í—¤ë” -->
            <div class="p-4 lg:p-6 border-b border-gray-200 bg-gradient-to-r from-primary-50 to-white">
                <div class="flex items-center space-x-3 mb-3">
                    <img src="../logo.jpg" alt="ë¡œê³ " class="w-10 h-10 rounded-xl shadow-sm sidebar-text">
                    <div class="sidebar-text">
                        <h2 class="text-lg lg:text-xl font-bold bg-gradient-to-r from-primary-600 to-primary-800 bg-clip-text text-transparent">ì‚¬ì¥ë‹˜ í”ŒëŸ¬ìŠ¤</h2>
                        <p class="text-sm text-gray-600 font-medium">í—¬í”„ì„¼í„°</p>
                    </div>
                </div>
                <p class="text-sm text-gray-500 mb-4 sidebar-text">ìˆ˜í–‰í•  ì‘ì—…ì„ ì„ íƒí•˜ì„¸ìš”</p>
                <div class="space-y-2 sidebar-text">
                    <div class="flex flex-col sm:flex-row gap-2">
                        <button id="cookie-sync-btn" class="flex items-center justify-center px-3 py-2 text-xs bg-gradient-to-r from-purple-600 to-purple-700 text-white rounded-lg hover:from-purple-700 hover:to-purple-800 transition-all shadow-sm">
                            ğŸª ì¿ í‚¤ ë™ê¸°í™”
                        </button>
                        <button id="token-sync-btn" class="flex items-center justify-center px-3 py-2 text-xs bg-gradient-to-r from-green-600 to-green-700 text-white rounded-lg hover:from-green-700 hover:to-green-800 transition-all shadow-sm">
                            ğŸ”„ í† í° ë™ê¸°í™”
                        </button>
                    </div>
                    <div id="token-status" class="text-xs text-gray-500 bg-gray-50 rounded-md px-3 py-2 border">ìƒíƒœ: í™•ì¸ì¤‘...</div>
                </div>
            </div>

            <!-- ì–´ë“œë¯¼ ê¸°ëŠ¥ëª©ë¡ í† ê¸€ í—¤ë” -->
            <div class="function-toggle px-4 py-2 bg-gray-50 border-b border-gray-200 flex items-center justify-between sidebar-text" onclick="toggleAdminFunctions()">
                <span class="font-medium text-gray-700">ì–´ë“œë¯¼ ê¸°ëŠ¥ëª©ë¡</span>
                <span id="admin-functions-arrow" class="text-gray-500">â–¼</span>
            </div>

            <!-- ì–´ë“œë¯¼ ê¸°ëŠ¥ ëª©ë¡ -->
            <div class="admin-functions" style="display: none;">
                <div class="function-item p-4 cursor-pointer border-b border-gray-100 hover:bg-blue-50" data-function="qr-create">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-3">
                            <div class="text-blue-600 sidebar-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.096 2.572-1.065z" />
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                                </svg>
                            </div>
                            <div class="sidebar-text">
                                <div class="font-medium text-gray-800">ê°€ë§¹ì  ìƒì„± ë° QR í™œì„±í™”</div>
                                <div class="text-xs text-gray-500 mt-1">3ê°œ ì–´ë“œë¯¼ ì—°ê´€</div>
                            </div>
                        </div>
                        <div class="text-gray-400 sidebar-text">â†’</div>
                    </div>
                </div>

                <div class="function-item p-4 cursor-pointer border-b border-gray-100 hover:bg-blue-50" data-function="qr-recovery">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-3">
                            <div class="text-blue-600 sidebar-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
                                </svg>
                            </div>
                            <div class="sidebar-text">
                                <div class="font-medium text-gray-800">ê°€ë§¹ì  QR ë³µêµ¬</div>
                                <div class="text-xs text-gray-500 mt-1">3ê°œ ì–´ë“œë¯¼ ì—°ê´€</div>
                            </div>
                        </div>
                        <div class="text-gray-400 sidebar-text">â†’</div>
                    </div>
                </div>

                <div class="function-item p-4 cursor-pointer border-b border-gray-100 hover:bg-blue-50" data-function="permission">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-3">
                            <div class="text-blue-600 sidebar-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
                                </svg>
                            </div>
                            <div class="sidebar-text">
                                <div class="font-medium text-gray-800">ë§¤ì¥ ê¶Œí•œë³€ê²½</div>
                                <div class="text-xs text-gray-500 mt-1">3ê°œ ì–´ë“œë¯¼ ì—°ê´€</div>
                            </div>
                        </div>
                        <div class="text-gray-400 sidebar-text">â†’</div>
                    </div>
                </div>
            </div>

            <!-- ë°ì´í„° ìƒì„± í† ê¸€ í—¤ë” -->
            <div class="function-toggle px-4 py-2 bg-gray-50 border-b border-gray-200 flex items-center justify-between sidebar-text" onclick="toggleDataGenerator()">
                <span class="font-medium text-gray-700">ë°ì´í„° ìƒì„±</span>
                <span id="data-generator-arrow" class="text-gray-500">â–¼</span>
            </div>

            <!-- ë°ì´í„° ìƒì„± ëª©ë¡ -->
            <div class="data-generator-functions" style="display: none;">
                <div class="function-item p-4 cursor-pointer border-b border-gray-100 hover:bg-blue-50" data-function="sample-image-generator">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-3">
                            <div class="text-purple-600 sidebar-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
                                </svg>
                            </div>
                            <div class="sidebar-text">
                                <div class="font-medium text-gray-800">ìƒ˜í”Œ ì´ë¯¸ì§€ ìƒì„±</div>
                                <div class="text-xs text-gray-500 mt-1">ì´ë¯¸ì§€ ìƒì„± ë„êµ¬</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="function-item p-4 cursor-pointer border-b border-gray-100 hover:bg-blue-50" data-function="qr-xlsx-generator">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-3">
                            <div class="text-green-600 sidebar-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                                </svg>
                            </div>
                            <div class="sidebar-text">
                                <div class="font-medium text-gray-800">QR XLSX ìƒì„±</div>
                                <div class="text-xs text-gray-500 mt-1">QR ì—‘ì…€ íŒŒì¼ ìƒì„±</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="function-item p-4 cursor-pointer border-b border-gray-100 hover:bg-blue-50" data-function="csv-generator">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-3">
                            <div class="text-blue-600 sidebar-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                                </svg>
                            </div>
                            <div class="sidebar-text">
                                <div class="font-medium text-gray-800">CSV ìƒì„±</div>
                                <div class="text-xs text-gray-500 mt-1">CSV íŒŒì¼ ìƒì„± ë„êµ¬</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 2ê³„ì¸µ: ì–´ë“œë¯¼ ëª©ë¡ -->
        <div id="admin-panel" class="bg-white border-r border-gray-200 flex-col hidden sidebar-transition relative" style="grid-area: admin;">
            <button class="toggle-btn" onclick="toggleAdminPanel()">
                <span id="admin-toggle-icon">â€¹</span>
            </button>
            <div class="p-4 border-b border-gray-200">
                <h3 class="text-lg font-semibold text-gray-800 admin-text">ì–´ë“œë¯¼ ëª©ë¡</h3>
                <p class="text-sm text-gray-500 mt-1 admin-text" id="function-name">ì„ íƒëœ ê¸°ëŠ¥</p>
            </div>
            <div class="flex-1 overflow-y-auto" id="admin-list">
                <!-- ì–´ë“œë¯¼ ëª©ë¡ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
            </div>
        </div>

        <!-- 3ê³„ì¸µ: ì½˜í…ì¸  ì˜ì—­ -->
        <div class="flex flex-col overflow-hidden" style="grid-area: content;">
            <!-- íƒ­ í—¤ë” -->
            <div id="tab-header" class="bg-white border-b border-gray-200 hidden">
                <div class="flex items-center p-2">
                    <div id="tab-list" class="flex-1 flex items-center space-x-1 overflow-x-auto">
                        <!-- íƒ­ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
                    </div>
                    <button id="new-tab-btn" class="px-3 py-1 text-sm bg-gray-200 rounded hover:bg-gray-300 ml-2">
                        + ìƒˆ íƒ­
                    </button>
                    <button id="new-window-btn" class="px-3 py-1 text-sm bg-blue-500 text-white rounded hover:bg-blue-600 ml-2">
                        + ìƒˆ ì°½
                    </button>
                </div>
            </div>

            <!-- ì½˜í…ì¸  ì˜ì—­ -->
            <div class="flex-1 bg-white relative" id="content-container">
                <div id="empty-state" class="flex items-center justify-center h-full">
                    <div class="text-center">
                        <div class="text-6xl mb-4">ğŸ–¥ï¸</div>
                        <h3 class="text-xl font-medium text-gray-500 mb-2">ì–´ë“œë¯¼ì„ ì„ íƒí•˜ì„¸ìš”</h3>
                        <p class="text-gray-400">ë¨¼ì € ìˆ˜í–‰í•  ê¸°ëŠ¥ì„ ì„ íƒí•œ í›„ ì–´ë“œë¯¼ì„ ì„ íƒí•˜ì„¸ìš”</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ì¿ í‚¤ ë™ê¸°í™” ëª¨ë‹¬ -->
    <div id="cookie-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50">
        <div class="bg-white rounded-lg p-6 max-w-2xl w-full m-4 max-h-[80vh] overflow-y-auto">
            <h3 class="text-lg font-semibold mb-4">ğŸª ì¿ í‚¤ ê´€ë¦¬</h3>
            <div class="mb-4">
                <h4 class="font-medium mb-2">í˜„ì¬ ì €ì¥ëœ ì¿ í‚¤:</h4>
                <div id="cookie-list" class="bg-gray-100 p-3 rounded text-sm font-mono max-h-40 overflow-y-auto">
                    ë¡œë”©ì¤‘...
                </div>
            </div>
            <div class="mb-4">
                <h4 class="font-medium mb-2">ì¿ í‚¤ ì¶”ê°€/ìˆ˜ì •:</h4>
                <input id="cookie-input" type="text"
                       placeholder="name=value; domain=.example.com; path=/"
                       class="w-full p-2 border rounded text-sm">
                <button onclick="addCookie()" class="mt-2 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">
                    ì¿ í‚¤ ì¶”ê°€
                </button>
            </div>
            <button onclick="closeCookieModal()" class="w-full p-3 bg-gray-300 text-gray-700 rounded hover:bg-gray-400">
                ë‹«ê¸°
            </button>
        </div>
    </div>

    <script>
        // ì „ì—­ ë³€ìˆ˜
        const functionData = {
            'qr-create': {
                name: 'ê°€ë§¹ì  ìƒì„± ë° QR í™œì„±í™”',
                admins: [
                    {
                        name: 'ì™€ì¹¸ë‹¤_ì‹ ì²­ì„œ',
                        url: 'https://www.google.com',
                        desc: 'ê°€ë§¹ì  ì‹ ì²­ì„œ ì‘ì„±',
                        isInternal: false
                    },
                    {
                        name: 'ì™€ì¹¸ë‹¤_í™œì„±í™”',
                        url: 'https://www.naver.com',
                        desc: 'ê°€ë§¹ì  í™œì„±í™” ì²˜ë¦¬',
                        isInternal: false
                    },
                    {
                        name: 'ì˜¤í”„ë¼ì¸_QRìƒì„±ìš”ì²­',
                        url: 'https://admin.example.com/qr',
                        desc: 'ì˜¤í”„ë¼ì¸ QR ìƒì„±',
                        isInternal: true
                    }
                ]
            },
            'qr-recovery': {
                name: 'ê°€ë§¹ì  QR ë³µêµ¬',
                admins: [
                    {
                        name: 'QR ê´€ë¦¬',
                        url: 'https://admin.example.com/qr-manage',
                        desc: 'QR ë³µêµ¬',
                        isInternal: true
                    },
                    {
                        name: 'ë¡œê·¸ ê´€ë¦¬',
                        url: 'https://admin.example.com/logs',
                        desc: 'ë¡œê·¸ í™•ì¸',
                        isInternal: true
                    },
                    {
                        name: 'ê°€ë§¹ì  ê´€ë¦¬',
                        url: 'https://www.kakao.com',
                        desc: 'ìƒíƒœ í™•ì¸',
                        isInternal: false
                    }
                ]
            },
            'permission': {
                name: 'ë§¤ì¥ ê¶Œí•œë³€ê²½',
                admins: [
                    {
                        name: 'ê¶Œí•œ ê´€ë¦¬',
                        url: 'https://admin.example.com/permissions',
                        desc: 'ê¶Œí•œ ì„¤ì •',
                        isInternal: true
                    },
                    {
                        name: 'ì‚¬ìš©ì ê´€ë¦¬',
                        url: 'https://admin.example.com/users',
                        desc: 'ì—­í•  ê´€ë¦¬',
                        isInternal: true
                    },
                    {
                        name: 'ê°ì‚¬ ê´€ë¦¬',
                        url: 'https://www.youtube.com',
                        desc: 'ë³€ê²½ ì´ë ¥',
                        isInternal: false
                    }
                ]
            }
        };

        let selectedFunction = null;
        let selectedAdmin = null;
        let windowRefs = {};
        let tabs = [];
        let activeTabId = null;
        let tabCounter = 0;

        // ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ë“¤
        function isValidUrl(string) {
            try {
                new URL(string);
                return true;
            } catch (_) {
                return false;
            }
        }

        function showToast(message, type = 'success') {
            const toast = document.createElement('div');
            toast.className = `success-toast ${type}`;
            toast.textContent = message;
            document.body.appendChild(toast);

            setTimeout(() => {
                toast.remove();
            }, 3000);
        }

        function showLoadingState(container) {
            container.innerHTML = `
                <div class="flex items-center justify-center h-full">
                    <div class="text-center">
                        <div class="loading-spinner mx-auto mb-4"></div>
                        <p class="text-gray-500">ë¡œë”© ì¤‘...</p>
                    </div>
                </div>
            `;
        }

        function showErrorState(container, message) {
            container.innerHTML = `
                <div class="flex items-center justify-center h-full">
                    <div class="error-container max-w-md text-center">
                        <div class="text-4xl mb-4">âš ï¸</div>
                        <h3 class="text-lg font-medium text-red-700 mb-2">ì˜¤ë¥˜ ë°œìƒ</h3>
                        <p class="text-red-600 mb-4">${message}</p>
                        <button onclick="location.reload()" class="px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600">
                            ë‹¤ì‹œ ì‹œë„
                        </button>
                    </div>
                </div>
            `;
        }

        // ìƒ˜í”Œ ì´ë¯¸ì§€ ìƒì„±ê¸° í•¨ìˆ˜ë“¤
        function generateSampleImage() {
            try {
                const size = document.getElementById('sample-imageSize').value;
                const [width, height] = size.split('x').map(Number);
                const bgColor = document.getElementById('sample-bgColor').value;
                const text = document.getElementById('sample-imageText').value;
                const count = parseInt(document.getElementById('sample-imageCount').value) || 1;

                // í¬ë§· ì²´í¬
                const formats = [];
                document.querySelectorAll('input[name="imageFormat"]:checked').forEach(el => {
                    formats.push(el.value);
                });

                if (formats.length === 0) {
                    alert('ìµœì†Œ í•˜ë‚˜ì˜ ì´ë¯¸ì§€ í¬ë§·ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
                    return;
                }

                const canvas = document.getElementById('sample-canvas');
                const ctx = canvas.getContext('2d');

                canvas.width = width;
                canvas.height = height;
                canvas.style.maxWidth = '100%';
                canvas.style.height = 'auto';

                // ì²« ë²ˆì§¸ ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸°
                ctx.fillStyle = bgColor;
                ctx.fillRect(0, 0, width, height);

                ctx.fillStyle = '#333333';
                ctx.font = Math.max(16, width/20) + 'px Arial';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText(text, width/2, height/2 - Math.max(20, width/20));

                // ìˆ«ì í‘œì‹œ
                ctx.font = Math.max(40, width/10) + 'px Arial';
                ctx.fillText('1', width/2, height/2 + Math.max(20, width/20));

                ctx.font = Math.max(12, width/30) + 'px Arial';
                ctx.fillText(width + ' Ã— ' + height, width/2, height - Math.max(20, width/30));

                // ì „ì—­ ë³€ìˆ˜ì— ì„¤ì • ì €ì¥
                window.sampleImageSettings = {
                    width, height, bgColor, text, count, formats
                };

                document.getElementById('sample-downloadBtn').disabled = false;
            } catch (error) {
                console.error('ì´ë¯¸ì§€ ìƒì„± ì˜¤ë¥˜:', error);
                alert('ì´ë¯¸ì§€ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        }

        function downloadSampleImage() {
            try {
                const settings = window.sampleImageSettings;
                if (!settings) {
                    alert('ë¨¼ì € ì´ë¯¸ì§€ë¥¼ ìƒì„±í•´ì£¼ì„¸ìš”.');
                    return;
                }

                const { width, height, bgColor, text, count, formats } = settings;
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');

                canvas.width = width;
                canvas.height = height;

                for (let i = 1; i <= count; i++) {
                    // ìº”ë²„ìŠ¤ ì´ˆê¸°í™”
                    ctx.fillStyle = bgColor;
                    ctx.fillRect(0, 0, width, height);

                    ctx.fillStyle = '#333333';
                    ctx.font = Math.max(16, width/20) + 'px Arial';
                    ctx.textAlign = 'center';
                    ctx.textBaseline = 'middle';
                    ctx.fillText(text, width/2, height/2 - Math.max(20, width/20));

                    // ìˆ«ì í‘œì‹œ
                    ctx.font = Math.max(40, width/10) + 'px Arial';
                    ctx.fillText(i.toString(), width/2, height/2 + Math.max(20, width/20));

                    ctx.font = Math.max(12, width/30) + 'px Arial';
                    ctx.fillText(width + ' Ã— ' + height, width/2, height - Math.max(20, width/30));

                    // ê° í¬ë§·ìœ¼ë¡œ ë‹¤ìš´ë¡œë“œ
                    formats.forEach(format => {
                        const link = document.createElement('a');
                        const ext = format.toLowerCase();
                        const timestamp = new Date().toISOString().replace(/[:.]/g, '-').slice(0, -5);
                        link.download = `sample-image_${timestamp}_${i}.${ext}`;

                        if (ext === 'jpg' || ext === 'jpeg') {
                            link.href = canvas.toDataURL('image/jpeg', 0.9);
                        } else if (ext === 'webp') {
                            link.href = canvas.toDataURL('image/webp', 0.9);
                        } else {
                            link.href = canvas.toDataURL('image/png');
                        }

                        link.click();
                    });
                }

                showToast(`${count}ê°œ ì´ë¯¸ì§€ Ã— ${formats.length}ê°œ í¬ë§· = ì´ ${count * formats.length}ê°œ íŒŒì¼ ë‹¤ìš´ë¡œë“œ ì™„ë£Œ`);
            } catch (error) {
                console.error('ë‹¤ìš´ë¡œë“œ ì˜¤ë¥˜:', error);
                alert('ë‹¤ìš´ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        }

        // QR XLSX ìƒì„±ê¸° í•¨ìˆ˜
        function generateQRXlsx() {
            try {
                const cid = document.getElementById('qr-cid').value || '';
                const tid = document.getElementById('qr-tid').value || '';
                const region = document.getElementById('qr-region').value || 'JEJU';
                const van = document.getElementById('qr-van').value || 'KIS';
                const phone = document.getElementById('qr-phone').value || '01025710628';
                const remark = document.getElementById('qr-remark').value || '';

                const data = [
                    ['cid', 'tid', 'ì§€ì—­ì½”ë“œ', 'van', 'íœ´ëŒ€í°ë²ˆí˜¸', 'ë¹„ê³ '],
                    [cid, tid, region, van, phone, remark]
                ];

                const ws = XLSX.utils.aoa_to_sheet(data);
                const wb = XLSX.utils.book_new();
                XLSX.utils.book_append_sheet(wb, ws, 'QR_Data');
                const timestamp = new Date().toISOString().split('T')[0];
                const cidPart = cid ? `_${cid}` : '';
                XLSX.writeFile(wb, `QR_Data${cidPart}_${timestamp}.xlsx`);

                document.getElementById('qr-preview').classList.remove('hidden');
            } catch (error) {
                console.error('XLSX ìƒì„± ì˜¤ë¥˜:', error);
                alert('XLSX íŒŒì¼ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        }

        // CSV ì—´ í† ê¸€ í•¨ìˆ˜
        function toggleCsvColumn(columnNumber) {
            const options = document.getElementById(`col${columnNumber}-options`);
            const checkbox = document.getElementById(`col${columnNumber}-enable`);

            if (checkbox && options) {
                if (checkbox.checked) {
                    options.classList.remove('hidden');
                } else {
                    options.classList.add('hidden');
                }
            }
        }

        // CSV ìƒì„±ê¸° í•¨ìˆ˜
        function generateRandomString() {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
            let result = '';
            for (let i = 0; i < 10; i++) {
                result += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return result;
        }

        let csvData = [];

        function generateCsvFile() {
            try {
                const rowCount = parseInt(document.getElementById('csv-rowCount').value);

                if (rowCount <= 0 || rowCount > 1000) {
                    alert('í–‰ ìˆ˜ëŠ” 1~1000 ë²”ìœ„ë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                    return;
                }

                // ì—´ ì„¤ì • í™•ì¸
                const col2Enabled = document.getElementById('col2-enable').checked;
                const col3Enabled = document.getElementById('col3-enable').checked;

                // ë°ì´í„° ìƒì„±
                csvData = [];

                for (let i = 0; i < rowCount; i++) {
                    const row = [];

                    // 1ì—´
                    const col1Type = document.querySelector('input[name="col1Type"]:checked').value;
                    if (col1Type === 'random') {
                        const col1Text = document.getElementById('col1-text').value || 'Data';
                        row.push(col1Text);
                    } else {
                        row.push(generateRandomString());
                    }

                    // 2ì—´
                    if (col2Enabled) {
                        const col2Type = document.querySelector('input[name="col2Type"]:checked').value;
                        if (col2Type === 'random') {
                            const col2Text = document.getElementById('col2-text').value || 'Data';
                            row.push(col2Text);
                        } else {
                            row.push(generateRandomString());
                        }
                    }

                    // 3ì—´
                    if (col3Enabled) {
                        const col3Type = document.querySelector('input[name="col3Type"]:checked').value;
                        if (col3Type === 'random') {
                            const col3Text = document.getElementById('col3-text').value || 'Data';
                            row.push(col3Text);
                        } else {
                            row.push(generateRandomString());
                        }
                    }

                    csvData.push(row);
                }

                // ë¯¸ë¦¬ë³´ê¸° í‘œì‹œ
                displayCsvPreview();

            } catch (error) {
                console.error('CSV ìƒì„± ì˜¤ë¥˜:', error);
                alert('CSV íŒŒì¼ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        }

        function displayCsvPreview() {
            const previewDiv = document.getElementById('csv-preview');
            const tbody = document.getElementById('csv-preview-body');

            if (!tbody) {
                previewDiv.classList.remove('hidden');
                return;
            }

            tbody.innerHTML = '';

            // ì²˜ìŒ 10ê°œ í–‰ë§Œ í‘œì‹œ
            const previewRows = Math.min(10, csvData.length);
            for (let i = 0; i < previewRows; i++) {
                const tr = document.createElement('tr');
                csvData[i].forEach(cell => {
                    const td = document.createElement('td');
                    td.className = 'border border-gray-300 px-4 py-2';
                    td.textContent = cell;
                    tr.appendChild(td);
                });
                tbody.appendChild(tr);
            }

            if (csvData.length > 10) {
                const tr = document.createElement('tr');
                const td = document.createElement('td');
                td.colSpan = csvData[0].length;
                td.className = 'border border-gray-300 px-4 py-2 text-center text-gray-500';
                td.textContent = `... ì™¸ ${csvData.length - 10}ê°œ í–‰`;
                tr.appendChild(td);
                tbody.appendChild(tr);
            }

            previewDiv.classList.remove('hidden');
        }

        function downloadCsv() {
            if (csvData.length === 0) {
                alert('ë¨¼ì € CSVë¥¼ ìƒì„±í•´ì£¼ì„¸ìš”.');
                return;
            }

            let csvContent = '';
            csvData.forEach(row => {
                csvContent += row.join(',') + '\n';
            });

            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            const timestamp = new Date().toISOString().replace(/[:.]/g, '-').slice(0, -5);
            const rowCount = csvData.length;
            link.setAttribute('download', `custom_data_${rowCount}rows_${timestamp}.csv`);
            link.click();

            showToast('CSV íŒŒì¼ì´ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤.');
        }

        // ì¿ í‚¤ ê´€ë¦¬ í•¨ìˆ˜
        function getAllCookies() {
            const cookies = {};
            document.cookie.split(';').forEach(cookie => {
                const [name, value] = cookie.trim().split('=');
                if (name) cookies[name] = value || '';
            });
            return cookies;
        }

        function setCookie(name, value, options = {}) {
            let cookieString = `${name}=${value}`;

            if (options.domain) cookieString += `; domain=${options.domain}`;
            if (options.path) cookieString += `; path=${options.path}`;
            if (options.expires) cookieString += `; expires=${options.expires}`;
            if (options.maxAge) cookieString += `; max-age=${options.maxAge}`;
            if (options.secure) cookieString += '; secure';
            if (options.sameSite) cookieString += `; samesite=${options.sameSite}`;

            document.cookie = cookieString;
        }

        function showCookieModal() {
            const modal = document.getElementById('cookie-modal');
            modal.classList.remove('hidden');
            updateCookieList();
        }

        function closeCookieModal() {
            document.getElementById('cookie-modal').classList.add('hidden');
        }

        function updateCookieList() {
            const cookies = getAllCookies();
            const cookieList = document.getElementById('cookie-list');

            if (Object.keys(cookies).length === 0) {
                cookieList.textContent = 'ì¿ í‚¤ê°€ ì—†ìŠµë‹ˆë‹¤.';
            } else {
                cookieList.innerHTML = Object.entries(cookies)
                    .map(([name, value]) => `<div class="mb-1"><strong>${name}</strong> = ${value}</div>`)
                    .join('');
            }
        }

        function addCookie() {
            const input = document.getElementById('cookie-input').value.trim();
            if (!input) {
                alert('ì¿ í‚¤ ì •ë³´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            try {
                const parts = input.split(';').map(p => p.trim());
                const [name, value] = parts[0].split('=');

                if (!name) {
                    alert('ì¿ í‚¤ ì´ë¦„ì´ í•„ìš”í•©ë‹ˆë‹¤.');
                    return;
                }

                const options = {};
                parts.slice(1).forEach(part => {
                    const [key, val] = part.split('=');
                    if (key) {
                        options[key.toLowerCase()] = val || true;
                    }
                });

                setCookie(name, value || '', options);
                updateCookieList();
                document.getElementById('cookie-input').value = '';
                showToast('ì¿ í‚¤ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.');
            } catch (e) {
                console.error('ì¿ í‚¤ ì¶”ê°€ ì˜¤ë¥˜:', e);
                alert('ì˜¬ë°”ë¥¸ ì¿ í‚¤ í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤. ì˜ˆ: name=value; domain=.example.com');
            }
        }

        // í† í° ê´€ë¦¬ í•¨ìˆ˜
        function getStoredTokens() {
            const tokens = {
                localStorage: {},
                sessionStorage: {},
                cookies: {}
            };

            try {
                // localStorage í† í°
                for (let i = 0; i < localStorage.length; i++) {
                    const key = localStorage.key(i);
                    if (key && (key.includes('token') || key.includes('auth') || key.includes('session'))) {
                        tokens.localStorage[key] = localStorage.getItem(key);
                    }
                }

                // sessionStorage í† í°
                for (let i = 0; i < sessionStorage.length; i++) {
                    const key = sessionStorage.key(i);
                    if (key && (key.includes('token') || key.includes('auth') || key.includes('session'))) {
                        tokens.sessionStorage[key] = sessionStorage.getItem(key);
                    }
                }

                // ì¿ í‚¤ í† í°
                const cookies = getAllCookies();
                Object.entries(cookies).forEach(([name, value]) => {
                    if (name.includes('token') || name.includes('auth') || name.includes('session')) {
                        tokens.cookies[name] = value;
                    }
                });
            } catch (error) {
                console.error('í† í° ì¡°íšŒ ì˜¤ë¥˜:', error);
            }

            return tokens;
        }

        function updateTokenStatus() {
            try {
                const tokens = getStoredTokens();
                const statusEl = document.getElementById('token-status');

                const totalCount =
                    Object.keys(tokens.localStorage).length +
                    Object.keys(tokens.sessionStorage).length +
                    Object.keys(tokens.cookies).length;

                if (totalCount > 0) {
                    statusEl.innerHTML =
                        `<span class="text-green-600">âœ… í† í° ${totalCount}ê°œ ë°œê²¬</span>` +
                        `<span class="text-xs text-gray-500 block">` +
                            `Local: ${Object.keys(tokens.localStorage).length}, ` +
                            `Session: ${Object.keys(tokens.sessionStorage).length}, ` +
                            `Cookie: ${Object.keys(tokens.cookies).length}` +
                        `</span>`;
                } else {
                    statusEl.innerHTML = '<span class="text-red-600">âŒ í† í° ì—†ìŒ</span>';
                }
            } catch (error) {
                console.error('í† í° ìƒíƒœ ì—…ë°ì´íŠ¸ ì˜¤ë¥˜:', error);
                document.getElementById('token-status').innerHTML = '<span class="text-red-600">âŒ ì˜¤ë¥˜</span>';
            }
        }

        function syncTokens() {
            try {
                const tokens = getStoredTokens();
                console.log('ë™ê¸°í™”í•  í† í°:', tokens);

                // ì—´ë ¤ìˆëŠ” ëª¨ë“  ì°½ì— í† í° ì „ì†¡ ì‹œë„
                Object.values(windowRefs).forEach(win => {
                    if (win && !win.closed) {
                        try {
                            win.postMessage({
                                type: 'SYNC_TOKENS',
                                tokens: tokens
                            }, '*');
                        } catch (e) {
                            console.log('í† í° ì „ì†¡ ì‹¤íŒ¨:', e);
                        }
                    }
                });

                showToast('í† í° ë™ê¸°í™”ë¥¼ ì‹œë„í–ˆìŠµë‹ˆë‹¤. ê°œë°œì ì½˜ì†”ì„ í™•ì¸í•˜ì„¸ìš”.');
            } catch (error) {
                console.error('í† í° ë™ê¸°í™” ì˜¤ë¥˜:', error);
                showToast('í† í° ë™ê¸°í™” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
            }
        }

        // UI í•¨ìˆ˜
        function selectFunction(funcId, element) {
            try {
                // ë°ì´í„° ìƒì„± ë„êµ¬ ëª©ë¡ì˜ í™œì„±í™” ìŠ¤íƒ€ì¼ ì œê±°
                document.querySelectorAll('.data-generator-functions .function-item').forEach(item => {
                    item.classList.remove('bg-blue-100');
                });

                // ê¸°ì¡´ íƒ­ë“¤ ëª¨ë‘ ì •ë¦¬
                clearAllTabs();

                selectedFunction = funcId;
                selectedAdmin = null;

                document.querySelectorAll('.function-item').forEach(item => {
                    item.classList.remove('function-selected');
                });
                element.classList.add('function-selected');

                const adminPanel = document.getElementById('admin-panel');
                adminPanel.classList.remove('hidden');
                adminPanel.classList.add('flex');

                document.getElementById('function-name').textContent = functionData[funcId].name;

                const adminList = document.getElementById('admin-list');
                adminList.innerHTML = '';

                functionData[funcId].admins.forEach((admin, index) => {
                    const adminItem = document.createElement('div');
                    adminItem.className = 'admin-item p-4 cursor-pointer border-b border-gray-100 hover:bg-green-50';
                    adminItem.innerHTML = `
                        <div class="flex items-center justify-between">
                            <span class="bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded flex-shrink-0">${index + 1}</span>
                            <div class="flex-1 ml-3 admin-text">
                                <div class="font-medium text-gray-800 flex items-center space-x-2">
                                    <span>${admin.name}</span>
                                    ${admin.isInternal ? '<span class="bg-yellow-100 text-yellow-800 text-xs px-2 py-1 rounded">ë‚´ë¶€</span>' : ''}
                                </div>
                                <div class="text-sm text-gray-500 mt-1">${admin.desc}</div>
                                <div class="text-xs text-gray-400 mt-1 truncate">${admin.url}</div>
                            </div>
                            <div class="text-gray-400 admin-text ml-2">â†’</div>
                        </div>
                    `;

                    adminItem.addEventListener('click', () => selectAdmin(admin, adminItem));
                    adminList.appendChild(adminItem);
                });

                // ë¹ˆ ìƒíƒœ í‘œì‹œ
                const contentContainer = document.getElementById('content-container');
                contentContainer.innerHTML = `
                    <div id="empty-state" class="flex items-center justify-center h-full">
                        <div class="text-center">
                            <div class="text-6xl mb-4">ğŸ–¥ï¸</div>
                            <h3 class="text-xl font-medium text-gray-500 mb-2">ì–´ë“œë¯¼ì„ ì„ íƒí•˜ì„¸ìš”</h3>
                            <p class="text-gray-400">ì™¼ìª½ì—ì„œ ì–´ë“œë¯¼ì„ ì„ íƒí•˜ì„¸ìš”</p>
                        </div>
                    </div>
                `;
            } catch (error) {
                console.error('ê¸°ëŠ¥ ì„ íƒ ì˜¤ë¥˜:', error);
                showToast('ê¸°ëŠ¥ ì„ íƒ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
            }
        }

        function selectAdmin(admin, element) {
            try {
                selectedAdmin = admin;

                document.querySelectorAll('.admin-item').forEach(item => {
                    item.classList.remove('admin-selected');
                });
                element.classList.add('admin-selected');

                openAdminPage(admin);
            } catch (error) {
                console.error('ì–´ë“œë¯¼ ì„ íƒ ì˜¤ë¥˜:', error);
                showToast('ì–´ë“œë¯¼ ì„ íƒ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
            }
        }

        function openAdminPage(admin) {
            try {
                if (admin.isInternal) {
                    createTab(admin);
                } else {
                    const windowName = 'admin_' + admin.name.replace(/\s/g, '_');
                    const windowFeatures = 'width=1200,height=800,menubar=yes,toolbar=yes,location=yes,status=yes,scrollbars=yes,resizable=yes';

                    const win = window.open(admin.url, windowName, windowFeatures);
                    if (win) {
                        windowRefs[windowName] = win;

                        const emptyState = document.getElementById('empty-state');
                        emptyState.innerHTML = `
                            <div class="text-center">
                                <div class="text-6xl mb-4">ğŸªŸ</div>
                                <h3 class="text-xl font-medium text-gray-700 mb-2">${admin.name}</h3>
                                <p class="text-gray-500 mb-4">ìƒˆ ì°½ì—ì„œ ì—´ë ¸ìŠµë‹ˆë‹¤</p>
                                <div class="space-y-2">
                                    <button onclick="focusWindow('${windowName}')" class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">
                                        ì°½ìœ¼ë¡œ ì´ë™
                                    </button>
                                </div>
                            </div>
                        `;
                    } else {
                        showToast('íŒì—…ì´ ì°¨ë‹¨ë˜ì—ˆìŠµë‹ˆë‹¤. íŒì—… í—ˆìš© í›„ ë‹¤ì‹œ ì‹œë„í•˜ì„¸ìš”.', 'error');
                    }
                }
            } catch (error) {
                console.error('ì–´ë“œë¯¼ í˜ì´ì§€ ì—´ê¸° ì˜¤ë¥˜:', error);
                showToast('í˜ì´ì§€ë¥¼ ì—´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.', 'error');
            }
        }

        // íƒ­ ê´€ë¦¬ í•¨ìˆ˜ë“¤
        function clearAllTabs() {
            try {
                // ëª¨ë“  íƒ­ ì œê±°
                tabs.forEach(tab => {
                    const tabElement = document.getElementById(`tab-${tab.id}`);
                    const tabContent = document.getElementById(`tab-content-${tab.id}`);
                    if (tabElement) tabElement.remove();
                    if (tabContent) tabContent.remove();
                });

                // íƒ­ ë°°ì—´ ì´ˆê¸°í™”
                tabs = [];
                activeTabId = null;

                // íƒ­ ë¦¬ìŠ¤íŠ¸ ë¹„ìš°ê¸°
                const tabList = document.getElementById('tab-list');
                if (tabList) {
                    tabList.innerHTML = '';
                }

                // íƒ­ í—¤ë” ìˆ¨ê¸°ê¸°
                document.getElementById('tab-header').classList.add('hidden');
            } catch (error) {
                console.error('íƒ­ ì •ë¦¬ ì˜¤ë¥˜:', error);
            }
        }

        function createTab(admin) {
            try {
                const tabId = ++tabCounter;
                const tab = {
                    id: tabId,
                    admin: admin,
                    active: false
                };
                tabs.push(tab);

                // íƒ­ í—¤ë” ì¶”ê°€
                const tabElement = document.createElement('div');
                tabElement.id = `tab-${tabId}`;
                tabElement.className = 'flex items-center px-3 py-1 bg-gray-200 rounded cursor-pointer hover:bg-gray-300';
                tabElement.innerHTML = `
                    <span class="text-sm truncate max-w-[150px]">${admin.name}</span>
                    <button class="ml-2 text-xs hover:text-red-500" onclick="closeTab(${tabId})">Ã—</button>
                `;
                tabElement.addEventListener('click', (e) => {
                    if (e.target.tagName !== 'BUTTON') {
                        activateTab(tabId);
                    }
                });

                document.getElementById('tab-list').appendChild(tabElement);

                // íƒ­ ì½˜í…ì¸  ì¶”ê°€
                const tabContent = document.createElement('div');
                tabContent.id = `tab-content-${tabId}`;
                tabContent.className = 'absolute inset-0 bg-white hidden flex flex-col';
                tabContent.innerHTML = `
                    <div class="bg-gray-100 p-2 border-b flex items-center space-x-2 flex-shrink-0">
                        <button class="nav-btn px-2 py-1 bg-gray-200 rounded text-xs hover:bg-gray-300" onclick="navigateTab(${tabId}, 'back')">â†</button>
                        <button class="nav-btn px-2 py-1 bg-gray-200 rounded text-xs hover:bg-gray-300" onclick="navigateTab(${tabId}, 'forward')">â†’</button>
                        <button class="nav-btn px-2 py-1 bg-gray-200 rounded text-xs hover:bg-gray-300" onclick="navigateTab(${tabId}, 'refresh')">âŸ³</button>
                        <input class="address-bar flex-1 px-2 py-1 border rounded text-xs" value="${admin.url}" id="address-${tabId}" onkeypress="handleAddressKeypress(event, ${tabId})">
                        <button class="nav-btn px-2 py-1 bg-blue-500 text-white rounded text-xs hover:bg-blue-600" onclick="navigateTab(${tabId}, 'go')">ì´ë™</button>
                        <button class="nav-btn px-2 py-1 bg-green-500 text-white rounded text-xs hover:bg-green-600" onclick="openInNewWindow('${admin.url}')">ğŸªŸ</button>
                    </div>
                    <div class="flex-1 relative">
                        <iframe src="${admin.url}"
                                class="w-full h-full border-0"
                                id="iframe-${tabId}"
                                sandbox="allow-same-origin allow-scripts allow-popups allow-forms allow-top-navigation">
                        </iframe>
                    </div>
                `;

                document.getElementById('content-container').appendChild(tabContent);

                // íƒ­ í—¤ë” í‘œì‹œ
                document.getElementById('tab-header').classList.remove('hidden');
                document.getElementById('empty-state').classList.add('hidden');

                // íƒ­ í™œì„±í™”
                activateTab(tabId);

                // iframe ë¡œë“œ ì´ë²¤íŠ¸ ì²˜ë¦¬
                const iframe = document.getElementById(`iframe-${tabId}`);
                iframe.addEventListener('load', () => {
                    handleIframeLoad(iframe, admin);
                });

                iframe.addEventListener('error', () => {
                    showErrorState(iframe.parentElement, 'í˜ì´ì§€ë¥¼ ë¡œë“œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                });
            } catch (error) {
                console.error('íƒ­ ìƒì„± ì˜¤ë¥˜:', error);
                showToast('íƒ­ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
            }
        }

        function activateTab(tabId) {
            try {
                activeTabId = tabId;

                // ëª¨ë“  íƒ­ ë¹„í™œì„±í™”
                tabs.forEach(tab => {
                    const tabElement = document.getElementById(`tab-${tab.id}`);
                    const tabContent = document.getElementById(`tab-content-${tab.id}`);
                    if (tabElement) tabElement.classList.remove('tab-active');
                    if (tabContent) tabContent.classList.add('hidden');
                    tab.active = false;
                });

                // ì„ íƒëœ íƒ­ í™œì„±í™”
                const selectedTab = tabs.find(t => t.id === tabId);
                if (selectedTab) {
                    const tabElement = document.getElementById(`tab-${tabId}`);
                    const tabContent = document.getElementById(`tab-content-${tabId}`);
                    if (tabElement) tabElement.classList.add('tab-active');
                    if (tabContent) tabContent.classList.remove('hidden');
                    selectedTab.active = true;
                }
            } catch (error) {
                console.error('íƒ­ í™œì„±í™” ì˜¤ë¥˜:', error);
            }
        }

        function closeTab(tabId) {
            try {
                const index = tabs.findIndex(t => t.id === tabId);
                if (index > -1) {
                    tabs.splice(index, 1);

                    const tabElement = document.getElementById(`tab-${tabId}`);
                    const tabContent = document.getElementById(`tab-content-${tabId}`);
                    if (tabElement) tabElement.remove();
                    if (tabContent) tabContent.remove();

                    if (tabs.length === 0) {
                        document.getElementById('tab-header').classList.add('hidden');
                        document.getElementById('empty-state').classList.remove('hidden');
                    } else if (activeTabId === tabId && tabs.length > 0) {
                        activateTab(tabs[tabs.length - 1].id);
                    }
                }
            } catch (error) {
                console.error('íƒ­ ë‹«ê¸° ì˜¤ë¥˜:', error);
            }
        }

        function handleIframeLoad(iframe, admin) {
            try {
                // ë™ì¼ ì¶œì²˜ì¼ ë•Œë§Œ ì ‘ê·¼ ê°€ëŠ¥
                const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;

                // 401 ì—ëŸ¬ ì²´í¬
                if (iframeDoc.title.includes('401') ||
                    iframeDoc.body.textContent.includes('Unauthorized') ||
                    iframeDoc.body.textContent.includes('401')) {

                    console.log('401 ì—ëŸ¬ ê°ì§€ë¨');

                    // ê¸°ì¡´ ê²½ê³  ì œê±°
                    const existingTip = iframe.parentElement.querySelector('.auth-warning');
                    if (existingTip) existingTip.remove();

                    // ìƒˆ ê²½ê³  í‘œì‹œ
                    const tipDiv = document.createElement('div');
                    tipDiv.className = 'auth-warning absolute top-0 left-0 right-0 bg-yellow-50 border-b border-yellow-200 p-3 z-10';
                    tipDiv.innerHTML = `
                        <div class="flex items-center justify-between">
                            <div class="flex items-center space-x-2">
                                <span class="text-yellow-600">âš ï¸</span>
                                <span class="text-sm text-yellow-800">401 ì—ëŸ¬ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì¿ í‚¤ ë™ê¸°í™”ë¥¼ ì‹œë„í•˜ê±°ë‚˜ í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•˜ì„¸ìš”.</span>
                            </div>
                            <button onclick="this.parentElement.parentElement.remove()" class="text-yellow-600 hover:text-yellow-800">Ã—</button>
                        </div>
                    `;
                    iframe.parentElement.appendChild(tipDiv);
                }
            } catch (e) {
                // Cross-origin ì œí•œìœ¼ë¡œ ì ‘ê·¼ ë¶ˆê°€ (ì •ìƒì ì¸ ìƒí™©)
                console.log('iframe ì½˜í…ì¸  ì ‘ê·¼ ë¶ˆê°€ (cross-origin)');
            }
        }

        // ë„¤ë¹„ê²Œì´ì…˜ í•¨ìˆ˜ë“¤
        function navigateTab(tabId, action) {
            try {
                const iframe = document.getElementById(`iframe-${tabId}`);
                const addressBar = document.getElementById(`address-${tabId}`);

                if (!iframe || !addressBar) return;

                switch (action) {
                    case 'back':
                        try {
                            iframe.contentWindow.history.back();
                        } catch (e) {
                            console.log('ë’¤ë¡œê°€ê¸° ì‹¤íŒ¨:', e);
                        }
                        break;
                    case 'forward':
                        try {
                            iframe.contentWindow.history.forward();
                        } catch (e) {
                            console.log('ì•ìœ¼ë¡œê°€ê¸° ì‹¤íŒ¨:', e);
                        }
                        break;
                    case 'refresh':
                        iframe.src = iframe.src;
                        break;
                    case 'go':
                        const url = addressBar.value;
                        if (url && url.trim()) {
                            if (isValidUrl(url.trim())) {
                                iframe.src = url.trim();
                            } else {
                                showToast('ì˜¬ë°”ë¥¸ URL í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤.', 'error');
                            }
                        }
                        break;
                }
            } catch (error) {
                console.error('ë„¤ë¹„ê²Œì´ì…˜ ì˜¤ë¥˜:', error);
                showToast('ë„¤ë¹„ê²Œì´ì…˜ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
            }
        }

        function handleAddressKeypress(event, tabId) {
            if (event.key === 'Enter') {
                navigateTab(tabId, 'go');
            }
        }

        function openInNewWindow(url) {
            try {
                if (!isValidUrl(url)) {
                    showToast('ì˜¬ë°”ë¥¸ URLì´ ì•„ë‹™ë‹ˆë‹¤.', 'error');
                    return;
                }

                const windowFeatures = 'width=1200,height=800,menubar=yes,toolbar=yes,location=yes,status=yes,scrollbars=yes,resizable=yes';
                const win = window.open(url, '_blank', windowFeatures);

                if (!win) {
                    showToast('íŒì—…ì´ ì°¨ë‹¨ë˜ì—ˆìŠµë‹ˆë‹¤. íŒì—… í—ˆìš© í›„ ë‹¤ì‹œ ì‹œë„í•˜ì„¸ìš”.', 'error');
                }
            } catch (error) {
                console.error('ìƒˆ ì°½ ì—´ê¸° ì˜¤ë¥˜:', error);
                showToast('ìƒˆ ì°½ì„ ì—´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.', 'error');
            }
        }

        function focusWindow(windowName) {
            try {
                const win = windowRefs[windowName];
                if (win && !win.closed) {
                    win.focus();
                } else {
                    showToast('ì°½ì´ ë‹«í˜”ìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì„ íƒí•´ì£¼ì„¸ìš”.', 'error');
                    delete windowRefs[windowName];
                }
            } catch (error) {
                console.error('ì°½ í¬ì»¤ìŠ¤ ì˜¤ë¥˜:', error);
                showToast('ì°½ì— ì ‘ê·¼í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.', 'error');
            }
        }

        // ëª¨ë°”ì¼ ì‚¬ì´ë“œë°” í† ê¸€ í•¨ìˆ˜
        function toggleMobileSidebar() {
            try {
                const sidebar = document.getElementById('function-sidebar');
                const overlay = document.querySelector('.sidebar-mobile-overlay');
                
                sidebar.classList.toggle('active');
                overlay.classList.toggle('active');
                
                // ëª¨ë°”ì¼ì—ì„œ body ìŠ¤í¬ë¡¤ ë°©ì§€
                if (sidebar.classList.contains('active')) {
                    document.body.style.overflow = 'hidden';
                } else {
                    document.body.style.overflow = '';
                }
            } catch (error) {
                console.error('ëª¨ë°”ì¼ ì‚¬ì´ë“œë°” í† ê¸€ ì˜¤ë¥˜:', error);
            }
        }

        // ì‚¬ì´ë“œë°” í† ê¸€ í•¨ìˆ˜ë“¤
        function toggleFunctionSidebar() {
            try {
                const sidebar = document.getElementById('function-sidebar');
                const adminPanel = document.getElementById('admin-panel');
                const icon = document.getElementById('function-toggle-icon');

                // ë°ìŠ¤í¬í†±ì—ì„œë§Œ ì‘ë™ (ëª¨ë°”ì¼ì€ ë³„ë„ ì²˜ë¦¬)
                if (window.innerWidth > 768) {
                    sidebar.classList.toggle('sidebar-collapsed');

                    if (sidebar.classList.contains('sidebar-collapsed')) {
                        icon.textContent = 'â€º';
                        // ê¸°ëŠ¥ ëª©ë¡ì´ ì ‘íˆë©´ ì–´ë“œë¯¼ íŒ¨ë„ë„ ìˆ¨ê¹€
                        adminPanel.classList.add('hidden');
                        adminPanel.classList.remove('flex');
                    } else {
                        icon.textContent = 'â€¹';
                    }
                }
            } catch (error) {
                console.error('ì‚¬ì´ë“œë°” í† ê¸€ ì˜¤ë¥˜:', error);
            }
        }

        function toggleDataGenerator() {
            try {
                const dataGeneratorFunctions = document.querySelector('.data-generator-functions');
                const arrow = document.getElementById('data-generator-arrow');

                if (dataGeneratorFunctions.style.display === 'none') {
                    dataGeneratorFunctions.style.display = 'block';
                    arrow.textContent = 'â–²';
                } else {
                    dataGeneratorFunctions.style.display = 'none';
                    arrow.textContent = 'â–¼';
                }
            } catch (error) {
                console.error('ë°ì´í„° ìƒì„±ê¸° í† ê¸€ ì˜¤ë¥˜:', error);
            }
        }

        function toggleAdminFunctions() {
            try {
                const adminFunctions = document.querySelector('.admin-functions');
                const arrow = document.getElementById('admin-functions-arrow');

                if (adminFunctions.style.display === 'none') {
                    adminFunctions.style.display = 'block';
                    arrow.textContent = 'â–²';
                } else {
                    adminFunctions.style.display = 'none';
                    arrow.textContent = 'â–¼';
                }
            } catch (error) {
                console.error('ì–´ë“œë¯¼ ê¸°ëŠ¥ í† ê¸€ ì˜¤ë¥˜:', error);
            }
        }

        function openAdminFunction(functionId) {
            selectFunction(functionId, document.querySelector(`[data-function="${functionId}"]`));
        }

        // ì§ì ‘ ë„êµ¬ ì—´ê¸° í•¨ìˆ˜ (2ë‹¨ê³„ ë©”ë‰´ ì—†ì´ ë°”ë¡œ ë„êµ¬ í‘œì‹œ)
        function openDirectTool(toolId) {
            try {
                // ì–´ë“œë¯¼ ê¸°ëŠ¥ ëª©ë¡ì˜ í™œì„±í™” ìŠ¤íƒ€ì¼ ì œê±°
                document.querySelectorAll('.admin-functions .function-item').forEach(item => {
                    item.classList.remove('bg-blue-100');
                });

                // ê¸°ì¡´ íƒ­ë“¤ ëª¨ë‘ ì •ë¦¬
                clearAllTabs();

                // ì–´ë“œë¯¼ íŒ¨ë„ ìˆ¨ê¸°ê¸°
                const adminPanel = document.getElementById('admin-panel');
                adminPanel.classList.add('hidden');

                // íƒ­ í—¤ë” ìˆ¨ê¸°ê¸°
                document.getElementById('tab-header').classList.add('hidden');

                // ë¹ˆ ìƒíƒœ ìˆ¨ê¸°ê¸°
                const emptyState = document.getElementById('empty-state');
                if (emptyState) {
                    emptyState.style.display = 'none';
                }

                // ê¸°ì¡´ ì½˜í…ì¸  ì •ë¦¬
                const contentContainer = document.getElementById('content-container');
                let toolHTML = '';

                // ë¡œë”© ìƒíƒœ í‘œì‹œ
                showLoadingState(contentContainer);

                setTimeout(() => {
                    switch(toolId) {
                        case 'sample-image-generator':
                            toolHTML = getSampleImageGeneratorHTML();
                            break;
                        case 'qr-xlsx-generator':
                            toolHTML = getQRXlsxGeneratorHTML();
                            break;
                        case 'csv-generator':
                            toolHTML = getCsvGeneratorHTML();
                            break;
                        default:
                            toolHTML = '<div class="p-8 text-center text-red-500">ë„êµ¬ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</div>';
                    }

                    // ë©”ì¸ ì½˜í…ì¸  ì˜ì—­ì— ë„êµ¬ í‘œì‹œ
                    contentContainer.innerHTML = toolHTML;

                    // ìƒ˜í”Œ ì´ë¯¸ì§€ ìƒì„±ê¸°ì¸ ê²½ìš° ì´ˆê¸° ì´ë¯¸ì§€ ìƒì„±
                    if (toolId === 'sample-image-generator') {
                        setTimeout(generateSampleImage, 100);
                    }
                }, 300);
            } catch (error) {
                console.error('ì§ì ‘ ë„êµ¬ ì—´ê¸° ì˜¤ë¥˜:', error);
                showErrorState(document.getElementById('content-container'), 'ë„êµ¬ë¥¼ ë¡œë“œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
            }
        }

        function toggleAdminPanel() {
            try {
                const panel = document.getElementById('admin-panel');
                const icon = document.getElementById('admin-toggle-icon');

                panel.classList.toggle('admin-panel-collapsed');

                if (panel.classList.contains('admin-panel-collapsed')) {
                    icon.textContent = 'â€º';
                } else {
                    icon.textContent = 'â€¹';
                }
            } catch (error) {
                console.error('ì–´ë“œë¯¼ íŒ¨ë„ í† ê¸€ ì˜¤ë¥˜:', error);
            }
        }

        // ë„êµ¬ HTML ìƒì„± í•¨ìˆ˜ë“¤
        function getSampleImageGeneratorHTML() {
            return `
                <div class="h-full overflow-auto bg-white">
                    <div class="p-6 border-b border-gray-200">
                        <h1 class="text-2xl font-bold text-gray-800">ìƒ˜í”Œ ì´ë¯¸ì§€ ìƒì„±ê¸°</h1>
                        <p class="text-gray-600 mt-2">ë‹¤ì–‘í•œ í¬ë§·ì˜ ìƒ˜í”Œ ì´ë¯¸ì§€ë¥¼ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                    </div>
                    <div class="p-6">
                        <div class="max-w-2xl mx-auto">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">ì´ë¯¸ì§€ í¬ê¸°</label>
                                        <select id="sample-imageSize" class="w-full px-3 py-2 border border-gray-300 rounded-md">
                                            <option value="100x100">100x100</option>
                                            <option value="200x200">200x200</option>
                                            <option value="400x400" selected>400x400</option>
                                            <option value="800x600">800x600</option>
                                            <option value="1920x1080">1920x1080</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">ë°°ê²½ìƒ‰</label>
                                        <input type="color" id="sample-bgColor" value="#f0f0f0" class="w-full h-10 border border-gray-300 rounded-md">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">í…ìŠ¤íŠ¸</label>
                                        <input type="text" id="sample-imageText" value="Sample Image" class="w-full px-3 py-2 border border-gray-300 rounded-md">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">ìƒì„±í•  ì´ë¯¸ì§€ ê°œìˆ˜</label>
                                        <input type="number" id="sample-imageCount" value="5" min="1" max="100" class="w-full px-3 py-2 border border-gray-300 rounded-md">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">ì´ë¯¸ì§€ í¬ë§·</label>
                                        <div class="space-y-2">
                                            <label class="flex items-center">
                                                <input type="checkbox" name="imageFormat" value="PNG" checked class="mr-2">
                                                <span>PNG</span>
                                            </label>
                                            <label class="flex items-center">
                                                <input type="checkbox" name="imageFormat" value="JPG" checked class="mr-2">
                                                <span>JPG</span>
                                            </label>
                                            <label class="flex items-center">
                                                <input type="checkbox" name="imageFormat" value="JPEG" checked class="mr-2">
                                                <span>JPEG</span>
                                            </label>
                                            <label class="flex items-center">
                                                <input type="checkbox" name="imageFormat" value="WEBP" checked class="mr-2">
                                                <span>WEBP</span>
                                            </label>
                                        </div>
                                    </div>
                                    <button onclick="generateSampleImage()" class="w-full bg-purple-600 text-white py-2 px-4 rounded-md hover:bg-purple-700">
                                        ì´ë¯¸ì§€ ìƒì„±í•˜ê¸°
                                    </button>
                                </div>
                                <div>
                                    <div class="border border-gray-300 rounded-md p-4 bg-gray-50 min-h-64 flex items-center justify-center">
                                        <canvas id="sample-canvas" class="border border-gray-200"></canvas>
                                    </div>
                                    <button id="sample-downloadBtn" onclick="downloadSampleImage()" class="w-full mt-4 bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700 disabled:opacity-50" disabled>
                                        ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function getQRXlsxGeneratorHTML() {
            return `
                <div class="h-full overflow-auto bg-white">
                    <div class="p-6 border-b border-gray-200">
                        <h1 class="text-2xl font-bold text-gray-800">QR XLSX ìƒì„±ê¸°</h1>
                        <p class="text-gray-600 mt-2">QR ì½”ë“œ ì •ë³´ê°€ í¬í•¨ëœ XLSX íŒŒì¼ì„ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                    </div>
                    <div class="p-6">
                        <div class="max-w-4xl mx-auto space-y-6">
                            <div class="space-y-4">
                                <div class="border-t pt-4">
                                    <h3 class="text-lg font-medium text-gray-700 mb-4">QR ì½”ë“œ ë°ì´í„° í•„ë“œ</h3>
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">CID</label>
                                            <input type="text" id="qr-cid" value="" placeholder="ë¹ˆê°’" class="w-full px-3 py-2 border border-gray-300 rounded-md">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">TID</label>
                                            <input type="text" id="qr-tid" value="" placeholder="ë¹ˆê°’" class="w-full px-3 py-2 border border-gray-300 rounded-md">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">ì§€ì—­ì½”ë“œ</label>
                                            <input type="text" id="qr-region" value="JEJU" class="w-full px-3 py-2 border border-gray-300 rounded-md">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">VAN</label>
                                            <input type="text" id="qr-van" value="KIS" class="w-full px-3 py-2 border border-gray-300 rounded-md">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">íœ´ëŒ€í°ë²ˆí˜¸</label>
                                            <input type="text" id="qr-phone" value="01025710628" class="w-full px-3 py-2 border border-gray-300 rounded-md">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">ë¹„ê³ </label>
                                            <input type="text" id="qr-remark" value="" placeholder="ë¹ˆê°’" class="w-full px-3 py-2 border border-gray-300 rounded-md">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <button onclick="generateQRXlsx()" class="bg-green-600 text-white py-3 px-6 rounded-md hover:bg-green-700">QR XLSX íŒŒì¼ ìƒì„±</button>
                            <div id="qr-preview" class="mt-6 p-4 border border-gray-300 rounded-md bg-gray-50 hidden">
                                <h3 class="text-lg font-medium mb-4">ìƒì„± ì™„ë£Œ!</h3>
                                <p>XLSX íŒŒì¼ì´ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤.</p>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function getCsvGeneratorHTML() {
            return `
                <div class="h-full overflow-auto bg-white">
                    <div class="p-6 border-b border-gray-200">
                        <h1 class="text-2xl font-bold text-gray-800">CSV ìƒì„±ê¸°</h1>
                        <p class="text-gray-600 mt-2">ì»¤ìŠ¤í…€ CSV íŒŒì¼ì„ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                    </div>
                    <div class="p-6">
                        <div class="max-w-4xl mx-auto space-y-6">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">ìƒì„±í•  í–‰ ìˆ˜</label>
                                <input type="number" id="csv-rowCount" value="10" min="1" max="1000" class="w-full max-w-xs px-3 py-2 border border-gray-300 rounded-md">
                            </div>

                            <div class="space-y-4">
                                <h3 class="text-lg font-medium text-gray-800">ì—´ ì„¤ì •</h3>

                                <!-- 1ì—´ (í•„ìˆ˜) -->
                                <div class="p-4 border border-gray-200 rounded-md">
                                    <div class="flex items-center justify-between mb-3">
                                        <span class="font-medium">1ì—´ (í•„ìˆ˜)</span>
                                    </div>
                                    <div class="space-y-3">
                                        <div>
                                            <label class="flex items-center">
                                                <input type="radio" name="col1Type" value="random" checked class="mr-2">
                                                <span>í…ìŠ¤íŠ¸ ì…ë ¥</span>
                                            </label>
                                            <input type="text" id="col1-text" placeholder="í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”" class="mt-2 w-full px-3 py-2 border border-gray-300 rounded-md">
                                        </div>
                                        <div>
                                            <label class="flex items-center">
                                                <input type="radio" name="col1Type" value="custom" class="mr-2">
                                                <span>ë‚œìˆ˜ë°œìƒ</span>
                                            </label>
                                        </div>
                                    </div>
                                </div>

                                <!-- 2ì—´ (ì„ íƒ) -->
                                <div class="p-4 border border-gray-200 rounded-md">
                                    <div class="flex items-center justify-between mb-3">
                                        <span class="font-medium">2ì—´ í¬í•¨</span>
                                        <label class="flex items-center">
                                            <input type="checkbox" id="col2-enable" checked class="mr-2" onchange="toggleCsvColumn(2)">
                                            <span>ì‚¬ìš©</span>
                                        </label>
                                    </div>
                                    <div class="space-y-3" id="col2-options">
                                        <div>
                                            <label class="flex items-center">
                                                <input type="radio" name="col2Type" value="random" checked class="mr-2">
                                                <span>í…ìŠ¤íŠ¸ ì…ë ¥</span>
                                            </label>
                                            <input type="text" id="col2-text" placeholder="í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”" class="mt-2 w-full px-3 py-2 border border-gray-300 rounded-md">
                                        </div>
                                        <div>
                                            <label class="flex items-center">
                                                <input type="radio" name="col2Type" value="custom" class="mr-2">
                                                <span>ë‚œìˆ˜ë°œìƒ</span>
                                            </label>
                                        </div>
                                    </div>
                                </div>

                                <!-- 3ì—´ (ì„ íƒ) -->
                                <div class="p-4 border border-gray-200 rounded-md">
                                    <div class="flex items-center justify-between mb-3">
                                        <span class="font-medium">3ì—´ í¬í•¨</span>
                                        <label class="flex items-center">
                                            <input type="checkbox" id="col3-enable" class="mr-2" onchange="toggleCsvColumn(3)">
                                            <span>ì‚¬ìš©</span>
                                        </label>
                                    </div>
                                    <div class="space-y-3 hidden" id="col3-options">
                                        <div>
                                            <label class="flex items-center">
                                                <input type="radio" name="col3Type" value="random" checked class="mr-2">
                                                <span>í…ìŠ¤íŠ¸ ì…ë ¥</span>
                                            </label>
                                            <input type="text" id="col3-text" placeholder="í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”" class="mt-2 w-full px-3 py-2 border border-gray-300 rounded-md">
                                        </div>
                                        <div>
                                            <label class="flex items-center">
                                                <input type="radio" name="col3Type" value="custom" class="mr-2">
                                                <span>ë‚œìˆ˜ë°œìƒ</span>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <button onclick="generateCsvFile()" class="bg-blue-600 text-white py-3 px-6 rounded-md hover:bg-blue-700">ë¯¸ë¦¬ë³´ê¸°</button>

                            <div id="csv-preview" class="mt-6 p-4 border border-gray-300 rounded-md bg-gray-50 hidden">
                                <h3 class="text-lg font-medium mb-4">CSV ë¯¸ë¦¬ë³´ê¸°</h3>
                                <div id="csv-preview-content" class="overflow-auto max-h-64">
                                    <table class="min-w-full border-collapse">
                                        <thead>
                                            <tr class="bg-gray-200">
                                                <th class="border border-gray-300 px-4 py-2">1ì—´</th>
                                                <th class="border border-gray-300 px-4 py-2">2ì—´</th>
                                                <th class="border border-gray-300 px-4 py-2">3ì—´</th>
                                            </tr>
                                        </thead>
                                        <tbody id="csv-preview-body">
                                        </tbody>
                                    </table>
                                </div>
                                <button onclick="downloadCsv()" class="mt-4 bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700">
                                    CSV ë‹¤ìš´ë¡œë“œ
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
        document.addEventListener('DOMContentLoaded', function() {
            try {
                // ì–´ë“œë¯¼ ê¸°ëŠ¥ í•­ëª© í´ë¦­ ì´ë²¤íŠ¸
                document.querySelectorAll('.admin-functions .function-item').forEach(item => {
                    item.addEventListener('click', function() {
                        const funcId = this.dataset.function;
                        if (funcId) {
                            openAdminFunction(funcId);
                        }
                    });
                });

                // ë°ì´í„° ìƒì„± ë„êµ¬ í•­ëª© í´ë¦­ ì´ë²¤íŠ¸
                document.querySelectorAll('.data-generator-functions .function-item').forEach(item => {
                    item.addEventListener('click', function() {
                        // ëª¨ë“  ë°ì´í„° ìƒì„± í•­ëª©ì˜ í™œì„±í™” ìŠ¤íƒ€ì¼ ì œê±°
                        document.querySelectorAll('.data-generator-functions .function-item').forEach(el => {
                            el.classList.remove('bg-blue-100');
                        });
                        // í˜„ì¬ í´ë¦­í•œ í•­ëª©ì— í™œì„±í™” ìŠ¤íƒ€ì¼ ì¶”ê°€
                        this.classList.add('bg-blue-100');
                        
                        const funcId = this.dataset.function;
                        if (funcId) {
                            openDirectTool(funcId);
                        }
                    });
                });

                // ì¿ í‚¤ ë™ê¸°í™” ë²„íŠ¼
                const cookieSyncBtn = document.getElementById('cookie-sync-btn');
                if (cookieSyncBtn) {
                    cookieSyncBtn.addEventListener('click', showCookieModal);
                }

                // í† í° ë™ê¸°í™” ë²„íŠ¼
                const tokenSyncBtn = document.getElementById('token-sync-btn');
                if (tokenSyncBtn) {
                    tokenSyncBtn.addEventListener('click', syncTokens);
                }

                // ìƒˆ íƒ­ ë²„íŠ¼
                const newTabBtn = document.getElementById('new-tab-btn');
                if (newTabBtn) {
                    newTabBtn.addEventListener('click', function() {
                        if (selectedAdmin) {
                            createTab(selectedAdmin);
                        } else {
                            showToast('ë¨¼ì € ì–´ë“œë¯¼ì„ ì„ íƒí•˜ì„¸ìš”.', 'error');
                        }
                    });
                }

                // ìƒˆ ì°½ ë²„íŠ¼
                const newWindowBtn = document.getElementById('new-window-btn');
                if (newWindowBtn) {
                    newWindowBtn.addEventListener('click', function() {
                        if (selectedAdmin) {
                            openInNewWindow(selectedAdmin.url);
                        } else {
                            showToast('ë¨¼ì € ì–´ë“œë¯¼ì„ ì„ íƒí•˜ì„¸ìš”.', 'error');
                        }
                    });
                }

                // ì¿ í‚¤ ì…ë ¥ì°½ ì—”í„°í‚¤ ì²˜ë¦¬
                const cookieInput = document.getElementById('cookie-input');
                if (cookieInput) {
                    cookieInput.addEventListener('keypress', function(e) {
                        if (e.key === 'Enter') {
                            addCookie();
                        }
                    });
                }

                // ì´ˆê¸°í™”
                updateTokenStatus();

                // ì£¼ê¸°ì ìœ¼ë¡œ í† í° ìƒíƒœ ì—…ë°ì´íŠ¸
                setInterval(updateTokenStatus, 5000);

                console.log('ì‚¬ì¥ë‹˜ í”ŒëŸ¬ìŠ¤ í—¬í”„ì„¼í„°ê°€ ì„±ê³µì ìœ¼ë¡œ ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤.');
            } catch (error) {
                console.error('ì´ˆê¸°í™” ì˜¤ë¥˜:', error);
                showToast('ì• í”Œë¦¬ì¼€ì´ì…˜ ì´ˆê¸°í™” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
            }
        });

        // ë©”ì‹œì§€ ìˆ˜ì‹  (ë‹¤ë¥¸ ì°½ì—ì„œì˜ í† í° ë™ê¸°í™” ìš”ì²­)
        window.addEventListener('message', function(event) {
            try {
                if (event.data && event.data.type === 'REQUEST_TOKENS') {
                    const tokens = getStoredTokens();
                    event.source.postMessage({
                        type: 'SYNC_TOKENS',
                        tokens: tokens
                    }, event.origin);
                }
            } catch (error) {
                console.error('ë©”ì‹œì§€ ì²˜ë¦¬ ì˜¤ë¥˜:', error);
            }
        });

        // ì—ëŸ¬ ì „ì—­ ì²˜ë¦¬
        window.addEventListener('error', function(event) {
            console.error('ì „ì—­ ì—ëŸ¬:', event.error);
            showToast('ì˜ˆìƒì¹˜ ëª»í•œ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
        });

        // ê¸€ë¡œë²Œ í•¨ìˆ˜ë“¤ (onclickì—ì„œ ì‚¬ìš©)
        window.closeTab = closeTab;
        window.focusWindow = focusWindow;
        window.navigateTab = navigateTab;
        window.handleAddressKeypress = handleAddressKeypress;
        window.openInNewWindow = openInNewWindow;
        window.toggleDataGenerator = toggleDataGenerator;
        window.toggleAdminFunctions = toggleAdminFunctions;
        window.toggleFunctionSidebar = toggleFunctionSidebar;
        window.toggleMobileSidebar = toggleMobileSidebar;
        window.toggleAdminPanel = toggleAdminPanel;
        window.openAdminFunction = openAdminFunction;
        window.openDirectTool = openDirectTool;
        window.showCookieModal = showCookieModal;
        window.closeCookieModal = closeCookieModal;
        window.addCookie = addCookie;
        window.syncTokens = syncTokens;
        window.generateSampleImage = generateSampleImage;
        window.downloadSampleImage = downloadSampleImage;
        window.generateQRXlsx = generateQRXlsx;
        window.generateCsvFile = generateCsvFile;
        window.downloadCsv = downloadCsv;
        window.toggleCsvColumn = toggleCsvColumn;
        <img src="../favicon-32x32.jpg" height="32" width="32"/></script>
</body>
</html>